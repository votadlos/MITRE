<html><body><table border="1" cellspacing="0"><tr><th>Technique</th><th>Step</th><th>Procedures</th><th colspan="2">CarbonBlack</th><th colspan="2">CounterTack</th><th colspan="2">CrowdStrike</th><th colspan="2">Cybereason</th><th colspan="2">Endgame</th><th colspan="2">F-Secure</th><th colspan="2">FireEye</th><th colspan="2">McAfee</th><th colspan="2">Microsoft</th><th colspan="2">PaloAltoNetworks</th><th colspan="2">RSA</th><th colspan="2">SentinelOne</th></tr><tr><td rowspan="5"><b>Query Registry</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1012/">T1012</a>)</td><td>12.E.1.7</td><td>Empire: WinEnum module included enumeration of system information via a Registry query</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1.6.1-1.png" target="_blank"><small>Telemetry showing the Get-Sysinfo function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-05.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.6-1.png" target="_blank"><small>Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.7-1.png" target="_blank"><small>Enrichment of the enumeration of system information via a Registry query as suspicious (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment-Tainted</p><p>Indicator of Compromise</p>32</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>13.C.1</td><td>Empire: 'reg query' via PowerShell to enumerate a specific Registry key</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-13.C.1-1.png" target="_blank"><small>Telemetry showing process tree with reg.exe and command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-13.C.1-2.png" target="_blank"><small>Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-13.C.1-1.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-13.C.1-4.png" target="_blank"><small>Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-13.C.1-2.png" target="_blank"><small>OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-13.C.1-3.png" target="_blank"><small>OverWatch General Behavior alert indicating reg query was suspicious</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed-Tainted</p><p>General Behavior-Delayed</p>58</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-13.C.1-10.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-13-3.png" target="_blank"><small>Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-13.A.1-1.png" target="_blank"><small>Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.G.1-2.png" target="_blank"><small>Telemetry showing powershell.exe executing reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-13.C.1-1.png" target="_blank"><small>Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-13.A.1-2.png" target="_blank"><small>Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-13.A.1-1.png" target="_blank"><small>Telemetry showed powershell.exe executing reg.exe (tainted by parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.C.1-1.png" target="_blank"><small>Telemetry showing execution of reg.exe and command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.C.1-2.png" target="_blank"><small>Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-13.B.3-1.png" target="_blank"><small>Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-13.B.3-2.png" target="_blank"><small>Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-13-1.png" target="_blank"><small>Telemetry showing execution of reg.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-13.A.1-1.png" target="_blank"><small>Telemetry showing execution of reg.exe and command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.H.1</td><td>Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.H.1-1.png" target="_blank"><small>Telemetry from process tree showing reg.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.H.1-2.png" target="_blank"><small>Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.H.1-1.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (reg query not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.G.1-1.png" target="_blank"><small>Telemetry showing reg with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating reg query was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.H.1-11.png" target="_blank"><small>Telemetry showing cmd.exe executing reg with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.H.1-10.png" target="_blank"><small>Telemetry within a process tree showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-15.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.H.1-1.png" target="_blank"><small>Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.H.1-2.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.G.2-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.G.2-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing reg) </small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>General Behavior</p><p>Telemetry</p><p>General Behavior</p>85</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.H.1-1.png" target="_blank"><small>Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.H.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about reg</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-99.png" target="_blank"><small>Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery).</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-26.png" target="_blank"><small>Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.H.1-2.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.H.1-1.png" target="_blank"><small>Telemetry showing execution sequence for reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.H.1-2.png" target="_blank"><small>Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.H.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-4.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.H.1-1.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>17.A.1</td><td>Empire: 'reg query' via PowerShell to enumerate a specific Registry key</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.A.1-2.png" target="_blank"><small>Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.A.1-1.png" target="_blank"><small>Telemetry from process tree showing reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-17.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing reg.exe (tainted by the parent \"New Windows service created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-17.A.1-1.png" target="_blank"><small>Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-17.A.1-10.png" target="_blank"><small>Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-2.png" target="_blank"><small>Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-1.png" target="_blank"><small>Event tree view showing tainted powershell.exe with reg.exe child process</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-1.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-2.png" target="_blank"><small>Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-3.png" target="_blank"><small>General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>Enrichment</p><p>General Behavior</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-17.A.1-1.png" target="_blank"><small>Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-2.png" target="_blank"><small>Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-9.png" target="_blank"><small>Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.A.1-2.png" target="_blank"><small>Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.A.1-1.png" target="_blank"><small>Telemetry showing reg.exe executing with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.A.1-3.png" target="_blank"><small>Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.A.1-2.png" target="_blank"><small>Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-17-1.png" target="_blank"><small>Telemetry showing reg.exe execution</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-17.A.1-4.png" target="_blank"><small>Threat story graph showing telemetry of reg.exe executing (tainted by prior lateral movement alert by Group ID)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>6.A.1</td><td>Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.A.1-1.png" target="_blank"><small>Telemetry from process tree showing reg.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.A.1-2.png" target="_blank"><small>Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-6.A.1-2.png" target="_blank"><small>Telemetry showing PIPEs created (tainted by the parent \"Powershell process created\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-6.A.1-1.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments (tainted by the parent \"Powershell process created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.A.1-1.png" target="_blank"><small>Telemetry showing reg with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.A.1-2.png" target="_blank"><small>OverWatch General Behavior alert identifying reg query as suspicious as well as reg.exe process (tainted by previous detection by orange line indicating medium severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed-Tainted</p>31</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.A.1-10.png" target="_blank"><small>Telemetry showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-1.png" target="_blank"><small>Telemetry showing reg with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-4.png" target="_blank"><small>Event tree view of telemetry showing reg with command-line arguments (tainted by parent Process Injection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-6.A.1-1.png" target="_blank"><small>Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-6.A.1-2.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.A.1-1.png" target="_blank"><small>Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.A.1-2.png" target="_blank"><small>File Write To Named Pipe  alert for write to remote named pipe from reg.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.A.1-3.png" target="_blank"><small>Additional details on named pipe alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.A.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about reg query</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-3.png" target="_blank"><small>Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.A.1-11.png" target="_blank"><small>Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.A.1-7.png" target="_blank"><small>Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.A.1-5.png" target="_blank"><small>General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>General Behavior-Delayed</p>49</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.A.1-2.png" target="_blank"><small>Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.A.1-1.png" target="_blank"><small>Telemetry showing execution sequence for reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.A.1-2.png" target="_blank"><small>Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.A.1-3.png" target="_blank"><small>Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-06-1.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-6.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing reg with command-line arguments (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="23"><b>Command-Line Interface</b><br><br><i>Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1059/">T1059</a>)</td><td>2.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.A.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.D.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.D.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.E.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.E.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.F.1</td><td>Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick </td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.F.1-1.png" target="_blank"><small>Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.F.1-3.png" target="_blank"><small>Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.F.1-2.png" target="_blank"><small>Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.F.1-3.png" target="_blank"><small>Telemetry showing wscript.exe execute autoupate.vbs and resulting powershell.exe (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.F.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.F.1-1.png" target="_blank"><small>Telemetry showing svchost.exe creating cmd.exe and executing autoupdate.vbs as user Kmitnick</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.F.1-2.png" target="_blank"><small>Telemetry showing wscript.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.F.1-1.png" target="_blank"><small>Telemetry showing cmd.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.F.1-13.png" target="_blank"><small>Parent alert on Malicious PowerShell Command (Invoke-RunAs)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.F.1-11.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.vbs though wscript.exe (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-11.png" target="_blank"><small>Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-10.png" target="_blank"><small>Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-9.png" target="_blank"><small>Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-4.png" target="_blank"><small>General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.F.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.F.1-1.png" target="_blank"><small>Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.F.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.F.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.F.1-2.png" target="_blank"><small>Enrichment of wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.F.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by parent PowerShell alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Parent alert for PowerShell script with suspicious content tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-5.png" target="_blank"><small>Parent alert for malicious PowerShell cmdlet tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-3.png" target="_blank"><small>Parent alert for PowerShell with suspicious command-line tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.F.1-3.png" target="_blank"><small>Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.F.1-2.png" target="_blank"><small>Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.F.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Indicator of Compromise</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-6.png" target="_blank"><small>Telemetry showing cmd.exe and executing autoupdate.vbs as user Kmitnick</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.F.1-1.png" target="_blank"><small>Telemetry showing cmd.exe launching autoupdate.vbs (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.F.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.F.3</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.C.2 </td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.G.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.G.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.F.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>7.C.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>8.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>8.A.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.H.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>4.A.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>6.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>4.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>4.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>4.C.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="7"><b>System Service Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1007/">T1007</a>)</td><td>12.D.1</td><td>Empire: 'net start' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.A.D.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.D.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-6.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net start was part of basic reconnaissance activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.D.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.D.1-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.D.1-1.png" target="_blank"><small>Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-1.png" target="_blank"><small>Enriched event tree showing enrichment of  net.exe with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.B.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.D.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.D.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-99.png" target="_blank"><small>General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-3.png" target="_blank"><small>Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-2.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>General Behavior</p>52</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.D.1-2.png" target="_blank"><small>Process tree view of \"Suspicious sequence of discovery activities\" alert context with net.exe command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.D.1-1.png" target="_blank"><small>Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-3.png" target="_blank"><small>General Behavior alert description for \"Suspicious sequence of discovery activities\"</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.D.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.D.1-3.png" target="_blank"><small>General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.D.1-2.png" target="_blank"><small>Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>General Behavior-Tainted</p>46</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-1.png" target="_blank"><small>Threat story showing initial compromise alert and powershell.exe tainting net.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>17.A.1</td><td>Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.A.1-1.png" target="_blank"><small>Telemetry from process tree showing reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-17.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing reg.exe (tainted by the parent \"New Windows service created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-17.A.1-1.png" target="_blank"><small>Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-17.A.1-20.png" target="_blank"><small>Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-2.png" target="_blank"><small>Telemetry from event tree showing reg.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-1.png" target="_blank"><small>Event tree view showing tainted powershell.exe with reg.exe child process</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-1.png" target="_blank"><small>Telemetry showing reg.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-17.A.1-1.png" target="_blank"><small>Telemetry showing reg.exe executing with command-line arguments (tainted by parent Reg Execution alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-99.png" target="_blank"><small>Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-2.png" target="_blank"><small>Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-9.png" target="_blank"><small>Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.A.1-2.png" target="_blank"><small>Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.A.1-1.png" target="_blank"><small>Telemetry showing reg.exe query for terminal server setting</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.A.1-3.png" target="_blank"><small>Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.A.1-2.png" target="_blank"><small>Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-17-1.png" target="_blank"><small>Telemetry showing reg.exe query for terminal server setting</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-17.A.1-4.png" target="_blank"><small>Threat story graph showing telemetry of reg.exe with query for terminal server setting (tainted by prior lateral movement alert by Group ID)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>16.J.1</td><td>Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.J.1-1.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.H.1-3.png" target="_blank"><small>Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.J.1-1.png" target="_blank"><small>Enrichment showing powershell.exe executing sc.exe query AdobeUpdater service on Creeper (enriched with condition SC QC Reconnaissance Command, tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-11.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed Bob querying for a service (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.J.1-1.png" target="_blank"><small>Telemetry showing sc.exe execution to query the AdobeUpdater service on Creeper process tree view (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.J.1-10.png" target="_blank"><small>Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" target="_blank"><small>Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.I.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-1.png" target="_blank"><small>Telemetry showing sc.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.J.1-1.png" target="_blank"><small>Additional details on enrichment of sc.exe with SC Execution alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.L.1-1.png" target="_blank"><small>Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-4.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-3.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried. </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.J.1-1.png" target="_blank"><small>Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.J.1-2.png" target="_blank"><small>Enrichment of powershell.exe executing sc.exe as enumeration of services via the command line (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.J.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-7.png" target="_blank"><small>Telemetry showing execution of sc.exe to query the AdobeUpdater service on 10.0.0.4 (Creeper)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.J.1-1.png" target="_blank"><small>Telemetry showing execution of sc.exe to query AdobeUpdater service on Creeper (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.D.2</td><td>Cobalt Strike: 'net start' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.D.2-2.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.D.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.D.2-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net start not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.D.2-1.png" target="_blank"><small>Telemetry showing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.D.2-10.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.B.1-10.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-7.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.D.2-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.D.2-98.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.D.2-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing net) </small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Telemetry</p><p>General Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.D.2-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.D.2-1.png" target="_blank"><small>Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery) </small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-5.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.D.2-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.D.2-2.png" target="_blank"><small>Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.D.2-1.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.D.2-3.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-7.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.D.1</td><td>Cobalt Strike: 'sc query' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.D.1-1.png" target="_blank"><small>Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.A-ALL.png" target="_blank"><small>Telemetry from process tree showing sc.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.D.1-1.png" target="_blank"><small>Enrichment of sc.exe with condition SC Query Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (sc query not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating sc query was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.B.1-1.png" target="_blank"><small>Telemetry showing sc with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.B.1-10.png" target="_blank"><small>Telemetry showing cmd.exe executing sc with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.D.1-10.png" target="_blank"><small>Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-6.png" target="_blank"><small>Telemetry showing sc.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.D.2-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.D.1-1.png" target="_blank"><small>Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.D.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about sc</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.D.1-2.png" target="_blank"><small>Additional details from enrichment of sc.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-1.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the sc.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-23.png" target="_blank"><small>Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-4.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.D.1-1.png" target="_blank"><small>Telemetry showing execution sequence for sc.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.D.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing sc with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-2.png" target="_blank"><small>Telemetry showing sc.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-6.png" target="_blank"><small>Telemetry showing sc.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.E.1.8</td><td>Empire: WinEnum module included enumeration of services</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-06.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Services function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-2.png" target="_blank"><small>Telemetry of execution sequence showing Get-Service invocation</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.8-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.H.1</td><td>Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.H.1-3.png" target="_blank"><small>Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.H.1-2.png" target="_blank"><small>Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.H.1-1.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution for the service query</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.H.1-1.png" target="_blank"><small>Enrichment showing powershell.exe executing sc.exe to query services on Creeper (enriched with condition SC Query Reconnaissance Command, tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.H.1-1.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution to query services on Creeper (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-11.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed Bob querying for a service on Creeper (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.H.1-10.png" target="_blank"><small>Telemetry of sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" target="_blank"><small>Enrichment of sc.exe execution to query services on Creeper with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)  (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-12.png" target="_blank"><small>Telemetry showing sc.exe execution to query services on Creeper</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.H.1-2.png" target="_blank"><small>General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.H.1-1.png" target="_blank"><small>Additional details on enrichment of sc.exe with SC Execution alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.L.1-1.png" target="_blank"><small>Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-4.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-3.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.H.1-1.png" target="_blank"><small>Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.H.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.H.1-3.png" target="_blank"><small>Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.H.1-2.png" target="_blank"><small>General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Tainted</p><p>Enrichment</p>49</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-7.png" target="_blank"><small>Telemetry showing execution of sc.exe to query services on 10.0.0.4 (Creeper)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.H.1-1.png" target="_blank"><small>Telemetry showing execution of sc.exe to query services on Creeper (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>File Permissions Modification</b><br><br><i>Defense Evasion</i><br><br>(<a href="https://attack.mitre.org/techniques/T1222/">T1222</a>)</td><td>17.B.1</td><td>Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.A.1-2.png" target="_blank"><small>Enrichment of takeown.exe execution with tag \"Permission modifications\"</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.B.1-1.png" target="_blank"><small>Telemetry from process tree showing takeown.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Configuration Change</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-17.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing takeown.exe (tainted by the parent \"New Windows service created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-17.B.1-1.png" target="_blank"><small>Telemetry from process tree view showing execution of takeown.exe (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-11.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed takeown.exe executed to bypass Windows logon (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-17.B.1-10.png" target="_blank"><small>General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-1.png" target="_blank"><small>Telemetry from event tree showing takeown.exe (tainted by parent alerts on powershell.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-1.png" target="_blank"><small>Telemetry showing takeown.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-2.png" target="_blank"><small>Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-3.png" target="_blank"><small>General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>General Behavior</p>100</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-17.B.1-1.png" target="_blank"><small>Enrichment of takeown.exe with Takeown Execution alert</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-9.png" target="_blank"><small>Enrichment of takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-1.png" target="_blank"><small>Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.B.1-1.png" target="_blank"><small>Telemetry showing takeown.exe execution with magnify.exe in command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.A.1-2.png" target="_blank"><small>Process tree view of suspicious PowerShell command-line alert showing tainted relationship to takeown.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.B.1-2.png" target="_blank"><small>Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.B.1-3.png" target="_blank"><small>Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-17-1.png" target="_blank"><small>Telemetry showing takeown.exe execution with magnify.exe in command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-17.A.1-1.png" target="_blank"><small>Enrichment showing takeown.exe execution (tainted by prior lateral movement alert by Group ID)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td></tr><tr><td>17.B.2</td><td>Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.A.1-2.png" target="_blank"><small>Enrichment of icacls.exe execution with tag \"Permission modifications\"</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.B.2-1.png" target="_blank"><small>Telemetry from process tree showing icacls.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Configuration Change</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-17.B.2-1.png" target="_blank"><small>Telemetry showing powershell.exe executing icacls.exe (tainted by the parent \"New Windows service created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-17.B.2-1.png" target="_blank"><small>Telemetry from process tree view showing execution of icacls.exe (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-11.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed icacls.exe executed to bypass Windows logon (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-17.B.2-10.png" target="_blank"><small>Telemetry showing icacls.exe executing  with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-1.png" target="_blank"><small>Telemetry from event tree showing icacls.exe (tainted by parent alerts on powershell.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-1.png" target="_blank"><small>Telemetry showing icacls.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-2.png" target="_blank"><small>Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-3.png" target="_blank"><small>General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>General Behavior</p>100</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-17.B.2-1.png" target="_blank"><small>Enrichment of icacls.exe with Icacls Execution alert</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-9.png" target="_blank"><small>Enrichment of icacls.exe with a suspicious indicator that full access permissions were given to certain users</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-1.png" target="_blank"><small>Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.B.2-1.png" target="_blank"><small>Telemetry showing icacls.exe execution with magnify.exe in command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.A.1-2.png" target="_blank"><small>Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.B.2-1.png" target="_blank"><small>Telemetry showing powershell.exe executing icacls with command-line arguments (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.B.2-2.png" target="_blank"><small>Enrichment of icacls.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-17-1.png" target="_blank"><small>Telemetry showing icacls.exe execution with magnify.exe in command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-17.A.1-3.png" target="_blank"><small>Telemetry showing icacls.exe execution (tainted by prior lateral movement alert by Group ID)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="3"><b>Masquerading</b><br><br><i>Defense Evasion</i><br><br>(<a href="https://attack.mitre.org/techniques/T1036/">T1036</a>)</td><td>19.A.1</td><td>Empire: File dropped to disk is a renamed copy of the WinRAR binary</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.A.1-1.png" target="_blank"><small>Telemetry showing filemod creation of recycler.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.A.1-2.png" target="_blank"><small>Binary metadata showing recycler.exe is WinRAR.exe based on digital signature and file version information</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.A.1-2.png" target="_blank"><small>Telemetry showing SHA256 hash of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.A.1-100.png" target="_blank"><small>Telemetry showing recycler.exe identified as WinRAR via file metadata (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-1.png" target="_blank"><small>Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-2.png" target="_blank"><small>Telemetry showing MD5 hash of recycler.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-1.png" target="_blank"><small>Telemetry showing the MD5/SHA256 hash value of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-1.png" target="_blank"><small>Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-2.png" target="_blank"><small>Binary reputation and metadata for recycler.exe showing WinRAR information</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.A.1-1.png" target="_blank"><small>Telemetry showing file create/write and hash values of recycler.exe (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.A.1-1.png" target="_blank"><small>Telemetry showing file write of recycler.exe with file hashes</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.A.1-2.png" target="_blank"><small>Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>16.I.1</td><td>Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.I.1-2.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution setting the AdobeUpdater service description</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.I.1-1.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.I.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.H.1-3.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution with the AdobeUpdater service description (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.H.1-4.png" target="_blank"><small>Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.I.1-21.png" target="_blank"><small>Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" target="_blank"><small>Telemetry of sc.exe executions to create and set the description of a new service on Creeper (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.I.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-1.png" target="_blank"><small>Telemetry showing sc.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.I.1-1.png" target="_blank"><small>Additional details on enrichment of sc.exe with SC Execution alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.L.1-1.png" target="_blank"><small>Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with related correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-4.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.I.1-1.png" target="_blank"><small>Telemetry showing execution sequence of sc.exe AdobeUpdater remote service creation</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.I.1-5.png" target="_blank"><small>Telemetry showed execution of sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-7.png" target="_blank"><small>Telemetry showing execution of sc.exe to create the AdobeUpdater service and set its description</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.I.1-1.png" target="_blank"><small>Telemetry showing execution of sc.exe to create the AdobeUpdater service and set the description (partially shown one line above; both tainted by prior threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>19.B.1</td><td>Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.A.1-1.png" target="_blank"><small>Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.B.1-5.png" target="_blank"><small>Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.B.1-1.png" target="_blank"><small>Enrichment showing recycler.exe creating old.rar (enriched with \"Data Exfiltration Archiving\", tainted by parent \"Powershell executed encoded command\" alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.B.1-3.png" target="_blank"><small>Telemetry showing recycler.exe with full command-line (tainted by parent \"Powershell executed encoded commands\" and \"Policy Dropper Behavior\" alerts)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted-Configuration Change</p><p>Telemetry-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.B.1-1.png" target="_blank"><small>Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.B.1-3.png" target="_blank"><small>Additional alert details showing recycler.exe was signed by win.rar GmbH</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p><p>Specific Behavior-Delayed</p>124</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.B.1-20.png" target="_blank"><small>Telemetry showing recycler.exe execution (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-1.png" target="_blank"><small>Telemetry showing execution of recycler.exe with command-line arguments and creation of old.rar output (tainted by Windows Script Executing PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-4.png" target="_blank"><small>Specific Behavior alert for the execution of recycler.exe named \"Exfiltration-Encrypting Files with WinRar\" (tainted by Windows Script Executing PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.B.1-4.png" target="_blank"><small>Telemetry showing recycler.exe metadata, which identified it as WinRAR</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-2.png" target="_blank"><small>Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-3.png" target="_blank"><small>Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-1.png" target="_blank"><small>General Behavior alert for Execution from Suspicious Directory</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-4.png" target="_blank"><small>General Behavior alert for File Write To Root Of Recycle Bin</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-5.png" target="_blank"><small>Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>Enrichment</p><p>General Behavior</p><p>Enrichment</p><p>Specific Behavior-Delayed</p>162</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-2.png" target="_blank"><small>Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-3.png" target="_blank"><small>Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.B.1-1.png" target="_blank"><small>Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression indicating it is WinRAR</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-3.png" target="_blank"><small>Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.B.1-1.png" target="_blank"><small>Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.B.1-2.png" target="_blank"><small>Enrichment of recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-19-1.png" target="_blank"><small>Telemetry showing execution of recycler.exe with command-line arguments indicating it is WinRAR</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.A.1-2.png" target="_blank"><small>Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.B.1-1.png" target="_blank"><small>Enrichment showing the execution of recycler.exe with process name identified as \"Command line RAR\"</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Service Execution</b><br><br><i>Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1035/">T1035</a>)</td><td>16.L.1</td><td>Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.L.1-1.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution to start the AdobeUpdater service on Creeper</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.L.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe start AdobeUpdater service on Creeper (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.L.1-2.png" target="_blank"><small>Telemetry showing AdobeUpdater service starting on Creeper (tainted by the parent \"\"New Windows service created\"\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-11.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed execution of update.vbs following the AdobeUpdater service start (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.L.1-1.png" target="_blank"><small>Telemetry showing sc start in the process tree view (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.L.1-12.png" target="_blank"><small>Telemetry showing cmd.exe executing update.vbs</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.L.1-100.png" target="_blank"><small>Telemetry showing sc.exe executing the service (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-15.png" target="_blank"><small>Specific Behavior alert \"Service Command Lateral Movement\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" target="_blank"><small>Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p><p>Specific Behavior</p>76</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.I.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-1.png" target="_blank"><small>Telemetry showing sc.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-3.png" target="_blank"><small>Specific Behavior alert for sc.exe used with parameters typical for lateral movement</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>General Behavior</p>100</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.I.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.L.1-1.png" target="_blank"><small>Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-4.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-3.png" target="_blank"><small>Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.L.1-2.png" target="_blank"><small>Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.L.1-3.png" target="_blank"><small>Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.L.1-1.png" target="_blank"><small>Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.L.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.L.1-3.png" target="_blank"><small>Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.L.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing update.vbs on 10.0.0.4 (Creeper)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-8.png" target="_blank"><small>Telemetry showing the execution of update.vbs on 10.0.0.4 (Creeper)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-9.png" target="_blank"><small>Telemetry showing the execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.L.1-1.png" target="_blank"><small>Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.G.1-1.png" target="_blank"><small>Lateral movement alert generated by the remote service start on Creeper</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior</p>37</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="4"><b>System Owner/User Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1033/">T1033</a>)</td><td>2.B.1</td><td>Cobalt Strike: 'echo' via cmd to enumerate specific environment variables</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.B.1-1.png" target="_blank"><small>Telemetry from process tree showing echo with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.B.1-1.png" target="_blank"><small>Telemetry showing echo with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (echo not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating echo was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.B.1-1.png" target="_blank"><small>Telemetry showing echo with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.B.1-100.png" target="_blank"><small>Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-4.png" target="_blank"><small>Telemetry showing echo with command-line arguments (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.B.1-99.png" target="_blank"><small>A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.B.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing the echo command</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.B.1-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command) </small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Telemetry</p><p>General Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about echo</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-1.png" target="_blank"><small>Telemetry showing echo with command-line arguments</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-1.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the echo command (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-3.png" target="_blank"><small>Telemetry showing cmd.exe executing the echo command</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-23.png" target="_blank"><small>Enrichment of echo command with a correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.B.1-1.png" target="_blank"><small>Telemetry showing execution sequence for echo with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-5.png" target="_blank"><small>Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.B.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.B.1-2.png" target="_blank"><small>Enrichment of cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-1.png" target="_blank"><small>Telemetry showing echo with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-4.png" target="_blank"><small>Telemetry showing echo with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>20.B.1</td><td>Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-20.B.1-2.png" target="_blank"><small>Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-20.B.1-1.png" target="_blank"><small>Telemetry from process tree with telemetry showing whoami.exe execution</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-20.B.1-1.png" target="_blank"><small>Telemetry showing magnify.exe executing whoami.exe (tainted by the parent POS Interactive Login Event alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-20.B.1-1.png" target="_blank"><small>Telemetry from process tree showing magnify.exe child process whoami.exe (tainted by pink line indicating critical severity)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-20.B.1-10.png" target="_blank"><small>Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-20-1.png" target="_blank"><small>Telemetry from event tree showing execution of whoami.exe (tainted by parent alert on magnify.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-20-2.png" target="_blank"><small>Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-6.png" target="_blank"><small>Enrichment of whoami.exe with a tag identifying the command as enumeration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-7.png" target="_blank"><small>General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-5.png" target="_blank"><small>Telemetry showing the execution of whoami</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>Enrichment</p><p>General Behavior</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-5.png" target="_blank"><small>Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-6.png" target="_blank"><small>Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-20.A.1-2.png" target="_blank"><small>Telemetry showing magnify.exe (original name identified as cmd.exe) executing whoami.exe (tainted by a trace detection on magnify.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-20.A.1-3.png" target="_blank"><small>Specific Behavior alert for the whoami command was executed through a masqueraded tool (magnify.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-20.A.1-1.png" target="_blank"><small>Execution sequence showing whoami.exe executing from magnify.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-20.A.1-4.png" target="_blank"><small>Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-20.B.1-1.png" target="_blank"><small>Telemetry showing magnify.exe executing whoami.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-20.B.1-2.png" target="_blank"><small>Enrichment of whoami.exe executing as an enumeration command</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-20-1.png" target="_blank"><small>Telemetry showing whoami.exe execution</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-20.B.1-1.png" target="_blank"><small>Enrichment of whoami command (displays logged on user information)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td></tr><tr><td>12.B.1</td><td>Empire: 'whoami /all /fo list' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.B.1-1.png" target="_blank"><small>Telemetry from process tree showing whoami.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.B.1-2.png" target="_blank"><small>Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.B.1-1.png" target="_blank"><small>Enrichment of whoami.exe with condition Whoami Reconnaissance Command (tainted by parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-6.png" target="_blank"><small>Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.B.1-1.png" target="_blank"><small>OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior-Delayed-Tainted</p><p>Telemetry</p><p>General Behavior-Delayed</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.B.1-1.png" target="_blank"><small>Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.B.1-2.png" target="_blank"><small>Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-2.png" target="_blank"><small>Telemetry showing whoami.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-1.png" target="_blank"><small>Enriched event tree showing enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.B.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing whoami.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.A.1-1.png" target="_blank"><small>Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.B.1-1.png" target="_blank"><small>Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-3.png" target="_blank"><small>Telemetry showing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-2.png" target="_blank"><small>Enrichment of whoami.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.B.1-1.png" target="_blank"><small>Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-4.png" target="_blank"><small>Process tree view of \"Suspicious sequence of exploration activities\" alert showing tainted powershell.exe process</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-1.png" target="_blank"><small>Telemetry showing whoami.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-3.png" target="_blank"><small>Telemetry showing whoami.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-2.png" target="_blank"><small>Continued threat story showing initial compromise alert and powershell.exe tainting whoami.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.E.1.1</td><td>Empire: WinEnum module included enumeration of user information</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-02.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Get-UserInfo function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.1-1.png" target="_blank"><small>Indicator of Compromise alert identifying suspicious PowerShell strings as Empire UserInfo</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Indicator of Compromise</p>20</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Standard Cryptographic Protocol</b><br><br><i>Command and Control</i><br><br>(<a href="https://attack.mitre.org/techniques/T1032/">T1032</a>)</td><td>11.B.1</td><td>Empire: Encrypted C2 channel established using HTTPS</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-11.B.1-2.png" target="_blank"><small>Telemetry showing modloads and certificate check</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.B.1-11.png" target="_blank"><small>Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.A.1-13.png" target="_blank"><small>Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-2.png" target="_blank"><small>Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-6.png" target="_blank"><small>Telemetry showing connection to letsencrypt.org</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.A.1-5.png" target="_blank"><small>Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.B.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>General Behavior-Delayed</p>27</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.A.1-5.png" target="_blank"><small>Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.B.1-4.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.B.1-3.png" target="_blank"><small>Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.B.1-4.png" target="_blank"><small>Telemetry within alert showing decoded command-line arguments containing HTTPS</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-11-2.png" target="_blank"><small>Telemetry showing network connections, including over port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Password Policy Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1201/">T1201</a>)</td><td>12.E.1.3</td><td>Empire: WinEnum module included enumeration of password policy information</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-03.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Password Last Changed function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="6"><b>System Network Configuration Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1016/">T1016</a>)</td><td>12.A.2</td><td>Empire: 'ipconfig /all' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.A.2-1.png" target="_blank"><small>Telemetry from process tree showing ipconfig.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.A.1-1.png" target="_blank"><small>Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.A.2-1.png" target="_blank"><small>Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-6.png" target="_blank"><small>Email excerpt from the OverWatch team indicating ipconfig was part of basic reconnaissance activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.A.1-2.png" target="_blank"><small>Telemetry from process tree showing ipconfig.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.A.2-1.png" target="_blank"><small>Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-2.png" target="_blank"><small>Telemetry showing ipconfig.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-1.png" target="_blank"><small>Event tree view of telemetry showing ipconfig.exe with command-line arguments (tainted by parent PowerShell alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.B.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.A.2-4.png" target="_blank"><small>Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.A.2-3.png" target="_blank"><small>Telemetry showing ipconfig.exe with command line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.2-1.png" target="_blank"><small>Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-3.png" target="_blank"><small>Telemetry showing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-2.png" target="_blank"><small>Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-4.png" target="_blank"><small>Process tree view of \"Suspicious sequence of exploration activities\" alert showing tainted powershell.exe process</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-2.png" target="_blank"><small>Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.A.2-2.png" target="_blank"><small>Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.A.2-1.png" target="_blank"><small>Telemetry showing powershell.exe executing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-1.png" target="_blank"><small>Telemetry showing ipconfig.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-3.png" target="_blank"><small>Telemetry showing ipconfig.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-1.png" target="_blank"><small>Threat story showing initial compromise alert and powershell.exe tainting ipconfig.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>4.B.1</td><td>Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.B.1-1.png" target="_blank"><small>Telemetry from process tree showing netsh.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.B.1-2.png" target="_blank"><small>Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-4.B.1-1.png" target="_blank"><small>Telemetry showing netsh.exe with command-line arguments (tainted by the parent \"Powershell Execution Policy ByPass command ran\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.B.1-1.png" target="_blank"><small>OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior-Delayed</p><p>Telemetry</p><p>General Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.B.1-10.png" target="_blank"><small>Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-1.png" target="_blank"><small>Telemetry from event tree showing netsh with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-4.B.1-2.png" target="_blank"><small>Telemetry showing netsh.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.B.1-1.png" target="_blank"><small>Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about netsh</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-2.png" target="_blank"><small>Enrichment of netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-10.png" target="_blank"><small>Process tree within trace detection showing cmd.exe executing netsh.exe (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.B.1-1.png" target="_blank"><small>Telemetry showing execution sequence for netsh.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.A.1-2.png" target="_blank"><small>Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.B.1-2.png" target="_blank"><small>Enrichment of netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.B.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing netsh with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-04-1.png" target="_blank"><small>Telemetry showing netsh.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-4.A.1-2.png" target="_blank"><small>Telemetry showing netsh.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.A.1</td><td>Empire: 'route print' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.A.1-2.png" target="_blank"><small>Telemetry from process tree showing route.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.A.1-1.png" target="_blank"><small>Enrichment of route.exe with conditions Reconnaissance Tool and Route Spawned with Reconnaissance (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-6.png" target="_blank"><small>Email excerpt from the OverWatch team indicating route print was part of basic reconnaissance activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.A.1-1.png" target="_blank"><small>Telemetry from process tree showing route.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.A.1-1.png" target="_blank"><small>Telemetry showing route.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-2.png" target="_blank"><small>Telemetry showing route.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-1.png" target="_blank"><small>Event tree view of telemetry showing route.exe with command-line arguments (tainted by parent PowerShell alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.B.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.A.1-1.png" target="_blank"><small>Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.A.1-2.png" target="_blank"><small>Telemetry showing route.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-1.png" target="_blank"><small>Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-3.png" target="_blank"><small>Telemetry showing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-2.png" target="_blank"><small>Enrichment of route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-4.png" target="_blank"><small>Process tree view of \"Suspicious sequence of exploration activities\" alert showing tainted powershell.exe process</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-1.png" target="_blank"><small>Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.A.1-2.png" target="_blank"><small>Enrichment of route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-1.png" target="_blank"><small>Telemetry showing route.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-3.png" target="_blank"><small>Telemetry showing route.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-2.png" target="_blank"><small>Continued threat story showing initial compromise alert and powershell.exe tainting route.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-1.png" target="_blank"><small>Threat story showing partial tree of activity from the initial compromise alert</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.A.2</td><td>Cobalt Strike: 'arp -a' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.A.2-2.png" target="_blank"><small>Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.A.2-1.png" target="_blank"><small>Telemetry from process tree showing arp.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.A.2-1.png" target="_blank"><small>Telemetry showing arp.exe with command-line arguments (tainted by the parent Script File Created alert) </small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (arp not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.2-1.png" target="_blank"><small>Telemetry showing arp with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating arp was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.A.2-10.png" target="_blank"><small>Telemetry showing arp.exe executing within the process tree (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.B.1-10.png" target="_blank"><small>Telemetry showing cmd.exe executing arp with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.A.2-5.png" target="_blank"><small>Telemetry showing cmd.exe executing arp with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-3.png" target="_blank"><small>Telemetry showing arp.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.2-2.png" target="_blank"><small>Enrichment of arp.exe indicating its usage can be a sign of reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.2-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior</p>45</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-2.png" target="_blank"><small>Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-5.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about arp.exe execution</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing arp.exe (tainted by a trace detection on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-23.png" target="_blank"><small>Enrichment of arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-6.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-2.png" target="_blank"><small>Telemetry showing execution sequence for arp.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.2-1.png" target="_blank"><small>Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.2-3.png" target="_blank"><small>Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.2-2.png" target="_blank"><small>Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.2-4.png" target="_blank"><small>Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment-Tainted</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-1.png" target="_blank"><small>Telemetry showing arp.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.2-1.png" target="_blank"><small>Telemetry showing arp.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.A.1</td><td>Cobalt Strike: 'ipconfig /all' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.A.1-1.png" target="_blank"><small>Telemetry from process tree showing ipconfig.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.A.1-2.png" target="_blank"><small>Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.A.1-1.png" target="_blank"><small>Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (ipconfig not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-2.png" target="_blank"><small>Telemetry showing ipconfig with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating ipconfig was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.A.1-10.png" target="_blank"><small>Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.B.1-10.png" target="_blank"><small>Telemetry showing cmd.exe executing ipconfig with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-1.png" target="_blank"><small>Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-2.png" target="_blank"><small>Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.1-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.1-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.1-2.png" target="_blank"><small>Enrichment of ipconfig.exe with a tag identifying the command as enumeration</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>General Behavior</p>75</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-1.png" target="_blank"><small>Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing ipconfig.exe (tainted by a trace detection on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-23.png" target="_blank"><small>Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-4.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of discovery techniques</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of discovery techniques</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-1.png" target="_blank"><small>Telemetry showing execution sequence for ipconfig.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.1-2.png" target="_blank"><small>Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.1-3.png" target="_blank"><small>Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.A.1-4.png" target="_blank"><small>General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment-Tainted</p><p>General Behavior-Tainted</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-1.png" target="_blank"><small>Telemetry showing ipconfig.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-3.png" target="_blank"><small>Telemetry showing ipconfig.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.E.1.11</td><td>Empire: WinEnum module included enumeration of network adapters</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-10.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Network Adapters function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-3.png" target="_blank"><small>Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-2.png" target="_blank"><small>Telemetry of execution sequence showing Get-NetInfo invocation</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.11-1.png" target="_blank"><small>Indicator of Compromise alert identifying suspicious PowerShell strings as Empire NetInfo</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Indicator of Compromise</p>20</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-3.png" target="_blank"><small>Additional telemetry showing powershell.exe WMI queries for network adapter and configuration information</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-2.png" target="_blank"><small>Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>User Execution</b><br><br><i>Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1204/">T1204</a>)</td><td>1.A.1</td><td>Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.A.1-2.png" target="_blank"><small>Telemetry from process tree showing Resume Viewer.exe execution sequence</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.A.1-1.png" target="_blank"><small>General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-1.A.1-2.png" target="_blank"><small>Telemetry showing Resume Viewer.exe running (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.A.1-1.png" target="_blank"><small>Machine Learning General Behavior alert showing execution of Resume Viewer.exe and detection as malicious</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.A.1-11.png" target="_blank"><small>General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.A.1-10.png" target="_blank"><small>General Behavior alert identifying Resume Viewer.exe as unknown malware</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.A.1-100.png" target="_blank"><small>Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>General Behavior</p><p>Telemetry-Tainted</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-2.png" target="_blank"><small>Event tree view showing Malicious File Detection General Behavior alert on Resume Viewer.exe execution</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-1.png" target="_blank"><small>Malicious File Detection General Behavior alert on Resume Viewer.exe execution and surrounding telemetry</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry-Tainted</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-1.A.1-4.png" target="_blank"><small>Telemetry showing the execution of Resume Viewer.exe</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.A.1-5.png" target="_blank"><small>Telemetry showing Resume Viewer.exe being executed by explorer.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.A.1-1.png" target="_blank"><small>General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Configuration Change</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-1.A.1-1.png" target="_blank"><small>Telemetry showing that Resume Viewer.exe was executed by Explorer.exe by user Debbie</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-8.png" target="_blank"><small>Exploit Guard audit of Resume Viewer.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-4.png" target="_blank"><small>Telemetry showing execution of pdfhelper.cmd and update.dat</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-5.png" target="_blank"><small>Telemetry showing execution of decoy PDF by MicrosoftPdfReader.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-6.png" target="_blank"><small>Telemetry showing Resume Viewer.exe binary and process metadata</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-7.png" target="_blank"><small>Telemetry showing Resume Viewer.exe binary reputation</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-1.png" target="_blank"><small>Telemetry showing execution of Resume Viewer.exe from explorer.exe and dropping pdfhelper.cmd and autoupdate.bat</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-2.png" target="_blank"><small>Telemetry showing write of pdfhelper.cmd</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-3.png" target="_blank"><small>Telemetry showing write of autoupdate.bat</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.A.1-1.png" target="_blank"><small>Telemetry showing Resume Viewer.exe running as a process</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-01-1.png" target="_blank"><small>Telemetry showing Resume Viewer.exe execution</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.A.1-1.png" target="_blank"><small>Telemetry from process tree showing execution of Resume Viewer.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.A.1-2.png" target="_blank"><small>General Behavior alert for execution of Resume Viewer.exe as a suspicious file</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Data from Network Shared Drive</b><br><br><i>collection</i><br><br>(<a href="https://attack.mitre.org/techniques/T1039/">T1039</a>)</td><td>18.B.1</td><td>Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-18.B.1-1.png" target="_blank"><small>Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-18.A.1-3.png" target="_blank"><small>Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-18.B.1-1.png" target="_blank"><small>Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-18.B.1-1.png" target="_blank"><small>Telemetry showing a file event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-18.B.1-2.png" target="_blank"><small>Specific Behavior alert for a script engine reading files from network locations (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p>64</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-18.B.1-1.png" target="_blank"><small>Exported telemetry of threat story (taints event) showing .vsdx file copy from network shared drive on Conficker</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>9.B.1</td><td>Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-9.B.1-20.png" target="_blank"><small>Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-09-3.png" target="_blank"><small>Telemetry showing .vsdx file creation, but no indication of network shared drive (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-9.B.1-1.png" target="_blank"><small>Telemetry showing a file read event for the .vsdx file from the network shared drive</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-9.B.1-1.png" target="_blank"><small>Telemetry showing .vsdx file access from WormShare on the network shared drive</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="4"><b>Process Injection</b><br><br><i>Defense Evasion, Privilege Escalation</i><br><br>(<a href="https://attack.mitre.org/techniques/T1055/">T1055</a>)</td><td>3.C.1</td><td>Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-3.C.1-3.png" target="_blank"><small>Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-3.C.1-2.png" target="_blank"><small>Telemetry showing open handles and thread injection into cmd.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-3.C.1-1.png" target="_blank"><small>Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-3.C.1-1.png" target="_blank"><small>Specific Behavior alert for DLL injection detection labeled with Process Hijacking and Privilege Escalation (tainted by the parent \"Powershell process created\" alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Tainted</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-3.C.1-2.png" target="_blank"><small>Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-3.C.1-1.png" target="_blank"><small>Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p><p>General Behavior-Delayed-Tainted</p>91</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-3.C.1-10.png" target="_blank"><small>Specific Behavior alert for powershell.exe injecting into cmd.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-3.C.1-100.png" target="_blank"><small>Specific Behavior alert for PowerShell injection into cmd.exe mapped to ATT&CK Tactic (Defense Evasion) and Technique (Process Injection) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Tainted</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-03-2.png" target="_blank"><small>Specific Behavior alert for process injection into cmd.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-3.C.1-1.png" target="_blank"><small>Specific Behavior alert for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-3.C.1-2.png" target="_blank"><small>Continued excerpt from the Managed Defense Report showing the artifact evidence of a process injection from PowerShell.exe to cmd.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-3.C.1-1.png" target="_blank"><small>Excerpt from the Managed Defense Report identifying a process injection from PowerShell.exe to cmd.exe (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Delayed</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-3.C.1-1.png" target="_blank"><small>Specific Behavior alert  for a process injection from PowerShell into cmd.exe based on both connecting to a named pipe, tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.C.1-4.png" target="_blank"><small>Telemetry showing process injection activity audited by Exploit Guard</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.C.1-1.png" target="_blank"><small>Enrichment of powershell.exe injecting into cmd.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.C.1-2.png" target="_blank"><small>Alert for \'Suspicious PowerShell command-line\' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.C.1-3.png" target="_blank"><small>Specific Behavior alert showing powershell.exe process injection</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment-Tainted</p><p>Specific Behavior-Delayed</p>69</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-3.C.1-1.png" target="_blank"><small>Specific Behavior alert for PowerShell injecting shellcode (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Tainted</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-03-2.png" target="_blank"><small>Telemetry showing powershell.exe creating a remote thread into cmd.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-3.C.1-2.png" target="_blank"><small>Telemetry showing powershell.exe injecting into cmd.exe (Group ID tainted this event but was not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>8.D.1</td><td>Cobalt Strike: Screen capture capability involved process injection into explorer.exe</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-8.D.1-1.png" target="_blank"><small>Telemetry showing \"open handle\" crossproc on explorer.exe by the process</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.D.1-1.png" target="_blank"><small>Telemetry showing remote thread being created into explorer.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.D.1-2.png" target="_blank"><small>Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.D.1-20.png" target="_blank"><small>Specific Behavior alert for Malicious code injection to explorer.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.D.1-21.png" target="_blank"><small>Specific Behavior alert for process injection explorer.exe rolled into chain of injections</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-08-3.png" target="_blank"><small>Event tree showing process injection Specific Behavior alert (last alert in the view, ID 2561310) (tainted by parent Malicious File Detection and process injection alerts and labeled with the correct ATT&CK Technique, Process Injection, and Tactics, Defense Evasion and Execution)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Tainted</p>57</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-8.D.1-9.png" target="_blank"><small>Specific Behavior alert for code injection into explorer.exe, tagged with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-8.D.1-1.png" target="_blank"><small>Specific Behavior alert for code injection into explorer.exe (tainted by a trace detection on cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Tainted</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.D.1-2.png" target="_blank"><small>Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \"Inject to process\")</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.D.1-2.png" target="_blank"><small>Enrichment of cmd.exe injecting into explorer.exe as code injection via CreateThread</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-08-4.png" target="_blank"><small>Floating Code module generated from DLL injection showing introspection into the module's characteristics (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-8.D.1-1.png" target="_blank"><small>Telemetry showing powershell.exe injecting into explorer.exe (Group ID tainted this event but was not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>5.A.1</td><td>Cobalt Strike: Credential dump capability involved process injection into lsass</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.A.1-1.png" target="_blank"><small>Telemetry showing cross process events, specifically a handle to open thread into lsass.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.1-1.png" target="_blank"><small>General Behavior alert showing DDNA Scan for svchost.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.1-3.png" target="_blank"><small>General Behavior alert additional details on DDNA Scan for svchost.exe, including that it appears to inject code into another process</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.1-2.png" target="_blank"><small>General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p>30</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-5.A.1-8.png" target="_blank"><small>Enrichment showing ReflectiveDllOpenLsass and ProcessHollowingDetected events</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.1-11.png" target="_blank"><small>Specific Behavior alert with correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.1-21.png" target="_blank"><small>Data within alert showing loaded powerkatz.dll as floating executable code</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-05-1.png" target="_blank"><small>Telemetry showing process accesses into lsass.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.1-1.png" target="_blank"><small>Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.1-3.png" target="_blank"><small>Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.2-2.png" target="_blank"><small>Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-5.A.1-1.png" target="_blank"><small>A Specific Behavior alert for a suspicious handle being opened to lsass.exe, tagged with a related ATT&CK Technique (Credential Dumping)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>5.A.2</td><td>Cobalt Strike: Hash dump capability involved process injection into lsass.exe</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.A.2-4.png" target="_blank"><small>Specific Behavior alert showing correct ATT&CK Technique (Process Injection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.A.2-1.png" target="_blank"><small>Alert showing correct ATT&CK Technique (Process Injection) within process tree</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.A.2-2.png" target="_blank"><small>Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.2-2.png" target="_blank"><small>Specific Behavior alert showing process hijacking detection for lsass.exe thread create (tainted by the parent \"Powershell process created\" and \"Policy Remote Process Compromise\" alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.2-3.png" target="_blank"><small>General Behavior alert showing DDNA Scan for svchost.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.2-5.png" target="_blank"><small>General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>General Behavior</p>87</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-5.A.2-5.png" target="_blank"><small>Enrichment showing ReflectiveDllOpenLsass, ProcessHollowingDetected, and LsassInjectedCode events</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.2-10.png" target="_blank"><small>Specific Behavior alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.2-20.png" target="_blank"><small>Details of Specific Behavior alert for svchost.exe process injection into lsass.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.2-11.png" target="_blank"><small>Data within alert showing loaded hashdumpx64.dll as floating executable code</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-05-2.png" target="_blank"><small>Telemetry showing process injection into lsass.exe (tainted by parent Process Injection alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-05-5.png" target="_blank"><small>Specific Behavior alert mapped to the correct ATT&CK Technique (Process Injection)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-5.A.2-1.png" target="_blank"><small>Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.1-1.png" target="_blank"><small>Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.2-1.png" target="_blank"><small>Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.2-2.png" target="_blank"><small>Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-5.A.1-2.png" target="_blank"><small>Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-5.A.2-1.png" target="_blank"><small>Telemetry showing powershell.exe invoking a remote thread into lsass.exe (Group ID tainted this event but was not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="3"><b>Remote System Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1018/">T1018</a>)</td><td>13.A.1</td><td>Empire: 'net group "Domain Computers" /domain' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-13.A.1-2.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (Account Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-13.A.1-1.png" target="_blank"><small>Telemetry showing process tree with net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-13.A.1-1.png" target="_blank"><small>Enrichment of net.exe with condition Net Group Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-13.A.1-1.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-13.A.1-2.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>General Behavior-Delayed</p>46</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-13.A.1-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-13.A.1-10.png" target="_blank"><small>Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-13-2.png" target="_blank"><small>Telemetry from event tree showing with net.exe with command-line arguments (tainted by parent alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-13-3.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery) (tainted by parent alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-13.A.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.1-3.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-13.A.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-13.A.1-2.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-13.A.1-1.png" target="_blank"><small>Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.A.1-2.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.A.1-3.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.A.1-1.png" target="_blank"><small>Telemetry showing execution of net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-13.A.1-1.png" target="_blank"><small>Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-13.A.1-2.png" target="_blank"><small>Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-13-1.png" target="_blank"><small>Telemetry showing execution of net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-13.A.1-1.png" target="_blank"><small>Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>4.A.1</td><td>Cobalt Strike: 'net group "Domain Controllers" /domain' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.A.1-2.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK technique (Account Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.A.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-4.A.1-1.png" target="_blank"><small>Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \"Powershell Execution Policy ByPass command ran\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.A.1-3.png" target="_blank"><small>OverWatch General Behavior alert for net group</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.A.1-2.png" target="_blank"><small>Additional process tree view showing net.exe enrichment</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.A.1-1.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Telemetry</p><p>General Behavior-Delayed</p><p>General Behavior-Delayed</p>79</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.A.1-101.png" target="_blank"><small>Telemetry showing net.exe executing with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.A.1-100.png" target="_blank"><small>General Behavior alert for net.exe executing as part of a suspicious execution chain</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.A.1-10.png" target="_blank"><small>Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-2.png" target="_blank"><small>Enriched event tree showing enrichment of net with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-1.png" target="_blank"><small>Telemetry from event tree showing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Delayed</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-4.A.1-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-4.A.1-1.png" target="_blank"><small>Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net group</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.A.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-2.png" target="_blank"><small>Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-10.png" target="_blank"><small>Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.A.1-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.A.1-2.png" target="_blank"><small>Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.A.1-2.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.A.1-3.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.A.1-4.png" target="_blank"><small>Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>Enrichment</p><p>Enrichment</p><p>Enrichment</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-04-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-4.A.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>4.A.2</td><td>Cobalt Strike: 'net group "Domain Computers" /domain' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.A.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.A.2-2.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK technique (Account Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-4.A.2-1.png" target="_blank"><small>Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \"Powershell Execution Policy ByPass command ran\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.A.2-1.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.A.2-2.png" target="_blank"><small>Additional process tree view showing net.exe enrichment</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.A.2-3.png" target="_blank"><small>OverWatch General Behavior alert for net group </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Telemetry</p><p>General Behavior-Delayed</p><p>General Behavior-Delayed</p>79</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.A.2-10.png" target="_blank"><small>Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.A.1-101.png" target="_blank"><small>Telemetry showing net.exe executing with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.A.2-100.png" target="_blank"><small>General Behavior alert for net.exe executing as part of a suspicious execution chain</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-2.png" target="_blank"><small>Enriched event tree showing enrichment of net group command mapped to related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-1.png" target="_blank"><small>Telemetry from event tree showing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Delayed</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-4.A.1-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-4.A.1-1.png" target="_blank"><small>Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.A.2-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net group</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.A.2-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-2.png" target="_blank"><small>Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-10.png" target="_blank"><small>Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.A.1-2.png" target="_blank"><small>Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.A.2-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.A.2-2.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.A.2-1.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-04-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-4.A.1-3.png" target="_blank"><small>Event tree showing net.exe (tainted by launch from process lineage previously identified as malicious)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-4.A.1-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="4"><b>Standard Application Layer Protocol</b><br><br><i>Command and Control</i><br><br>(<a href="https://attack.mitre.org/techniques/T1071/">T1071</a>)</td><td>6.B.1</td><td>Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-2.png" target="_blank"><small>Telemetry showing network connection over TCP port 80 to the C2 domain (could be used in conjunction with modload to determine protocol)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-8.png" target="_blank"><small>Telemetry showing modloads showing winhttp.dll loaded</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-6.B.1-2.png" target="_blank"><small>Telemetry showing outbound C2 traffic over HTTP to www.freegoogleadsense.info (C2 domain)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.B.1-30.png" target="_blank"><small>Enrichment of rundll32.exe making an unusual network connection over the \"HTTP Port\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.B.1-100.png" target="_blank"><small>Enrichment of rundll32.exe showing connection over port 80 and the amount of transmitted/received bytes (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.B.1-101.png" target="_blank"><small>Enrichment of rundll32.exe showing winhttp.dll module loaded (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-6.B.1-2.png" target="_blank"><small>Telemetry showing rundll32 making HTTP connections</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.B.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.B.1-3.png" target="_blank"><small>Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.B.1-2.png" target="_blank"><small>Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.B.1-22.png" target="_blank"><small>Telemetry showing that the winhttp.dll module was loaded into the process (PID 6276) that made the network connection</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.B.1-1.png" target="_blank"><small>Telemetry showing port 80 command and control traffic as well as the loading of winhttp.dll</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>1.C.1</td><td>Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-4.png" target="_blank"><small>Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS requests</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.C.1-2.png" target="_blank"><small>Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>General Behavior-Delayed</p><p>Telemetry</p><p>Specific Behavior-Delayed</p>154</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.C.1-20.png" target="_blank"><small>Telemetry showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.C.1-100.png" target="_blank"><small>Process tree showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-6.png" target="_blank"><small>Telemetry showing DNS connections</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-5.png" target="_blank"><small>Telemetry showing DNS requests from rundll32.exe (tainted by parent Malicious File Detection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-1.C.1-T1071-new.png" target="_blank"><small>Telemetry showing rundll32 making DNS queries</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.C.1-2.png" target="_blank"><small>Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.C.1-5.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Indicator of Compromise</p><p>Specific Behavior-Delayed</p>77</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS requests to the C2 domain (custom query)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Configuration Change</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS requests to the C2 domain (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>14.A.1</td><td>Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-14.A.1-2.png" target="_blank"><small>Telemetry showing port 8080  HTTP GET request to C2 domain for file wdbypass (tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-14.A.1-7.png" target="_blank"><small>Decoded PowerShell (outside of capability) showing download request over HTTP (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-14.A.1-6.png" target="_blank"><small>Telemetry showing encoded PowerShell command that decodes to show HTTP traffic (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-40.png" target="_blank"><small>Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-30.png" target="_blank"><small>Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Tainted</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-14-1.png" target="_blank"><small>Telemetry showing decoded PowerShell with download request of wdbypass over port 8080</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-14.A.1-2.png" target="_blank"><small>Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-14.A.1-4.png" target="_blank"><small>Enrichment of HTTP GET request with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-14.A.1-1.png" target="_blank"><small>Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-4.png" target="_blank"><small>Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-14.A.1-5.png" target="_blank"><small>Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-14-1.png" target="_blank"><small>Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>11.B.1</td><td>Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-11.B.1-2.png" target="_blank"><small>Telemetry showing modloads and certificate check</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.B.1-11.png" target="_blank"><small>Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.A.1-13.png" target="_blank"><small>Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-2.png" target="_blank"><small>Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-6.png" target="_blank"><small>Telemetry showing connection to letsencrypt.org</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.A.1-5.png" target="_blank"><small>An alert for PowerShell downloading a significant amount of data using HTTP(S) (does not count as a detection since it was based on port)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.B.1-T1071-new.png" target="_blank"><small>Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.B.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>General Behavior-Delayed</p>27</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.A.1-5.png" target="_blank"><small>Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.B.1-4.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.B.1-3.png" target="_blank"><small>Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.B.1-2.png" target="_blank"><small>Alert for C2 domain indicator of compromise </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.B.1-4.png" target="_blank"><small>Telemetry within alert showing decoded command-line arguments containing HTTPS</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Indicator of Compromise-Configuration Change</p>24</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-11-2.png" target="_blank"><small>Telemetry showing network connections, including over port 443</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Network Share Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1135/">T1135</a>)</td><td>12.E.1.9.2</td><td>Empire: WinEnum module included enumeration of mapped network drives</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-07.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Mapped Network Drives function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.9-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-3.png" target="_blank"><small>Additional telemetry showing powershell.exe WMI queries for logical disk information</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-2.png" target="_blank"><small>Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.E.1.9.1</td><td>Empire: WinEnum module included enumeration of available shares</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-06.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Available Shares function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.9-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Data Encoding</b><br><br><i>Command and Control</i><br><br>(<a href="https://attack.mitre.org/techniques/T1132/">T1132</a>)</td><td>1.C.1</td><td>Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.C.1-2.png" target="_blank"><small>Telemetry within an alert showing encoded DNS requests (tainted by parent Exfiltration alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.C.1-20.png" target="_blank"><small>Telemetry showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.C.1-100.png" target="_blank"><small>Process tree showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-1.C.1-T1071-new.png" target="_blank"><small>Telemetry showing rundll32 making encoded DNS queries</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.C.1-2.png" target="_blank"><small>Telemetry showing encoded DNS requests (tainted by parent Cobalt Strike DNS Beacon alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.C.1-2.png" target="_blank"><small>Telemetry showing stream of DNS requests with encoded data</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS query for freegoogleadsenseinfo.com (C2 domain) (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="3"><b>Remote Desktop Protocol</b><br><br><i>Lateral Movement</i><br><br>(<a href="https://attack.mitre.org/techniques/T1076/">T1076</a>)</td><td>20.A.1</td><td>RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-20.A.1-1.png" target="_blank"><small>Telemetry showing connection to Creeper (10.0.0.4) on port 3389</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-20.A.1-3.png" target="_blank"><small>Telemetry showing logon type 10 (remote interactive logon) for Kmitnick on Creeper</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-20.A.1-20.png" target="_blank"><small>Telemetry of connection to port 3389 on Creeper (10.0.0.4)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-20.A.1-21.png" target="_blank"><small>Enrichment of RDP connection to Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-20-3.png" target="_blank"><small>Telemetry showing connection to Creeper (10.0.0.4) on port 3389</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-2.png" target="_blank"><small>Enrichment of a Remote Desktop connection indicating a successful login to Remote Desktop Services. </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-1.png" target="_blank"><small>Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-20.A.1-2.png" target="_blank"><small>Telemetry showing svchost.exe starting terminal service session on Creeper from CodeRed (10.0.1.5)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-20.A.1-3.png" target="_blank"><small>Telemetry showing Kmitnick RDP logon from CodeRed to Creeper</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-20.A.1-2.png" target="_blank"><small>Telemetry showing an inbound connection to Creeper (10.0.0.4) on port 3389</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>6.C.1</td><td>Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.C.1-3.png" target="_blank"><small>Telemetry showing rdpclip.exe running</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-1.png" target="_blank"><small>Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.C.1-1.png" target="_blank"><small>Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-6.C.1-1.png" target="_blank"><small>Enrichment of outbound TCP port 3389 (RDP) connection with Lateral Movement and Remote Share Access (tainted by parent \"Windows command prompt invoked\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-6.C.1-2.png" target="_blank"><small>Telemetry showing inbound TCP port 3389 connection to 10.0.0.5 (Conficker)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted-Configuration Change</p><p>Telemetry</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.C.1-3.png" target="_blank"><small>Telemetry showing logon type 10 (interactive remote login) as user George@shockwave on 10.0.0.5 (Conficker)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.C.1-5.png" target="_blank"><small>Telemetry showing a network connection to 10.0.0.5 (Conficker) over TCP port 3389</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-1.png" target="_blank"><small>Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.B.1-20.png" target="_blank"><small>Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent Injected Shellcode alert, listed as Owner process)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.C.1-10.png" target="_blank"><small>Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.C.1-11.png" target="_blank"><small>Telemetry showing rdpclip.exe executing on 10.0.0.5 (Conficker)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-3.png" target="_blank"><small>Telemetry showing Type 10 (interactive remote) login event by user George on Conficker</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-4.png" target="_blank"><small>Event tree view of telemetry showing port 3389 connection to 10.0.0.5 (Conficker) (tainted by parent Process Injection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-6.C.1-T1076-new.png" target="_blank"><small>Telemetry showing rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.C.1-1.png" target="_blank"><small>Enrichment of RDP connection from rundll32.exe with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.C.1-1.png" target="_blank"><small>Telemetry showing a connection to 10.0.0.5 (Conficker) over TCP port 3389</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.C.1-2.png" target="_blank"><small>Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.C.1-4.png" target="_blank"><small>Graph showing movement from Debbie account to George</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.C.1-1.png" target="_blank"><small>Telemetry showing execution sequence for cmd.exe connection over RDP to 10.0.0.5 (Conficker)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.C.1-3.png" target="_blank"><small>Telemetry showing user logon activity on 10.0.0.5 (Conficker) showing George with a logon type 10 RemoteInteractive logon event</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.C.1-2.png" target="_blank"><small>Telemetry showing execution sequence on 10.0.0.5 (Conficker) showing George logon</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.C.1-1.png" target="_blank"><small>
Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent process injection alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.C.1-2.png" target="_blank"><small>General Behavior alert for an unexpected process using the RDP port (tainted by a parent process injection alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Tainted</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-06-3.png" target="_blank"><small>Telemetry showing cmd.exe connecting over port 3389 (RDP) to 10.0.0.5 (Conficker)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-6.C.1-1.png" target="_blank"><small>Telemetry showing port 3389 connection (tainted by relationship to threat story shown in Group ID)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>10.B.1</td><td>RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-10.B.1-2.png" target="_blank"><small>Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-10.B.1-1.png" target="_blank"><small>Telemetry from process tree showing rdpclip.exe running as user Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-10.B.1-2.png" target="_blank"><small>Enrichment of TCP port 3389 (RDP) connection to 10.0.0.5 (Conficker) with conditions Lateral Movement and Remote Share Access (tainted by the parent \"Windows command prompt invoked\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-10.B.1-1.png" target="_blank"><small>Telemetry showing user logon by Jesse to Conficker with type 10 (interactive logon)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-10.B.1-2.png" target="_blank"><small>Telemetry showing logged-on user activity, including the use of rdpclip.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-1.png" target="_blank"><small>Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.B.1-100.png" target="_blank"><small>Telemetry showing rundll32.exe process used to proxy connection over port 3389 from Nimda (10.0.1.6) to Conficker (10.0.0.5) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.B.1-10.png" target="_blank"><small>Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.B.1-20.png" target="_blank"><small>Telemetry showing a TCP port 3389 connection to Conficker (10.0.0.5) </small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-10-7.png" target="_blank"><small>Telemetry showing remote connections over port 3389 to 10.0.0.5 (Conficker)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-10-6.png" target="_blank"><small>Telemetry showing Type 10 (interactive) logon for Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-10.B.1-T1076-new.png" target="_blank"><small>Telemetry showing a RemoteInteractive connection over port 3389 to Conficker (10.0.0.5)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.B.1-4.png" target="_blank"><small>Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.B.1-3.png" target="_blank"><small>Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.B.1-1.png" target="_blank"><small>Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Telemetry</p><p>Specific Behavior-Delayed</p>82</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-10.A.1-1.png" target="_blank"><small>Enrichment of the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-10.B.1-3.png" target="_blank"><small>Telemetry showing a connection over port 3389 to Conficker (10.0.0.5) (tainted by parent alert on rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-10.B.1-1.png" target="_blank"><small>Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-10.B.1-2.png" target="_blank"><small>Telemetry showing successful port 3389 connection to Conficker (10.0.0.5)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-10.B.1-3.png" target="_blank"><small>Enrichment of the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-10.B.1-2.png" target="_blank"><small>Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-10.B.1-2.png" target="_blank"><small>Threat group identified as malicious, including rundll32.exe (PID 184) proxying the port 3389 connection (port 3389 connection not specifically shown in this view, but it identifies the rundll32.exe process tainting the connection by Group ID)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-10.B.1-1.png" target="_blank"><small>Telemetry showing connection over port 3389 to 10.0.0.5 (Conficker)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Scheduled Task</b><br><br><i>Execution, Persistence, Privilege Escalation</i><br><br>(<a href="https://attack.mitre.org/techniques/T1053/">T1053</a>)</td><td>10.A.2</td><td>Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-10.A.2-2.png" target="_blank"><small>Telemetry from process tree showing updater.dll executed by rundll32.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-10.A.2-1.png" target="_blank"><small>Telemetry from process tree showing svchost.exe parent of rundll32.exe process running with \"-k netsvcs -p -s Schedule\" arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-10.A.2-1.png" target="_blank"><small>Telemetry showing svchost.exe executing rundll32.exe (tainted by parent \"Sponsor process started V2\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-10.A.2-2.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll (tainted by the parent OverWatch alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.A.2-100.png" target="_blank"><small>Telemetry showing rundll32.exe executing update.dat (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.A.1-20.png" target="_blank"><small>Parent alert for Injected shellcode into rundll32.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-10-1.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll (tainted by Malicious File Detection alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-10-2.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll (tainted by Process Injection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-10.A.1-2.png" target="_blank"><small>Telemetry showing rundll32 starting updater.dll, tainted by an "abnormal rundll32 launch" alert</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.2-3.png" target="_blank"><small>Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.2-2.png" target="_blank"><small>Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.2-1.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-10.A.2-1.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments "-k netsvcs -p -s Schedule"</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-10.A.2-1.png" target="_blank"><small>Telemetry showing execution sequence for svchost.exe parent of rundll32.exe process running with \"-k netsvcs -p -s Schedule\" arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-10.A.2-4.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-10.A.2-3.png" target="_blank"><small>Telemetry showing svchost.exe running with command-line arguments "-k netsvcs -p -s Schedule"</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-10-2.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-10.A.2-2.png" target="_blank"><small>Telemetry showing rundll32.exe executing updater.dll</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-10.A.1-3.png" target="_blank"><small>Group ID query showing both autoupdate.bat and updater.dll persistence execution</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td>7.C.1</td><td>Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-7.C.1-2.png" target="_blank"><small>Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-7.C.1-1.png" target="_blank"><small>Telemetry showing process tree containing schtasks.exe and full command a task creation</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-7.C.1-1.png" target="_blank"><small>Specific Behavior alert on \"Schtasks with create command\" for schtasks.exe run from cmd.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-4.png" target="_blank"><small>Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-7.C.1-2.png" target="_blank"><small>Telemetry showing creation of the scheduled task</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-7.C.1-3.png" target="_blank"><small>General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>General Behavior-Delayed-Tainted</p><p>Specific Behavior-Delayed</p>91</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-7.C.1-11.png" target="_blank"><small>Telemetry showing the Resume Viewer Update Checker scheduled task</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-7.C.1-10.png" target="_blank"><small>Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-07-4.png" target="_blank"><small>Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-07-3.png" target="_blank"><small>Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-07-2.png" target="_blank"><small>Enrichment of scheduled task from persistence hunt</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p><p>Specific Behavior-Tainted</p>88</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-7.C.1-2.png" target="_blank"><small>Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.C.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.C.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about schtask</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.C.1-1.png" target="_blank"><small>Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-7.C.1-1.png" target="_blank"><small>Specific Behavior alert for a task being created that runs an executable (via rundll32) under system rights at Windows logon, tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-7.C.1-3.png" target="_blank"><small>Telemetry showed cmd.exe creating the "Resume Viewer Update Checker" scheduled task via schtasks.exe (tainted by a trace detection on cmd.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-7.C.1-1.png" target="_blank"><small>Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-7.C.1-2.png" target="_blank"><small>Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.C.1-4.png" target="_blank"><small>Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.C.1-1.png" target="_blank"><small>Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.C.1-3.png" target="_blank"><small>Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.C.1-2.png" target="_blank"><small>Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p><p>Specific Behavior-Tainted</p><p>Enrichment</p>136</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-07-2.png" target="_blank"><small>Telemetry showing the schtask.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-7.C.1-1.png" target="_blank"><small>Telemetry showing schtask.exe and associated command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Data Staged</b><br><br><i>collection</i><br><br>(<a href="https://attack.mitre.org/techniques/T1074/">T1074</a>)</td><td>18.B.1</td><td>Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\$Recycle.Bin) on CodeRed (10.0.1.5)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-18.B.1-2.png" target="_blank"><small>Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-18.B.1-1.png" target="_blank"><small>Telemetry showing creation of the .vsdx file in the Recycle Bin</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-18.B.1-1.png" target="_blank"><small>Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed the .vsdx file being copied to Recycle Bin for staging (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-18.B.1-1.png" target="_blank"><small>Telemetry showing the .vsdx being written into the Recycle Bin (event_SimpleName of OoxmlFileWritten)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-18.B.1-10.png" target="_blank"><small>Telemetry of file create/write of vsdx (tainted by a parent PowerShell alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-18-1.png" target="_blank"><small>Telemetry showing the file creation of the .vsdx file in the Recycle Bin</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-18-2.png" target="_blank"><small>Event tree showing creation of the .vsdx file (tainted by parent alerts on powershell.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-18.B.1-T1074-new.png" target="_blank"><small>Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-18.A.1-4.png" target="_blank"><small>Telemetry showing a file create event for the .vsdx file in the Recycle Bin</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-18.B.1-3.png" target="_blank"><small>Specific Behavior alert for File Write to Root of Recycle Bin</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-18.B.1-2.png" target="_blank"><small>Additional telemetry showing file write of .vsdx with PowerShell File Write alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-18.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-18.B.1-9.png" target="_blank"><small>Specific Behavior alert for PowerShell creating a file in the Recycle Bin, tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged).</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-18.B.1-1.png" target="_blank"><small>Telemetry showing file creation in the Recycle Bin (tainted by parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-18.B.1-1.png" target="_blank"><small>Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-18.B.1-1.png" target="_blank"><small>Telemetry showing file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-18.B.1-1.png" target="_blank"><small>Exported telemetry of threat story (taints event) showing .vsdx file copy and write</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Application Window Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1010/">T1010</a>)</td><td>8.C.1</td><td>Cobalt Strike: Keylogging capability included residual enumeration of application windows</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>15.A.1</td><td>Empire: Built-in keylogging module included residual enumeration of application windows</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-15.A.1-2.png" target="_blank"><small>Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-15.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing the GetForegroundWindow method</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-15.A.1-3.png" target="_blank"><small>Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-15.A.1-2.png" target="_blank"><small>Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>Indicator of Compromise</p>30</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="3"><b>Valid Accounts</b><br><br><i>Defense Evasion, Persistence, Privilege Escalation, Initial Access</i><br><br>(<a href="https://attack.mitre.org/techniques/T1078/">T1078</a>)</td><td>16.B.1</td><td>Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-1.png" target="_blank"><small>Telemetry showing process tree with five different net.exe logon attempts, including a success</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-2.png" target="_blank"><small>Telemetry showing successful logon via net.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.B.1-2.png" target="_blank"><small>Telemetry showing explorer.exe writing \\\\conficker\\PIPE\\srvsvc (tainted by the parent \"FileExts Registry Key modified\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.B.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.B.1-2.png" target="_blank"><small>OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.B.1-1.png" target="_blank"><small>Telemetry from process tree showing successful net.exe connection using valid credentials of Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed-Tainted</p>31</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.B.1-20.png" target="_blank"><small>Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-3.png" target="_blank"><small>Enrichment of successful net.exe connection (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-2.png" target="_blank"><small>Telemetry showing a logon event for user Kmitnick on Conficker (10.0.0.5)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.B.1-1.png" target="_blank"><small>Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.B.1-2.png" target="_blank"><small>Telemetry showing successful logon of user Kmitnick</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-3.png" target="_blank"><small>Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-4.png" target="_blank"><small>Telemetry showing a login event on Conficker (10.0.0.5) for user Kmitnick</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.B.1-3.png" target="_blank"><small>Telemetry showing 10.0.1.5 (CodeRed) system accessed resources on 10.0.0.5 (Conficker)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.B.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.B.1-2.png" target="_blank"><small>Telemetry showing user Kmitnick login activity on 10.0.0.5 (Conficker)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.B.1-3.png" target="_blank"><small>Enrichment of an lsass.exe event with the correct ATT&CK Technique (Valid Accounts).</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.B.1-2.png" target="_blank"><small>Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.B.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-2.png" target="_blank"><small>Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.B.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempts, the last of which using valid credentials for user Kmitnick (tainted by relationship to threat story)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempts and corresponding exit codes</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>10.B.1</td><td>RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-10.B.1-2.png" target="_blank"><small>Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-10.B.1-1.png" target="_blank"><small>Telemetry from process tree showing rdpclip.exe running as user Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-10.B.1-1.png" target="_blank"><small>Telemetry showing explorer.exe running as Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-10.B.1-1.png" target="_blank"><small>Telemetry showing user logon by Jesse to Conficker</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.B.1-10.png" target="_blank"><small>Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-10-3.png" target="_blank"><small>Telemetry showing userinit.exe running as Jesse (tainted by parent \"Start Folder Persistence\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-10.B.1-T1076-new.png" target="_blank"><small>Telemetry showing a RemoteInteractive connection as Jesse over port 3389 to Conficker (10.0.0.5)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.B.1-3.png" target="_blank"><small>Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.B.1-2.png" target="_blank"><small>Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-10.B.1-1.png" target="_blank"><small>Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-10.B.1-1.png" target="_blank"><small>Telemetry showing local user account Jesse first and last seen logons on Conficker</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-10.B.1-1.png" target="_blank"><small>Telemetry showing userinit.exe as well as explorer.exe spawn as the user Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-10-3.png" target="_blank"><small>Telemetry showing \"unregmp2.exe /FirstLogon\" (associated with user logon)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-10-4.png" target="_blank"><small>Telemetry showing user name \"Jesse J\" within Machine Properties</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-10.B.1-3.png" target="_blank"><small>Telemetry showing last logged on user identified as Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td>16.D.1</td><td>Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.D.1-1.png" target="_blank"><small>Telemetry showing process tree with logon using valid account credentials</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.D.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.D.1-2.png" target="_blank"><small>Telemetry showing successful net use connection by Kmitnick in the process tree view (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.D.1-10.png" target="_blank"><small>General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-6.png" target="_blank"><small>Enrichment of successful net.exe connection (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-2.png" target="_blank"><small>Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-T1078-new.png" target="_blank"><small>The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.D.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.D.1-1.png" target="_blank"><small>Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.D.1-9.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-2.png" target="_blank"><small>Telemetry from query showing successful Kmitnick logon event for Creeper</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.D.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.D.1-2.png" target="_blank"><small>Telemetry showing a event for a successful login by user Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-4.png" target="_blank"><small>Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.D.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt using valid credentials for user Kmitnick (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Brute Force</b><br><br><i>Credential Access</i><br><br>(<a href="https://attack.mitre.org/techniques/T1110/">T1110</a>)</td><td>16.B.1</td><td>Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-1.png" target="_blank"><small>Telemetry showing process tree with five different net.exe logon attempts, including a success</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-2.png" target="_blank"><small>Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Configuration Change</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.B.1-2.png" target="_blank"><small>Telemetry showing explorer.exe writing \\\\conficker\\PIPE\\srvsvc (tainted by the parent \"FileExts Registry Key modified\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.B.1-1.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-10.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.B.1-2.png" target="_blank"><small>OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.B.1-1.png" target="_blank"><small>Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed-Tainted</p><p>General Behavior-Delayed</p>58</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.B.1-20.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-4.png" target="_blank"><small>Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-3.png" target="_blank"><small>Enrichment of successful net.exe connection with \"Mounting Hidden Share\" and Lateral Movement tags (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.B.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.B.1-2.png" target="_blank"><small>Telemetry showing successful logon of user Kmitnick</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-3.png" target="_blank"><small>Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-2.png" target="_blank"><small>Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-1.png" target="_blank"><small>Specific Behavior alert for brute force attempt to remote SMB shares</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.B.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.B.1-2.png" target="_blank"><small>Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.B.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-2.png" target="_blank"><small>Telemetry showing logon attempts via net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.B.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempts (tainted by relationship to threat story)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempts and corresponding exit codes</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>16.A.1</td><td>Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users Kmitnick, Bob, and Frieda</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-2.png" target="_blank"><small>Enrichment of the individual net.exe logon attempts with tag \"Credential Access using Admin Shares - Failed Attempts\"</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.A.1-1.png" target="_blank"><small>Telemetry showing process tree with four different net.exe logon attempts</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Configuration Change</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-1.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-2.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-3.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-4.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-10.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.A.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempts</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.A.1-3.png" target="_blank"><small>Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.A.1-2.png" target="_blank"><small>Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.A.1-4.png" target="_blank"><small>Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>General Behavior-Delayed-Tainted</p><p>General Behavior-Delayed</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-20.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-2.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-3.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-1.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-10.png" target="_blank"><small>Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-2.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-1.png" target="_blank"><small>Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempts</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-2.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-3.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-6.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-4.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-5.png" target="_blank"><small>Telemetry showing failed logon attempt for Kmitnick</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>Telemetry-Configuration Change</p><p>General Behavior-Delayed</p>49</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-2.png" target="_blank"><small>Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing repeated logon attempts via net.exe (tainted by a parent alert on powershell.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-3.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-1.png" target="_blank"><small>Specific Behavior alert for brute force attempt to remote SMB shares</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-5.png" target="_blank"><small>System access history from CodeRed to Nimda and Morris</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-4.png" target="_blank"><small>Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-4.png" target="_blank"><small>General Behavior alert for a sensitive administrative shares mapping with unexpected parent</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-3.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-1.png" target="_blank"><small>Telemetry showing logon attempts via net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempts and corresponding exit codes</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.A.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempts (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Screen Capture</b><br><br><i>Collection</i><br><br>(<a href="https://attack.mitre.org/techniques/T1113/">T1113</a>)</td><td>8.D.1</td><td>Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-8.D.1-1.png" target="_blank"><small>Telemetry showing modloads and crossprocess events (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.D.1-1.png" target="_blank"><small>Telemetry showing remote thread being created into explorer.exe (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.D.1-2.png" target="_blank"><small>DDNA JSON output showing the process had the capability to capture screen shots (does not count as a detection; DDNA scan was manually initiated)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.D.1-2.png" target="_blank"><small>Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.D.1-11.png" target="_blank"><small>Alert for explorer.exe loading a Meterpreter agent (does not count as detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.D.1-10.png" target="_blank"><small>Alert showing loaded screenshotx64.dll module (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-08-5.png" target="_blank"><small>Strings output extracted from Process Injection alert, showing BitBlt and CreateCompatibleBitmap that could be associated with screen capture, but no evidence of execution (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.D.1-1.png" target="_blank"><small>Enrichment of explorer.exe with ScreenshotTaken</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Configuration Change</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.D.1-1.png" target="_blank"><small>Enrichment of the execution of a specific API call using screen capture and suspicious activity</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-08-4.png" target="_blank"><small>Floating Code module generated from DLL injection showing multiple jpeg components (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Create Account</b><br><br><i>Persistence</i><br><br>(<a href="https://attack.mitre.org/techniques/T1136/">T1136</a>)</td><td>7.A.1</td><td>Added user Jesse to Conficker (10.0.0.5) through RDP connection</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-7.A.1-2.png" target="_blank"><small>Telemetry showing Registry modifications for new user Jesse</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-7.A.1-4.png" target="_blank"><small>Enrichment of lsass.exe with tag \"Create Accounts using GUI\"</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Configuration Change</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-7.A.1-2.png" target="_blank"><small>Child event of Specific Behavior alert showing new account added to local admins group</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-7.A.1-1.png" target="_blank"><small>Specific Behavior alert for \"New user account created\" and event showing account name was Jesse</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Configuration Change</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-7.A.1-1.png" target="_blank"><small>Telemetry showing creation of the user Jesse with the user RID 000003E8</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-7.A.1-2.png" target="_blank"><small>Telemetry showing user RID 000003E8 (corresponding to the user Jesse) added to the admin group (00000220), a well-known security identifier</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-7.A.1-3.png" target="_blank"><small>Telemetry showing group membership of the user Jesse, including Remote (0000022B), Admins (00000220), and Users (00000221), which are well-known security identifiers</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-7.A.1-20.png" target="_blank"><small>Telemetry showing lsass.exe creating a Registry key for user Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-7.A.1-2.png" target="_blank"><small>Telemetry showing the creation of the new user Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.A.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.A.1-1.png" target="_blank"><small>Telemetry showing creation of user Jesse </small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-7.A.1-1.png" target="_blank"><small>Telemetry showing creation of user account Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-7.A.1-1.png" target="_blank"><small>Telemetry showing creation of user account Jesse</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Configuration Change</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.A.1-3.png" target="_blank"><small>Telemetry showing mmc.exe creating a Registry key for user Jesse </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.A.1-4.png" target="_blank"><small>Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-7.A.1-1.png" target="_blank"><small>Telemetry showing creation of user account Jesse</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="4"><b>System Information Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1082/">T1082</a>)</td><td>2.E.2</td><td>Cobalt Strike: 'net config workstation' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.E.2-2.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.E.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.E.2-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net config not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net config was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.D.2-1.png" target="_blank"><small>Telemetry showing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.E.2-10.png" target="_blank"><small>Telemetry showing cmd.exe executing net executing with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.E.2-12.png" target="_blank"><small>Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Tainted</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-9.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.1-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing net) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.2-2.png" target="_blank"><small>Enrichment of net.exe indicating it is commonly used for reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.A.1-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.E.2-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>85</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.E.2-1.png" target="_blank"><small>Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.E.2-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-5.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.E.2-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.E.2-2.png" target="_blank"><small>Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.E.2-1.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.E.2-3.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.E.2-2.png" target="_blank"><small>Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment-Tainted</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-9.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.E.1</td><td>Cobalt Strike: 'systeminfo' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.E.1-1.png" target="_blank"><small>Telemetry from process tree showing systeminfo.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.E.1-2.png" target="_blank"><small>Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.E.1-1.png" target="_blank"><small>Telemetry showing systeminfo.exe (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.E.1-1.png" target="_blank"><small>OverWatch General Behavior alert indicating systeminfo.exe was suspicious</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.D.2-1.png" target="_blank"><small>Telemetry showing systeminfo</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p><p>General Behavior-Delayed</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.E.1-11.png" target="_blank"><small>Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.B.1-10.png" target="_blank"><small>Telemetry showing cmd.exe executing systeminfo</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-8.png" target="_blank"><small>Telemetry showing systeminfo.exe (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.E.1-1.png" target="_blank"><small>Enrichment of systeminfo.exe indicating it could be used for reconnaissance.</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.B.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior</p>45</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.E.1-1.png" target="_blank"><small>Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.E.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about systeminfo</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-1.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the systeminfo.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-5.png" target="_blank"><small>Enrichment of systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.E.1-1.png" target="_blank"><small>Telemetry showing execution sequence for systeminfo.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-4.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.E.1-2.png" target="_blank"><small>Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.E.1-3.png" target="_blank"><small>Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.E.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment-Tainted</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-3.png" target="_blank"><small>Telemetry showing systeminfo.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-8.png" target="_blank"><small>Telemetry showing systeminfo.exe (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.E.1.6.1</td><td>Empire: WinEnum module included enumeration of system information</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1.6.1-1.png" target="_blank"><small>Telemetry showing the Get-Sysinfo function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-05.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-2.png" target="_blank"><small>Telemetry of execution sequence showing Get-SysInfo invocation</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.6-1.png" target="_blank"><small>Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Indicator of Compromise</p>20</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-3.png" target="_blank"><small>Additional telemetry showing powershell.exe WMI queries for operating system information</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-2.png" target="_blank"><small>Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.E.1.6.2</td><td>Empire: WinEnum module included enumeration of Windows update information</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-2.png" target="_blank"><small>Telemetry of execution sequence showing Get-HotFix invocation</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="7"><b>File and Directory Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1083/">T1083</a>)</td><td>18.A.1</td><td>Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-18.A.1-T1083-new.png" target="_blank"><small>Telemetry showing powershell.exe executing the Get-ChildItem command </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-18.A.1-1.png" target="_blank"><small>Query showing .vsdx PowerShell file search script that was executed</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-18.A.1-1.png" target="_blank"><small>Telemetry showing an event with the execution of the Get-ChildItem command (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>8.A.1</td><td>Cobalt Strike: 'dir /s /b "\\conficker\wormshare"' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-8.C.1-2.png" target="_blank"><small>Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-8.A.1-1.png" target="_blank"><small>Telemetry from process tree showing dir with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.A.1-1.png" target="_blank"><small>Telemetry showing dir with command-line arguments (tainted by the parent \"Powershell process created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.A.1-2.png" target="_blank"><small>Process tree view showing cmd.exe that ran dir (dir not specifically shown, cmd.exe is second from top and tainted by previous detection by orange line indicating medium severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe running dir with command-line arguments (search was on commands running within the past 10 minutes)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.A.1-10.png" target="_blank"><small>Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-08-1.png" target="_blank"><small>Enriched event tree showing enrichment of dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-8.A.1-99.png" target="_blank"><small>Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-8.A.1-98.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-8.A.1-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing dir) </small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>General Behavior</p>75</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-8.A.1-1.png" target="_blank"><small>Enrichment of cmd.exe executing dir with Dir Command alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and, Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-8.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing the dir command (tainted by a trace detection on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-8.A.2-5.png" target="_blank"><small>Enrichment of cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.A.1-1.png" target="_blank"><small>Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.A.1-2.png" target="_blank"><small>Process tree view of rundll32.exe \"Unexpected behavior from process run with no command-line arguments\" alert that tainted dir (dir command not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.A.1-4.png" target="_blank"><small>Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.A.1-1.png" target="_blank"><small>Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.A.1-2.png" target="_blank"><small>Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-08-1.png" target="_blank"><small>Telemetry showing cmd.exe executing dir with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-8.A.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing dir with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>8.A.2</td><td>Cobalt Strike: 'tree "C:\Users\debbie"' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-8.C.1-2.png" target="_blank"><small>Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-8.A.1-2.png" target="_blank"><small>Telemetry from process tree showing tree.com with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.A.2-1.png" target="_blank"><small>Telemetry showing tree with command-line arguments (tainted by the parent \"Powershell process created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.A.2-2.png" target="_blank"><small>Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.A.1-2.png" target="_blank"><small>OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed-Tainted</p><p>General Behavior-Delayed</p>58</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.A.1-20.png" target="_blank"><small>Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-08-1.png" target="_blank"><small>Enriched event tree showing enrichment of tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-8.A.1-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-8.A.2-2.png" target="_blank"><small>Enrichment of tree.exe with a tag identifying the command as enumeration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-8.A.1-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing tree) </small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>General Behavior</p>75</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-8.A.1-2.png" target="_blank"><small>Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.C.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-8.A.1-4.png" target="_blank"><small>Excerpt from Managed Defense Report showing additional details about tree</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-8.A.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing tree.exe (tainted by a trace detection on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-8.A.2-5.png" target="_blank"><small>Enrichment of tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.A.2-1.png" target="_blank"><small>Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.A.1-2.png" target="_blank"><small>Process tree view of rundll32.exe \"Unexpected behavior from process run with no command-line arguments\" alert that tainted tree (tree command not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.A.2-2.png" target="_blank"><small>Enrichment of cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.A.2-1.png" target="_blank"><small>Telemetry showed cmd.exe executing tree with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-08-1.png" target="_blank"><small>Telemetry showing cmd.exe executing tree with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-8.A.1-3.png" target="_blank"><small>Telemetry showing cmd.exe executing tree with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.E.1.4.2</td><td>Empire: WinEnum module included enumeration of interesting files</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-04.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Interesting Files function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.4-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.E.1.4.1</td><td>Empire: WinEnum module included enumeration of recently opened files</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-03.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Last 5 files opened function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.4-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>9.A.1</td><td>Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.K.1</td><td>Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing the type command with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.K.1-1.png" target="_blank"><small>Telemetry showing a file read event for update.vbs (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Credentials in Files</b><br><br><i>Credential Access</i><br><br>(<a href="https://attack.mitre.org/techniques/T1081/">T1081</a>)</td><td>15.B.1</td><td>Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-15.A.1-2.png" target="_blank"><small>Telemetry showing decoded PowerShell script containing the function Get-Keystrokes</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating keylogging activity occurred (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-15.A.1-4.png" target="_blank"><small>Telemetry showing powershell.exe executing the Get-Content cmdlet on IT_tasks.txt</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-15.B.1-1.png" target="_blank"><small>Telemetry showing "Get-Content" cmdlet (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-15.B.1-1.png" target="_blank"><small>Telemetry showing a file read event for IT_tasks.txt</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="35"><b>PowerShell</b><br><br><i>Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1086/">T1086</a>)</td><td>13.C.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.A.1</td><td></td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td></tr><tr><td>12.F.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>17.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>17.B.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.F.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>17.C.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.G.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.G.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.D.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.D.1</td><td></td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td></tr><tr><td>18.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.E.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.C.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>18.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.E.1</td><td></td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td></tr><tr><td>17.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.K.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>11.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.H.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.A.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>19.D.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>19.D.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.G.1</td><td></td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td></tr><tr><td>16.I.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.J.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.B.1</td><td></td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td></tr><tr><td>15.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>13.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>13.B.2</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>13.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.C.1</td><td></td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td><td></td><td align="center" bgcolor="#DF01D7"><p>Not tested</p>0</td></tr><tr><td>16.L.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="5"><b>Account Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1087/">T1087</a>)</td><td>2.G.2</td><td>Cobalt Strike: 'net user george /domain' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.G.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.G.2-2.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.G.2-1.png" target="_blank"><small>Enrichment of net.exe with conditions Reconnaissance Tool and Net User Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.G.1-1.png" target="_blank"><small>Telemetry showing net with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net user was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.D.2-10.png" target="_blank"><small>Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.G.2-10.png" target="_blank"><small>Telemetry showing net executing with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.G.1-100.png" target="_blank"><small>Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Tainted</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-14.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.H.1-2.png" target="_blank"><small>Enrichment of net.exe with a tag identifying the command as enumeration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.G.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior</p>45</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.G.2-1.png" target="_blank"><small>Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.E.2-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-26.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.G.2-2.png" target="_blank"><small>Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.G.2-3.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.G.2-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.G.2-3.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.G.2-2.png" target="_blank"><small>Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.G.2-1.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment-Tainted</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-4.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-14.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.G.1</td><td>Empire: 'net user' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.G.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.F.1-3.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.G.1-1.png" target="_blank"><small>Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.G.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.G.1-1.png" target="_blank"><small>Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.G.1-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-6.png" target="_blank"><small>Telemetry from event tree showing net.exe with command-line arguments (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.G.1-T1087-new.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.1-3.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.G.1-1.png" target="_blank"><small>Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-2.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.G.1-2.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.G.1-1.png" target="_blank"><small>Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.G.1-2.png" target="_blank"><small>Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.G.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-2.png" target="_blank"><small>Continued threat story showing related processes</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.G.2</td><td>Empire: 'net user /domain' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.G.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.F.1-3.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.G.2-1.png" target="_blank"><small>Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.G.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.G.1-1.png" target="_blank"><small>Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.G.2-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.G.2-T1087-new.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.1-3.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.G.2-1.png" target="_blank"><small>Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-3.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery).</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.G.2-2.png" target="_blank"><small>Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.G.2-3.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.G.2-1.png" target="_blank"><small>Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p><p>Specific Behavior-Delayed</p>91</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.G.2-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.G.2-2.png" target="_blank"><small>Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-1.png" target="_blank"><small>Threat story showing initial compromise alert and powershell.exe tainting net.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-2.png" target="_blank"><small>Continued threat story showing initial compromise alert and powershell.exe tainting net.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>7.A.1</td><td>Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-7.A.1-3.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-7.A.1-3.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.msc (tainted by the parent \"LSA Registry Key modified\" alert) </small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.C.1-4.png" target="_blank"><small>Telemetry showing mmc.exe running lursmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-7.A.1-10.png" target="_blank"><small>Telemetry showing lusrmgr.msc running from mmc.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-07-5.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-7.A.1-1.png" target="_blank"><small>Telemetry showing mmc.exe running lursmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.A.1-3.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.exe </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-7.A.1-2.png" target="_blank"><small>Telemetry showing lusrmgr.msc running from mmc.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-7.A.1-2.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.A.1-1.png" target="_blank"><small>Telemetry showing lusrmgr.msc running from mmc.exe </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.A.1-5.png" target="_blank"><small>Enrichment of mmc.exe as reconnaissance via the MMC utility with local users and groups view</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.G.1</td><td>Cobalt Strike: 'net user /domain' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.G.1-2.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.G.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.G.1-1.png" target="_blank"><small>Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.G.1-1.png" target="_blank"><small>Telemetry showing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.D.2-10.png" target="_blank"><small>Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.G.2-100.png" target="_blank"><small>Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.G.1-10.png" target="_blank"><small>Telemetry showing net executing with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Tainted</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-13.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.G.1-2.png" target="_blank"><small>Enrichment of net.exe with a tag identifying the command as enumeration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.G.1-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing net) </small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Enrichment</p>45</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.G.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.G.1-1.png" target="_blank"><small>Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-26.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.G.1-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.G.1-2.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.G.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.G.1-2.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-13.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Rundll32</b><br><br><i>Defense Evasion, Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1085/">T1085</a>)</td><td>1.A.1</td><td>Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.A.1-2.png" target="_blank"><small>Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.A.1-1.png" target="_blank"><small>Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-1.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe launched rundll32.exe (tainted by the Script File Created alert) </small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.A.1-6.png" target="_blank"><small>Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.A.1-4.png" target="_blank"><small>OverWatch General Behavior alert indicating rundll32 execution was suspicious</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>General Behavior-Delayed</p><p>Telemetry</p>97</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.A.1-30.png" target="_blank"><small>Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.A.1-101.png" target="_blank"><small>Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.A.1-200.png" target="_blank"><small>Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p>121</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-11.png" target="_blank"><small>Specific Behavior alert for RunDLL32 with Suspicious DLL Location and surrounding telemetry  (tagged with correct ATT&CK Technique, T1085 - Rundll32 and Tactics, Defense Evasion, Execution; tainted by parent Malicious File Detection alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-10.png" target="_blank"><small>Telemetry showing rundll32.exe running update.dat execution event</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-2.png" target="_blank"><small>Event tree view showing the Malicious File Detection alert tainting rundll32.exe telemetry</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-1.A.1-4.png" target="_blank"><small>Telemetry showing rundll32.exe executing update.dat</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Specific Behavior</p><p>Telemetry</p>100</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.A.1-6.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.A.1-3.png" target="_blank"><small>Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-1.A.1-5.png" target="_blank"><small>Telemetry showing cmd.exe executing update.dat via rundll32.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-1.B.1-6.png" target="_blank"><small>Process tree within trace detection showing rundll32.exe executing (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-1.A.1-23.png" target="_blank"><small>Specific Behavior alerts based on suspicious indicators that a "Loaded non-DLL and non-CPL file with specified parameters via rundll32." The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-10.png" target="_blank"><small>Telemetry showing rundll32.exe process injection sequence</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.A.1-13.png" target="_blank"><small>General Behavior alert on low-reputation DLL load by signed executable</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.A.1-5.png" target="_blank"><small>Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.A.1-4.png" target="_blank"><small>Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.A.1-7.png" target="_blank"><small>Additional details of General Behavior alert for rundll32.exe executing update.dat</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.A.1-6.png" target="_blank"><small>General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p><p>General Behavior-Tainted</p>91</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-01-1.png" target="_blank"><small>Telemetry showing execution of Resume Viewer.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.A.1-1.png" target="_blank"><small>Telemetry from process tree showing rundll32.exe (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="4"><b>System Network Connections Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1049/">T1049</a>)</td><td>12.E.1.12</td><td>Empire: WinEnum module included enumeration of established network connections</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.E.1.12-2.png" target="_blank"><small>Telemetry from process tree showing netstat.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.E.1.12-1.png" target="_blank"><small>Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.12-2.png" target="_blank"><small>Telemetry from process tree showing netstat.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.E.1.12-1.png" target="_blank"><small>Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-3.png" target="_blank"><small>Event tree showing telemetry of netstat subprocess associated with WinEnum (tainted by parent PowerShell alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-10.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Netstat Established Connections and Processes function (does not count as a detection due to manual process of pulling events)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-7.png" target="_blank"><small>Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.E.1.12-1.png" target="_blank"><small>Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing netstat.exe (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-3.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing netstat.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-2.png" target="_blank"><small>Telemetry of execution sequence showing Get-NetInfo invocation</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-1.png" target="_blank"><small>Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.12-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-3.png" target="_blank"><small>Telemetry showing netstat.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-1.png" target="_blank"><small>Telemetry showing netstat.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>13.B.1</td><td>Empire: 'net use' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-13.A.1-2.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (Account Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-13.B.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net use was part of additional malicious discovery activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-13.B.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-13.B.1-10.png" target="_blank"><small>Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-13.B.1-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-13-3.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-13-1.png" target="_blank"><small>Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>73</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-13.A.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.1-3.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-13.B.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-13.A.1-1.png" target="_blank"><small>Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.A.1-3.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.B.1-1.png" target="_blank"><small>Telemetry showing execution of net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.B.1-2.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-13.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-13-1.png" target="_blank"><small>Telemetry showing execution of net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-13.A.1-1.png" target="_blank"><small>Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>13.B.2</td><td>Empire: 'netstat -ano' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-13.B.1-1.png" target="_blank"><small>Telemetry showing process tree with netstat.exe and command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-13.A.1-2.png" target="_blank"><small>Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-13.B.2-1.png" target="_blank"><small>Telemetry showing netstat.exe with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-13.B.2-1.png" target="_blank"><small>Telemetry from process tree showing netstat.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating netstat was part of additional malicious discovery activity (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-13.B.2-10.png" target="_blank"><small>Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-13-3.png" target="_blank"><small>Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-13.A.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.G.1-2.png" target="_blank"><small>Telemetry showing powershell.exe executing netstat.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-13.B.2-1.png" target="_blank"><small>Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-13.A.1-2.png" target="_blank"><small>Enrichment of nestat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-13.A.1-1.png" target="_blank"><small>Telemetry showed powershell.exe executing netstat.exe (tainted by parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.A.1-3.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.B.2-2.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing netstat.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-13.B.2-1.png" target="_blank"><small>Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-13.B.2-1.png" target="_blank"><small>Telemetry showing powershell.exe executing netstat with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-13.A.1-1.png" target="_blank"><small>Telemetry showing execution of netstat.exe and command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>4.C.1</td><td>Cobalt Strike: 'netstat -ano' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.C.1-1.png" target="_blank"><small>Telemetry from process tree showing netstat.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-4.C.1-2.png" target="_blank"><small>Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-4.C.1-1.png" target="_blank"><small>Telemetry showing netstat.exe with command-line arguments (tainted by the parent \"Powershell Execution Policy ByPass command ran\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-4.C.1-1.png" target="_blank"><small>OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior-Delayed</p><p>Telemetry</p><p>General Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.C.1-100.png" target="_blank"><small>Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-4.C.1-10.png" target="_blank"><small>Telemetry showing cmd.exe executing netstat with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-4.png" target="_blank"><small>Additional UI view of telemetry (showing the netstat command in this instance) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-2.png" target="_blank"><small>Enriched event tree showing enrichment of netstat with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-04-1.png" target="_blank"><small>Telemetry from event tree showing netstat with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Delayed</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-4.C.1-2.png" target="_blank"><small>Enrichment of netstat.exe with a tag identifying the command as enumeration</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.C.1-1.png" target="_blank"><small>Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.C.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about netstat</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-6.png" target="_blank"><small>Enrichment of netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-4.A.1-10.png" target="_blank"><small>Process tree within trace detection showing cmd.exe executing netstat.exe (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.C.1-1.png" target="_blank"><small>Telemetry showing execution sequence for netstat.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-4.A.1-2.png" target="_blank"><small>Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.C.1-2.png" target="_blank"><small>Enrichment of netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-4.C.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing netstat with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-04-1.png" target="_blank"><small>Telemetry showing netstat.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-4.A.1-2.png" target="_blank"><small>Telemetry showing netstat.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Bypass User Account Control</b><br><br><i>Defense Evasion, Privilege Escalation</i><br><br>(<a href="https://attack.mitre.org/techniques/T1088/">T1088</a>)</td><td>3.A.1</td><td>Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-3.A.1-2.png" target="_blank"><small>Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-3.A.1-1.png" target="_blank"><small>Alert for PowerShell process creation (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-3.A.1-1.png" target="_blank"><small>Telemetry showing process integrity level change for Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-3.A.1-20.png" target="_blank"><small>Telemetry showing powershell.exe running as high integrity as user Debbie (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-3.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe running as medium integrity as user Debbie</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-03-06.png" target="_blank"><small>Telemetry showing authentication (logon) ID mismatch between parent and child processes</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-3.A.1-2.png" target="_blank"><small>Enrichment of an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass.</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-3.A.1-3.png" target="_blank"><small>Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0xfcf5fd</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-3.A.1-4.png" target="_blank"><small>Telemetry showing group membership of token logon ID 0xfcf5fd, associated with user Debbie, which includes S-1-16-12288 (High Mandatory Level)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Configuration Change</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-3.A.1-3.png" target="_blank"><small>Specific Behavior alert for a possible UAC bypass, tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.A.1-2.png" target="_blank"><small>Telemetry showing powershell.exe running as high integrity as SYSTEM</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.A.1-1.png" target="_blank"><small>Telemetry showing rundll32.exe running as medium integrity as user Debbie</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.C.1-2.png" target="_blank"><small>Alert for \'Suspicious PowerShell command-line\' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-3.A.1-3.png" target="_blank"><small>Telemetry showing process integrity level change from parent rundll32.exe (medium) to child powershell.exe (high), both running as user Debbie</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-03-2.png" target="_blank"><small>Alert for powershell.exe execution with encoded command-line arguments (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td>14.A.1</td><td>Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-14.A.1-1.png" target="_blank"><small>Alert for encoded PowerShell (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-14.A.1-4.png" target="_blank"><small>Telemetry showing the Invoke-BypassUACTokenManipulation function</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating obfuscated PowerShell invoked UAC bypass (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-14.A.1-9.png" target="_blank"><small>Telemetry showing integrity level change through query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-11.png" target="_blank"><small>Telemetry showing powershell.exe executing with medium process integrity (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-12.png" target="_blank"><small>Telemetry showing powershell.exe executing with high process integrity (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-13.png" target="_blank"><small>Parent alert generated for malicious use of PowerShell</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-14-2.png" target="_blank"><small>Telemetry showing authentication (logon) ID mismatch between parent and child processes</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-14-4.png" target="_blank"><small>Telemetry showing svhost.exe seclogon event for token login id 0x9b6855 (10184789), used by the spawned powershell.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-14.A.1-T1088-new.png" target="_blank"><small>Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-14.A.1-1.png" target="_blank"><small>General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-14.A.1-7.png" target="_blank"><small>Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0x10530b3 </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-14.A.1-8.png" target="_blank"><small>Telemetry showing group membership of token logon ID 0x10530b3 associated with user Bob, which includes S-1-16-12288 (High Mandatory Level)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Configuration Change</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-14.A.1-1.png" target="_blank"><small>Specific Behavior alert for a possible UAC bypass.</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-14.A.1-2.png" target="_blank"><small>Telemetry showing an integrity level change for powershell.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-5.png" target="_blank"><small>Parent alert for \"Suspicious sequence of exploration activities\" showing powershell.exe process tainting this event</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-1.png" target="_blank"><small>Telemetry showing medium integrity powershell.exe process executing Invoke-BypassUACTokenManipulation as user Bob</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-3.png" target="_blank"><small>Telemetry showing high integrity powershell.exe process as Bob</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-2.png" target="_blank"><small>Telemetry showing high integrity powershell.exe process as SYSTEM</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-14.A.1-2.png" target="_blank"><small>Telemetry showing powershell.exe running as high integrity level (12288)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-14.A.1-3.png" target="_blank"><small>Indicator of Compromise alert identifying a PowerShell Empire script performing the bypass UAC attack.</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-14.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe running as medium integrity level (8192)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>Indicator of Compromise</p>30</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-14.A.1-1.png" target="_blank"><small>Telemetry showing process integrity level change from medium to high (tainted by relationship to threat story but Group ID not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="5"><b>Process Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1057/">T1057</a>)</td><td>2.C.1</td><td>Cobalt Strike: 'ps' (Process status) via Win32 APIs</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.C.1-1.png" target="_blank"><small>Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.C.2 </td><td>Cobalt Strike: 'tasklist /v' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.C.2-1.png" target="_blank"><small>Telemetry from process tree showing tasklist.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.C.2-2.png" target="_blank"><small>Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.C.2-1.png" target="_blank"><small>Telemetry showing tasklist.exe with command-line arguments (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (tasklist not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating tasklist was a reconnaissance command (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.B.1-1.png" target="_blank"><small>Telemetry showing tasklist with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.A.2-10.png" target="_blank"><small>Telemetry showing tasklist.exe executing within the process tree (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.C.2-10.png" target="_blank"><small>Telemetry showing cmd.exe executing tasklist with command-line arguments</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-5.png" target="_blank"><small>Telemetry showing tasklist.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.D.2-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.D.2-2.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.C.2-2.png" target="_blank"><small>Telemetry showing tasklist.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Telemetry</p><p>General Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.C.2-1.png" target="_blank"><small>Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.C.2-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about tasklist</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-1.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing tasklist.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-23.png" target="_blank"><small>Enrichment of tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-4.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.C.2-1.png" target="_blank"><small>Telemetry showing execution sequence for tasklist.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.C.2-3.png" target="_blank"><small>Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.C.2-2.png" target="_blank"><small>Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.C.2-1.png" target="_blank"><small>Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment-Tainted</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-1.png" target="_blank"><small>Telemetry showing tasklist.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-2.png" target="_blank"><small>Additional telemetry showing tasklist.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-5.png" target="_blank"><small>Telemetry showing tasklist.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>3.B.1</td><td>Cobalt Strike: 'ps' (Process status) via Win32 APIs</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-3.B.1-1.png" target="_blank"><small>Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>8.B.1</td><td>Cobalt Strike: 'ps' (Process status) via Win32 APIs</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.B.1-1.png" target="_blank"><small>Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.C.1</td><td>Empire: 'qprocess *' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.C.1-1.png" target="_blank"><small>Telemetry from process tree showing qprocess.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.C.1-2.png" target="_blank"><small>Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.C.1-1.png" target="_blank"><small>Telemetry showing qprocess.exe with command-line arguments (tainted by parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-6.png" target="_blank"><small>Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.C.1-1.png" target="_blank"><small>OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior-Delayed-Tainted</p><p>Telemetry</p><p>General Behavior-Delayed</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.C.1-1.png" target="_blank"><small>Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.B.1-2.png" target="_blank"><small>Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-1.png" target="_blank"><small>Event tree view of telemetry showing qprocess.exe with command-line arguments (tainted by parent PowerShell alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.C.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing qprocess.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.A.1-1.png" target="_blank"><small>Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.A.1-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.C.1-1.png" target="_blank"><small>Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-99.png" target="_blank"><small>Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-3.png" target="_blank"><small>Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.A.1-2.png" target="_blank"><small>Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.C.1-1.png" target="_blank"><small>Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-4.png" target="_blank"><small>Process tree view of \"Suspicious sequence of exploration activities\" alert showing tainted powershell.exe process</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.C.1-2.png" target="_blank"><small>Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.C.1-3.png" target="_blank"><small>Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.C.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-1.png" target="_blank"><small>Telemetry showing qprocess.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-3.png" target="_blank"><small>Telemetry showing qprocess.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.A.1-1.png" target="_blank"><small>Threat story showing initial compromise alert and powershell.exe tainting qprocess.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Data Encrypted</b><br><br><i>Exfiltration</i><br><br>(<a href="https://attack.mitre.org/techniques/T1022/">T1022</a>)</td><td>19.B.1</td><td>Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.A.1-1.png" target="_blank"><small>Telemetry showing recycler.exe and command-line arguments with encryption password</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.B.1-2.png" target="_blank"><small>Enrichment of recycler.exe with correct ATT&CK Technique (1022 - Data Encrypted)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.B.1-1.png" target="_blank"><small>Enrichment showing recycler.exe creating old.rar (enriched with \"Data Exfiltration Archiving\", tainted by parent \"Powershell executed encoded command\" alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.B.1-3.png" target="_blank"><small>Telemetry showing recycler.exe with full command-line (tainted by parent \"Powershell executed encoded commands\" and \"Policy Dropper Behavior\" alerts)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted-Configuration Change</p><p>Telemetry-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.B.1-1.png" target="_blank"><small>Specific Behavior alert showing use of -hp flags within command-line (mapped to related ATT&CK Technique, Data Compressed, and correct Tactic, Exfiltration; tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p><p>Specific Behavior-Delayed</p>124</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.B.1-20.png" target="_blank"><small>Telemetry showing recycler.exe execution (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-1.png" target="_blank"><small>Enriched event tree showing enrichment of recycler.exe and creation of old.rar output with correct ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration) (tainted by Windows Script Executing PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-4.png" target="_blank"><small>Specific Behavior alert for the execution of recycler.exe named \"Exfiltration-Encrypting Files with WinRar\" (tainted by Windows Script Executing PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>73</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.C.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.B.1-4.png" target="_blank"><small>Telemetry showing recycler.exe execution</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-2.png" target="_blank"><small>Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with correct ATT&CK Technique, T1022 - Data Encrypted)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-3.png" target="_blank"><small>Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-1.png" target="_blank"><small>General Behavior alert for Execution from Suspicious Directory</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-4.png" target="_blank"><small>General Behavior alert for File Write To Root Of Recycle Bin</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-5.png" target="_blank"><small>Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>Enrichment</p><p>General Behavior</p><p>Enrichment</p><p>Specific Behavior-Delayed</p>162</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-2.png" target="_blank"><small>Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-3.png" target="_blank"><small>Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.B.1-1.png" target="_blank"><small>Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-3.png" target="_blank"><small>Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.B.1-1.png" target="_blank"><small>Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-19-1.png" target="_blank"><small>Telemetry showing execution of recycler.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.A.1-2.png" target="_blank"><small>Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.B.1-1.png" target="_blank"><small>Telemetry showing the execution of recycler.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Input Capture</b><br><br><i>collection, Credential Access</i><br><br>(<a href="https://attack.mitre.org/techniques/T1056/">T1056</a>)</td><td>8.C.1</td><td>Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.C.1-2.png" target="_blank"><small>Command-Line Interface view for host Nimda kicking off DDNA Scan for PID 11252 (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.C.1-3.png" target="_blank"><small>DDNA JSON output from PID 11252 showing process capabilities (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-8.C.1-1.png" target="_blank"><small>Telemetry showing remote thread being created into explorer.exe (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-8.C.1-1.png" target="_blank"><small>Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.C.1-10.png" target="_blank"><small>Alert for Chain of Injections for powershell.exe injecting into cmd.exe (does not count as detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.C.1-11.png" target="_blank"><small>Alert showing loaded keyloggerx64.dll module (does not count as detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.C.1-12.png" target="_blank"><small>Alert showing keyloggerx64.dll module loaded into explorer.exe, including memory address and size (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-8.C.1-100.png" target="_blank"><small>Alert for Chain of Injections showing powershell.exe injecting into explorer.exe (does not count as detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-08-2.png" target="_blank"><small>Event tree showing a Process Injection alert from which strings were pulled (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-08-4.png" target="_blank"><small>Strings output extracted from Process Injection alert, showing key definitions typically associated with a keylogger, but no evidence of execution (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-8.C.1-3.png" target="_blank"><small>Alert that cmd.exe obtained a handle to the memory thread and injected code into explorer.exe (does not count as detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.C.1-3.png" target="_blank"><small>Telemetry showing explorer.exe reading user keystrokes</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.C.1-2.png" target="_blank"><small>Specific Behavior alert for \"Possible keylogging activity\" against explorer.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-8.C.1-1.png" target="_blank"><small>Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Configuration Change</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.C.1-2.png" target="_blank"><small>Telemetry showing code injection into explorer.exe (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.C.1-3.png" target="_blank"><small>Telemetry showing hook injection from explorer.exe (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-8.C.1-1.png" target="_blank"><small>Enrichment of the execution of a specific API call as keylogging and suspicious activity</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-08-3.png" target="_blank"><small>Floating Code module output showing keylogger key definitions (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-08-2.png" target="_blank"><small>Floating Code module output showing keylogger aggressor script (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-8.C.1-2.png" target="_blank"><small>Telemetry showing GetAsyncKeyStateApi (Group ID tainted the event but was not shown in this view)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-8.C.1-1.png" target="_blank"><small>Telemetry showing process injection into explorer.exe (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>15.A.1</td><td>Empire: Built-in keylogging module executed to capture keystrokes of user Bob</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-15.A.1-1.png" target="_blank"><small>Telemetry showing modloads associated with keylogger</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-15.A.1-3.png" target="_blank"><small>Enrichment of data with tag \"PowerShell Input Capture -keylogger\"</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-15.B.1-1.png" target="_blank"><small>Telemetry showing FsPostOpen event for IT_tasks.txt</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-15.B.1-2.png" target="_blank"><small>Telemetry showing file read event for IT_tasks.txt</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-15.A.1-20.png" target="_blank"><small>Indicator of Compromise alert for Malicious Command Get-Keystrokes </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-15.A.1-100.png" target="_blank"><small>Telemetry showing modloads associated with a keylogger</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Indicator of Compromise</p><p>Telemetry</p>30</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-15-1.png" target="_blank"><small>Telemetry showing PowerShell Script Block logging with execution of Get-KeyStrokes (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-15.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing the GetAsyncKeyState method</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-15.B.1-3.png" target="_blank"><small>Enrichment of powershell.exe with a tag indicating .NET keylogging</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-15.A.1-1.png" target="_blank"><small>PowerShell activity during the time of the keylogging (does not count as detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-15.A.1-1.png" target="_blank"><small>Telemetry showing execution of Get-Keystrokes cmdlet</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-15.A.1-2.png" target="_blank"><small>Telemetry showing keylogger events</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-15.A.1-3.png" target="_blank"><small>Specific Behavior alert for keylogging activity from powershell.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-15.A.1-5.png" target="_blank"><small>Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-15.A.1-2.png" target="_blank"><small>Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-15.A.1-1.png" target="_blank"><small>Enrichment of the execution of a specific API call as keylogging and suspicious activity</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>Indicator of Compromise</p>35</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-15.A.1-1.png" target="_blank"><small>Enrichment of use of GetAsyncKeyStateApi tagged as a keylogger (tainted by relationship to threat story but Group ID not shown in this view)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Multiband Communication</b><br><br><i>Command and Control</i><br><br>(<a href="https://attack.mitre.org/techniques/T1026/">T1026</a>)</td><td>6.B.1</td><td>Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-3.png" target="_blank"><small>Telemetry showing network connection over UDP port 53</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-2.png" target="_blank"><small>Telemetry showing network connection over TCP port 80</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-6.B.1-1.png" target="_blank"><small>Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by the parent \"Sponsor Process Established Network Connection\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.C.1-1.png" target="_blank"><small>Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.C.1-2.png" target="_blank"><small>Telemetry within an alert showing abnormally large DNS requests occurred (tainted by parent Exfiltration alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.B.1-20.png" target="_blank"><small>Telemetry showing the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain) (tainted by a parent Injected Shellcode alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-6.png" target="_blank"><small>Telemetry showing DNS connections</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-7.png" target="_blank"><small>Telemetry showing port 80 traffic (tainted by parent Malicious File Detection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-1.C.1-1.png" target="_blank"><small>Telemetry showing rundll32.exe making DNS queries</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-6.B.1-T1043-new.png" target="_blank"><small>Telemetry showing rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.B.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.B.1-2.png" target="_blank"><small>Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.B.1-1.png" target="_blank"><small>Telemetry showing execution sequence for rundll32.exe opening port 80 network connection</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.B.1-2.png" target="_blank"><small>Incident graph from \"Unexpected process behavior\" alert (resulting from rundll32.exe) showing tainted network connection</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.B.1-3.png" target="_blank"><small>Telemetry showing DNS traffic to C2 domain</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.B.1-1.png" target="_blank"><small>Telemetry showing ports 80 and 53 command and control traffic</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-6.B.1-1.png" target="_blank"><small>Telemetry showing port 80 connection to 192.168.0.4 (C2 server)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS query to C2 domain (tainted by relationship to threat story shown in Group ID)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="3"><b>Windows Admin Shares</b><br><br><i>Lateral Movement</i><br><br>(<a href="https://attack.mitre.org/techniques/T1077/">T1077</a>)</td><td>16.B.1</td><td>Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5) </td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-1.png" target="_blank"><small>Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-2.png" target="_blank"><small>Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.B.1-2.png" target="_blank"><small>Telemetry showing explorer.exe writing \\\\conficker\\PIPE\\srvsvc (tainted by the parent \"FileExts Registry Key modified\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.B.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-10.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.B.1-2.png" target="_blank"><small>OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.B.1-1.png" target="_blank"><small>Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed-Tainted</p><p>General Behavior-Delayed</p>58</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.B.1-20.png" target="_blank"><small>Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-3.png" target="_blank"><small>Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>73</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.B.1-2.png" target="_blank"><small>Specific Behavior alerts for net.exe connecting to a remote administrative share</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.B.1-3.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-1.png" target="_blank"><small>Telemetry showing a net use logon attempt to ADMIN$ shares</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>General Behavior</p>100</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.B.1-1.png" target="_blank"><small>Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.B.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-3.png" target="_blank"><small>Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-2.png" target="_blank"><small>Specific Behavior alert for the net utility executed to authenticate to a remote admin share with valid accounts, tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-1.png" target="_blank"><small>Specific Behavior alert for brute force attempt to remote SMB shares</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.B.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.B.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-2.png" target="_blank"><small>Telemetry showing logon attempt targeting ADMIN$ via net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.B.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt targeting ADMIN$ (tainted by relationship to threat story)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempts and corresponding exit codes</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>16.D.1</td><td>Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.D.1-2.png" target="_blank"><small>Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.D.1-1.png" target="_blank"><small>Telemetry showing process tree with successful net.exe logon targeting C$</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.D.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-10.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.D.1-2.png" target="_blank"><small>Telemetry showing process tree containing successful net use connection to C$ (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.D.1-10.png" target="_blank"><small>Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.D.1-100.png" target="_blank"><small>Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-6.png" target="_blank"><small>Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>73</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-3.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.D.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.D.1-1.png" target="_blank"><small>Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.D.1-5.png" target="_blank"><small>Specific Behavior alert for the net utility removing a shared connection via PowerShell, mapped to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.D.1-9.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.D.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-4.png" target="_blank"><small>Telemetry showing logon attempt targeting C$ via net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.D.1-1.png" target="_blank"><small>Telemetry showing a net.exe logon attempt targeting C$ (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>16.A.1</td><td>Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.A.1-3.png" target="_blank"><small>Specific Behavior alerts for of the 4 different net.exe logon attempts</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.A.1-1.png" target="_blank"><small>Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-1.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-2.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-3.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.A.1-4.png" target="_blank"><small>Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \"Net User Reconnaissance Command\", tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.A.1-1.png" target="_blank"><small>Telemetry showing net use logon attempts to ADMIN$ shares</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-10.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.A.1-2.png" target="_blank"><small>Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>General Behavior-Delayed-Tainted</p><p>General Behavior-Delayed</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-20.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-2.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-3.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-1.png" target="_blank"><small>Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.A.1-10.png" target="_blank"><small>Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-2.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-1.png" target="_blank"><small>Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>73</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.A.1-1.png" target="_blank"><small>Specific Behavior alerts for net.exe connecting to a remote administrative share</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.A.1-2.png" target="_blank"><small>Telemetry showing net use logon attempts to ADMIN$ shares</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.A.1-99.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>General Behavior</p>100</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-2.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Bob</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-3.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Frieda</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.A.1-4.png" target="_blank"><small>Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing repeated logon attempts targeting ADMIN$ via net.exe (tainted by a parent alert on powershell.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-3.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-1.png" target="_blank"><small>Specific Behavior alert for brute force attempt to remote SMB shares</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-4.png" target="_blank"><small>Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-5.png" target="_blank"><small>Specific Behavior alert for a net.exe logon attempt to ADMIN$ tagged with the correct ATT&CK Technique (Windows Admin Shares)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local user Kmitnick (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.A.1-3.png" target="_blank"><small>Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-1.png" target="_blank"><small>Telemetry showing logon attempts targeting ADMIN$ via net.exe and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.A.1-2.png" target="_blank"><small>Telemetry showing net.exe logon attempts targeting ADMIN$ and corresponding exit codes</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.A.1-1.png" target="_blank"><small>Telemetry showing net.exe logon attempts targeting ADMIN$ (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Clipboard Data</b><br><br><i>collection</i><br><br>(<a href="https://attack.mitre.org/techniques/T1115/">T1115</a>)</td><td>12.E.1.5</td><td>Empire: WinEnum module included enumeration of clipboard contents</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1.5-1.png" target="_blank"><small>OverWatch alert indicating encoded PowerShell was suspicious (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1.5-3.png" target="_blank"><small>Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1-2.png" target="_blank"><small>Telemetry showing encoded PowerShell, which decodes to show Windows.Clipboard details (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.E.1.5-1.png" target="_blank"><small>Telemetry of the PowerShell function to gather clipboard data (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-05.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and Clipboard Contents function (does not count as part of detection due to manual process of pulling events)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-4.png" target="_blank"><small>Telemetry showing decoded PowerShell displaying Windows.Clipboard as part of WinEnum. The PowerShell process was tainted by parent PowerShell alerts.</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-4.png" target="_blank"><small>Indicator of Compromise alert for PowerShell Empire accessing the clipboard.</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>Indicator of Compromise</p>30</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker executed the Windows Clipboard capability of Empire (Indicator of Compromise)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.E.1.5-2.png" target="_blank"><small>Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.E.1.5-1.png" target="_blank"><small>PowerShell Execution alert containing encoded PowerShell command (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Indicator of Compromise-Delayed</p>17</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.E.1.1-5.png" target="_blank"><small>Telemetry showing execution of an encoded PowerShell command (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.5-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>New Service</b><br><br><i>Persistence, Privilege Escalation</i><br><br>(<a href="https://attack.mitre.org/techniques/T1050/">T1050</a>)</td><td>16.I.1</td><td>Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.H.1-3.png" target="_blank"><small>Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.I.1-1.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.I.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.I.1-2.png" target="_blank"><small>Specific Behavior alert for \"\"New Windows service created\"\" and additional alert for \"Windows Service Registry Key modified\" </small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Configuration Change</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.H.1-2.png" target="_blank"><small>Telemetry from process tree showing sc.exe execution to create the AdobeUpdater service (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-11.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed a newly created file (AdobeUpdater service in registry) to establish persistence (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.H.1-4.png" target="_blank"><small>Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.I.1-13.png" target="_blank"><small>Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" target="_blank"><small>Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-13.png" target="_blank"><small>Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p><p>Specific Behavior</p>76</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.I.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-1.png" target="_blank"><small>Telemetry showing sc.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-2.png" target="_blank"><small>Specific Behavior alert for sc.exe used with parameters typical for lateral movement</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>General Behavior</p>100</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.I.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.I.1-1.png" target="_blank"><small>Additional details on enrichment of sc.exe with SC Execution alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.L.1-1.png" target="_blank"><small>Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-4.png" target="_blank"><small>Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.I.1-1.png" target="_blank"><small>Telemetry showing that a new service was added</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.J.1-3.png" target="_blank"><small>Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.I.1-3.png" target="_blank"><small>Specific Behavior alert on suspicious service registration on Creeper</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.I.1-2.png" target="_blank"><small>Telemetry showing AdobeUpdater service registry information that was changed on Creeper</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.I.1-1.png" target="_blank"><small>Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.I.1-4.png" target="_blank"><small>Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.I.1-1.png" target="_blank"><small>Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.I.1-2.png" target="_blank"><small>Telemetry showing the creation of Registry keys associated with the AdobeUpdater service </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.I.1-3.png" target="_blank"><small>Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p><p>Enrichment</p>79</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-7.png" target="_blank"><small>Telemetry showing execution of sc.exe to create the AdobeUpdater service</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.I.1-1.png" target="_blank"><small>Telemetry showing execution of sc.exe to create the AdobeUpdater service (tainted by prior threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="6"><b>Permission Groups Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1069/">T1069</a>)</td><td>12.E.1.2</td><td>Empire: WinEnum module included enumeration of AD group memberships</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.E.1.2-1.png" target="_blank"><small>Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper) (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-03.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the AD Group Memberships function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.E.1.2-1.png" target="_blank"><small>Telemetry showing loading of System.DirectoryServices.AccountManagement assembly (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.F.1</td><td>Empire: 'net group "Domain Admins" /domain' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.F.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.F.1-3.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.F.1-1.png" target="_blank"><small>Enrichment of net.exe with conditions Net Domain Admins Reconnaissance Command and Net Group Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.F.1-3.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.F.1-1.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>General Behavior-Delayed</p>46</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.F.1-1.png" target="_blank"><small>Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.F.1-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-5.png" target="_blank"><small>Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p><p>Enrichment-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.1-3.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.1-T1069-new.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.F.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-99.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-2.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment</p><p>Enrichment</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.F.1-1.png" target="_blank"><small>Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.F.1-2.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.F.1-3.png" target="_blank"><small>Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.F.1-2.png" target="_blank"><small>Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.F.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.F.1-4.png" target="_blank"><small>Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>46</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>12.F.2</td><td>Empire: 'net localgroup administrators' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.F.1-3.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.F.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.F.2-1.png" target="_blank"><small>Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.F.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-8.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net localgroup was part of additional malicious discovery activity (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.F.2-1.png" target="_blank"><small>Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.F.2-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-7.png" target="_blank"><small>Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert.</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Delayed</p><p>Enrichment-Tainted</p>28</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.2-T1069-new.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.F.1-3.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.F.2-1.png" target="_blank"><small>Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>General Behavior-Delayed</p>42</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.F.1-2.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.F.2-2.png" target="_blank"><small>Process tree view of General Behavior alert on \"Suspicious sequence of exploration activities\" showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.F.2-1.png" target="_blank"><small>Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.F.2-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.F.2-2.png" target="_blank"><small>Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.F.2-3.png" target="_blank"><small>Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.F.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.F.1</td><td>Cobalt Strike: 'net localgroup administrators' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.1-3.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.1-2.png" target="_blank"><small>Enrichment of net.exe with tag Administrator Enumeration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.F.1-1.png" target="_blank"><small>Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.F.1-3.png" target="_blank"><small>OverWatch General Behavior alert for net localgroup </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.F.1-1.png" target="_blank"><small>Telemetry showing net with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p><p>General Behavior-Delayed</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.F.1-10.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.D.2-10.png" target="_blank"><small>Process tree showing enriched net.exe executing (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.F.1-100.png" target="_blank"><small>Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Tainted</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-10.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-16.png" target="_blank"><small>Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.1-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.1-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing net) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.1-98.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.1-99.png" target="_blank"><small>Enrichment of net.exe indicating it is commonly used for reconnaissance</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>85</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.F.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.F.1-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-6.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.F.1-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.F.1-2.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.F.1-1.png" target="_blank"><small>Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-10.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.F.3</td><td>Cobalt Strike: 'net group "Domain Admins" /domain' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.3-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.3-3.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.3-2.png" target="_blank"><small>Enrichment of net.exe with tag Administrator Enumeration</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.F.3-1.png" target="_blank"><small>Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.F.1-2.png" target="_blank"><small>Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.F.1-1.png" target="_blank"><small>Telemetry showing net with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>46</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.F.3-100.png" target="_blank"><small>General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.D.2-10.png" target="_blank"><small>Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.F.3-10.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Tainted</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-12.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-17.png" target="_blank"><small>Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.3-1.png" target="_blank"><small>Enrichment of net.exe indicating it is commonly used for reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.3-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.3-3.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.F.3-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.F.3-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.A.1-27.png" target="_blank"><small>Enrichment of net group with a correct ATT&CK Tactic (Discovery) and Technique (Permission Group Discovery) and a suspicious indicator that a net utility was used to gather information of user groups</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.F.3-2.png" target="_blank"><small>Telemetry showing domain admins group discovery by Nimda at the domain controller</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.F.3-3.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.F.3-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.F.3-5.png" target="_blank"><small>Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.F.3-4.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.F.3-3.png" target="_blank"><small>Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.F.3-2.png" target="_blank"><small>Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.F.3-1.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>Enrichment-Tainted</p>31</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-5.png" target="_blank"><small>Event enrichment from IIOC module \"Enumerates domain administrators\"</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-12.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>2.F.2</td><td>Cobalt Strike: 'net localgroup administrators /domain' via cmd</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.2-1.png" target="_blank"><small>Telemetry from process tree showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.2-2.png" target="_blank"><small>Enrichment of net.exe with tag Administrator Enumeration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-2.F.2-3.png" target="_blank"><small>Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-2.F.2-1.png" target="_blank"><small>Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.A.1-1.png" target="_blank"><small>Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-2.F.1-1.png" target="_blank"><small>Telemetry showing net with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-3.png" target="_blank"><small>Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.F.2-10.png" target="_blank"><small>Telemetry showing cmd.exe executing net with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.D.2-10.png" target="_blank"><small>Process tree showing enriched net.exe executing (tainted by a parent Injected Shellcode alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-2.F.2-100.png" target="_blank"><small>Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment-Tainted</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-18.png" target="_blank"><small>General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-11.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-16.png" target="_blank"><small>Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-02-19.png" target="_blank"><small>Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>General Behavior-Configuration Change-Delayed-Tainted</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.2-1.png" target="_blank"><small>General Behavior alert for rundll32.exe launching cmd.exe (executing net) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.2-99.png" target="_blank"><small>Enrichment of net.exe indicating it is commonly used for reconnaissance</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.2-2.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-2.F.2-98.png" target="_blank"><small>General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>Telemetry</p><p>General Behavior</p>85</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.B.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.F.2-1.png" target="_blank"><small>Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-2.F.2-2.png" target="_blank"><small>Excerpt from the Managed Defense Report with additional details about net</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-4.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-2.B.1-6.png" target="_blank"><small>Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.A.1-3.png" target="_blank"><small>General Behavior alert on suspicious sequence of exploration activities</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.F.2-2.png" target="_blank"><small>Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-2.F.2-1.png" target="_blank"><small>Telemetry showing execution sequence for net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-2.F.2-1.png" target="_blank"><small>Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-02-3.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-2.A.1-11.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Network Share Connection Removal</b><br><br><i>Defense Evasion</i><br><br>(<a href="https://attack.mitre.org/techniques/T1126/">T1126</a>)</td><td>16.C.1</td><td>Empire: 'net use /delete' via PowerShell</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.C.1-1.png" target="_blank"><small>Telemetry showing process tree with net.exe and command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.B.1-2.png" target="_blank"><small>Specific Behavior alerts for removing connected network share</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.C.1-1.png" target="_blank"><small>Telemetry showing net.exe and command-line arguments (tainted by the parent \"Powershell executed remote commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-10.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating they observed ADMIN$ artifact removed (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.C.1-1.png" target="_blank"><small>Telemetry from process tree showing net.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.C.1-10.png" target="_blank"><small>General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Tainted</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-5.png" target="_blank"><small>Telemetry showing event tree containing net.exe and command-line argument (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-3.png" target="_blank"><small>General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.C.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.C.1-1.png" target="_blank"><small>Telemetry showed net.exe executing with command-line arguments. </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.B.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-3.png" target="_blank"><small>Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.A.1-2.png" target="_blank"><small>Specific Behavior alert for the net utility removing a shared connection via PowerShell, tagged to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.C.1-1.png" target="_blank"><small>Telemetry showing net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.A.1-6.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.C.1-2.png" target="_blank"><small>Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.C.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-3.png" target="_blank"><small>Telemetry showing net.exe execution and command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.C.1-1.png" target="_blank"><small>Telemetry showing net.exe and command-line arguments (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>File Deletion</b><br><br><i>Defense Evasion</i><br><br>(<a href="https://attack.mitre.org/techniques/T1107/">T1107</a>)</td><td>19.D.1</td><td>Empire: 'del C:\"$"Recycle.bin\old.rar'</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.D.1-1.png" target="_blank"><small>Telemetry showing filemod (file modification) deletion of old.rar</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.D.1-1.png" target="_blank"><small>Telemetry showing powershell.exe deleting old.rar (tainted by the parent \"PowerShell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed old.rar being deleted (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.D.1-1.png" target="_blank"><small>Telemetry showing deletion of old.rar</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.D.1-10.png" target="_blank"><small>Telemetry showing a deletion event for old.rar via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.D.1-1.png" target="_blank"><small>Telemetry showing the deletion of old.rar</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.D.1-1.png" target="_blank"><small>Telemetry showing PowerShell executing the Remove-Item cmdlet (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.D.1-1.png" target="_blank"><small>Telemetry showing the file delete event for old.rar (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-19-3.png" target="_blank"><small>Master file table on 10.0.1.5 (CodeRed) shows old.rar listed under deleted files (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.D.1-1.png" target="_blank"><small>Telemetry exported from threat story showing the deletion of old.rar was tainted by prior activity because it was under the same Group ID</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>19.D.2</td><td>Empire: 'del recycler.exe'</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.D.1-1.png" target="_blank"><small>Telemetry showing filemod (file modification) deletion of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.D.2-1.png" target="_blank"><small>Telemetry showing powershell.exe deleting recycler.exe (tainted by the parent \"PowerShell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed recycler.exe being deleted (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.D.1-2.png" target="_blank"><small>Telemetry showing deletion of recycler.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.D.2-10.png" target="_blank"><small>Telemetry showing a deletion event for recycler.exe via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-3.png" target="_blank"><small>Telemetry showing file deletion of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.D.1-1.png" target="_blank"><small>Telemetry showing the deletion of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.D.1-1.png" target="_blank"><small>Telemetry showing file deletion event for recycler.exe (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.D.1-9.png" target="_blank"><small>Enrichment of PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.D.1-1.png" target="_blank"><small>Telemetry showing the file delete event for recycler.exe (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.D.1-1.png" target="_blank"><small>Telemetry exported from threat story showing the deletion of recycler.exe was tainted by prior activity because it was under the same Group ID</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="8"><b>Execution through API</b><br><br><i>Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1106/">T1106</a>)</td><td>8.C.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>3.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>8.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>9.B.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>8.D.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>9.A.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>2.C.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.E.1</td><td></td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="5"><b>Remote File Copy</b><br><br><i>Command and Control, Lateral Movement</i><br><br>(<a href="https://attack.mitre.org/techniques/T1105/">T1105</a>)</td><td>19.A.1</td><td>Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.A.1-1.png" target="_blank"><small>Telemetry showing filemod (file modification) creation of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.A.1-2.png" target="_blank"><small>Telemetry showing creation of recycler.exe (tainted by \"Powershell executed encoded commands\" and \"Policy Dropper Behavior\" alerts) and powershell.exe behavior contributing to \"Policy Dropper Behavior\" alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.A.1-1.png" target="_blank"><small>General Behavior alert for \"Policy Dropper Behavior\" based on three correlated events</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Configuration Change</p><p>Telemetry-Tainted</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.A.1-3.png" target="_blank"><small>Telemetry showing network connection from 192.168.0.5 (C2 server) used by powershell.exe to transfer recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.A.1-1.png" target="_blank"><small>Telemetry showing file write of recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.A.1-20.png" target="_blank"><small>Telemetry showing file create/write of recycler.exe (tainted by a parent PowerShell alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-1.png" target="_blank"><small>Telemetry showing file creation of recycler.exe by powershell.exe (tainted by parent PowerShell alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.B.1-2.png" target="_blank"><small>Telemetry showing the creation of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-1.png" target="_blank"><small>Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-2.png" target="_blank"><small>Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-1.png" target="_blank"><small>Telemetry showing file creation event for recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-1.png" target="_blank"><small>Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-3.png" target="_blank"><small>Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.A.1-3.png" target="_blank"><small>General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.A.1-2.png" target="_blank"><small>General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.A.1-1.png" target="_blank"><small>Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>General Behavior-Tainted</p><p>General Behavior-Tainted</p>61</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-19-1.png" target="_blank"><small>Telemetry showing file write of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.A.1-1.png
" target="_blank"><small>Telemetry showing file write of recycler.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.A.1-2.png" target="_blank"><small>Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>7.B.1</td><td>Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-7.B.1-1.png" target="_blank"><small>Telemetry showing updater.dll written to disk</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-7.B.1-1.png" target="_blank"><small>Telemetry showing creation of updater.dll (tainted by the parent \"Powershell process created\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-7.B.1-2.png" target="_blank"><small>Additional telemetry showing file write for updater.dll</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-7.B.1-1.png" target="_blank"><small>Telemetry showing file write for updater.dll (tainted by the parent \"unexpected process\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-7.B.1-10.png" target="_blank"><small>Telemetry showing the file write of updater.dll (tainted by a parent alert on cmd.exe, listed as Owner Process)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-7.B.1-11.png" target="_blank"><small>Parent alert for updater.dll being detected as known malware</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-07-1.png" target="_blank"><small>Telemetry showing creation of updater.dll (tainted by parent Malicious File Detection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-7.B.1-1.png" target="_blank"><small>Enrichment of the creation of updater.dll identifying that a command prompt modified an unknown DLL</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.B.1-2.png" target="_blank"><small>Telemetry showing updater.dll file write (tainted by parent AV signature alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.B.1-1.png" target="_blank"><small>Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105  - Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry-Tainted</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-7.B.1-1.png" target="_blank"><small>Specific Behavior alert for a new PE file created in the Windows system (System32) folder</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-7.B.1-99.png" target="_blank"><small>Specific Behavior alert for a new dynamic library file created in the Windows system (System32) folder</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Specific Behavior</p>120</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-7.B.1-1.png" target="_blank"><small>Telemetry showing file write of updater.dll</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.B.1-1.png" target="_blank"><small>Telemetry showed the file create event for updater.dll</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.B.1-2.png" target="_blank"><small>Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.B.1-3.png" target="_blank"><small>Specific Behavior alert for a Windows scripting engine creating an executable on disk</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Tainted</p><p>Specific Behavior</p>127</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-07-1.png" target="_blank"><small>Telemetry showing file write event of updater.dll</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-7.B.1-1.png" target="_blank"><small>Telemetry showing file write of updater.dll (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>16.E.1</td><td>Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.E.1-1.png" target="_blank"><small>Telemetry showing creation and write to autoupdate.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.E.1-1.png" target="_blank"><small>Telemetry showing powershell.exe creating autoupdate.vbs (tainted by parent \"Powershell executed remote commands\" alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-10.png" target="_blank"><small>Excerpt from email sent by OverWatch team indicating they observed autoupdate.vbs written (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.E.1-1.png" target="_blank"><small>Telemetry showing File Write and New Script Write for autoupdate.vbs within powershell.exe (tainted by previous detection by orange line indicating medium severity)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.E.1-10.png" target="_blank"><small>Telemetry showing file write of autoupdate.vbs (tainted by a parent PowerShell alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-8.png" target="_blank"><small>Telemetry showing creation of autoupdate.vbs (tainted by parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-6.png" target="_blank"><small>Telemetry showing the creation of autoupdate.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.E.1-2.png" target="_blank"><small>Additional details on enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.E.1-1.png" target="_blank"><small>Enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy) and Tactics, Command and Control and Lateral Movement)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.E.1-2.png" target="_blank"><small>Telemetry showing the creation of autoupdate.vbs</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.E.1-1.png" target="_blank"><small>Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.E.1-1.png" target="_blank"><small>Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.E.1-1.png" target="_blank"><small>Telemetry showing file create and write events for autoupdate.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-16-5.png" target="_blank"><small>Telemetry showing file write of autoupdate.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.E.1-2.png" target="_blank"><small>Telemetry showing creation and writes to autoupdate.vbs</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.E.1-1.png" target="_blank"><small>Telemetry showing file event for autoupdate.vbs (tainted by relationship to threat story but Group ID not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>14.A.1</td><td>Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk</td><td></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-14.A.1-2.png" target="_blank"><small>Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-11.png" target="_blank"><small>Email excerpt from the OverWatch team indicating PowerShell retrieved the file wdbypass (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Delayed</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-40.png" target="_blank"><small>Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-10.png" target="_blank"><small>Specific Behavior alert for Download & execute of the wdbypass file</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Specific Behavior-Tainted</p>57</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-14-1.png" target="_blank"><small>Telemetry showing decoded PowerShell with download request of wdbypass over port 8080</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-14.A.1-2.png" target="_blank"><small>Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-14.A.1-1.png" target="_blank"><small>Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-14.A.1-4.png" target="_blank"><small>Enrichment of HTTP GET request for wdbypass with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy, and Tactic, Command and Control)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-14.A.1-1.png" target="_blank"><small>Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-4.png" target="_blank"><small>Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-3.png" target="_blank"><small>Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-14.A.1-5.png" target="_blank"><small>Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-14-1.png" target="_blank"><small>Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>16.G.1</td><td>Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-16.G.1-1.png" target="_blank"><small>Telemetry showing remote creation and write to update.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-16.G.1-1.png" target="_blank"><small>Enrichment of powershell.exe creating update.vbs (tainted by parent \"Powershell executed remote commands\" alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Enrichment-Tainted-Configuration Change</p>9</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-16.G.1-1.png" target="_blank"><small>Telemetry showing update.vbs with event_name NewScriptWritten indicating a write to C$</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-16.G.1-10.png" target="_blank"><small>Telemetry of file events for write of update.vbs to Creeper (10.0.0.4) (tainted by a parent PowerShell alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-16.D.1-6.png" target="_blank"><small>Telemetry showing the creation of update.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.G.1-1.png" target="_blank"><small>Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-16.G.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.G.1-1.png" target="_blank"><small>Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-16.G.1-2.png" target="_blank"><small>Telemetry showing the creation of update.vbs</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.G.1-1.png" target="_blank"><small>Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.D.1-4.png" target="_blank"><small>Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-16.G.1-2.png" target="_blank"><small>Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.G.1-2.png" target="_blank"><small>Specific Behavior alert for a script being modified/moved to a remote location (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-16.G.1-1.png" target="_blank"><small>Telemetry showed file create and write events for update.vbs</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Tainted</p>67</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-16.G.1-2.png" target="_blank"><small>Telemetry showing create file event of update.vbs on 10.0.0.4 (Creeper) (tainted by relationship to threat story but Group ID not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Access Token Manipulation</b><br><br><i>Defense Evasion, Privilege Escalation</i><br><br>(<a href="https://attack.mitre.org/techniques/T1134/">T1134</a>)</td><td>3.A.1</td><td>Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-3.A.1-5.png" target="_blank"><small>Telemetry showing svchost.exe activity related to token manipulation</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-3.A.1-6.png" target="_blank"><small>Telemetry showing svchost.exe command line arguments, specifically seclogon</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-3.A.1-2.png" target="_blank"><small>Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-3.A.1-1.png" target="_blank"><small>Alert for PowerShell process creation (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-3.C.1-10.png" target="_blank"><small>Alert for malicious code injection into PowerShell (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-3.A.1-10.png" target="_blank"><small>Telemetry showing the bypassuactoken.x64.dll was loaded (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-03-06.png" target="_blank"><small>Telemetry showing powershell.exe spawned with token authentication id 100243447</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-03-7.png" target="_blank"><small>Telemetry showing svhost.exe seclogon event for token login id 0x5f997f7 (100243447)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-3.A.1-1.png" target="_blank"><small>Telemetry showing logon event for user Debbie with an elevated token</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-3.A.1-3.png" target="_blank"><small>Telemetry showing svchost.exe executed with the seclogon command-line argument </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-3.A.1-3.png" target="_blank"><small>Telemetry showing svchost.exe seclogon event for token login ID 0xfcf5fd</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-3.A.1-4.png" target="_blank"><small>Telemetry showing group membership of token logon ID 0xfcf5fd, which includes S-1-16-12288 (High Mandatory Level)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Configuration Change</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-3.A.1-2.png" target="_blank"><small>Telemetry showing a New Credentials logon event for user Debbie</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-3.A.1-1.png" target="_blank"><small>Telemetry showing svchost.exe, with the seclogon command-line argument</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Delayed</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.A.1-2.png" target="_blank"><small>Telemetry showing svchost.exe execution with seclogon command-line argument then subsequent powershell.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-3.C.1-2.png" target="_blank"><small>Alert for \'Suspicious PowerShell command-line\' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-3.A.1-2.png" target="_blank"><small>Telemetry showing logon event with an elevated token and new logon ID</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-3.A.1-1.png" target="_blank"><small>Telemetry showing svchost.exe executed with the seclogon command-line argument</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>5.B.1</td><td>Cobalt Strike: Built-in token theft capability executed to change user context to George</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.B.1-2.png" target="_blank"><small>Telemetry showing parent cmd.exe process running under user context Debbie</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.B.1-3.png" target="_blank"><small>Telemetry showing child cmd.exe process running under user context George</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-5.B.1-1.png" target="_blank"><small>Telemetry showing children of the compromised process (PID 21898821890) first running as Debbie, then as George</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.B.1-10.png" target="_blank"><small>Telemetry within the process tree showing cmd.exe associated with users Debbie and George (tainted by a parent alert on explorer.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-05-7.png" target="_blank"><small>Telemetry showing the cmd.exe that spawned as user George from rundll32.exe running as user Debbie (tainted by parent Privilege Escalation alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-05-6.png" target="_blank"><small>Specific Behavior alert on Privilege Escalation showing a process spawning (cmd.exe) with different tokens than the parent (rundll32.exe) (mapped to the correct ATT&CK Technique, T1134 - Access Token Manipulation, and Tactics, Privilege Escalation and Defense Evasion)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry-Tainted</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-5.B.1-T1134-new.png" target="_blank"><small>Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-5.B.1-1.png" target="_blank"><small>Telemetry showing the user George executing reg.exe with command-line arguments during Step 6</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-4.A.1-1.png" target="_blank"><small>Telemetry showing the user Debbie executing net.exe with command-line arguments during Step 4</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-5.C.1-1.png" target="_blank"><small>Telemetry showing a change in user execution context from Debbie to George between processes</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.B.1-4.png" target="_blank"><small>Alert for suspicious process injection showing tainted association via a process tree containing subsequent cmd.exe processes (inner failure message in screenshot not relevant to tested functionality)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.B.1-2.png" target="_blank"><small>Telemetry showing resulting cmd.exe running as user George</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.B.1-1.png" target="_blank"><small>Telemetry showing svchost.exe invocation with seclogon flag subsequently running cmd.exe as SYSTEM</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-5.B.1-1.png" target="_blank"><small>Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation (tainted by a parent process injection alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="3"><b>Scripting</b><br><br><i>Defense Evasion, Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1064/">T1064</a>)</td><td>1.A.1</td><td>Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.A.1-3.png" target="_blank"><small>Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.A.1-1.png" target="_blank"><small>Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-1.A.1-4.png" target="_blank"><small>Telemetry showing cmd.exe running pdfhelper.cmd (tainted by the Script File Created alert) </small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.A.1-7.png" target="_blank"><small>Telemetry showing pdfhelper.cmd execution</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.A.1-5.png" target="_blank"><small>OverWatch General Behavior alert indicating pdfhelper.cmd execution was suspicious</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior-Delayed</p><p>Telemetry</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.A.1-20.png" target="_blank"><small>Telemetry showing cmd.exe launching pdfhelper.cmd (tainted by parent alert on explorer.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-3.png" target="_blank"><small>Telemetry showing pdfhelper.cmd spawned as a child process of Resume Viewer.exe (tainted by parent Malicious File Detection alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-9.png" target="_blank"><small>Telemetry showing cmd.exe process creation and execution of pdfhelper.cmd (tainted by parent Malicious File Detection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-1.A.1-4.png" target="_blank"><small>Telemetry showing the execution of pdfhelper.cmd</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.A.1-2.png" target="_blank"><small>Telemetry showing the child cmd.exe process running the pdfhelper.cmd script</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-1.B.1-6.png" target="_blank"><small>Process tree within trace detection containing cmd.exe executing pdfhelper.cmd (tainted by a parent alert on Resume Viewer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-1.B.1-5.png" target="_blank"><small>Telemetry showing pdfhelper.cmd execution</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.B.1-1.png" target="_blank"><small>Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.A.1-3.png" target="_blank"><small>Specific Behavior alert for execution of Windows script engine tagged with the correct ATT&CK Technique (Scripting)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.A.1-2.png" target="_blank"><small>Telemetry showing cmd.exe launching pdfhelper.cmd</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-01-1.png" target="_blank"><small>Telemetry showing Resume Viewer.exe execution (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.B.1-1.png" target="_blank"><small>Telemetry from process tree showing the child cmd.exe process running the script pdfhelper.cmd (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>11.A.1</td><td>Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-11.A.1-1.png" target="_blank"><small>Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-11.A.1-3.png" target="_blank"><small>Specific Behavior alerts for Powershell scripting</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-11.A.1-2.png" target="_blank"><small>Telemetry showing process tree of script execution</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Telemetry</p><p>Specific Behavior</p><p>Specific Behavior</p>145</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-11.A.1-3.png" target="_blank"><small>Telemetry showing powershell.exe creation from wscript.exe (tainted by the parent Script File Created alert) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-11.A.1-2.png" target="_blank"><small>Telemetry showing script execution (tainted by the parent Script File Created alert) </small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-6.png" target="_blank"><small>Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-11.A.1-2.png" target="_blank"><small>General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-11.A.1-1.png" target="_blank"><small>Specific Behavior alert for PowerShell sharing characteristics with known exploit kits</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>General Behavior-Delayed</p><p>Telemetry</p><p>Specific Behavior-Delayed</p>154</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.A.1-14.png" target="_blank"><small>Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.A.1-13.png" target="_blank"><small>Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.A.1-12.png" target="_blank"><small>Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.A.1-11.png" target="_blank"><small>Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry-Tainted</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-1.png" target="_blank"><small>Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-7.png" target="_blank"><small>Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry-Tainted</p><p>Specific Behavior</p>127</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.A.1-5.png" target="_blank"><small>Specific Behavior alert for PowerShell executing a long, encoded command</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.A.1-3.png" target="_blank"><small>Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.A.1-1.png" target="_blank"><small>Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Enrichment</p><p>Specific Behavior</p>85</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.A.1-4.png" target="_blank"><small>Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.A.1-1.png" target="_blank"><small>Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.A.1-3.png" target="_blank"><small>Additional details on Specific Behavior alert for Suspicious PowerShell Usage</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.A.1-2.png" target="_blank"><small>Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Enrichment</p><p>Indicator of Compromise</p>95</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.A.1-5.png" target="_blank"><small>Specific Behavior alerts and enrichments for wcript.exe and powershell.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.A.1-1.png" target="_blank"><small>Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p><p>Specific Behavior</p><p>Enrichment</p><p>Enrichment</p><p>Specific Behavior</p><p>Specific Behavior</p>277</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-8.png" target="_blank"><small>Process tree of alert showing containing malicious PowerShell cmdlets related to Empire</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-4.png" target="_blank"><small>Telemetry showing PowerShell script metadata and decoded command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-5.png" target="_blank"><small>Specific Behavior alert for \"Suspicious PowerShell command-line\"</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-6.png" target="_blank"><small>Specific Behavior alert for \"PowerShell script with suspicious content\" detected through Antimalware Scan Interface extracted content</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-7.png" target="_blank"><small>Specific Behavior alert for PowerShell script with malicious cmdlets</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-1.png" target="_blank"><small>Telemetry showing execution of autoupdate.vbs script</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-2.png" target="_blank"><small>Telemetry showing execution of wscript.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-3.png" target="_blank"><small>Telemetry showing execution of PowerShell cmdlets from wscript.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>Specific Behavior-Delayed</p><p>Specific Behavior</p>187</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-3.png" target="_blank"><small>Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-2.png" target="_blank"><small>Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-1.png" target="_blank"><small>Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-7.png" target="_blank"><small>Specific Behavior alert for suspicious PowerShell activity</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-6.png" target="_blank"><small>Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-5.png" target="_blank"><small>Specific Behavior alert for PowerShell execution with base64 encoded commands</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-4.png" target="_blank"><small>Indicator of Compromise alert identifying PowerShell Empire</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-8.png" target="_blank"><small>Indicator of Compromise alerts for suspicious PowerShell strings</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Specific Behavior</p><p>Specific Behavior</p><p>Indicator of Compromise</p><p>Indicator of Compromise</p><p>Specific Behavior</p><p>Telemetry-Tainted</p>287</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-11-1.png" target="_blank"><small>Telemetry showing the autoupdate.vbs script executed by wscript.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-11.A.1-1.png" target="_blank"><small>General Behavior alert for execution of autoupdate.vbs listed as an active threat</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-11.A.1-2.png" target="_blank"><small>Telemetry showing wscript.exe and powershell.exe </small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td></tr><tr><td>12.E.1</td><td>Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.E.1-2.png" target="_blank"><small>Telemetry showing dynamically loaded libraries (modloads) that may indicate PowerShell functionality</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-12.E.1-1.png" target="_blank"><small>Telemetry showing powershell.exe execution</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-12.E.1.2-1.png" target="_blank"><small>Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1-1.png" target="_blank"><small>Telemetry showing the temp write of the ps1 script</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1-3.png" target="_blank"><small>Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-12.E.1-4.png" target="_blank"><small>OverWatch Specific Behavior alert indicating the PowerShell script was malicious</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p><p>Specific Behavior-Delayed</p>124</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.E.1-100.png" target="_blank"><small>Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.E.1-2.png" target="_blank"><small>Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-12.E.1-1.png" target="_blank"><small>Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-3.png" target="_blank"><small>Specific Behavior alert for \"PowerShell with Unusual Arguments\" (tagged with correct ATT&CK Technique, T1086 - PowerShell, and Tactic, Execution; tainted by parent PowerShell alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-01.png" target="_blank"><small>Telemetry pulled by Interactive Shell showing the contents of the WinEnum script (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-7.png" target="_blank"><small>Telemetry showing powershell.exe execution (ID 2397532) (tainted by parent PowerShell alerts)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.E.1-1.png" target="_blank"><small>Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-12.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Specific Behavior-Delayed</p>72</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-12.E.1-4.png" target="_blank"><small>Telemetry showing the PowerShell script (.ps1) being written to the temp folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-2.png" target="_blank"><small>Additional telemetry showing powershell.exe execution sequence resulting from WinEnum</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-1.png" target="_blank"><small>Telemetry showing powershell.exe execution sequence resulting from WinEnum</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.A.1-4.png" target="_blank"><small>Process tree view of \"Suspicious sequence of exploration activities\" alert showing tainted powershell.exe process</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-5.png" target="_blank"><small>Specific Behavior alert for \"A malicious PowerShell Cmdlet was invoked on the machine\"</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-12.E.1-4.png" target="_blank"><small>Process tree under alert \"A malicious PowerShell Cmdlet was invoked on the machine\" showing Invoke-Empire and Invoke-WinEnum</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1-2.png" target="_blank"><small>Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1-3.png" target="_blank"><small>Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p><p>Indicator of Compromise</p>84</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-12-3.png" target="_blank"><small>Telemetry showing a PowerShell script written to disk</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-1.png" target="_blank"><small>Telemetry showing encoded PowerShell script (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Credential Dumping</b><br><br><i>Credential Access</i><br><br>(<a href="https://attack.mitre.org/techniques/T1003/">T1003</a>)</td><td>5.A.1</td><td>Cobalt Strike: Built-in Mimikatz credential dump capability executed</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.A.1-4.png" target="_blank"><small>Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.A.1-1.png" target="_blank"><small>Telemetry showing cross process events, specifically a handle to open thread into lsass.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.1-1.png" target="_blank"><small>Alert showing DDNA Scan for svchost.exe (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.1-3.png" target="_blank"><small>Alert showing additional DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.1-2.png" target="_blank"><small>Alert showing DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-5.A.1-6.png" target="_blank"><small>Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p><p>General Behavior-Delayed-Tainted</p>91</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.1-11.png" target="_blank"><small>Specific Behavior alert with correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection) with details about svchost.exe accessing lsass</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-05-1.png" target="_blank"><small>Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.2-2.png" target="_blank"><small>Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.1-2.png" target="_blank"><small>Specific Behavior alert description for sensitive credential memory read</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.1-3.png" target="_blank"><small>Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.1-1.png" target="_blank"><small>Process tree for sensitive credential memory read alert</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment-Tainted</p><p>Specific Behavior-Delayed</p>69</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-5.A.1-1.png" target="_blank"><small>A Specific Behavior alert for a suspicious handle being opened to lsass.exe to dump password, tagged with the correct ATT&CK Technique (Credential Dumping)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>5.A.2</td><td>Cobalt Strike: Built-in hash dump capability executed</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-5.A.2-2.png" target="_blank"><small>Telemetry showing cross process events, specifically a handle to open thread into lsass.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-5.A.2-2.png" target="_blank"><small>Telemetry showing thread create to lsass.exe (tainted by the parent \"Powershell process created\" and \"Policy Remote Process Compromise\" alerts)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-5.A.2-4.png" target="_blank"><small>Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-5.A.2-1.png" target="_blank"><small>Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Specific Behavior-Tainted</p><p>Telemetry</p><p>General Behavior-Delayed-Tainted</p>148</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.2-10.png" target="_blank"><small>Parent alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.2-20.png" target="_blank"><small>Telemetry showing svchost.exe process injection into lsass.exe (tainted by a parent injection alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-5.A.2-11.png" target="_blank"><small>Telemetry within alert showing loaded hashdumpx64.dll as floating executable code</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-05-2.png" target="_blank"><small>Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-5.A.2-1.png" target="_blank"><small>Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.2-2.png" target="_blank"><small>Alert for process injection into lsass.exe tainting this event (inner failure message in screenshot not relevant to tested functionality)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-5.A.2-1.png" target="_blank"><small>Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p>12</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-5.A.1-3.png" target="_blank"><small>Specific Behavior alert for svchost dumping credentials via the Registry tagged with the correct ATT&CK Technique (Credential Dumping)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-5.A.1-2.png" target="_blank"><small>Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Exfiltration Over Command and Control Channel</b><br><br><i>Exfiltration</i><br><br>(<a href="https://attack.mitre.org/techniques/T1041/">T1041</a>)</td><td>9.B.1</td><td>Cobalt Strike: Download capability exfiltrated data through existing C2 channel</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-9.B.1-20.png" target="_blank"><small>Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-9.B.1-1.png" target="_blank"><small>DNS requests to freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-9.B.1-2.png" target="_blank"><small>Port 53 network traffic to/from freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Registry Run Keys / Startup Folder</b><br><br><i>Persistence</i><br><br>(<a href="https://attack.mitre.org/techniques/T1060/">T1060</a>)</td><td>10.A.1</td><td>Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-10.A.1-1.png" target="_blank"><small>Telemetry from process tree showing cmd.exe executing autoupdate.bat from Startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-10.A.1-2.png" target="_blank"><small>Telemetry showing cmd.exe starting rundll32.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-10.A.1-3.png" target="_blank"><small>Telemetry showing explorer.exe creating cmd.exe and executing .bat from startup </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-10.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe running autoupdate.bat from Startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.A.1-10.png" target="_blank"><small>Parent alert for Injected shellcode into rundll32.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-10.A.1-100.png" target="_blank"><small>Telemetry showing rundll32.exe executing autoupdate.bat from the Startup folder (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-10-5.png" target="_blank"><small>Telemetry showing rundll32.exe executing update.dat (tainted by parent \"RunDLL32 with Suspicious DLL Location\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-10.A.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-10.A.1-1.png" target="_blank"><small>Specific Behavior alert for a batch file automatically being started from the Startup folder.</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.1-1.png" target="_blank"><small>Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.1-2.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.bat from Startup folder</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.1-3.png" target="_blank"><small>Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.1-4.png" target="_blank"><small>Additional details of rundll32.exe telemetry</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-10.A.1-5.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Telemetry</p><p>Telemetry-Tainted</p><p>Specific Behavior-Delayed</p>89</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-10.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.bat then update.dat via rundll32.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-10.A.1-1.png" target="_blank"><small>Telemetry showing Startup folder execution sequence for autoupdate.bat on user logon</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-10.A.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-10-1.png" target="_blank"><small>Telemetry showing the execution of autoupdate.bat from the Startup Folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-10.A.1-3.png" target="_blank"><small>Group ID query showing both autoupdate.bat and updater.dll persistence execution</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-10.A.1-2.png" target="_blank"><small>Telemetry showing execution of autoupdate.bat from the Startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td>1.B.1</td><td>Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.B.1-1.png" target="_blank"><small>Telemetry showing filemods indicating update.bat was written to the Startup folder</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-1.B.1-2.png" target="_blank"><small>Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-1.B.1-1.png" target="_blank"><small>Telemetry showing autoupdate.bat created in Startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.B.1-1.png" target="_blank"><small>Telemetry showing Registry modification related to Startup Folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.B.1-100.png" target="_blank"><small>Process tree showing the cmd.exe associated with the autoupdate.bat file event (tainted by parent alert on explorer.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.B.1-10.png" target="_blank"><small>Telemetry showing rename file event for autoupdate.bat</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-7.png" target="_blank"><small>\"Detected Persistence - Start Folder Persistence\" Specific Behavior alert related to autoupdate.bat (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Start Folder, and Tactic, Persistence; tainted by cmd.exe generating the alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-01-8.png" target="_blank"><small>Telemetry showing autoupdate.bat written to the Start Menu (tainted by parent Malicious File Detection alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-1.B.1-T1060-new.png" target="_blank"><small>Telemetry showing the autoupdate.bat within the Startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.B.1-1.png" target="_blank"><small>Telemetry showing autoupdate.bat file written to the Startup folder</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.B.1-2.png" target="_blank"><small>Enrichment of autoupdate.bat being written to Startup with Persistence category</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.B.1-3.png" target="_blank"><small>Additional details on enrichment of autoupdate.dat</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.B.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Enrichment</p><p>Specific Behavior-Delayed</p>82</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-1.B.1-1.png" target="_blank"><small>Specific Behavior alert for "An exe/bat/lnk/dll file has been copied or renamed in the Windows Startup Folder" for persistence based on pdfhelper.cmd, tagged with the correct ATT&CK Tactic (Persistence) and Technique (Registry Run Keys / Start Folder)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p>60</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.B.1-1.png" target="_blank"><small>Telemetry showing write of autoupdate.bat to startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.B.1-2.png" target="_blank"><small>Enrichment of a file being created in the Startup folder tagged with the correct ATT&CK Technique (Registry Run Keys / Start Folder) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.B.1-1.png" target="_blank"><small>Telemetry showing autoupdate.bat being moved to the user Debbie's Startup folder (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted-Configuration Change</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-01-1.png" target="_blank"><small>Telemetry showing cmd.exe \"rename to executable\" event for autoupdate.bat in Startup folder</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-1.B.1-1.png" target="_blank"><small>Telemetry showing autoupdate.bat write to the Startup folder (tainted by relationship to threat story)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Graphical User Interface</b><br><br><i>Execution</i><br><br>(<a href="https://attack.mitre.org/techniques/T1061/">T1061</a>)</td><td>7.A.1</td><td>Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-7.A.1-3.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-7.A.1-3.png" target="_blank"><small>Telemetry showing mmc.exe process executing lusrmgr.msc (tainted by the parent \"LSA Registry Key modified\" alert) </small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.C.1-4.png" target="_blank"><small>Telemetry showing mmc.exe running lursmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-7.A.1-30.png" target="_blank"><small>Telemetry showing lusrmgr.msc running from mmc.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-07-5.png" target="_blank"><small>Telemetry showing mmc.exe running lursmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-7.A.1-T1061-new.png" target="_blank"><small>Telemetry showing mmc.exe running lursmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-7.A.1-3.png" target="_blank"><small>Telemetry showing mmc.exe spawning lusrmgr.exe </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-7.A.1-2.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-7.A.1-2.png" target="_blank"><small>Telemetry showing mmc.exe running lusrmgr.msc</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.A.1-2.png" target="_blank"><small>Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-7.A.1-1.png" target="_blank"><small>Telemetry showing lusrmgr.msc running from mmc.exe </small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Exfiltration Over Alternative Protocol</b><br><br><i>Exfiltration</i><br><br>(<a href="https://attack.mitre.org/techniques/T1048/">T1048</a>)</td><td>19.C.1</td><td>Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.C.1-2.png" target="_blank"><small>Enrichment of ftp.exe with correct ATT&CK Technique (Exfil Over Alternate Protocol)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.C.1-1.png" target="_blank"><small>Telemetry from process tree showing execution of ftp.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.C.1-1.png" target="_blank"><small>Telemetry showing powershell.exe executing ftp.exe (tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.C.1-2.png" target="_blank"><small>Telemetry showing outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21 (tainted by the parent \"PowerShell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed the collected files being exfiltrated via FTP (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.C.1-1.png" target="_blank"><small>OverWatch General Behavior alert indicating ftp.exe executing with ftp.txt was suspicious (tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior-Delayed-Tainted</p><p>Telemetry</p><p>Specific Behavior-Delayed</p>91</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.C.1-11.png" target="_blank"><small>Enrichment of ftp.exe execution with related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.C.1-10.png" target="_blank"><small>Enrichment of ftp.exe execution in process tree with related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.C.1-13.png" target="_blank"><small>Continuation of enrichment of ftp.exe execution in process tree showing command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.C.1-12.png" target="_blank"><small>Continuation of enrichment of ftp.exe execution showing total number of bytes transmitted</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-2.png" target="_blank"><small>Telemetry showing the ftp.exe with command-line arguments including ftp.txt and subsequent connection to 192.168.0.4 (C2 server) on port 21</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.C.1-1.png" target="_blank"><small>A Specific Behavior alert for the execution of ftp.exe with a command file option by an unusual parent process and could be used for exfiltration</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.C.1-2.png" target="_blank"><small>Telemetry showing ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.C.1-3.png" target="_blank"><small>Enrichment of ftp.exe executing the ftp.txt file with FTP Utility Execution alert (tagged with the correct ATT&CK Software, S0095 - FTP)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.C.1-6.png" target="_blank"><small>Excerpt from the Managed Defense Report showing the writing of FTP command to ftp.txt and the subsequent execution of the ftp.txt file (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.C.1-5.png" target="_blank"><small>Enrichment of TCP port 21 connection to 192.168.0.4 (C2 server) (tagged with correct ATT&CK Technique, T1048 - Exfiltration Over Alternative Protocol and, Tactic, Exfiltration)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.C.1-4.png" target="_blank"><small>Enrichment of ftp.exe executing ftp.exe based on the use of the -s argument with FTP Utility Execution alert</small></a></p></td><td align="center" bgcolor="#31B404"><p>Enrichment</p><p>Enrichment</p><p>Enrichment</p><p>Specific Behavior-Delayed</p>102</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.C.1-2.png" target="_blank"><small>Enrichment of powershell.exe executing ftp.exe with the correct ATT&CK Tactic (Exfiltration) and Technique (Exfiltration over Alternative Protocol) and a suspicious indicator that a connection was made to a remove server via the ftp protocol</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.C.1-1.png" target="_blank"><small>Telemetry showing cmd.exe executing ftp.exe, which made an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21 (tainted by a trace detection on cmd.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment</p>22</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.C.1-2.png" target="_blank"><small>Telemetry showing powreshell.exe running ftp.exe and the subsequent connection to 192.168.0.4 (C2 server) on port 21</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.C.1-1.png" target="_blank"><small>Telemetry showing powreshell.exe running ftp.exe and the subsequent connection to 192.168.0.4 (C2 server) on port 20</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-3.png" target="_blank"><small>Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.C.1-1.png" target="_blank"><small>Telemetry showing ftp.exe execution (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.C.1-3.png" target="_blank"><small>Enrichment of ftp.exe as the execution of a CLI file transfer/copy utility (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.C.1-2.png" target="_blank"><small>Telemetry showing an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21 (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-19-2.png" target="_blank"><small>Telemetry showing the execution ftp.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.C.1-1.png" target="_blank"><small>Telemetry showing the execution of ftp.exe with ftp.txt associated to prior lateral movement threat story by Group ID</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Security Software Discovery</b><br><br><i>Discovery</i><br><br>(<a href="https://attack.mitre.org/techniques/T1063/">T1063</a>)</td><td>12.E.1.10.2</td><td>Empire: WinEnum module included enumeration of firewall rules</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-09.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the Firewall Rules function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.10-1.png" target="_blank"><small>Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p>15</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>12.E.1.10.1</td><td>Empire: WinEnum module included enumeration of AV solutions</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-12-E-08.png" target="_blank"><small>Interactive Shell events showing the WinEnum script and the AV Solution function (does not count as a detection due to manual process of pulling events)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-12.E.1-2.png" target="_blank"><small>Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-12.E.1.10-2.png" target="_blank"><small>Telemetry showing an event log for the WMI query of the system AV products</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-3.png" target="_blank"><small>Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-12.E.1-2.png" target="_blank"><small>Enrichment of powershell.exe with action \"attempted to find other installed security software\" (tainted Group ID not shown but was the search parameter)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p>19</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="1"><b>Data Compressed</b><br><br><i>Exfiltration</i><br><br>(<a href="https://attack.mitre.org/techniques/T1002/">T1002</a>)</td><td>19.B.1</td><td>Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.B.1-2.png" target="_blank"><small>Enrichment of recycler.exe with correct ATT&CK Technique (1002 - Data Compressed)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.B.1-3.png" target="_blank"><small>Process tree with telemetry showing recycler.exe and command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-19.B.1-1.png" target="_blank"><small>Telemetry showing filemod (file modification) creation of old.rar output of recycler.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.B.1-1.png" target="_blank"><small>Enrichment showing recycler.exe creating old.rar (enriched with \"Data Exfiltration Archiving\", tainted by parent \"Powershell executed encoded command\" alerts)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-19.B.1-3.png" target="_blank"><small>Telemetry showing recycler.exe with full command-line (tainted by parent \"Powershell executed encoded commands\" and \"Policy Dropper Behavior\" alerts)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted-Configuration Change</p><p>Telemetry-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.B.1-1.png" target="_blank"><small>Specific Behavior alert on RAR archive written (mapped to correct ATT&CK Technique, Data Compressed, and Tactic, Exfiltration; tainted by previous powershell.exe detection by red line indicating high severity)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-19.B.1-3.png" target="_blank"><small>Additional details of recycler.exe from the alert showing it was signed by win.rar GmbH</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p><p>Specific Behavior-Delayed</p>124</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-19.B.1-10.png" target="_blank"><small>Telemetry showing recycler.exe execution (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-1.png" target="_blank"><small>Enriched event tree showing enrichment of recycler.exe and creation of old.rar output with related ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration) (tainted by Windows Script Executing PowerShell alert, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-19-4.png" target="_blank"><small>Specific Behavior alert for the execution of recycler.exe named \"Exfiltration-Encrypting Files with WinRar\" (tainted by Windows Script Executing PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>73</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.C.1-1.png" target="_blank"><small>General Behavior alert showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.B.1-5.png" target="_blank"><small>Telemetry showing the creation of old.rar as the output of recycler.exe running</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-19.B.1-4.png" target="_blank"><small>Telemetry showing recycler.exe execution</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-2.png" target="_blank"><small>Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-3.png" target="_blank"><small>Enrichment of RAR file write with RAR Archive Created alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-1.png" target="_blank"><small>General Behavior alert for Execution from Suspicious Directory</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-4.png" target="_blank"><small>General Behavior alert for File Write To Root Of Recycle Bin</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.B.1-5.png" target="_blank"><small>Enrichment of RAR file write with RAR Archive Created alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-19.A.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Enrichment</p><p>Enrichment</p><p>General Behavior</p><p>Enrichment</p><p>Specific Behavior-Delayed</p>162</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-2.png" target="_blank"><small>Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-19.A.1-3.png" target="_blank"><small>Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.B.1-1.png" target="_blank"><small>Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-19.A.1-3.png" target="_blank"><small>Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-19.B.1-1.png" target="_blank"><small>Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-19-1.png" target="_blank"><small>Telemetry showing execution of recycler.exe with command-line arguments</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.A.1-2.png" target="_blank"><small>Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-19.B.1-1.png" target="_blank"><small>Telemetry showing the execution of recycler.exe</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="4"><b>Commonly Used Port</b><br><br><i>Command and Control</i><br><br>(<a href="https://attack.mitre.org/techniques/T1043/">T1043</a>)</td><td>6.B.1</td><td>Cobalt Strike: C2 channel modified to use port 80</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-2.png" target="_blank"><small>Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-4.png" target="_blank"><small>Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-6.B.1-1.png" target="_blank"><small>Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by parent \"Sponsor Process Established Network Connection\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-6.C.1-1.png" target="_blank"><small>Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.B.1-20.png" target="_blank"><small>Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-6.B.1-10.png" target="_blank"><small>Enrichment of rundll32.exe making a connection over the \"HTTP Port\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-2.png" target="_blank"><small>Telemetry showing a TCP port 80 connection from rundll32.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-06-7.png" target="_blank"><small>Telemetry showing port 80 traffic (tainted by the parent Malicious File Detection alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-6.B.1-T1043-new.png" target="_blank"><small>Telemetry showing network connections over port 80 to 192.168.0.4 (C2 server)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.B.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-6.B.1-1.png" target="_blank"><small>Telemetry showing port 80 connections to 192.168.0.4 (C2 server)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior-Delayed</p>37</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.B.1-2.png" target="_blank"><small>Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-6.C.1-2.png" target="_blank"><small>Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p><p>Enrichment</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.B.1-1.png" target="_blank"><small>Telemetry showing execution sequence for rundll32.exe opening network connection</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-6.B.1-2.png" target="_blank"><small>Incident graph from \"Unexpected process behavior\" alert (resulting from rundll32.exe) showing tainted network connection</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-6.B.1-1.png" target="_blank"><small>Telemetry showing port 80 command and control traffic</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-06-2.png" target="_blank"><small>Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-6.B.1-1.png" target="_blank"><small>Telemetry showing port 80 connection to 192.168.0.4 (C2 server) (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>1.C.1</td><td>Cobalt Strike: C2 channel established using port 53</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-6.B.1-3.png" target="_blank"><small>Telemetry showing network connection over UDP port 53</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-1.C.1-1.png" target="_blank"><small>OverWatch alert showing suspicious DNS traffic (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-1.C.1-10.png" target="_blank"><small>Telemetry showing port 53 command and control traffic</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.C.1-1.png" target="_blank"><small>Telemetry showing port 53 command and control traffic</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-1.C.1-4.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior-Delayed</p>67</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-1.C.1-1.png" target="_blank"><small>Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.C.1-2.png" target="_blank"><small>Specific Behavior alert for a scripting engine (rundll32.exe) making a network connection over DNS ports (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-1.C.1-1.png" target="_blank"><small>Telemetry showing port 53 command and control traffic (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p>64</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td></tr><tr><td>14.A.1</td><td>Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-14.A.1-3.png" target="_blank"><small>Telemetry showing network connection to 192.168.0.5 (C2 server) over TCP port 8080</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-14.A.1-2.png" target="_blank"><small>Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \"Powershell executed encoded commands\" alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-14.A.1-5.png" target="_blank"><small>Telemetry showing IEX connection over to 192.168.0.5 (C2 server) on TCP port 8080</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-40.png" target="_blank"><small>Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-14.A.1-30.png" target="_blank"><small>Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior-Tainted</p><p>Telemetry</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-14-1.png" target="_blank"><small>Telemetry showing decoded PowerShell with download request of wdbypass over port 8080</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-14-3.png" target="_blank"><small>General Behavior alert for Command and Control associated with network traffic from PowerShell over TCP port 8080</small></a></p></td><td align="center" bgcolor="#40FF00"><p>General Behavior</p><p>Telemetry</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-14.A.1-2.png" target="_blank"><small>Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-14.A.1-4.png" target="_blank"><small>Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-14.A.1-9.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.B.1-4.png" target="_blank"><small>Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-14.A.1-4.png" target="_blank"><small>Telemetry showing a network connection to 192.168.0.5 (C2 server) over TCP port 8080</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-4.png" target="_blank"><small>Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-14.A.1-3.png" target="_blank"><small>Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-14.A.1-4.png" target="_blank"><small>Telemetry showing an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-14-1.png" target="_blank"><small>Telemetry of decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-14-2.png" target="_blank"><small>Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-14.A.1-2.png" target="_blank"><small>Telemetry showing network connections over port 8080 in the filter (tainted by relationship to threat story but Group ID not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>11.B.1</td><td>Empire: C2 channel established using port 443</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-11.A.1-1.png" target="_blank"><small>Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-11.B.1-1.png" target="_blank"><small>Telemetry showing network connections, including over TCP port 443</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment</p><p>Telemetry</p>25</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over TCP port 443</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe making a network connection over port 443 (tainted by parent powershell.exe high severity alert indicated by red icon)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.B.1-100.png" target="_blank"><small>Enrichment of powershell.exe making a connection over a ”HTTP Port," tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.B.1-11.png" target="_blank"><small>Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-11.A.1-13.png" target="_blank"><small>Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted</p><p>Telemetry-Tainted</p>19</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-2.png" target="_blank"><small>Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-3.png" target="_blank"><small>Telemetry showing powershell.exe making connections over port 443 (tainted by parent alert) </small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-5.png" target="_blank"><small>Specific Behavior alert for \"PowerShell Making Network Connections\" (mapped to correct ATT&CK Tactic, Command and Control)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-11-6.png" target="_blank"><small>Event tree view of Specific Behavior alert for \"Command and Control PowerShell Network\"(tainted by parent alert)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior-Tainted</p>64</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-11.A.1-4.png" target="_blank"><small>Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.B.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-11.B.1-4.png" target="_blank"><small>Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>General Behavior-Delayed</p>34</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.A.1-5.png" target="_blank"><small>Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-11.B.1-4.png" target="_blank"><small>Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe) </small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p><p>Enrichment</p>82</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.A.1-9.png" target="_blank"><small>Telemetry showing powershell.exe communicating over TCP port 443</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-11.B.1-4.png" target="_blank"><small>Telemetry within alert showing decoded command-line arguments containing port 443 and tainted relationship to the powershell.exe process</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.A.1-3.png" target="_blank"><small>Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.B.1-1.png" target="_blank"><small>Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-11.B.1-2.png" target="_blank"><small>General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry-Tainted</p><p>Enrichment-Tainted</p><p>General Behavior-Tainted</p>46</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-11-2.png" target="_blank"><small>Telemetry showing network connections, including over port 443 (does not count as a detection)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>None</p>0</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-11.B.1-1.png" target="_blank"><small>Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (Group ID tainted the event but was not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td rowspan="2"><b>Accessibility Features</b><br><br><i>Persistence, Privilege Escalation</i><br><br>(<a href="https://attack.mitre.org/techniques/T1015/">T1015</a>)</td><td>17.C.1</td><td>Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.A.1-2.png" target="_blank"><small>Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-17.C.1-1.png" target="_blank"><small>Telemetry showing creation and file write replacing magnify.exe in the system directory</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-17.C.1-2.png" target="_blank"><small>Telemetry showing copy of cmd.exe to magnify.exe in the system directory (tainted by the parent \"New Windows service created\" alert)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-17.C.1-1.png" target="_blank"><small>Enrichment showing powershell.exe creating and writing magnify.exe (enriched with condition \"Creation of Sticky Keys File\", tainted by the parent \"New Windows service created\" alert)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Enrichment-Tainted-Configuration Change</p><p>Telemetry-Tainted</p>16</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-17.C.1-2.png" target="_blank"><small>Additional view of telemetry showing the magnify.exe file write</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-17.C.1-1.png" target="_blank"><small>Telemetry showing file write of magnify.exe by powershell.exe (tainted by parent powershell.exe high severity alert indicated by red icon)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-17.C.1-10.png" target="_blank"><small>Telemetry showing creation and write events for magnify.exe (tainted by a parent PowerShell alert, listed as Owner process)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-2.png" target="_blank"><small>Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-17-1.png" target="_blank"><small>Specific Behavior alert on overwrite of magnify.exe named \"Persistence-Accessibility Features\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>76</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.B.2-1.png" target="_blank"><small>Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-17.A.1-2.png" target="_blank"><small>Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry</p><p>Enrichment</p>85</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-17.C.1-1.png" target="_blank"><small>Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-17.C.1-3.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-17.C.1-2.png" target="_blank"><small>Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Specific Behavior</p><p>Specific Behavior-Delayed</p>177</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.C.1-1.png" target="_blank"><small>Telemetry showing a file modification event for Magnifier.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-17.A.1-9.png" target="_blank"><small>A General Behavior alert for powershell.exe altering the attributes of an executable file under the Windows system folder</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p>40</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.C.1-1.png" target="_blank"><small>Telemetry showing overwrite of magnify.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.C.1-2.png" target="_blank"><small>Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-17.C.1-3.png" target="_blank"><small>Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.C.1-2.png" target="_blank"><small>Telemetry showing change in the hash of magnify.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-17.C.1-1.png" target="_blank"><small>Telemetry showing file write events overwriting magnify.exe in the system directory (tainted by a parent alert on cmd.exe)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-17-2.png" target="_blank"><small>Magnify.exe hash matches cmd.exe (top two hashes in Tracking pane, file names and full hash values cut off)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-17-1.png" target="_blank"><small>Telemetry showing file write to magnify.exe in the system directory</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-17.C.1-1.png" target="_blank"><small>Telemetry showing file copy and write events of cmd.exe to overwrite magnify.exe with matching hash values (tainted by prior lateral movement threat story; Group ID not shown in this view)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td></tr><tr><td>20.A.1</td><td>magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-20.B.1-2.png" target="_blank"><small>Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe showing red severity scores</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CB-20.B.1-1.png" target="_blank"><small>Telemetry from process tree telemetry showing magnify.exe execution</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p><p>General Behavior</p><p>General Behavior</p>130</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CT-20.B.1-1.png" target="_blank"><small>Telemetry showing magnify.exe (tainted by the parent POS Interactive Login Event alert)</small></a></p></td><td align="center" bgcolor="#FE2E2E"><p>Telemetry-Tainted</p>7</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-E-12.png" target="_blank"><small>Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-20.A.1-2.png" target="_blank"><small>File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CS-20.A.1-1.png" target="_blank"><small>Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry</p><p>General Behavior-Delayed</p>97</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-20.A.1-11.png" target="_blank"><small>Specific Behavior alert for magnify.exe, in process tree, masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CR-20.A.1-10.png" target="_blank"><small>Specific Behavior alert for magnify.exe masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-20-1.png" target="_blank"><small>Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-20-2.png" target="_blank"><small>Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Specific Behavior</p><p>Telemetry-Tainted</p><p>Enrichment-Delayed-Tainted</p>76</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-7.png" target="_blank"><small>Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-4.png" target="_blank"><small>General Behavior alert for magnify.exe executing as a process with a renamed executable</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/CC-20.A.1-3.png" target="_blank"><small>Telemetry showing me magnify.exe executing from utilman.exe</small></a></p></td><td align="center" bgcolor="#40FF00"><p>Telemetry</p><p>General Behavior</p><p>Enrichment</p>55</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-3.png" target="_blank"><small>General Behavior alert for RENAMED CMD.EXE</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-2.png" target="_blank"><small>Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-5.png" target="_blank"><small>Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/FE-20.A.1-4.png" target="_blank"><small>Continued details for General Behavior alert for RENAMED CMD.EXE</small></a></p></td><td align="center" bgcolor="#31B404"><p>General Behavior</p><p>Specific Behavior</p><p>Specific Behavior-Delayed</p>147</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-20.A.1-2.png" target="_blank"><small>Telemetry showing magnify.exe (original name identified as cmd.exe) executing from utilman.exe (tainted by a trace detection on magnify.exe)</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MC-20.A.1-3.png" target="_blank"><small>Specific Behavior alert for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features)</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry-Tainted</p><p>Specific Behavior</p>67</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-20.A.1-1.png" target="_blank"><small>Telemetry showing sequence of magnify.exe executing from utilman.exe</small></a></p><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/MS-20.A.1-4.png" target="_blank"><small>Specific Behavior alert on sticky keys binary hijack of magnify.exe</small></a></p></td><td align="center" bgcolor="#31B404"><p>Telemetry</p><p>Specific Behavior</p>70</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/PA-20.A.1-1.png" target="_blank"><small>Telemetry showing magnify.exe executing from utilman.exe</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/RSA-20-1.png" target="_blank"><small>Telemetry showing magnify.exe execution</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td><td><p><a href="https://d1zq5d3dtjfcoj.cloudfront.net/S1-20.B.1-1.png" target="_blank"><small>Telemetry showing magnify.exe execution (identified as Windows Command Processor)</small></a></p></td><td align="center" bgcolor="#F7FE2E"><p>Telemetry</p>10</td></tr><tr><td align="center" bgcolor="#000000"><font color="#FFFFFF">Technique</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Step</font></td><td align="center" bgcolor="#000000"><font color="#FFFFFF">Procedures</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CarbonBlack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CounterTack</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">CrowdStrike</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Cybereason</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Endgame</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">F-Secure</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">FireEye</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">McAfee</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">Microsoft</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">PaloAltoNetworks</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">RSA</font></td><td align="center" colspan="2" bgcolor="#000000" ><font color="#FFFFFF">SentinelOne</font></td></tr><tr><td colspan="3"><b>TOTAL SCORE</b></td><td align="right" colspan="2"><b>2810</td><td align="right" colspan="2"><b>1173</td><td align="right" colspan="2"><b>4467</td><td align="right" colspan="2"><b>2648</td><td align="right" colspan="2"><b>2971</td><td align="right" colspan="2"><b>4240</td><td align="right" colspan="2"><b>5262</td><td align="right" colspan="2"><b>2913</td><td align="right" colspan="2"><b>2601</td><td align="right" colspan="2"><b>3611</td><td align="right" colspan="2"><b>775</td><td align="right" colspan="2"><b>862</td></tr></table></body></html>