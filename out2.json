{"T1012": {"Steps": {"12.C.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "microsoft reg key in powershell data", "ScreenshotName": "Elastic-APT29-1398.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14500.png"}], "Score": 72}, {"DetectionNote": "A Tactic alert detection (high severity) called for Discovery was generated when the software function was executed.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3183.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3180.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13242.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13241.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 197}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 12.C", "ScreenshotName": "FireEye-APT29-13029.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed scriptblock with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "12.C.1 - Script block for registry query", "ScreenshotName": "FireEye-APT29-11423.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1101.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12287.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed scriptblock with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe calling the software function.", "ScreenshotName": "CrowdStrike-APT29-10605.png"}, {"ScreenshotCaption": "Telemetry showing the powershell script block for the software module.", "ScreenshotName": "CrowdStrike-APT29-10604.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Query Registry\" occurred that containing registry query for installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Query Registry description", "ScreenshotName": "Symantec-APT29-12959.png"}, {"ScreenshotCaption": "MSSP Day 1: Query Registry technique", "ScreenshotName": "Symantec-APT29-12958.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}, {"ScreenshotCaption": "MSSP - reg key queries", "ScreenshotName": "F-Secure-APT29-11311.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "uninstall reg key", "ScreenshotName": "F-Secure-APT29-10289.png"}, {"ScreenshotCaption": "OpenSubKey", "ScreenshotName": "F-Secure-APT29-10287.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence PowerShell checked for installed software by querying the registry. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12221.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-302.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for a script with suspicious content.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14018.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed registry query for installed software. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-492.png"}, {"ScreenshotName": "Microsoft-APT29-493.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell querying the registry.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14755.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13956.png"}, {"ScreenshotName": "Carbon Black-APT29-13958.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for the script block with registry query for installed software. The event was correlated to a previous detection for \"Security Software Discovery.\"", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "scriptblock logging with enrichments containing registry manipulation", "ScreenshotName": "CyCraft-APT29-2440.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Query Registry\" was received that included a PowerShell script and explained that it was used to detect installed software.", "Detect": "MSSP-Delayed (Processing)", "Screenshots": [{"ScreenshotCaption": "12.B.1 - MDR Report Day 2, detectav & software scriptblock", "ScreenshotName": "CyCraft-APT29-12488.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15131.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1012\" occurred containing scriptblock with registry query for installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1/2 - SBL", "ScreenshotName": "SentinelOne-APT29-12856.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - C1 - Powershell alert showing query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "ScreenshotName": "SentinelOne-APT29-7246.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Discovery - PowerShell Querying the Registry Key\" was generated due to the registry query for installed software.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7028.png"}, {"ScreenshotName": "SecureWorks-APT29-10444.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17644.png"}], "Score": 10}], "Step score": 75}}, "12.C.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "microsoft reg key in powershell data", "ScreenshotName": "Elastic-APT29-1398.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14500.png"}], "Score": 72}, {"DetectionNote": "A Tactic alert detection (high severity) for Discovery was generated when the software function was executed.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3183.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3180.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13241.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13242.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed scriptblock with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 197}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 12.C", "ScreenshotName": "FireEye-APT29-13029.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "12.C.2 - Script block for registry query", "ScreenshotName": "FireEye-APT29-11422.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed scriptblock with registry query for installed software.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1101.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12287.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the powershell script block for the software module.", "ScreenshotName": "CrowdStrike-APT29-10604.png"}, {"ScreenshotCaption": "Telemetry showing powershell.exe calling the software function.", "ScreenshotName": "CrowdStrike-APT29-10605.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Query Registry\" occurred that containing registry query for installed software.", "Detect": "MSSP", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Query Registry description", "ScreenshotName": "Symantec-APT29-12959.png"}, {"ScreenshotCaption": "MSSP Day 1: Query Registry technique", "ScreenshotName": "Symantec-APT29-12958.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}, {"ScreenshotCaption": "MSSP - reg key queries", "ScreenshotName": "F-Secure-APT29-11311.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "uninstall reg key", "ScreenshotName": "F-Secure-APT29-10289.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence PowerShell checked for installed software by querying the registry. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12221.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-302.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for a script with suspicious content.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14018.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed registry query for installed software. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-492.png"}, {"ScreenshotName": "Microsoft-APT29-493.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell querying the registry.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14755.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13956.png"}, {"ScreenshotName": "Carbon Black-APT29-13958.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for the scriptblock with registry query for installed software. The event was correlated to a previous detection for \"Security Software Discovery.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "scriptblock logging with enrichments containing registry manipulation", "ScreenshotName": "CyCraft-APT29-2440.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Query Registry\" was received that included a PowerShell script and explained that it was used to detect installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "12.B.1 - MDR Report Day 2, detectav & software scriptblock", "ScreenshotName": "CyCraft-APT29-12488.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15131.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1012\" occurred containing scriptblock with registry query for installed software.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1/2 - SBL", "ScreenshotName": "SentinelOne-APT29-12856.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed scriptblock with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "CC - C2 - powershell alert showing query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "ScreenshotName": "SentinelOne-APT29-7247.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Discovery - PowerShell Querying the Registry Key\" was generated due to the registry query for installed software.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7028.png"}, {"ScreenshotName": "SecureWorks-APT29-10444.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17644.png"}], "Score": 10}], "Step score": 75}}}, "TechniqueName": "Query Registry", "Steps count": 2, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1097": {"Steps": {"20.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) for \"Credential Access via PowerShell Cmdlets\"  was generated for PowerShell executing Invoke-Mimikatz.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "same as above with powershell enrichments", "ScreenshotName": "Elastic-APT29-1623.png"}], "Score": 35}], "Step score": 35}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence of powershell.exe executing Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15752.png"}], "Score": 70}], "Step score": 70}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for a non-standard process loading the Windows credential management library vaultcli.dll.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "20.B.1 - PowerShell loading vaultcli.dll (bottom)", "ScreenshotName": "FireEye-APT29-11685.png"}, {"ScreenshotCaption": "20.B.1 - PowerShell loading vaultcli.dll (top)", "ScreenshotName": "FireEye-APT29-11684.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for Invoke-Mimikatz (kerberos::golden) to create and inject a golden ticket into the current session.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 20.B", "ScreenshotName": "FireEye-APT29-13055.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20.B.1 - Script block for Mimikatz use of kerberos::golden to create a golden ticket", "ScreenshotName": "FireEye-APT29-11701.png"}], "Score": 10}], "Step score": 115}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for the use of a golden ticket. The detection was correlated to a parent alert for powershell.exe executing with suspicious large command line.", "Detect": "Technique-Alert-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1113.png"}, {"ScreenshotName": "Bitdefender-APT29-1111.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) was generated for a credential related module loaded by an unusual process. The detection was correlated to a parent alert for powershell.exe executing with suspicious large command line.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1112.png"}, {"ScreenshotName": "Bitdefender-APT29-1041.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 110}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) called \"Win_Mimikatz_Empire_MITRET1003\" was generated for PowerShell using Empire.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12178.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12322.png"}], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe executing the Invoke-Mimikatz command through PowerShell Command Logging.", "ScreenshotName": "CrowdStrike-APT29-10745.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection was generated for attempted credential theft. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "20.b.1 - malops for powershell and credential theft, command and control", "ScreenshotName": "Cybereason-APT29-9840.png"}, {"ScreenshotCaption": "20b1 - vendor pic - process tree with evidence", "ScreenshotName": "Cybereason-APT29-13712.png"}], "Score": 42}], "Step score": 42}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed WinRM activity as MScott from Scranton (10.0.1.4) to Utica (10.0.1.5) with a Kerberos ticket in memory for MScott on Scranton (10.0.1.4). ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20b1 - multiple telemetry bundled up", "ScreenshotName": "Symantec-APT29-17735.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of use of a suspicious Kerberos ticket.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "successful logon of mscott on scranton & new york with event type 13", "ScreenshotName": "Kaspersky-APT29-3414.png"}, {"ScreenshotCaption": "20.b.1 - kerberos ticket age alert", "ScreenshotName": "Kaspersky-APT29-3413.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for a suspicious PowerShell command.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "1 - invoke mimikatax", "ScreenshotName": "F-Secure-APT29-10524.png"}, {"ScreenshotCaption": "suspicious PS command", "ScreenshotName": "F-Secure-APT29-10522.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of Mimikatz being used to execute a golden ticket attack impersonating mscott.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - invoke mimikatz and toby useradd", "ScreenshotName": "F-Secure-APT29-11323.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "golden ticket invoke mimi", "ScreenshotName": "F-Secure-APT29-10534.png"}], "Score": 10}], "Step score": 115}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for a golden ticket being created and used.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12217.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Suspected Golden Ticket Usage was generated by Azure ATP due to mscott using a weaker encryption method (RC4) in the Kerberos service request.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-550.png"}], "Score": 65}], "Step score": 65}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for a Credential Theft Application Running. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4386.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell running Mimikatz.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4386.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4390.png"}, {"ScreenshotName": "Carbon Black-APT29-4391.png"}], "Score": 17}], "Step score": 157}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called of \"Pass the Ticket\" was generated when the user MScott forged a suspicious Kerberos ticket with the domain krbtgt.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Suspicious ticket forgery with enrichments", "ScreenshotName": "CyCraft-APT29-2495.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) was generated identifying PowerShell executing Invoke-Mimikatz as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Invoke-mimikatz with arguments and enrichments", "ScreenshotName": "CyCraft-APT29-2496.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Pass the Ticket\" was received that described the adversary using Mimikatz to forge a golden ticket.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock", "ScreenshotName": "CyCraft-APT29-12521.png"}, {"ScreenshotCaption": "20.B.1 - MDR Report Day 2, pass the ticket, enter-pssession, account creation", "ScreenshotName": "CyCraft-APT29-12523.png"}], "Score": 70}], "Step score": 170}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred for evidence of pass the ticket.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12734.png"}, {"ScreenshotName": "GoSecure-APT29-12733.png"}, {"ScreenshotName": "GoSecure-APT29-12735.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (Critical severity) was generated for a suspicious process loading Mimikatz with PowerShell.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3973.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3977.png"}], "Score": 10}], "Step score": 45}, "SentinelOne": {"Detects": [{"DetectionNote": "A General alert detection for \"TokenPrivAdd\" under \"Privilege Escalation/Defense Evation {T1134} \" was generated when Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session was executed. The detection was correlated to a parent grouping of malicious activity.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B1 - Token Manipulation alert generated", "ScreenshotName": "SentinelOne-APT29-7011.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"T1097\" occurred containing evidence of  Invoke-Mimikatz (kerberos::golden) usage along with Token Manipulation indicator.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - Invoke + indicator", "ScreenshotName": "SentinelOne-APT29-12893.png"}], "Score": 70}], "Step score": 112}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) was generated for \"Mimikatz Creating Golden Ticket.\"", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7291.png"}, {"ScreenshotName": "SecureWorks-APT29-7290.png"}, {"ScreenshotName": "SecureWorks-APT29-7288.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17657.png"}], "Score": 10}], "Step score": 75}}}, "TechniqueName": "Pass the Ticket", "Steps count": 1, "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}]}, "T1096": {"Steps": {"11.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for \"Suspicious Read from Alternate Data Streams (ADS)\" was generated for powershell.exe accessing an NTFS ADS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "suspicisos read from ADS alert with enrichment expanded. ", "ScreenshotName": "Elastic-APT29-1381.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "showing the get content commandline in powershell", "ScreenshotName": "Elastic-APT29-1354.png"}], "Score": 10}], "Step score": 75}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13234.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3126.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"ADS Code Exec (Methodology)\" was generated due to PowerShell's use of command-line arguments associated with executing alternate data streams.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.A.2 - ADS Code Exec for schemas stream", "ScreenshotName": "FireEye-APT29-11347.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for suspicious usage of PowerShell's Get-Content command.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "11.A - PowerShell Get-Content Command with schemas IEX", "ScreenshotName": "FireEye-APT29-11346.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13020.png"}], "Score": 70}], "Step score": 170}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-801.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "A Technique detection called \"NTFS File Attributes\" was generated due to execution of schemas ADS by powershell.exe.\n", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-2006.png"}], "Score": 53}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1817.png"}], "Score": 10}], "Step score": 63}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (high severity) called \"Fileless Powershell Malware\" was generated due to PowerShell executing a paylaod with IEX and Get-Content.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12053.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe executing schemas ADS via Get-Content and IEX.", "ScreenshotName": "CrowdStrike-APT29-10569.png"}, {"ScreenshotCaption": "Telemetry showing powershell.exe executing schemas ADS via Get-Content and IEX.", "ScreenshotName": "CrowdStrike-APT29-10568.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.2 - commandline, schemas, etc. from process tree", "ScreenshotName": "Cybereason-APT29-9689.png"}, {"ScreenshotCaption": "11.a.1/2 - get-content ", "ScreenshotName": "Cybereason-APT29-9687.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"NTFS File Attributes\"  was received that included the PowerShell command used by the adversary and explained that it was used to retrieve the PowerShell script from the schemas Alternate Data Stream and execute it.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: NTFS File Attributes", "ScreenshotName": "Symantec-APT29-12947.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell.exe obtaining the script from the Alternate Data Stream and executing it.", "ScreenshotName": "Symantec-APT29-9697.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called NTFS File Attributes was generated due to execution of schemas ADS by powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.2 - ps exec schemas ads", "ScreenshotName": "Kaspersky-APT29-3118.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.a.2 - MSSP report #4", "ScreenshotName": "Kaspersky-APT29-12375.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.2 - ps exec schemas ads", "ScreenshotName": "Kaspersky-APT29-3118.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) was generated due to PowerShell running a script from an ADS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-10230.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - lnk being executed with iex/schemas", "ScreenshotName": "F-Secure-APT29-11305.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "thp get-content ", "ScreenshotName": "F-Secure-APT29-10223.png"}], "Score": 10}], "Step score": 145}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"NTFS File Attributes\" was generated due to PowerShell executing the schemas ADS. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12064.png"}, {"ScreenshotName": "TrendMicro-APT29-12062.png"}, {"ScreenshotName": "TrendMicro-APT29-12063.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for PowerShell accessing Alternative Data Streams (ADS) and executing its content. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12049.png"}], "Score": 10}], "Step score": 145}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-286.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for a \"Suspicious Powershell commandline.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-464.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-464.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for the use of PowerShell executing with Invoke-Expression. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4113.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4162.png"}, {"ScreenshotName": "Carbon Black-APT29-4112.png"}], "Score": 10}], "Step score": 45}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) was generated NTFS File Attributes for 2016_UNITED_STATES_PRESEDENTIAL_ELECTION_-_WIKIPEDIA.HTML:SCHEMAS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11a2-vendor submitted screenshot", "ScreenshotName": "CyCraft-APT29-14981.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (blue indicator) was generated identifying powershell.exe executing the schemas ADS with Get-Content and IEX as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "powershell get-content of html file", "ScreenshotName": "CyCraft-APT29-2432.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"NTFS File Attributes\" was received that described a PowerShell script reading another script from the schemas Alternate Data Stream in 2016_United_States_presidential_election_-_Wikipedia.html and executing it via IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 170}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"NTFS File Attributes\" was generated due to PowerShell executing the schemas ADS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Execution with get-content (11a1 and 2)", "ScreenshotName": "MalwareBytes-APT29-2557.png"}], "Score": 3}], "Step score": 3}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (warning severity) called \"Suspicious Powershell Commandline\" was generated for powershell.exe executing the schemas ADS via Get-Content and IEX.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3699.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1096\" occurred containing evidence of powershell.exe executing schemas ADS via Get-Content and IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1/2 - powershell and SBL", "ScreenshotName": "SentinelOne-APT29-12843.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A1/2 - Process tree showing explorer.exe executing  powershell calling Get-Content", "ScreenshotName": "SentinelOne-APT29-6785.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Defense Evasion - NTFS File Attributes\" occurred containing evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13768.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6929.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "NTFS File Attributes", "Steps count": 1, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1099": {"Steps": {"12.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for \"Timestomping\" was generated for the modification of the timestamp of kxwn.lock. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "better timestomp aler - expanded showing API event. ", "ScreenshotName": "Elastic-APT29-1387.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (medium severity) for \"ATT&CK T1099 Timestomp\" was generated for PowerShell calling the NtSetInformationFile API. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "better timestomp aler - expanded showing API event. ", "ScreenshotName": "Elastic-APT29-1387.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed the modification of the timestamp of kxwn.lock, as well as the contents of the timestomp function. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "timestomp function in powershell event", "ScreenshotName": "Elastic-APT29-1391.png"}, {"ScreenshotCaption": "12a2 - timestomp telemetry", "ScreenshotName": "Elastic-APT29-14989.png"}], "Score": 17}], "Step score": 161}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"ioc.Timestomp_T1099\" (high severity) was generated due to PowerShell modifying timestamps on kxwn.lock file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3178.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13688.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed scriptblock with commands to timestomp kxwn.lock.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for file timestamp modification on the kxwn.lock file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 12.A", "ScreenshotName": "FireEye-APT29-13027.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed modification of creation, last access, and last write times of kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "12.A.2 - Modification of timestamp values on kxwn.lock", "ScreenshotName": "FireEye-APT29-11415.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1098.png"}, {"ScreenshotName": "Bitdefender-APT29-1099.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "An MSSP detection for \"Evading Detection\" occurred containing evidence of \"timestomp\" function definition.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12917.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12286.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell executing timestomp to enumerate System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019).", "ScreenshotName": "CrowdStrike-APT29-10598.png"}, {"ScreenshotCaption": "Telemetry showing timestomp script block which enumerates System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019).", "ScreenshotName": "CrowdStrike-APT29-10599.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. However, manually viewing kxwn.lock on the impacted host showed that it had been modified, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "12.a.2 - lock file was created", "ScreenshotName": "Cybereason-APT29-9726.png"}], "Score": 3}], "Step score": 3}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Timestomp\" occurred containing evidence of timestamp modifications of kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp explanations", "ScreenshotName": "Symantec-APT29-12956.png"}, {"ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp techniques", "ScreenshotName": "Symantec-APT29-12955.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe setting the file attributes of kxwn.lock.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe set attributes of kxwn.lock file", "ScreenshotName": "Symantec-APT29-9869.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of timestomping of kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "12.a.2 MSSP report", "ScreenshotName": "Kaspersky-APT29-12388.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Powershell function \"timestomp\" being called to modify the creation time of kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - timestomp", "ScreenshotName": "F-Secure-APT29-11309.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the LastWriteTime of kxwn.lock being accessed. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "timestop being called, and access to LastWriteTime ", "ScreenshotName": "F-Secure-APT29-10264.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Timestomping\" was generated due to time modification of kxwn.lock. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12079.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for evidence of file timestamp manipulation.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12689.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 140}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-295.png"}, {"ScreenshotName": "ReaQta-APT29-298.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for suspicious PowerShell commandline.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14016.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for Timestomping was generated due to time attributes being modified on kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1143.png"}, {"ScreenshotName": "Microsoft-APT29-1144.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a timestamp modification event for kxwn.lock as well as specific time modifications. The activity is correlated to a previous General detection on kxwn.lock.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-489.png"}, {"ScreenshotName": "Microsoft-APT29-490.png"}], "Score": 17}], "Step score": 122}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell modifying filesystem access and write times of the kxwn.lock file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14755.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock as well as the execution of the timestomp function against the kxwn.lock file. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4146.png"}, {"ScreenshotName": "Carbon Black-APT29-4145.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (purple icon) for \"Timestomp\" was generated when the kxwn.lock was created with falsified creation, last access, and last write times.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Creation of .lock file with enrichments", "ScreenshotName": "CyCraft-APT29-2437.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Timestomp\" occured that noted modified timestamp of kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "12.A.1 - MDR Report Day 2, summary and timestomp", "ScreenshotName": "CyCraft-APT29-12485.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred for evidence of file timestamp manipulation.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12736.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the timestomp function being used to modify attributes of kxwn.lock along with the details of the function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3767.png"}, {"ScreenshotName": "HanSight-APT29-3768.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"FileTimeCopied\" was generated due to GetCreationTime API call targeting kxwn.lock. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell parent process", "ScreenshotName": "SentinelOne-APT29-6828.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1099\" occurred containing evidence of timestamp modifications of kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1 - FileEnum + gci SBL", "ScreenshotName": "SentinelOne-APT29-12852.png"}, {"ScreenshotCaption": "MSSP - A2 - FileTime alerts", "ScreenshotName": "SentinelOne-APT29-12853.png"}], "Score": 70}], "Step score": 142}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) called \"FileTimestomped\" was generated due to timestamp modifications of kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7018.png"}, {"ScreenshotName": "SecureWorks-APT29-7019.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Defense Evasion - Timestomp\" occurred containing evidence of the modification of creation, last access, and last write times of kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12643.png"}, {"ScreenshotName": "SecureWorks-APT29-12640.png"}, {"ScreenshotName": "SecureWorks-APT29-12641.png"}, {"ScreenshotName": "SecureWorks-APT29-12639.png"}, {"ScreenshotName": "SecureWorks-APT29-12642.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13769.png"}, {"ScreenshotName": "SecureWorks-APT29-13770.png"}], "Score": 10}], "Step score": 145}}}, "TechniqueName": "Timestomp", "Steps count": 1, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1027": {"Steps": {"3.A.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "powershell -- monkey.png", "ScreenshotName": "Elastic-APT29-14010.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13195.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2757.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2719.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 3.A", "ScreenshotName": "FireEye-APT29-12983.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "3.A.2 - PowerShell extraction and execution on monkey.png", "ScreenshotName": "FireEye-APT29-10933.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique detection called \"PowershellImgObfuscation\" was generated due to a payload being loaded from an image via PowerShell.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-672.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-675.png"}], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Data Obfuscation\" was generated due to the Suspicious Indicator \"Script hidden in bitmap file executed through Powershell...\"", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1963.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1964.png"}], "Score": 17}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11852.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert (high severity) was generated for PowerShell using obfuscation. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "3.b.1 Powershell executing against the obfuscated monkey.png in falcon activity app view", "ScreenshotName": "CrowdStrike-APT29-10259.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "3a2 - new vendor screenshot", "ScreenshotName": "CrowdStrike-APT29-15011.png"}], "Score": 17}], "Step score": 89}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection was generated for a malicious PowerShell process that showed the PowerShell script contained within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "3.a.2 - powershell loaded from monkey. full path from process tree", "ScreenshotName": "Cybereason-APT29-9894.png"}, {"ScreenshotCaption": "3.a.2 - malop for malicious process, powershell ", "ScreenshotName": "Cybereason-APT29-9895.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2, PS in monkey", "ScreenshotName": "Cybereason-APT29-10775.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Cybereason-APT29-9893.png"}], "Score": 17}], "Step score": 129}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection for Obfuscated Files or Information was generated for PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file. Detection incurred a delay based on machine learning processing.", "Detect": "Technique-Alert-Delayed (Processing)-Correlated", "Screenshots": [{"ScreenshotCaption": "tech + delayed + corr", "ScreenshotName": "Symantec-APT29-17553.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"Data Obfuscation\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MEDR Report: Contains the powershell scriptblock log for deobfuscating the powershell script in monkey.png. Human analysis explains the script and use of steganography.", "ScreenshotName": "Symantec-APT29-9908.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "tech + delayed + corr", "ScreenshotName": "Symantec-APT29-17553.png"}], "Score": 17}], "Step score": 159}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red; high severity) for suspicious command-line obfuscation was generated for PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for suspicious PowerShell.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "tree for powershell command", "ScreenshotName": "Kaspersky-APT29-2694.png"}, {"ScreenshotCaption": "powershell decoding script from monkey.png (likely 3.b.2)", "ScreenshotName": "Kaspersky-APT29-2693.png"}, {"ScreenshotCaption": "powershell decoding script from monkey.png (likely 3.b.2)", "ScreenshotName": "Kaspersky-APT29-2693.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection contained evidence of a PowerShell script in monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 3a2", "ScreenshotName": "Kaspersky-APT29-17989.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell decoding script from monkey.png (likely 3.b.2)", "ScreenshotName": "Kaspersky-APT29-2693.png"}], "Score": 10}], "Step score": 152}, "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of a PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14335.png"}, {"ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt1", "ScreenshotName": "F-Secure-APT29-11300.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "script within monkey.png", "ScreenshotName": "F-Secure-APT29-10021.png"}, {"ScreenshotCaption": "new-object moneky.png andthen the script above it ", "ScreenshotName": "F-Secure-APT29-10022.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17557.png"}], "Score": 10}], "Step score": 10}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-56.png"}], "Score": 17}], "Step score": 17}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) for suspicious PowerShell commandline was generated for PowerShell extracting and executing the code embedded within monkey.png. This detection was correlated to a parent General detection of rcs.3aka3.doc being identified as 'patpoopy' backdoor.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13981.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for Defense Evasion occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-386.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting, allocating memory, and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13982.png"}], "Score": 10}], "Step score": 122}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection was generated for the execution of the PowerShell executing a fileless script or command. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3788.png"}, {"ScreenshotName": "Carbon Black-APT29-3790.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3793.png"}], "Score": 17}], "Step score": 59}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (purple indicator) was generated for PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Threat Activity PowerShell scriptblock log creation of monkey.png, but not File Creation of monkey.png", "ScreenshotName": "CyCraft-APT29-2206.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "3.A.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12231.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection for Obfuscated PowerShell occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12705.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10851.png"}], "Score": 10}], "Step score": 80}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Script that decodes monkey.png payload", "ScreenshotName": "MalwareBytes-APT29-2399.png"}], "Score": 17}], "Step score": 17}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3478.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Steganography\" was generated when identifying the PowerShell script contained within monkey.png.  The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - A2 - Steganography Alert Generated", "ScreenshotName": "SentinelOne-APT29-7279.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1027\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A2 - Powershell decoding stego", "ScreenshotName": "SentinelOne-APT29-12802.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A1 - Cleaner view of powershell script generating monkey.png", "ScreenshotName": "SentinelOne-APT29-7278.png"}], "Score": 17}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) was generated for a PowerShell process executing code hidden in images via stenography. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6541.png"}, {"ScreenshotName": "SecureWorks-APT29-6540.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"PowerShell script...that decodes malicious code\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12592.png"}, {"ScreenshotName": "SecureWorks-APT29-12591.png"}, {"ScreenshotName": "SecureWorks-APT29-12588.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13735.png"}], "Score": 10}], "Step score": 145}}, "14.B.5": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection for \"ATT&CK T1027 Obfuscated Files or Information\" was generated for PowerShell executing Set-WmiInstance. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Technique-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "cc - metadata upgrade - new wmi and obfuscated enrichment for put instance. ", "ScreenshotName": "Elastic-APT29-1811.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "b5 script block for set wmiinstance", "ScreenshotName": "Elastic-APT29-1458.png"}], "Score": 17}], "Step score": 77}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13251.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13715.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell Set-WmiInstance writing encoded content to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.B", "ScreenshotName": "FireEye-APT29-13035.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "14.B.5 - Script block for Set-WmiInstance", "ScreenshotName": "FireEye-APT29-11505.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1940.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Win_Powershell_Base64_MITRE1027\" was generated due to PowerShell encoding base64 information.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12082.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content to the WMI class. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing PowerShell executing Set-WmiObject to write encoded content from Win32_AuditCode via the download cradle.", "ScreenshotName": "CrowdStrike-APT29-10653.png"}, {"ScreenshotCaption": "Telemetry showing PowerShell executing Set-WmiObject to write encoded content from Win32_AuditCode.", "ScreenshotName": "CrowdStrike-APT29-10649.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection was generated for Set-WmiInstance (by suspicious process). The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "General-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "14.b.5 - alert for the Set-WmiInstance (cc)", "ScreenshotName": "Cybereason-APT29-9929.png"}], "Score": 35}], "Step score": 35}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "14b5 - telemetry for win_audit code", "ScreenshotName": "Symantec-APT29-17711.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell Set-WmiInstance to write encoded content to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - wc function - no context", "ScreenshotName": "F-Secure-APT29-11314.png"}, {"ScreenshotCaption": "MSSP Summary", "ScreenshotName": "F-Secure-APT29-13276.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "wmiaudit code", "ScreenshotName": "F-Secure-APT29-10359.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12107.png"}], "Score": 10}], "Step score": 10}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. Script preview was truncated so an alternate view was shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-518.png"}, {"ScreenshotName": "Microsoft-APT29-516.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4241.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated showing PowerShell writing encoded content into the WMI class.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "set-wmiinstance with enrichments in graph view", "ScreenshotName": "CyCraft-APT29-2455.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.B.5 - MDR Report Day 2, writing mimikatz output", "ScreenshotName": "CyCraft-APT29-12502.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12715.png"}, {"ScreenshotName": "GoSecure-APT29-12714.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3866.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1027\" occurred containing evidence of \"wmidump\" function definition and WMI indicators writing to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - WMI write audit of code", "ScreenshotName": "SentinelOne-APT29-12871.png"}, {"ScreenshotCaption": "MSSP - WMIDUMP SBL", "ScreenshotName": "SentinelOne-APT29-12872.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B5 - Powershell alert of Set-WmiInstance", "ScreenshotName": "SentinelOne-APT29-7260.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Defense Evasion - Obfuscated Files or Information\" occurred containing evidence of PowerShell Set-WmiInstance to write encoded content to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12658.png"}, {"ScreenshotName": "SecureWorks-APT29-12656.png"}, {"ScreenshotName": "SecureWorks-APT29-12657.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7069.png"}], "Score": 10}], "Step score": 80}}, "17.C.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "17C2 - vendor pic - set-content", "ScreenshotName": "Elastic-APT29-13979.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13259.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13729.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-17857.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell writing the WindowsParentalControlMigration.tmp file to disk with the GIF89a header present in the textAtLowestOffset field.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "17.C.2 - PowerShell File Write for WindowsParentalControlMigration.tmp (top)", "ScreenshotName": "FireEye-APT29-11592.png"}, {"ScreenshotCaption": "17.C.2 - PowerShell File Write for WindowsParentalControlMigration.tmp (bottom)", "ScreenshotName": "FireEye-APT29-11596.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 17.C", "ScreenshotName": "FireEye-APT29-13046.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "17.C.2 - Script block for set-content on header bytes", "ScreenshotName": "FireEye-APT29-11601.png"}], "Score": 10}], "Step score": 115}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1108.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1888.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12152.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing ZipFileWritten event for powershell on WindowsParentalControlMigration. Telemetry showing PowerShell prepending the GIF file header to the compressed file.", "ScreenshotName": "CrowdStrike-APT29-10701.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of PowerShell appending the GIF file header to the compressed file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - set content - c2", "ScreenshotName": "Cybereason-APT29-10808.png"}, {"ScreenshotCaption": "MSSP - function zip - c1", "ScreenshotName": "Cybereason-APT29-10807.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. PowerShell was seen modifying WindowsParentalControlMigration.tmp and increasing the file size by 6 bytes but there is no indication addition is for obfuscation.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "powershell.exe modified tmp file, adding 6 bytes", "ScreenshotName": "Symantec-APT29-9884.png"}], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence that WindowsParentalControlMigration.tmp was a ZIP archive with a gif file header.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "17.c.2 MSSP report #2", "ScreenshotName": "Kaspersky-APT29-12414.png"}, {"ScreenshotCaption": "17.c.2 MSSP report #1", "ScreenshotName": "Kaspersky-APT29-12413.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell appending the GIF file header to the compressed file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - move to B- copy-item", "ScreenshotName": "F-Secure-APT29-11320.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "set-content", "ScreenshotName": "F-Secure-APT29-10453.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of WindowsParentalControlMigration.tmp changing from PKZIP to GIF. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed WindowsParentalControlMigration.tmp filetype changing from PKZIP to GIF.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17567.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-334.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Suspicious Activity was generated containing evidence PowerShell appended bytes from a GIF file header format to WindowsParentalControlMigration.tmp.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1148.png"}, {"ScreenshotName": "Microsoft-APT29-1147.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-541.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4326.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell script, which included PowerShell appending the GIF file header to the compressed file.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "zip scriptblock log with enrichments", "ScreenshotName": "CyCraft-APT29-2481.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence PowerShell was used to add noisy data (GIF89) to an archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "17.B.1 - MDR Report Day 2,staging obfsucation and collection", "ScreenshotName": "CyCraft-APT29-12516.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though file was manually pulled to show the GIF89 header, it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11461.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3937.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection called \"HeaderExtensionMismatch\" was generated due to file header not matching file extension. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - C2 - HeaderExtensionMismatch alert generated", "ScreenshotName": "SentinelOne-APT29-7274.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence that additional bytes were used to disguise a zip as a GIF image format.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - alert, SBL", "ScreenshotName": "SentinelOne-APT29-12885.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "17.C.2 - zip function definition script block", "ScreenshotName": "SentinelOne-APT29-15040.png"}, {"ScreenshotCaption": "17.C.2 - zip function being called", "ScreenshotName": "SentinelOne-APT29-15041.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell appending the GIF file header to the compressed file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13787.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7152.png"}, {"ScreenshotName": "SecureWorks-APT29-7153.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Obfuscated Files or Information", "Steps count": 3, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1036": {"Steps": {"1.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for \"Process with Left-to-Right Encoding Character \" was generated for rcs.3aka3.doc execution.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "cc flex demo new alert after firing - config change new rule logic", "ScreenshotName": "Elastic-APT29-18054.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the file type .doc was an executable, and that the filename included the unicode character for RTLO.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "(use this pic) Malicious file execution (revolver view) showing the file type as executable", "ScreenshotName": "Elastic-APT29-1173.png"}], "Score": 10}], "Step score": 68}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) was generated for rcs.3aka3.doc, identified as a screensaver process, executing from users or temporary folder.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2649.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for Masquerading \"(T1036\u200b)\" occurred containing evidence of of the RLO character to obfuscate payload file name\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13200.png"}], "Score": 70}], "Step score": 135}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"RTL OVERRIDE ATTACK (METHODOLOGY)\" was generated due to rcs.3aka3.doc containing a RTLO character with an MZ header value.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.A.2 - RTL Override alert on rcs.3aka3.doc", "ScreenshotName": "FireEye-APT29-10835.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for Generic.Exploit.Shellcode on rcs.3aka3.doc.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "1.A.2 - Generic Exploit Shellcode on rcs.3aka3.doc", "ScreenshotName": "FireEye-APT29-10832.png"}], "Score": 35}, {"DetectionNote": "A MSSP detection occurred for the RTLO character in rcs.3aka.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 1.A", "ScreenshotName": "FireEye-APT29-12976.png"}], "Score": 70}], "Step score": 170}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"RLOCharacterProcessCreate\" was generated due to a a file being executed with the RTLO character in its name, hiding its extension. ", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1060.png"}, {"ScreenshotName": "Bitdefender-APT29-1062.png"}], "Score": 58}], "Step score": 58}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Masquerading\" was generated due to the Suspicious Indicator \"Executed process with left to right character override.\"", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1962.png"}], "Score": 58}], "Step score": 58}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection  (low severity) called \"Process Without Common Executable Extension\" was generated when an executable file ran without a valid signature created a process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11819.png"}, {"ScreenshotName": "Cylance-APT29-11818.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Process Without Common Executable Extension\" occurred containing evidence of an executable file ran without a valid signature creating a process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12895.png"}], "Score": 70}], "Step score": 135}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Masquerading\" was generated when an executable ran containing a RTLO character.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.A.2 on both write and execution for masquerading", "ScreenshotName": "CrowdStrike-APT29-10177.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an portable executable.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Alert showing explorer.exe executing the rcs.3aka3.doc file.", "ScreenshotName": "CrowdStrike-APT29-10183.png"}, {"ScreenshotCaption": "MSSP Alert for the rcs.3aka3.doc file.", "ScreenshotName": "CrowdStrike-APT29-10188.png"}], "Score": 70}], "Step score": 135}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a payload using the RTLO character to manipulate and obscure the payload's extension.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.a.2 - fill Alert details for the .scr file", "ScreenshotName": "Cybereason-APT29-7328.png"}], "Score": 65}], "Step score": 65}, "Symantec": {"Detects": [{"DetectionNote": "A General detection was generated for \"Suspicious File Detected rcs.3aka3.doc\" due to machine learning identifying the payload as a PE32 executable and analyzing it.", "Detect": "General", "Screenshots": [{"ScreenshotCaption": "1a2 - Suspicious File Detected rcs.3aka3.doc", "ScreenshotName": "Symantec-APT29-17521.png"}], "Score": 30}, {"DetectionNote": "Telemetry showed original filename of cod.3aka.scr and it was a Windows PE file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "In Incident Report, report of a malicious file with the RTL override showing up as unknown Unicode characters.", "ScreenshotName": "Symantec-APT29-9896.png"}, {"ScreenshotCaption": "File details assumed it was PE file, and stated attributes of it.", "ScreenshotName": "Symantec-APT29-9898.png"}], "Score": 10}], "Step score": 40}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called Masquerading was generated due to altered file name by the RTLO character.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Threat hunting views, \"medium alert\" for the technique, \"yellow means medium\"", "ScreenshotName": "Kaspersky-APT29-2631.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of \"Defense Evasion\" contained evidence of RTLO character in rcs.3aka.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 1a2", "ScreenshotName": "Kaspersky-APT29-17986.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the original filename\u200b cod.3aka.scr as well as the RTLO ASCII characters.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Threat hunting views, \"medium alert\" for the technique, \"yellow means medium\"", "ScreenshotName": "Kaspersky-APT29-2631.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred showing the original filename:\u200b cod.3aka.scr.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2/3 - rtlo and network connection ", "ScreenshotName": "F-Secure-APT29-11250.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a process \"?cod.3aka\" with filename \"rcs.3aka.doc\", indicative of masquerading.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "process name is different from full path name", "ScreenshotName": "F-Secure-APT29-9989.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"RTLO.Masquerading T1036\" was generated when an executable ran containing a RTLO character.", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12293.png"}], "Score": 53}, {"DetectionNote": "Telemetry showed the original filename\u200b cod.3aka.scr, which became rcs.3aka.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11813.png"}], "Score": 10}], "Step score": 63}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Masquerading was generated due to Right-to-Left -Override (RLO) technique being observed on rcs.3aka3.doc", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13972.png"}], "Score": 65}], "Step score": 65}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed that the file was a .scr binary, and that the filename included the unicode character for RTLO.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3713.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (purple severity) was generated for rcs.3aka.doc, identified as an EXE.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Identifies the file as an EXE. Level 10 is highest degree of risk. File based alert. (Out of scope)", "ScreenshotName": "CyCraft-APT29-2048.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an EXE.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.A.2 - MDR Executive Summary, rcs.3aka3.doc", "ScreenshotName": "CyCraft-APT29-12471.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection for Masqurading contained evidence that showed the original file name cod.3aka3.scr.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12697.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the original filename cod.3aka.scr.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10819.png"}, {"ScreenshotName": "GoSecure-APT29-10813.png"}], "Score": 10}], "Step score": 80}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Masquerading was generated due to rcs.3aka.doc having a .doc extension but running as an executable.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Technique detection for Masquerading", "ScreenshotName": "MalwareBytes-APT29-2587.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A Technique detection called Masquerading was generated due to the presence of the RTLO character.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3433.png"}], "Score": 60}], "Step score": 60}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Masquerading\" was generated for \"SuspiciousCharInPath\" observed on rcs.3aka.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A.2 - Specifically shows and describes masquerading via a specific character", "ScreenshotName": "SentinelOne-APT29-6463.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for the RTLO character in [?]cod.3aka3.scr was used to masquerade as rcs.3aka.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "A2 - MSSP - Description of LTR override char", "ScreenshotName": "SentinelOne-APT29-12369.png"}], "Score": 70}], "Step score": 135}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Right-to-Left Override\" was generated due a process event with RTLO.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7194.png"}, {"ScreenshotName": "SecureWorks-APT29-7191.png"}, {"ScreenshotName": "SecureWorks-APT29-7193.png"}, {"ScreenshotName": "SecureWorks-APT29-7192.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of the original filename: cod.3aka.scr.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12582.png"}, {"ScreenshotName": "SecureWorks-APT29-12584.png"}, {"ScreenshotName": "SecureWorks-APT29-12782.png"}, {"ScreenshotName": "SecureWorks-APT29-12782.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the right-to-left override character (U+202E) in rcs.3aka.doc and the original filename.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13733.png"}], "Score": 10}], "Step score": 145}}, "6.A.3": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (high severity; red indicator) for \"Malicious File\" was generated for accesschk.exe execution. The event was correlated to a parent General detection for malicious file execution.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "same  accesschk alert, but showing the hash for masquerading", "ScreenshotName": "Elastic-APT29-1255.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "same  accesschk alert, but showing the hash for masquerading", "ScreenshotName": "Elastic-APT29-1255.png"}], "Score": 17}], "Step score": 59}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Windows process masquerading by an unsigned process\" was generated when accesschk.exe was identified as an unsigned executable and the hash did not match the valid accesschk.exe hash. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2944.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13214.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2942.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sysinternals Masquerade\" was generated due to the process accesschk.exe executing without accepting the EULA.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 6.A.3 - Sysinternal Masquerade alert for accesschk.exe", "ScreenshotName": "FireEye-APT29-11728.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 6.A", "ScreenshotName": "FireEye-APT29-12996.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "6.A.3 - PowerShell Child Process for accseschk.exe execution showing hash (bottom)", "ScreenshotName": "FireEye-APT29-11079.png"}, {"ScreenshotCaption": "6.A.3 - PowerShell Child Process for accseschk.exe execution (top)", "ScreenshotName": "FireEye-APT29-11067.png"}], "Score": 10}], "Step score": 138}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary which can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-711.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "A General detection was generated for \"Malicious file(s) reputation report(s)\" on accesschk.exe.", "Detect": "General-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1631.png"}], "Score": 30}, {"DetectionNote": "Telemetry showed the hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-14603.png"}], "Score": 10}], "Step score": 40}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash value provided. This can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11929.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "A General detection called \"HashPupAdwareCrowdStrikeSha256\" was generated when accesschk.exe matched known malicious payload hashes. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detect": "General-Correlated", "Screenshots": [{"ScreenshotCaption": "Technique detection showing  showing accesschk.exe matching HashPupAdwareCrowdStrikeSha256 event.", "ScreenshotName": "CrowdStrike-APT29-10366.png"}], "Score": 37}], "Step score": 37}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for accesschk.exe being an unsigned file with a known signed version. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "generic alert for unsigned file with a known signed version", "ScreenshotName": "Cybereason-APT29-9615.png"}], "Score": 42}], "Step score": 42}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection was generated for \"Potential risk found\" on accesschk.exe receiving a reputation report that indicated it was known to be an untrusted file with the maximum suspicion rating, which indicates it is not a legitimate Sysinternals tool.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "hid_level 500 showing that accesschk.exe is very suspicious. Essentially a score, which triggers can be based on.", "ScreenshotName": "Symantec-APT29-7437.png"}, {"ScreenshotCaption": "Reputation request for accesschck.exe showing low reputation, indicative of not being the correct file", "ScreenshotName": "Symantec-APT29-7436.png"}, {"ScreenshotCaption": "context for accesschck.exe", "ScreenshotName": "Symantec-APT29-7438.png"}], "Score": 35}], "Step score": 35}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence showing accesschk.exe is not the legitimate Sysinternals tool.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 6a3", "ScreenshotName": "Kaspersky-APT29-17997.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2804.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated identifying accesschk.exe as potentially unwanted application (PUA). This indicates that the file is not the legitimate Sysinternals tool.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "bad bad file kibana pua for accesschk", "ScreenshotName": "F-Secure-APT29-10077.png"}], "Score": 35}], "Step score": 35}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection (suspicious severity) called \"Low global prevalence without signer\" was generated for accesscheck.exe, indicating it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11909.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred for accesschk.exe not being the legitimate Sysinternals tool due to a low census prevalence and the binary was unsigned.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed that accesschk.exe received a reputation report that indicated it was known to be an untrusted file with the maximum suspicion rating, which indicates it is not a legitimate Sysinternals tool. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11909.png"}], "Score": 17}], "Step score": 129}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-100.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection was generated for accesschk.exe being detected as \"Hacktool:Win32/ChromePassRecovery.A.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-405.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed hash of accesschk.exe, which can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-405.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for a \"PUP or Potentially Unwanted Program (PUP: ChromePassRecovery)\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3976.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3975.png"}], "Score": 10}], "Step score": 45}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Masquerading\" was received that included an execution event for accesschk.exe and explained that the file was masquerading as a legitimate SysInternals tool. Additional data was received that included details of the file accesscheck.exe such as the hash, company name, and signer. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "6.A.3 - MDR Executive Summary, accesscheck.exe", "ScreenshotName": "CyCraft-APT29-12472.png"}, {"ScreenshotCaption": "6.A.1 - MDR Report Day 1, accesschk.exe", "ScreenshotName": "CyCraft-APT29-12444.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10956.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed hash of accesschk.exe, which can be used to verify it is not the legitimate Sysinternals tool. The event was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "accesschk.exe running with hash (6a3)", "ScreenshotName": "MalwareBytes-APT29-2536.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed hash of accesschk.exe, which can be used to verify it is not the legitimate Sysinternals tool.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3557.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1036\" occurred containing evidence of accesschk.exe with an MD5 value which was also found publicly and is known to be malicious.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1/3 - asscesschk.exe usage and alerts", "ScreenshotName": "SentinelOne-APT29-12822.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash value provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A3 - Shows Sysinternals is not signed", "ScreenshotName": "SentinelOne-APT29-6562.png"}, {"ScreenshotCaption": "Showing hash value of Sysinternals", "ScreenshotName": "SentinelOne-APT29-6569.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for Masquerading occurred containing evidence that accesschk.exe is not the legitimate Sysinternals tool.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12606.png"}, {"ScreenshotName": "SecureWorks-APT29-12605.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed that accesschk.exe is not the legitimate Sysinternals tool by comparing the hashes.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6642.png"}, {"ScreenshotName": "SecureWorks-APT29-6643.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Masquerading", "Steps count": 2, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1035": {"Steps": {"8.C.3": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1035 Service Execution\" for PsExec64.exe calling the CreateServiceW API. The detection was correlated to a parent alert for malicious file execution.\t", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "service executed tag for psexec64 - 8.c.3 technique alert", "ScreenshotName": "Elastic-APT29-1307.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (low severity) for \"Service Creation/Modification\" was generated due to PsExec64.exe creating the psexesvc.exe service.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "service created/executed alert for psexec64  - 8.c.3 technique", "ScreenshotName": "Elastic-APT29-1308.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PSEXESVC.exe executing python.exe. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\". ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "python executed better view - 8.c.3", "ScreenshotName": "Elastic-APT29-1310.png"}], "Score": 17}], "Step score": 161}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Service Execution Start service T1050\" was generated due to psexec.exe spawning python.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3023.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (low severity) was generated due to an unsigned process running from a temporary directory.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3025.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) for \"Lateral Movement\" was generated due to PSEXE64.exe execution with plain-text credentials from Nashua as the user Pam. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3016.png"}], "Score": 42}, {"DetectionNote": "A General alert detection was generated for PSEXESVC.exe being copied to a remote host. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3016.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13225.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe and originated from a RPC call originating on the remote host Nashua (10.0.1.6).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3025.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13658.png"}], "Score": 10}], "Step score": 264}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PsExec Execution\" was generated due to PSEXESVC.exe spawning the child process python.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "8.C.3 - PSEXESVC.exe executing python.exe", "ScreenshotName": "FireEye-APT29-11196.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.C", "ScreenshotName": "FireEye-APT29-13008.png"}, {"ScreenshotCaption": "MSSP - 8.C", "ScreenshotName": "FireEye-APT29-13013.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection called \"PSExecLateralMovement\" was generated for unusual markers of PSExec being used for lateral movement.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-765.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PSEXESVC.exe with command-line arguments to execute python.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-766.png"}, {"ScreenshotName": "Bitdefender-APT29-761.png"}], "Score": 17}], "Step score": 52}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1750.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11981.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique detection for \"ServiceExecOnSMBFile\" was generated due to PsExec running a python.exe remotely. ", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "8c3 - new vendor screenshot", "ScreenshotName": "CrowdStrike-APT29-15006.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed python.exe spawned from PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing python.exe spawned by PSEXESVC.exe.", "ScreenshotName": "CrowdStrike-APT29-10474.png"}], "Score": 10}], "Step score": 70}, "Cybereason": {"Detects": [{"DetectionNote": "A Tactic alert detection (red icon) called \"ATT&CK: Execution\" was generated due to PSEXESVC.exe attempting to execute a malicious file. The detection was correlated to a parent alert for malicious PowerShell. ", "Detect": "Tactic-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "8.c.3 - process details with the suspicious ", "ScreenshotName": "Cybereason-APT29-9648.png"}, {"ScreenshotCaption": "8.c.3 - full proces tree with suspicious for python.exe info", "ScreenshotName": "Cybereason-APT29-9647.png"}], "Score": 52}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe. The detection was correlated to a parent alert for malicious PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "8.c.3 - full proces tree with suspicious for python.exe info", "ScreenshotName": "Cybereason-APT29-9647.png"}], "Score": 17}], "Step score": 69}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection for \"PsExec interacted with services - SONAR.PsExeSvc!gen1\" was generated on PsExecSvc targeting python.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "PSExec executing python.exe on scranton", "ScreenshotName": "Symantec-APT29-7458.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Service Execution\" occurred containing evidence of PSEXECSVC.exe executing python.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: PSExec for lateral movement", "ScreenshotName": "Symantec-APT29-12942.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PSEXECSVC.exe executing python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "python.exe running as pam, and psexec64.exe running as pam with command line arguments", "ScreenshotName": "Symantec-APT29-7466.png"}], "Score": 10}], "Step score": 145}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the execution of psexecsvc.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Report Page 3 - Step 8", "ScreenshotName": "Kaspersky-APT29-11796.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PSEXESVC.exe with command-line arguments to execute python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8C3 - vendor provided screenshot, use this", "ScreenshotName": "Kaspersky-APT29-13410.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Executed python.exe using PSExec", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for \"Service Execution\" was generated due to PsExec running a process remotely. The event was correlated to parent alert for Abnormal File Modification.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "with att&ck ids", "ScreenshotName": "F-Secure-APT29-10135.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of PSEXESVC.exe executing python.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}, {"ScreenshotCaption": "MSSP - command line arg for lateral movement via psexec", "ScreenshotName": "F-Secure-APT29-11295.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "psexec executing python", "ScreenshotName": "F-Secure-APT29-10134.png"}], "Score": 10}], "Step score": 152}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"Service Execution\" was generated due to PSEXESVC.exe executing python.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11986.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11989.png"}], "Score": 10}], "Step score": 75}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-142.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PSEXESVC.exe creating process python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-438.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"T1035 & T1077 - Service Execution - psexec - target\" was generated due to a process running remotely with PsExec.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4055.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4055.png"}], "Score": 10}], "Step score": 75}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Service Execution\" was generated for the execution of python.exe by PSEXECSVC.exe on host Scranton (10.0.1.4) as SYSTEM.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "PSExecSvc executing python.exe on Scranton as SYSTEM", "ScreenshotName": "CyCraft-APT29-2255.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Service Execution\" occurred containing evidence of PSEXESVC.exe executing python.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "8.C.3 - MDR Report Day 1, PSEXECSVC.exe execution", "ScreenshotName": "CyCraft-APT29-12457.png"}, {"ScreenshotCaption": "8.C.3 - MDR Report Day 1, PSExec description", "ScreenshotName": "CyCraft-APT29-12456.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "A Tactic detection was generated due to PsExec tool detected process created labeled \"Lateral Movement with Remote Execution.\" The event was correlated to a parent detection for \"Bypass User Account Control\".", "Detect": "Tactic-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11052.png"}], "Score": 47}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe. The event was correlated to a parent General detection for a suspicious process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11052.png"}, {"ScreenshotName": "GoSecure-APT29-11049.png"}], "Score": 17}], "Step score": 64}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PSEXESVC.exe executing python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3642.png"}, {"ScreenshotName": "HanSight-APT29-3643.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated due to PSEXESVC.exe executing python.exe.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "8.C.3 - Execution of python.exe from PSEXESVC.exe", "ScreenshotName": "SentinelOne-APT29-14734.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"T1035\" occurred containing evidence of PsExec executing python.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C2/3 -network info + psexec + admin share access", "ScreenshotName": "SentinelOne-APT29-12835.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "C3 - PSEXECSVC being spawned from python.exe", "ScreenshotName": "SentinelOne-APT29-6727.png"}], "Score": 10}], "Step score": 125}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for Lateral Movement showed python.exe spawned by PSEXESVC.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13755.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6781.png"}, {"ScreenshotName": "SecureWorks-APT29-6780.png"}], "Score": 10}], "Step score": 80}}, "10.A.1": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of javamtsup.exe spawning from services.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "10.a.1 mssp report #2", "ScreenshotName": "Kaspersky-APT29-12574.png"}, {"ScreenshotCaption": "10.a.1 mssp report #1", "ScreenshotName": "Kaspersky-APT29-12573.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed javamtsup.exe with parent process services.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2982.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Executed persistent service (javamtsup) on system startup", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for services.exe accessing javamtsup.exe. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12682.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed  javamtsup.exe with parent process services.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12251.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed javamtsup.exe with the parent process services.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-159.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed rundll32.exe with a parent process of javamtsup.exe (identified as being spawned from services.exe).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4101.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Service Execution\" was generated when services.exe spawned javamtsup.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "javamtsup execution by services.exe, with enrichments. ", "ScreenshotName": "CyCraft-APT29-2267.png"}], "Score": 65}], "Step score": 65}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated when services.exe executed javamtsup.exe.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "10.A.1 - Execution of javamtsup.exe by services.exe", "ScreenshotName": "SentinelOne-APT29-14736.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"T1035\" occurred containing evidence of javamtsup.exe with parent process services.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1 - process tree", "ScreenshotName": "SentinelOne-APT29-12841.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed javamtsup.exe with parent process services.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A1 - javamtsup.exe with parent process services.exe via process tree flow", "ScreenshotName": "SentinelOne-APT29-6770.png"}], "Score": 10}], "Step score": 125}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed the javamtsup.exe processes executing as a persistent service.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13762.png"}, {"ScreenshotName": "SecureWorks-APT29-13761.png"}], "Score": 10}], "Step score": 10}}}, "TechniqueName": "Service Execution", "Steps count": 2, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}]}, "T1033": {"Steps": {"13.C.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "script block of getusernameex", "ScreenshotName": "Elastic-APT29-1418.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "13.C.1 - Script block for GetUserNameEx API", "ScreenshotName": "FireEye-APT29-11433.png"}], "Score": 10}], "Step score": 10}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1936.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block log function definition of \"user\" containing the GetUserNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12291.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showed the powershell script block calling the GetUserNameEx API.", "ScreenshotName": "CrowdStrike-APT29-10616.png"}, {"ScreenshotCaption": "Telemetry showed powershell.exe calling the user function.", "ScreenshotName": "CrowdStrike-APT29-10613.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for a PowerShell process occurred containing evidence of the GetUserNameEx API call.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - API call", "ScreenshotName": "Cybereason-APT29-10793.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to obtain the username.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery techniques", "ScreenshotName": "Symantec-APT29-12960.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery script details", "ScreenshotName": "Symantec-APT29-12961.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing the GetUserNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "13.c.1 MSSP report #1", "ScreenshotName": "Kaspersky-APT29-12393.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated the current username using the GetUserNameEx API", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the GetUserNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 13a/b/c/d - function imports ", "ScreenshotName": "F-Secure-APT29-11312.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the GetUserNameEx API call. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "API calls", "ScreenshotName": "F-Secure-APT29-10303.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Score": 3}], "Step score": 3}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-308.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed executed PowerShell script block with GetUserNameEx. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14021.png"}, {"ScreenshotName": "Microsoft-APT29-14020.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4189.png"}, {"ScreenshotName": "Carbon Black-APT29-4182.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection was generated for powershell.exe executing the script which contained GetUserNameEx API function. The event was correlated to a parent Technique detection for PowerShell.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "GetUserNameEx with enrichments", "ScreenshotName": "CyCraft-APT29-2443.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used enumerate users.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "13.A.1 - MDR Report Day 2, summary and GetComputerNameEx", "ScreenshotName": "CyCraft-APT29-12489.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the execution of the GetUserNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12713.png"}, {"ScreenshotName": "GoSecure-APT29-12712.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3775.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block log with function definition of \"user\" which calls GetUserNameEx API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Configuration Change (UX)-Correlated", "Screenshots": [{"ScreenshotCaption": "CC - C1 - Powershell alert of GetUserNameEx API being used", "ScreenshotName": "SentinelOne-APT29-7250.png"}], "Score": 10}], "Step score": 10}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection  occurred containing evidence of PowerShell calling the GetUserNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13771.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetUserNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7036.png"}], "Score": 10}], "Step score": 80}}, "15.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "script block of username", "ScreenshotName": "Elastic-APT29-1484.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing $env:UserName.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13248.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13254.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3400.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell executing $env:UserName.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 15.A", "ScreenshotName": "FireEye-APT29-13037.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "15.A.1 - Script block for PowerShell executing $env:UserName", "ScreenshotName": "FireEye-APT29-11510.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1949.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12304.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing wmi script block which executes $env:Username.", "ScreenshotName": "CrowdStrike-APT29-10656.png"}, {"ScreenshotCaption": "Telemetry showing powershell.exe executing wmi function.", "ScreenshotName": "CrowdStrike-APT29-10657.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated logged on users using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing $env:UserName.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-10669.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12119.png"}], "Score": 10}], "Step score": 10}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-320.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-520.png"}, {"ScreenshotName": "Microsoft-APT29-522.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4258.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated when powershell.exe ran the script, which obtained the name of the current user. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "env username with enrichments", "ScreenshotName": "CyCraft-APT29-2457.png"}], "Score": 35}], "Step score": 35}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15132.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A1 - Powershell alert of wmi function definition which shows  $env:Username reference ", "ScreenshotName": "SentinelOne-APT29-7262.png"}], "Score": 10}], "Step score": 10}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Discovery - System Owner/User Discovery\" occurred containing evidence of PowerShell $env:UserName.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12659.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13777.png"}, {"ScreenshotName": "SecureWorks-APT29-13776.png"}], "Score": 10}], "Step score": 80}}, "4.C.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c1-3 script block", "ScreenshotName": "Elastic-APT29-1229.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:USERNAME.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.2 - Script block for $env:USERNAME", "ScreenshotName": "FireEye-APT29-11016.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using $env:USERNAME.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}, {"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Discovery - System Owner/User Discovery\" occurred containing evidence of PowerShell executing: $env:USERNAME.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - c2 invoke discovery Username", "ScreenshotName": "Cybereason-APT29-10799.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection for \"System Owner/User Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the User Name.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}, {"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated the current username using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "invoke-discovery", "ScreenshotName": "F-Secure-APT29-10062.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions. Details showing a PowerShell command containing $env:USERNAME were verified.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERNAME. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERNAME. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13988.png"}, {"ScreenshotName": "Microsoft-APT29-581.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current user name.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3532.png"}, {"ScreenshotName": "HanSight-APT29-3543.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $env:USERNAME usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1-5 - readme.ps1", "ScreenshotName": "SentinelOne-APT29-12815.png"}], "Score": 70}], "Step score": 70}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - System Owner/User Discovery\" occurred containing evidence of powershell.exe executing: $env:USERNAME.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe executing: $env:USERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6628.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 80}}, "16.B.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "convertsidtostringsid script block", "ScreenshotName": "Elastic-APT29-1506.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13255.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3390.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing the ConvertSidToStringSid API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 16.B", "ScreenshotName": "FireEye-APT29-13039.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "16.B.1 - Script block for the ConvertSidToStringSid API", "ScreenshotName": "FireEye-APT29-11544.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1107.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1953.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_Domain_SidToUser_MITRET1082\" was generated when PowerShell accessed SID. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12135.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll in order to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry-Configuration Change (UX)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12340.png"}, {"ScreenshotName": "Cylance-APT29-12339.png"}], "Score": 3}], "Step score": 68}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing ConvertSidToStringSid script block which calls ConvertSidToStringSid API.", "ScreenshotName": "CrowdStrike-APT29-10666.png"}, {"ScreenshotCaption": "Telemetry showing powershell.exe executing siduser function (which calls ConvertSidToStringSid function).", "ScreenshotName": "CrowdStrike-APT29-10667.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for Account Discovery occurred containing evidence of the ConvertSidToStringSid API call.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - api call", "ScreenshotName": "Cybereason-APT29-10802.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "function API names being called", "ScreenshotName": "F-Secure-APT29-10401.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing siduser.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12267.png"}], "Score": 3}], "Step score": 73}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-326.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for a script with suspicious content being observed.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-527.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17402.png"}, {"ScreenshotName": "Microsoft-APT29-526.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4293.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) for threat activity was generated for PowerShell executing the ConvertSidToStringSid API function.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: ConvertSidToString", "ScreenshotName": "CyCraft-APT29-2357.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the domain SID from the current user's SID.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.A.1 - MDR Report Day 2, summary & Get-NetDomainController", "ScreenshotName": "CyCraft-APT29-12506.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the execution of the ConvertSidToStringSid API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12726.png"}, {"ScreenshotName": "GoSecure-APT29-12725.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3894.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1033\" occurred containing evidence of ConvertSidToStringSid API usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - ConvertSidToStringSid, Advapi32.dll", "ScreenshotName": "SentinelOne-APT29-12877.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Configuration Change (UX)-Correlated", "Screenshots": [{"ScreenshotCaption": "CC - B1/2 - Powershell alert of ConvertSidToStringSid being used in script", "ScreenshotName": "SentinelOne-APT29-7264.png"}, {"ScreenshotCaption": "CC - B1/2 - powershell alert of siduser function definition ", "ScreenshotName": "SentinelOne-APT29-7265.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Discovery - System Owner/User Discovery\" occurred containing evidence of PowerShell reflectively loading Advapi32.dll and executing APIs to identify the current user's SID.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13781.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7114.png"}, {"ScreenshotName": "SecureWorks-APT29-7155.png"}, {"ScreenshotName": "SecureWorks-APT29-7112.png"}], "Score": 10}], "Step score": 80}}, "11.A.6": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "alert for multiple wmi discovery techniques", "ScreenshotName": "Elastic-APT29-1364.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "win32 computersystem wmi event", "ScreenshotName": "Elastic-APT29-1361.png"}], "Score": 10}], "Step score": 55}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13687.png"}], "Score": 10}], "Step score": 125}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13024.png"}, {"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A - gwmi query for Win32_ComputerSystem", "ScreenshotName": "FireEye-APT29-11389.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for the execution of a WMI system discovery command.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-811.png"}, {"ScreenshotName": "Bitdefender-APT29-809.png"}, {"ScreenshotName": "Bitdefender-APT29-798.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) for a suspicious WMI query operation was generated for a WMI operation via PowerShell.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12054.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 55}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system owner.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery Techniques", "ScreenshotName": "Symantec-APT29-12948.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery description", "ScreenshotName": "Symantec-APT29-12949.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a5-7", "ScreenshotName": "Kaspersky-APT29-18010.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process", "ScreenshotName": "F-Secure-APT29-11306.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a3-8 - thp - wmi stuff", "ScreenshotName": "F-Secure-APT29-10234.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_ComputerSystem. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-289.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to obtain system information: gwmi -namespace root\\cimv2 -query 'Select * from Win32_ComputerSystem'.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1141.png"}, {"ScreenshotName": "Microsoft-APT29-1140.png"}, {"ScreenshotName": "Microsoft-APT29-1139.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-469.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4165.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell wmi query of computersystem with enrichments", "ScreenshotName": "CyCraft-APT29-2421.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.4 - MDR Report Day 2, Win32_computersystem", "ScreenshotName": "CyCraft-APT29-12476.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.\n", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (warning severity) called \"Get System Information\" was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4210.png"}], "Score": 28}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3721.png"}], "Score": 10}], "Step score": 38}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection for \"Discovery\" was generated on a suspicious WMI query targeting Win32_ComputerSystem.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "A4/6/7 - WMI win32_computer system", "ScreenshotName": "SentinelOne-APT29-6793.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of WMI query targeting Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration", "ScreenshotName": "SentinelOne-APT29-12845.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A.7 - WMIOperation for Win32_ComputerSystem", "ScreenshotName": "SentinelOne-APT29-17530.png"}], "Score": 10}], "Step score": 125}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"WMI Queries Win32_ComputerSystem\" was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6944.png"}, {"ScreenshotName": "SecureWorks-APT29-6945.png"}, {"ScreenshotName": "SecureWorks-APT29-6943.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Discovery - System Owner/User Discovery\" occurred for the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13768.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17612.png"}, {"ScreenshotName": "SecureWorks-APT29-17611.png"}], "Score": 10}], "Step score": 145}}}, "TechniqueName": "System Owner/User Discovery", "Steps count": 5, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1032": {"Steps": {"11.A.15": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making an network connection to C2 (192.168.0.4) over port 443, which was identified as using the SSL protocol.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1097.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "An MSSP alert showed outbound connection with Cryptographic API calls to C2 server.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "An MSSP alert showing outbound connection with Cryptographic API calls to c2 server.", "ScreenshotName": "CrowdStrike-APT29-10579.png"}], "Score": 70}], "Step score": 70}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Standard Application Layer Protocol\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: stager script explanation", "ScreenshotName": "Symantec-APT29-12954.png"}, {"ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques", "ScreenshotName": "Symantec-APT29-12953.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)", "ScreenshotName": "Symantec-APT29-9867.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14657.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Standard Cryptographic Protocol\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12075.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for the network connection over HTTPS. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}], "Score": 70}], "Step score": 130}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13955.png"}], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.\t", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1032\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A13/14/15 - network information", "ScreenshotName": "SentinelOne-APT29-12849.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection", "ScreenshotName": "SentinelOne-APT29-6810.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "3.B.5": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS.", "Detect": "None-Residual Artifact", "Screenshots": [{"ScreenshotCaption": "3.B - Parsing strings in process memory for HTTPS reference", "ScreenshotName": "FireEye-APT29-10929.png"}], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed a SSL connection to to 192.168.0.5 on port 443.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1086.png"}, {"ScreenshotName": "Bitdefender-APT29-1088.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.", "ScreenshotName": "Symantec-APT29-7402.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.", "ScreenshotName": "Symantec-APT29-7402.png"}], "Score": 10}], "Step score": 45}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell process exchanging data over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-15101.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Standard Application Layer Protocol\" was generated due to the PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11866.png"}], "Score": 60}], "Step score": 60}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Command and Control was generated containing evidence Meterpreter communications are being sent using HTTPS, due to the presence of the WINHTTP_FLAG_SECURE within the embedded shell code.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13989.png"}, {"ScreenshotName": "Microsoft-APT29-579.png"}], "Score": 70}], "Step score": 70}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13938.png"}, {"ScreenshotName": "Carbon Black-APT29-3825.png"}], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1032\" occurred containing evidence of the PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B3/4/5 - port information", "ScreenshotName": "SentinelOne-APT29-12807.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B3/4/5 - Network connection, powershell exchanging data with host over https", "ScreenshotName": "SentinelOne-APT29-6515.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "1.A.4": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "1A4 - new pic - EG client DLLs", "ScreenshotName": "Elastic-APT29-14343.png"}], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2656.png"}], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the rcs.3aka3.doc process using rc4 encryption for network communication.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 1.A", "ScreenshotName": "FireEye-APT29-12976.png"}], "Score": 70}, {"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "CC - 1.A.4 - Cryptographic Library Load (top)", "ScreenshotName": "FireEye-APT29-11720.png"}, {"ScreenshotCaption": "1.A.4 - rcs.3aka3.doc loading bcrypt.dll, crypt32.dll, cryptbase.dll", "ScreenshotName": "FireEye-APT29-11707.png"}], "Score": 0}], "Step score": 70}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "1a4- new vendor screenshot", "ScreenshotName": "CrowdStrike-APT29-15010.png"}], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "1.a.4 - process details showing rc4 encryption", "ScreenshotName": "Cybereason-APT29-7335.png"}, {"ScreenshotCaption": "1.a.3 - process details showing the network connection over port 1234", "ScreenshotName": "Cybereason-APT29-7334.png"}], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17345.png"}], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3718.png"}], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "A.4 - Shows that a cryptographic protocol was used", "ScreenshotName": "SentinelOne-APT29-6469.png"}, {"ScreenshotCaption": "A.4 - Specifically shows the library that was alerted on", "ScreenshotName": "SentinelOne-APT29-6470.png"}], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Standard Cryptographic Protocol", "Steps count": 3, "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}]}, "T1016": {"Steps": {"4.C.4": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c4-6 script block event (same as above)", "ScreenshotName": "Elastic-APT29-1230.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:USERDOMAIN.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERDOMAIN.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.4 - Script block for $env:USERDOMAIN", "ScreenshotName": "FireEye-APT29-11018.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using $env:USERDOMAIN.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}, {"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the user's domain name.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}, {"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated the current domain name using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "invoke-discovery", "ScreenshotName": "F-Secure-APT29-10062.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERDOMAIN. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERDOMAIN. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-581.png"}, {"ScreenshotName": "Microsoft-APT29-13988.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current environment information.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3543.png"}, {"ScreenshotName": "HanSight-APT29-3532.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $env:USERDOMAIN usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1-5 - readme.ps1", "ScreenshotName": "SentinelOne-APT29-12815.png"}], "Score": 70}], "Step score": 70}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - System System Network Configuration Discovery\" occurred containing evidence of powershell.exe executing: $env:USERDOMAIN.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe executing: $env:USERDOMAIN.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6628.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 80}}, "13.B.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "netwrksta powershell event", "ScreenshotName": "Elastic-APT29-1412.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell loading netapi32.dll, which contains functions for user and group discovery, including NetWkstaGetInfo.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 13.B.1 - PowerShell loading netapi32.dll", "ScreenshotName": "FireEye-APT29-11754.png"}], "Score": 28}, {"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "13.B.1 - Script block for NetWkstaGetInfo API", "ScreenshotName": "FireEye-APT29-11431.png"}], "Score": 10}], "Step score": 38}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though alerts were generated for PowerShell compiling a DLL file using csc.exe and a suspicious binary write by csc.exe with a PowerShell parent.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-833.png"}, {"ScreenshotName": "Bitdefender-APT29-830.png"}], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1934.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12289.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showed powershell.exe calling the domain function.", "ScreenshotName": "CrowdStrike-APT29-10611.png"}, {"ScreenshotCaption": "Telemetry showed the powershell script block calling the NetWkstaGetInfo API.", "ScreenshotName": "CrowdStrike-APT29-10612.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - API call", "ScreenshotName": "Cybereason-APT29-10792.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery script details", "ScreenshotName": "Symantec-APT29-12961.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery techniques", "ScreenshotName": "Symantec-APT29-12960.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing the NetWKstaGetInfo API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 13B1", "ScreenshotName": "Kaspersky-APT29-18016.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 13a/b/c/d - function imports ", "ScreenshotName": "F-Secure-APT29-11312.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the NetWkstaGetInfo API call. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "API calls", "ScreenshotName": "F-Secure-APT29-10303.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Score": 3}], "Step score": 3}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-306.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-495.png"}, {"ScreenshotName": "Microsoft-APT29-494.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4182.png"}, {"ScreenshotName": "Carbon Black-APT29-4191.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for Threat Activity.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "NetWkstaGetInfo with enrichments", "ScreenshotName": "CyCraft-APT29-2442.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell script and explained that it was used to obtain the domain name.", "Detect": "MSSP-Delayed (Processing)", "Screenshots": [{"ScreenshotCaption": "13.B.1 - MDR Report Day 2, summary and NetWkstaGetInfo ", "ScreenshotName": "CyCraft-APT29-12490.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the execution of PowerShell calling the NetWkstaGetInfo API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12713.png"}, {"ScreenshotName": "GoSecure-APT29-12712.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3774.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "13.B.1 - MSSP", "ScreenshotName": "SentinelOne-APT29-17874.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B1 - Generic powershell alert showing NetWkstaGetInfo call", "ScreenshotName": "SentinelOne-APT29-7249.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection  occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13771.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7034.png"}], "Score": 10}], "Step score": 80}}, "11.A.7": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "alert for multiple wmi discovery techniques", "ScreenshotName": "Elastic-APT29-1364.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "win32 computersystem wmi event", "ScreenshotName": "Elastic-APT29-1361.png"}], "Score": 10}], "Step score": 55}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13687.png"}], "Score": 10}], "Step score": 125}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}, {"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13024.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A - gwmi query for Win32_ComputerSystem", "ScreenshotName": "FireEye-APT29-11389.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for the execution of a WMI system discovery command.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-798.png"}, {"ScreenshotName": "Bitdefender-APT29-811.png"}, {"ScreenshotName": "Bitdefender-APT29-809.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) for a suspicious WMI query operation was generated for a WMI operation via PowerShell.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12054.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 55}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system's network configuration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery Techniques", "ScreenshotName": "Symantec-APT29-12948.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery description", "ScreenshotName": "Symantec-APT29-12949.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a5-7", "ScreenshotName": "Kaspersky-APT29-18010.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Checked that the computer is joined to a domain using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process", "ScreenshotName": "F-Secure-APT29-11306.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a3-8 - thp - wmi stuff", "ScreenshotName": "F-Secure-APT29-10234.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_ComputerSystem. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-289.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence PowerShell runs command to obtain system information: gwmi -namespace root\\cimv2 -query 'Select * from Win32_ComputerSystem'.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1140.png"}, {"ScreenshotName": "Microsoft-APT29-1141.png"}, {"ScreenshotName": "Microsoft-APT29-1139.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-469.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4165.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell wmi query of computersystem with enrichments", "ScreenshotName": "CyCraft-APT29-2421.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.4 - MDR Report Day 2, Win32_computersystem", "ScreenshotName": "CyCraft-APT29-12476.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (warning severity) called \"Get System Information\" was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4210.png"}], "Score": 28}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3721.png"}], "Score": 10}], "Step score": 38}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"Discovery {T1016}\" was generated on a suspicious WMI query targeting Win32_ComputerSystem.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A4/6/7 - WMI win32_computer system", "ScreenshotName": "SentinelOne-APT29-6793.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of WMI query targeting Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration", "ScreenshotName": "SentinelOne-APT29-12845.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A.7 - WMIOperation for Win32_ComputerSystem", "ScreenshotName": "SentinelOne-APT29-17530.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"WMI Queries Win32_ComputerSystem\" was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6945.png"}, {"ScreenshotName": "SecureWorks-APT29-6944.png"}, {"ScreenshotName": "SecureWorks-APT29-6943.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Discovery - System Network Configuration Discovery\" occurred for the PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13768.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17612.png"}, {"ScreenshotName": "SecureWorks-APT29-17611.png"}], "Score": 10}], "Step score": 145}}}, "TechniqueName": "System Network Configuration Discovery", "Steps count": 3, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1204": {"Steps": {"1.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (high severity) was generated for the execution of a malicious file (rcs.3aka3.doc). ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "(use this pic) Malicious file execution (revolver view) showing the file type as executable", "ScreenshotName": "Elastic-APT29-1173.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "(use this pic) Malicious file execution (revolver view) showing the file type as executable", "ScreenshotName": "Elastic-APT29-1173.png"}], "Score": 10}], "Step score": 45}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for rcs.3aka3.doc being tagged as malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2611.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of the user Pam executing the malicious document rcs.3aka3.doc file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13200.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2605.png"}], "Score": 10}], "Step score": 115}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Execution from User Directory\" was generated due to the rcs.3aka3.doc process executing from a user's desktop.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.A.1 - explorer.exe executing rcs.3aka3.doc", "ScreenshotName": "FireEye-APT29-10838.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for a new application in AppCompat, indicating an application executing for the first time.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 1.A.1 - New App in AppCompat alert for rcs.3aka3.doc. Indicating rcs.3aka3.doc is an application that has not been run on the system before.", "ScreenshotName": "FireEye-APT29-11717.png"}], "Score": 28}, {"DetectionNote": "An MSSP detection occurred for user Pam executing rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 1.A", "ScreenshotName": "FireEye-APT29-12976.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Another of explorer.exe with PRS to doc file, indicates presence. PRS  is related to the RTLO, that this process generated a presence based IOC alert", "ScreenshotName": "FireEye-APT29-10846.png"}], "Score": 10}], "Step score": 173}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection (high severity) for Antimalware was generated for explorer.exe executing rcs.3aka3.doc.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-637.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (low severity) was generated for the execution of a rogue unusual executable.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-639.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-636.png"}, {"ScreenshotName": "Bitdefender-APT29-642.png"}], "Score": 10}], "Step score": 80}, "McAfee": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) called \"Running Process(es) with suspicious name\" was generated for the execution of a process with a suspicious name.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1665.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1403.png"}, {"ScreenshotName": "McAfee-APT29-1399.png"}], "Score": 10}], "Step score": 45}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection was generated identifying rcs.3aka3.doc as malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11822.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"process spawning with an uncommon file extension\" occurred containing evidence of explorer.exe executing rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12895.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11820.png"}], "Score": 10}], "Step score": 115}, "CrowdStrike": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated for a suspicious file meeting the sensor's low-confidence threshold for a malicious file.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "A general detection showing explorer.exe executing rcs.3aka.doc.", "ScreenshotName": "CrowdStrike-APT29-10176.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for the suspicious execution of the rcs.3aka3.doc file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Alert for the rcs.3aka3.doc file.", "ScreenshotName": "CrowdStrike-APT29-10184.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A process tree showing explorer.exe executing rcs.3aka.doc.", "ScreenshotName": "CrowdStrike-APT29-10179.png"}], "Score": 10}], "Step score": 115}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red; unique symbol) called \"User Execution\" was generated due to explorer.exe executing rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.a.1 - process tree for user execution", "ScreenshotName": "Cybereason-APT29-7330.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for rcs.3aka3.doc being identified as unknown malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "1.a.1 - timestamp included for user execution alert", "ScreenshotName": "Cybereason-APT29-7333.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1.a.1 - timestamp included for user execution alert", "ScreenshotName": "Cybereason-APT29-7333.png"}, {"ScreenshotCaption": "1.a.1 - process tree for user execution", "ScreenshotName": "Cybereason-APT29-7330.png"}], "Score": 10}], "Step score": 110}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection was generated for \"malicious file ???.cod.3aka3.scr with heuristic signature SONAR.ProcHijack!g31\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "1a1 - malicious file ???.cod.3aka3.scr with heuristic signature SONAR.ProcHijack!g31", "ScreenshotName": "Symantec-APT29-17516.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Forensics Report for rcs.3aka3.doc", "ScreenshotName": "Symantec-APT29-7346.png"}, {"ScreenshotCaption": "List of events related to rcs.3aka3.doc", "ScreenshotName": "Symantec-APT29-7342.png"}], "Score": 10}], "Step score": 45}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"User Execution\" was generated due to execution of rcs.3aka3.doc file by explorer.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.a.1 - explorer.exe executing payload", "ScreenshotName": "Kaspersky-APT29-2623.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of \"User Execution\" due to execution of rcs.3aka3.doc by explorer.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new MSSP 1a1", "ScreenshotName": "Kaspersky-APT29-17985.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1.a.1 - explorer.exe executing payload", "ScreenshotName": "Kaspersky-APT29-2623.png"}], "Score": 10}], "Step score": 145}, "Procedure": "User Pam executed payload rcs.3aka3.doc", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated for rcs.3aka3.doc being identified as a \"rare process executed.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "process tree detection information, rare process executed with command line from pam desktop, explorere.exe executing .doc", "ScreenshotName": "F-Secure-APT29-9985.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of user Pam executing rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2/3 - rtlo and network connection ", "ScreenshotName": "F-Secure-APT29-11250.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "process name is different from full path name", "ScreenshotName": "F-Secure-APT29-9989.png"}], "Score": 10}], "Step score": 115}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection (suspicious severity) was generated for rcs.3aka3.doc being a suspicious process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17544.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for user Pam executing rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17544.png"}], "Score": 10}], "Step score": 115}, "ReaQta": {"Detects": [{"DetectionNote": "A General alert detection (blue/yellow indicators) was generated identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-17.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-20.png"}, {"ScreenshotName": "ReaQta-APT29-17.png"}], "Score": 10}], "Step score": 45}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated for rcs.3aka3.doc that was identified as \"patpoopy\" backdoor during execution.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-351.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-352.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for rcs.3aka3.doc being tagged as suspicious.  ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3707.png"}, {"ScreenshotName": "Carbon Black-APT29-3714.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for the execution of the malicious document rcs.3aka3.doc file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3702.png"}], "Score": 10}], "Step score": 115}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) including \"User Execution\" was generated when explorer.exe executed rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Execution of malicious file. Level 4 alert (red). After scan occured, selected NASHUA and look through logs.", "ScreenshotName": "CyCraft-APT29-14868.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection including \"User Execution\" was received that included a description of rcs.3aka3.doc and its execution.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.A.1 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12218.png"}, {"ScreenshotCaption": "1.A.1, 1.A.3 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-11803.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10819.png"}, {"ScreenshotName": "GoSecure-APT29-10812.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Telemetry showing explorer.exe executing rcs.3aka3.doc", "ScreenshotName": "MalwareBytes-APT29-2586.png"}], "Score": 3}], "Step score": 3}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3429.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for explorer.exe executing rcs.3aka3.doc.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "1.A.1 - Execution for explorer.exe starting rcs.3aka3.doc", "ScreenshotName": "SentinelOne-APT29-14532.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection contained evidence of explorer.exe executing rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "A1 - MSSP - explorer.exe executing rcs.3aka3.doc", "ScreenshotName": "SentinelOne-APT29-12790.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A.1 - Showing explorer execution by 3aka3", "ScreenshotName": "SentinelOne-APT29-6457.png"}], "Score": 10}], "Step score": 125}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Execution - User Execution\" occurred containing evidence of explorer.exe executing rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12782.png"}, {"ScreenshotName": "SecureWorks-APT29-12582.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6506.png"}], "Score": 10}], "Step score": 80}}, "11.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for \"Suspicious Windows Script from Parent Process\" for explorer.exe executing powershell.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Resolver view of suspicious windows script from parent process -- shows explorer starting powershell", "ScreenshotName": "Elastic-APT29-1352.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "showing the get content commandline in powershell", "ScreenshotName": "Elastic-APT29-1354.png"}], "Score": 10}], "Step score": 45}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3125.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13234.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3125.png"}], "Score": 10}], "Step score": 115}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A - PowerShell Get-Content Command with schemas IEX", "ScreenshotName": "FireEye-APT29-11346.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated identifying the powershell.exe process as malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-799.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe spawning powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-801.png"}], "Score": 10}], "Step score": 45}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1814.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Fileless Powershell Malware\" was generated due to PowerShell invoking a script in a temporary directory.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12053.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing explorer.exe executing powershell.exe.", "ScreenshotName": "CrowdStrike-APT29-10567.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for malicious use of powershell.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.1 - process tree spawning powershell, malops", "ScreenshotName": "Cybereason-APT29-9685.png"}, {"ScreenshotCaption": "11.a.1/2 - get-content ", "ScreenshotName": "Cybereason-APT29-9687.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe spawning powershell.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Execution\" was generated when explorer.exe executed powershell.exe.", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "11a1- better tactic SS", "ScreenshotName": "Symantec-APT29-17704.png"}], "Score": 40}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "explorer.exe launched powershell.exe with ADS reader. Shows the decoded output.", "ScreenshotName": "Symantec-APT29-9704.png"}], "Score": 10}], "Step score": 50}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow tag) called \"User Execution\" was generated due to the execution of powershell.exe from explorer.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.2 - ps exec schemas ads", "ScreenshotName": "Kaspersky-APT29-3118.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed explorer.exe spawning powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a12 - vendor pic PS tag - technique", "ScreenshotName": "Kaspersky-APT29-13802.png"}], "Score": 10}], "Step score": 75}, "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - lnk file details ", "ScreenshotName": "F-Secure-APT29-11304.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "explorer launching powershell", "ScreenshotName": "F-Secure-APT29-10228.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12060.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-166.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for a \"Suspicious Powershell commandline.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-464.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Execution\" was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1137.png"}, {"ScreenshotName": "Microsoft-APT29-1136.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-464.png"}], "Score": 10}], "Step score": 115}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for the execution of powershell.exe from explorer.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4112.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe spawning powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4112.png"}], "Score": 10}], "Step score": 45}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) for \"User Execution\" was generated when the .lnk file was executed.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Execution of LNK with enrichments", "ScreenshotName": "CyCraft-APT29-2417.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (blue indicator) was generated identifying explorer.exe executing powershell.exe as threat activity. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: Threat Activity alert for initial powershell execution", "ScreenshotName": "CyCraft-APT29-2279.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"User Execution\" was received that described the user executing 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk to launch powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.1 - MDR Report Day 2, executed powershell", "ScreenshotName": "CyCraft-APT29-12473.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 170}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Execution with get-content (11a1 and 2)", "ScreenshotName": "MalwareBytes-APT29-2557.png"}], "Score": 3}], "Step score": 3}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (warning severity) was generated for \"Suspicious Powershell Commandline\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3699.png"}, {"ScreenshotName": "HanSight-APT29-3701.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3701.png"}], "Score": 10}], "Step score": 45}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated when explorer.exe executed powershell.exe.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "11.A.1 - Execution for explorer.exe spawning powershell.exe", "ScreenshotName": "SentinelOne-APT29-14963.png"}], "Score": 45}, {"DetectionNote": "A General alert detection was generated for a suspicious powershell.exe process spawning. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "A1 - True context start point", "ScreenshotName": "SentinelOne-APT29-6787.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"T1204\" occurred containing evidence of powershell.exe execution targeting .lnk payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1/2 - powershell and SBL", "ScreenshotName": "SentinelOne-APT29-12843.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A1 - Process tree showing explorer.exe executing  powershell calling Get-Content", "ScreenshotName": "SentinelOne-APT29-6783.png"}], "Score": 10}], "Step score": 160}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Execution - User Execution\" occurred containing evidence of  explorer.exe executing powershell.exe (Get-Content\u2026).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13764.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6929.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "User Execution", "Steps count": 2, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}]}, "T1055": {"Steps": {"19.C.2": {"Elastic": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Reflectively injected SDelete binary into PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}}, "19.A.2": {"Elastic": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Reflectively injected SDelete binary into PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}}, "19.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Reflectively injected SDelete binary into PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Process Injection", "Steps count": 3, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1018": {"Steps": {"8.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389.  The detection was correlated to a parent alert for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "port 389 - data transfer to DC ESTABLISHED CONNECTION \nshowed terminated because it had data transfer", "ScreenshotName": "Elastic-APT29-1286.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3000.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for LDAP connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) over port 389.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "8.A.1 - LDAP Network Connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) (top)", "ScreenshotName": "FireEye-APT29-11146.png"}, {"ScreenshotCaption": "8.A.1 - LDAP Network Connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) (bottom)", "ScreenshotName": "FireEye-APT29-11145.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for PowerShell being used to enumerate Active Directory hosts.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.A", "ScreenshotName": "FireEye-APT29-13003.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 115}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4).", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1081.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1714.png"}, {"ScreenshotName": "McAfee-APT29-1712.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (info severity) was generated for Powershell making a network connection.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12203.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe establishing network connections over port 5985 and port 389.", "ScreenshotName": "CrowdStrike-APT29-10454.png"}, {"ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Command and Ad-Search.  (no execution on the Scranton host yet?)", "ScreenshotName": "CrowdStrike-APT29-10451.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Remote System Discovery\" was received that included PowerShell commands run by the adversary and an explanation of those commands.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Remote System Discovery", "ScreenshotName": "Symantec-APT29-12941.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4).", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe connecting to DC via LDAP. Also, registry value creation and set events for LDAP queries", "ScreenshotName": "Symantec-APT29-9930.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8.a.1 - connection to 10.0.0.4:389", "ScreenshotName": "Kaspersky-APT29-2875.png"}], "Score": 10}], "Step score": 10}, "Procedure": "Enumerated remote systems using LDAP queries", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "port 389 for 10.0.0.4", "ScreenshotName": "F-Secure-APT29-10107.png"}, {"ScreenshotCaption": "invoke command script block get-process", "ScreenshotName": "F-Secure-APT29-10113.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A General detection for \"Suspicious Behavior\" was generated due to LDAP queries to NewYork (10.0.0.4) over port 389. ", "Detect": "General", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11957.png"}], "Score": 30}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 40}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-129.png"}, {"ScreenshotName": "ReaQta-APT29-131.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of LDAP queries from Nashua to NewYork (Domain Controller - 10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13997.png"}, {"ScreenshotName": "Microsoft-APT29-13998.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the results of the LDAP query issued by Ad-Search.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-419.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4029.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Remote System Discovery\" was received that explained that the Ad-Search PowerShell command was used to discover remote systems in the domain.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "8.A.1 - MDR Report Day 1, Remote System Discovery", "ScreenshotName": "CyCraft-APT29-12452.png"}, {"ScreenshotCaption": "8.A.1 - MDR Report Day 1, Remote System Discovery (2)", "ScreenshotName": "CyCraft-APT29-12453.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11022.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection identified as LDAP over TCP port 389 to NewYork (10.0.0.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3602.png"}, {"ScreenshotName": "HanSight-APT29-3603.png"}, {"ScreenshotName": "HanSight-APT29-3604.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1018\" occurred containing evidence of Ad-Search function definition along with LDAP network connection to NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - ldap, wsman, SBL of AD-Search", "ScreenshotName": "SentinelOne-APT29-12830.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4). The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A1 - Shows LDAP connection from Nashua to Scranton", "ScreenshotName": "SentinelOne-APT29-6690.png"}, {"ScreenshotCaption": "A1 - Specifically identifies protocol as LDAP", "ScreenshotName": "SentinelOne-APT29-6692.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Discovery - Remote System Discovery\" occurred containing evidence of LDAP queries from Nashua to NewYork (Domain Controller - 10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13750.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6775.png"}, {"ScreenshotName": "SecureWorks-APT29-6742.png"}], "Score": 10}], "Step score": 80}}, "16.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the Get-NetDomainController cmdlet then subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "endgame client view showing the ldap queries (port 389)", "ScreenshotName": "Elastic-APT29-1497.png"}, {"ScreenshotCaption": "script block  for get-netdomaincontroller", "ScreenshotName": "Elastic-APT29-1498.png"}, {"ScreenshotCaption": "get forestdomain powershel cmdlet with the  discovery  tag for powershell  (tactic tags is changing  for powershell)", "ScreenshotName": "Elastic-APT29-1496.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though events showed the execution of the PowerShell Get-DomainController function.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13726.png"}], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell making a LDAP network connections over port 389 to the domain controller NewYork (10.0.0.4)", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "16.A.1 - LDAP Network Connection (bottom)", "ScreenshotName": "FireEye-APT29-11531.png"}, {"ScreenshotCaption": "16.A.1 - LDAP Network Connection (top)", "ScreenshotName": "FireEye-APT29-11530.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell making a network connection over port 389 to the domain controller NewYork (10.0.0.4). ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though a real time search showed that the System.DirectoryServices.dll module was loaded by powershell.exe.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1860.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though an alert was generated for PowerShell executing the Get-NetDomainController cmdlet.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12125.png"}], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the System.DirectoryServices.dll module loaded by powershell.exe as well as powershell.exe executing the Get-NetDomainController cmdlet. The detection was correlated to a parent alert on PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing Powershell.exe executed get-netdomaincontrollers script.", "ScreenshotName": "CrowdStrike-APT29-10659.png"}, {"ScreenshotCaption": "Telemetry showing network connections from Utica to NewYork on port 135.", "ScreenshotName": "CrowdStrike-APT29-10664.png"}, {"ScreenshotCaption": "Telemetry showing System.DirectoryServices.dll module loaded by powershell.exe.", "ScreenshotName": "CrowdStrike-APT29-10662.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "16.a.1 - network connection details", "ScreenshotName": "Cybereason-APT29-9767.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell making a network connection to the domain controller NewYork (10.0.0.4) over LDAP port 389. Additionally, Oscar's Kerberos ticket was seen in memory on NewYork. ", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16a1 - telem - delayed search query", "ScreenshotName": "Symantec-APT29-17718.png"}, {"ScreenshotCaption": "16a1 - telem - delayed forensic report ", "ScreenshotName": "Symantec-APT29-17717.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of System.DirectoryServices.ni.dll loaded into PowerShell, which can be used to execute LDAP queries.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 16a1", "ScreenshotName": "Kaspersky-APT29-18018.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "port 389 ", "ScreenshotName": "F-Secure-APT29-10397.png"}, {"ScreenshotCaption": "function API names being called", "ScreenshotName": "F-Secure-APT29-10401.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A General detection alert (informational severity) called \"LDAP SASL Connection Detected\" was generated for PowerShell  making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12140.png"}, {"ScreenshotName": "TrendMicro-APT29-12138.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell executing the Get-NetDomainController cmdlet and subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the Get-NetDomainController cmdlet and subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-322.png"}, {"ScreenshotName": "ReaQta-APT29-187.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for powershell.exe making a \"suspicious LDAP query.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-524.png"}], "Score": 35}], "Step score": 35}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4292.png"}, {"ScreenshotName": "Carbon Black-APT29-14757.png"}, {"ScreenshotName": "Carbon Black-APT29-4267.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing the Get-NetDomainController command.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Get-NetDomainController with enrichments", "ScreenshotName": "CyCraft-APT29-2463.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Remote System Discovery\" was received that included a PowerShell script and explained that it was used to discover a remote system.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.A.1 - MDR Report Day 2, summary & Get-NetDomainController", "ScreenshotName": "CyCraft-APT29-12506.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred for suspicious activity indicative of remote discovery attempts. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12721.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell making a network connection over port 389 to the domain controller NewYork (10.0.0.4). The event was correlated to a parent detection on \"PowerShell with Execution Bypass Command Launched.\"", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11406.png"}], "Score": 17}], "Step score": 87}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell loading System.DirectoryServices.dll and making a network connection to the domain controller NewYork (10.0.0.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A1 -  LDAP network connection information", "ScreenshotName": "SentinelOne-APT29-6899.png"}, {"ScreenshotCaption": "A1 - System.directoryservices.dll being loaded by powershell", "ScreenshotName": "SentinelOne-APT29-6906.png"}], "Score": 10}], "Step score": 10}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Discovery - Remote System Discovery\" occurred containing evidence of PowerShell executing LDAP queries via functions from System.DirectoryServices namespace.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13780.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the Get-NetDomainController cmdlet and subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7115.png"}, {"ScreenshotName": "SecureWorks-APT29-7111.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Remote System Discovery", "Steps count": 2, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1071": {"Steps": {"3.B.4": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS.", "Detect": "None-Residual Artifact", "Screenshots": [{"ScreenshotCaption": "3.B - Parsing strings in process memory for HTTPS reference", "ScreenshotName": "FireEye-APT29-10929.png"}], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed an SSL network connection to 192.168.0.5 on port 443.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1086.png"}, {"ScreenshotName": "Bitdefender-APT29-1088.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.", "ScreenshotName": "Symantec-APT29-7402.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.", "ScreenshotName": "Symantec-APT29-7402.png"}], "Score": 10}], "Step score": 45}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell process exchanging data over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17349.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Standard Application Layer Protocol\" was generated due to the PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11866.png"}], "Score": 60}], "Step score": 60}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Command and Control was generated containing evidence Meterpreter communications were being sent using HTTPS, due to the presence of the WINHTTP_FLAG_SECURE within the embedded shell code.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-579.png"}, {"ScreenshotName": "Microsoft-APT29-13989.png"}], "Score": 70}], "Step score": 70}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13938.png"}, {"ScreenshotName": "Carbon Black-APT29-3825.png"}], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1071\" occurred containing evidence of PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B3/4/5 - port information", "ScreenshotName": "SentinelOne-APT29-12807.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B3/4/5 - Network connection, powershell exchanging data with host over https", "ScreenshotName": "SentinelOne-APT29-6515.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443 using shellcode that loads WinInet.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12589.png"}], "Score": 70}], "Step score": 70}}, "11.A.14": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making an network connection to C2 (192.168.0.4) over port 443, which was identified as using the SSL protocol.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1097.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading http libraries.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "Telemetry showing http module loads for powershell.exe process.", "ScreenshotName": "CrowdStrike-APT29-10589.png"}], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection for \"Standard Application Layer Protocol\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: stager script explanation", "ScreenshotName": "Symantec-APT29-12954.png"}, {"ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques", "ScreenshotName": "Symantec-APT29-12953.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)", "ScreenshotName": "Symantec-APT29-9867.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "11.a.13-5 MSSP report #2", "ScreenshotName": "Kaspersky-APT29-12385.png"}, {"ScreenshotCaption": "11.a.13-5 MSSP report #1", "ScreenshotName": "Kaspersky-APT29-12384.png"}], "Score": 0}], "Step score": 0}, "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14657.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Standard Application Layer Protocol\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12075.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for the network connection over HTTPS. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}], "Score": 70}], "Step score": 130}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.\t", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1071\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A13/14/15 - network information", "ScreenshotName": "SentinelOne-APT29-12849.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection", "ScreenshotName": "SentinelOne-APT29-6810.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Standard Application Layer Protocol", "Steps count": 2, "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}]}, "T1056": {"Steps": {"7.A.3": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1056 Input Capture\" (low severity) was generated for powershell.exe calling the NtUserGetAsyncKeyState API. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "alert for keyboard, encriched with input capture based on api event ", "ScreenshotName": "Elastic-APT29-1271.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe calling the NtUserGetAsyncKeyState. API. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "alert for keyboard, encriched with input capture based on api event ", "ScreenshotName": "Elastic-APT29-1271.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Input Capture\" was generated due to powershell.exe making the GetAsyncKeyState API call. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2963.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2961.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of key logging.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13218.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection called \"PowerShell Loading User32.dll\" was generated due to powershell.exe loading user32.dll, indicating possible Input Capture.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 7.A.3 - PowerShell Loading User32.dll", "ScreenshotName": "FireEye-APT29-11727.png"}], "Score": 28}, {"DetectionNote": "An MSSP detection occurred containing evidence of keylogging.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 7.A", "ScreenshotName": "FireEye-APT29-13000.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "7.A.3 - Script block for GetAsyncKeyState", "ScreenshotName": "FireEye-APT29-11106.png"}], "Score": 10}], "Step score": 108}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1125.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Input Capture\" was generated due to PowerShell key logging module activity.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1662.png"}], "Score": 65}], "Step score": 65}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12250.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Input Capture\" was generated when a process performed reads of the user key buffers. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the GetAsyncKeyStateEtwBatch caused the technique detection.", "ScreenshotName": "CrowdStrike-APT29-10414.png"}, {"ScreenshotCaption": "A Technique detection for \"Input Capture\" showing powershell used GetAsyncKeyState API.", "ScreenshotName": "CrowdStrike-APT29-10408.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the GetAsyncKeyStateEtwBatch caused the technique detection.", "ScreenshotName": "CrowdStrike-APT29-10414.png"}, {"ScreenshotCaption": "Telemetry showing Get-Clipboard and Get-Keystrokes executing.", "ScreenshotName": "CrowdStrike-APT29-10413.png"}], "Score": 17}], "Step score": 89}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Input Capture\" occurred containing evidence of Get-Keystrokes function execution from psversion.ps1.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - get keystrokes", "ScreenshotName": "Symantec-APT29-17628.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell loading .NET assemblies to capture key strokes.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 7a3", "ScreenshotName": "Kaspersky-APT29-17999.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection called dotnet-keylogging (medium severity) was generated for use of the GetAsyncKeyState API.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "get async keystate", "ScreenshotName": "F-Secure-APT29-10099.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "7a3", "ScreenshotName": "F-Secure-APT29-10093.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection mapped to \"T1056\" (Input Capture) was generated due to powershell.exe executing GetAsyncKeyState. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11934.png"}, {"ScreenshotName": "TrendMicro-APT29-11933.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-273.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection for Input Capture (high severity) was generated due to powershell.exe using APIs that are commonly abused by malicious applications to log keystrokes.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-406.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed API calls for GetAsyncKeyState. Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of key logging.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12758.png"}, {"ScreenshotName": "Carbon Black-APT29-12757.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4008.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection for Threat Activity (red indicator) was generated for PowerShell calling the GetAsyncKeyState API.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier raw data: Threat Activity alert containing powershell for collection\n", "ScreenshotName": "CyCraft-APT29-14846.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Input Capture\" occurred containing evidence of key logging.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "7.A.3 - MDR Report Day 1, Input Capture", "ScreenshotName": "CyCraft-APT29-12450.png"}, {"ScreenshotCaption": "7.A.3 - MDR Report Day 1, Input Capture (2)", "ScreenshotName": "CyCraft-APT29-12451.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing evidence of API execution was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10981.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) called \"Keylogger with Powershell\" was generated due to PowerShell making use of GetAsyncKeyState.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3577.png"}, {"ScreenshotName": "HanSight-APT29-3576.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"SuspiciousKeylogging\" was generated due to GetAsyncKeyState execution. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - A2/3 - Alerts for Suspicious keylogging and screenshots", "ScreenshotName": "SentinelOne-APT29-7214.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1056\" occurred containing evidence of GetAsyncKeyState API calls and Get-Keystrokes function call.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A3 - KeyLogging alert", "ScreenshotName": "SentinelOne-APT29-12826.png"}, {"ScreenshotCaption": "MSSP - A3 - SBL GetSyncState", "ScreenshotName": "SentinelOne-APT29-12827.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Configuration Change (UX)-Correlated", "Screenshots": [{"ScreenshotCaption": "CC - A3 - Powershell script using the GetAsyncKeyState API call", "ScreenshotName": "SentinelOne-APT29-7211.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of input capture.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12610.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6656.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Input Capture", "Steps count": 1, "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}]}, "T1077": {"Steps": {"8.C.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "smb connection - 8c2 tactic", "ScreenshotName": "Elastic-APT29-1318.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection for network share access was generated due to remote access to a Windows admin share.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3019.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3018.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection was generated for an executable being copied to a remote host via a share. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3016.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13225.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3022.png"}], "Score": 17}], "Step score": 224}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for network traffic from Nashua (10.0.1.6) to Scranton (10.0.1.4) over a port associated with DCOM RPC traffic.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "8.C.2 - DCOM RPC network traffic (top)", "ScreenshotName": "FireEye-APT29-11184.png"}, {"ScreenshotCaption": "8.C.2 - DCOM RPC network traffic (bottom)", "ScreenshotName": "FireEye-APT29-11185.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.C", "ScreenshotName": "FireEye-APT29-13008.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 115}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection for Windows Admin Shares was generated for PSExec using credentials to execute a remote command.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13442.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection was generated for PsExec64.exe writing a file to a remote admin share through the SMB protocol.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-767.png"}], "Score": 65}], "Step score": 130}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1743.png"}], "Score": 17}], "Step score": 17}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Win_NetDrive_DataInteraction_MITRET1039\" was generated due to a PowerShell targeting a network drive.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11977.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (info severity) called \"Win_Network_CommonPorts_MitreT1043\" was generated due to Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11979.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 110}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Windows Admin Shares\" was generated when python.exe was copied to Scranton via SMB.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments.", "ScreenshotName": "CrowdStrike-APT29-10491.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments.", "ScreenshotName": "CrowdStrike-APT29-10491.png"}, {"ScreenshotCaption": "Telemetry showing connection from nashua to 10.0.1.4 over port 135.", "ScreenshotName": "CrowdStrike-APT29-10483.png"}], "Score": 10}], "Step score": 75}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for malicious PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "8.c.2 - connection on port 135", "ScreenshotName": "Cybereason-APT29-9644.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "network connections from nashua showing PSExec connection to scranon on port 445 and connection to domain controller on port 389", "ScreenshotName": "Symantec-APT29-7461.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of psexec64 establishing an IPC share on Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 8c2", "ScreenshotName": "Kaspersky-APT29-18004.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Saw connection over SMB between systems", "ScreenshotName": "Kaspersky-APT29-2895.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "135 port for SMB ", "ScreenshotName": "F-Secure-APT29-10124.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Executable file dropped in administrative share\"  was generated due PSEXESVC.exe being copied to Scranton.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11975.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-138.png"}], "Score": 17}], "Step score": 17}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP 135.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-437.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13945.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for \"Remote Accessed.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "PSExecSVC.exe remote access NASHUA > Scranton as Pam", "ScreenshotName": "CyCraft-APT29-2254.png"}], "Score": 35}], "Step score": 35}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called \"Windows Admin Shares\" was generated due to access of a remote admin share.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11052.png"}, {"ScreenshotName": "GoSecure-APT29-11057.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11057.png"}], "Score": 10}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Windows Admin Shares  was generated due to PSEXEC connecting to Scranton's IPC$ share. The event was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Technique-Alert-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "write of psexec (8c3)", "ScreenshotName": "MalwareBytes-APT29-2538.png"}], "Score": 65}], "Step score": 65}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Windows Share by Shared Folder Access Monitor\" was generated due to remote access to a Windows admin share.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3634.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection (warning severity) called \"Lateral Movement with PsExec\" was generated due to PsExec64.exe executing a remote command from Nashua (10.0.1.6) to Scranton (10.0.1.4).", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3628.png"}, {"ScreenshotName": "HanSight-APT29-3629.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 120}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"AdminShareAccess\" was generated due to PSEXESVC.exe being copied to $ADMIN on Scranton (10.0.1.4). The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "Admin share access alert from psexec64", "ScreenshotName": "SentinelOne-APT29-6721.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1077\" occurred containing evidence of  PsExec64.exe establishing SMB session to Scranton's IPC$ share, and writes PSEXESVC.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C2 - network information", "ScreenshotName": "SentinelOne-APT29-12834.png"}, {"ScreenshotCaption": "MSSP - C2/3 -network info + psexec + admin share access", "ScreenshotName": "SentinelOne-APT29-12835.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135 identified as RPC.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "8.C.2 - rpc network connection correlated", "ScreenshotName": "SentinelOne-APT29-14733.png"}, {"ScreenshotCaption": "C2 - SMB session being established", "ScreenshotName": "SentinelOne-APT29-6718.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Lateral Movement - Windows Admin Shares\" occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13755.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6756.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Windows Admin Shares", "Steps count": 1, "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}]}, "T1050": {"Steps": {"5.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for \"Service Creation/Modification\" was generated due to powershell.exe creating the javamtsup.exe service. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "same pric esc alert with the file renamed event.", "ScreenshotName": "Elastic-APT29-1245.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PowerShell created the new service javamtsup. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "5a1 - vendor pic for telem", "ScreenshotName": "Elastic-APT29-15109.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell created the new service javamtsup. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13653.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13656.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13654.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13655.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13666.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Service Persistence\" was generated due to the modification of Windows service Registry keys when the javamtsup service was created.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "5.A.1 - Service Persistence for javamtsup (bottom)", "ScreenshotName": "FireEye-APT29-11043.png"}, {"ScreenshotCaption": "5.A.1 - Service Persistence for javamtsup (top)", "ScreenshotName": "FireEye-APT29-11041.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for javamtsup.exe being classified as malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "5.A.1 - Malware signature detection on javamtsup.exe", "ScreenshotName": "FireEye-APT29-11077.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for the creation of the javamtsup service.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 5.A", "ScreenshotName": "FireEye-APT29-12993.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell created the new service javamtsup.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 180}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection called \"A New Service Has Been Created\" was generated due to PowerShell creating the new service javamtsup. ", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1063.png"}], "Score": 58}], "Step score": 58}, "McAfee": {"Detects": [{"DetectionNote": "A General detection was generated for a service \"never seen in the baseline of the company.\"", "Detect": "General", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1609.png"}], "Score": 30}, {"DetectionNote": "Telemetry showed the creation of javamtsup service.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1609.png"}, {"ScreenshotName": "McAfee-APT29-1585.png"}], "Score": 10}], "Step score": 40}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_Powershell_NewService_MITRET1050\" was generated due to PowerShell creating the new service javamtsup. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11923.png"}, {"ScreenshotName": "Cylance-APT29-11924.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Persistence Mechanisms\" occurred containing evidence of javamtsup service launching C:\\Windows\\System32\\javamtsup.exe and New-Service cmdlet usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12904.png"}], "Score": 70}], "Step score": 135}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell command used to create the new service javamtsup. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the invoke-persistence step 1 and step 2 scriptblock contents.", "ScreenshotName": "CrowdStrike-APT29-10338.png"}, {"ScreenshotCaption": "Telemetry showing the Invoke-Persistence -PersistStep 1 script executing.", "ScreenshotName": "CrowdStrike-APT29-10337.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed the creation of javamtsup service. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "5.a.1 - service details on java ", "ScreenshotName": "Cybereason-APT29-9608.png"}, {"ScreenshotCaption": "5.a.1 - creation of javamtsup", "ScreenshotName": "Cybereason-APT29-9606.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"New Service\" was generated due to services.exe creating javamtsup. ", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "Registry creation events for javamtsup.exe tagged with New Service", "ScreenshotName": "Symantec-APT29-7432.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed a registry event for the creation of javamtsup service.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Registry creation events for javamtsup.exe tagged with New Service", "ScreenshotName": "Symantec-APT29-7432.png"}], "Score": 10}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of the javamtsup service.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 5a1", "ScreenshotName": "Kaspersky-APT29-17995.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a registry event for the creation of javamtsup service. The event was correlated to a parent General detection for suspicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "javamtsup added to registry in Services -> indicates service is created.", "ScreenshotName": "Kaspersky-APT29-2798.png"}, {"ScreenshotCaption": "javamtsup.exe created - tree", "ScreenshotName": "Kaspersky-APT29-2777.png"}], "Score": 17}], "Step score": 87}, "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection for Create New Service occurred containing evidence of the javamtsup service being installed. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - new service with command line args", "ScreenshotName": "F-Secure-APT29-11279.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a registry event and service creation of javamtsup.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "javamtsup", "ScreenshotName": "F-Secure-APT29-10073.png"}, {"ScreenshotCaption": "javamtsup service creation", "ScreenshotName": "F-Secure-APT29-10069.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell making a new service named javamtsup. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12678.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a Registry event and service creation of javamtsup.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11898.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the file rename event for the service executable.", "Detect": "None", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-95.png"}], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Suspicious Service registration\" (medium severity) was generated due to the creation of javamtsup service. This detection was correlated to a parent General detection that rcs.3aka3.doc was identified as a backdoor.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13991.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed a registry event for the creation of javamtsup service.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-396.png"}], "Score": 10}], "Step score": 82}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though a manual query for the showed the new service and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3957.png"}, {"ScreenshotName": "Carbon Black-APT29-3949.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (orange indicator) showed a Registry event for the creation of javamtsup service.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier raw data: registry creation events related to registration of javamtsup service", "ScreenshotName": "CyCraft-APT29-2168.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"New Service\" was received that included events and analysis related to registration and execution of the javamtsup service.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "5.A.1 - MDR Report Day 1, Service creation", "ScreenshotName": "CyCraft-APT29-12442.png"}, {"ScreenshotCaption": "5.A.1, 5.A.2 - MDR Report Day 1, Service execution, registry run key", "ScreenshotName": "CyCraft-APT29-12441.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (green indicator) called New Service was generated due to the creation of the javamtsup service. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10920.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a registry event and service creation of javamtsup.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10920.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"New Service Creation via Snapshot\" was generated due to the creation of the javamtsup service.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3546.png"}], "Score": 65}], "Step score": 65}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ServiceCreate\" under \"Persistence {T1084}\" was generated due to \"javamtsup\" being added to the \"...\\Services\" registry path. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "A1 - Detailed view of the new service creation, specifically shows persistence", "ScreenshotName": "SentinelOne-APT29-6554.png"}, {"ScreenshotCaption": "A1 - Reg keys being created", "ScreenshotName": "SentinelOne-APT29-6556.png"}, {"ScreenshotCaption": "A1 -  Reg keys being created", "ScreenshotName": "SentinelOne-APT29-6555.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred for PowerShell initiating a new persistence service \"javamtsup\". ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1 - New-Service info pt2", "ScreenshotName": "SentinelOne-APT29-12819.png"}, {"ScreenshotCaption": "MSSP - A1 - New-Service info pt1", "ScreenshotName": "SentinelOne-APT29-12818.png"}], "Score": 70}], "Step score": 142}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Persistence - New Service\" occurred for the creation of the javamtsup service.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13740.png"}, {"ScreenshotName": "SecureWorks-APT29-13742.png"}, {"ScreenshotName": "SecureWorks-APT29-13741.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of the javamtsup service.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6681.png"}, {"ScreenshotName": "SecureWorks-APT29-6683.png"}, {"ScreenshotName": "SecureWorks-APT29-6682.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "New Service", "Steps count": 1, "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}]}, "T1074": {"Steps": {"17.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed the file creation event for MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "17b2 file create of ATTCK Evals html", "ScreenshotName": "Elastic-APT29-1564.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3298.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3297.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell writing the MITRE-ATTACK-EVALS.HTML file to disk.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "17.B.2 - PowerShell File Write for MITRE-ATTACK-EVALS.HTML (top)", "ScreenshotName": "FireEye-APT29-11585.png"}, {"ScreenshotCaption": "17.B.2 - PowerShell File Write for MITRE-ATTACK-EVALS.HTML (bottom)", "ScreenshotName": "FireEye-APT29-11584.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. This event was correlated to parent alerts relating to the PowerShell process that carried out the file write.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "17.B.2 - Triage view of the file write for MITRE-ATTACK-EVALS.HTML", "ScreenshotName": "FireEye-APT29-11589.png"}], "Score": 17}], "Step score": 52}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection called \"PowerShell Suspicious Write\" was generated due to a PowerShell file write to an uncommon location.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1002.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12317.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "17.b.2 - file event with the powershell process tree and html file ", "ScreenshotName": "Cybereason-APT29-9799.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell.exe created and modified html file", "ScreenshotName": "Symantec-APT29-9874.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing the file write event for WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp or recrop current", "ScreenshotName": "Kaspersky-APT29-18020.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "17.b.2 - tree", "ScreenshotName": "Kaspersky-APT29-3296.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Staged collected file into directory using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of MITRE-ATTACK-EVALS.html being copied into the Temp folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}, {"ScreenshotCaption": "MSSP - move to B- copy-item", "ScreenshotName": "F-Secure-APT29-11320.png"}], "Score": 70}], "Step score": 70}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for a file collected then staged. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17563.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-202.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence PowerShell executed a command to copy a malicious HTML file to a TEMP folder with a different name.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1148.png"}, {"ScreenshotName": "Microsoft-APT29-1147.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-542.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell staging a collected file into a directory.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4330.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) called \"Email Collection (email file copy)\" was generated for the file copy MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11453.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11453.png"}], "Score": 17}], "Step score": 59}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3931.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1074\" occurred containing evidence of Copy-Item with ..\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML being the destination file. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - Copy-Item", "ScreenshotName": "SentinelOne-APT29-12884.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.  The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B2 - File Write to C:\\Windows\\Temp\\WindowsParentalControlMigration\\ MITRE-ATTACK-EVALS.HTML", "ScreenshotName": "SentinelOne-APT29-6938.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "9.B.5": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed a File Created event for powershell.exe creating working.zip. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "working.zip file created", "ScreenshotName": "Elastic-APT29-1327.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"Collection\" was generated due to working.zip file creation in %APPDATA%\\roaming folder. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3049.png"}], "Score": 52}, {"DetectionNote": "An MSSP detection contained evidence of the creation of working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create of working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3052.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13663.png"}], "Score": 17}], "Step score": 139}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"ZIP Archive Created\" \"T1074\" was generated due to the file creation of the ZIP file working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.B.5 - ZIP Archive Created for working.zip (bottom)", "ScreenshotName": "FireEye-APT29-11209.png"}, {"ScreenshotCaption": "9.B.5 - ZIP Archive Created for working.zip (top)", "ScreenshotName": "FireEye-APT29-11208.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for file create of working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.B", "ScreenshotName": "FireEye-APT29-13017.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file create event for working.zip.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed the file write of working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1078.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed a File Created event for powershell.exe creating working.zip. The detection was correlated to a parent alert for PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1787.png"}], "Score": 17}], "Step score": 17}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) called \"Win_FileExtensions_LocalSystemCollection_NonSys_MITRET1005\"  was generated for file activity involving draft.zip.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12014.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a File Write event for powershell.exe creating working.zip.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed a ZipFileWritten event for the creation of working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing ZipFileWritten event.", "ScreenshotName": "CrowdStrike-APT29-10496.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed a Create File event for powershell.exe creating working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.b.5 file creating with app data roaming file", "ScreenshotName": "Cybereason-APT29-9653.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed a Created File event for powershell.exe creating working.zip. The event was correlated to a parent General detection for a suspicious PowerShell process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9b5 - telem + correlation", "ScreenshotName": "Symantec-APT29-17692.png"}, {"ScreenshotCaption": "powershell.exe created working.zip", "ScreenshotName": "Symantec-APT29-7473.png"}], "Score": 17}], "Step score": 17}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 9B1 and 9B5", "ScreenshotName": "Kaspersky-APT29-18007.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file create event for powershell.exe creating working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Triggering on  creation of a powershell process", "ScreenshotName": "Kaspersky-APT29-2929.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell staging files into working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - raw command - childitem", "ScreenshotName": "F-Secure-APT29-11293.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a FILE_CREATE event for powershell.exe creating working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip", "ScreenshotName": "F-Secure-APT29-10136.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell creating working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12788.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a File Created event for powershell.exe creating working.zip. The detection was correlated to a parent alert for service execution on python.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12001.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe creating working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-150.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence PowerShell created working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1135.png"}, {"ScreenshotName": "Microsoft-APT29-1134.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a created file event for powershell.exe creating working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-446.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed a filemod event for powershell.exe creating working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4064.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed a File Create event for powershell.exe creating working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11081.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1074\" occurred containing evidence of working.zip creation from file creation events.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B5/6 - file creation event", "ScreenshotName": "SentinelOne-APT29-12839.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a File Creation event for powershell.exe creating working.zip.The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B5 - File creation of working.zip", "ScreenshotName": "SentinelOne-APT29-6743.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "2.A.5": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection for \"Data Staged\" was generated due to the NtCreateFile API being used to create Draft.zip. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Technique-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "cc i think, showing enrichments for data staged and data compressed. ", "ScreenshotName": "Elastic-APT29-1679.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "file create event - showing the file created (zip) coming off of powershell. ", "ScreenshotName": "Elastic-APT29-1196.png"}], "Score": 17}], "Step score": 77}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Data Staged \"(T1074)\" occurred containing evidence that there was a compressed zip file created named Draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2678.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for file creation of Draft.zip", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "2.A.5 - PowerShell File Write for Draft.zip (bottom)", "ScreenshotName": "FireEye-APT29-10869.png"}, {"ScreenshotCaption": "2.A.5 - PowerShell File Write for Draft.zip (top)", "ScreenshotName": "FireEye-APT29-10868.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for the file creation of Draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 2.A", "ScreenshotName": "FireEye-APT29-12979.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. This was correlated to prior a detection of the parent PowerShell process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "2.A.5 - Triage view of powershell.exe writing Draft.zip with first bytes of the file displayed", "ScreenshotName": "FireEye-APT29-10873.png"}], "Score": 17}], "Step score": 122}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-654.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed the creation of Draft.Zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1448.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed file creation of Draft.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11841.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed file creation of Draft.zip.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the draft.zip file being written.", "ScreenshotName": "CrowdStrike-APT29-10759.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for Data Staged occurred containing evidence of the creation of the file Draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a5 (draft.zip create)", "ScreenshotName": "Cybereason-APT29-10772.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "2.a.5 - file create event for draft.zip file", "ScreenshotName": "Cybereason-APT29-7372.png"}], "Score": 17}], "Step score": 87}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed the creation of Draft.Zip. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection + correlation", "ScreenshotName": "Symantec-APT29-17539.png"}], "Score": 17}], "Step score": 17}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of Draft.Zip by powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-17988.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The event was correlated to a parent Technique detection for a suspicious PowerShell process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "2.a.5 - Creation of Draft.Zip", "ScreenshotName": "Kaspersky-APT29-2650.png"}], "Score": 17}], "Step score": 87}, "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed file creation of Draft.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14964.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell storing files in a zip file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11844.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the creation of Draft.Zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-40.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery occurred containing evidence that PowerShell ran commands to query files with certain extensions and compress the found files into a zip file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17383.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-364.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection was generated referencing the creation of Draft.zip for later exfiltration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3758.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of Draft.Zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10822.png"}], "Score": 10}], "Step score": 80}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for Data Staged was generated due the creation of Draft.Zip. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Technique-Alert-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "alert for data staged (2a5)", "ScreenshotName": "MalwareBytes-APT29-2392.png"}], "Score": 65}], "Step score": 65}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for the file creation of Draft.zip was received. The alert stated that \"C:\\Users\\pam\\AppData\\Roaming\\Draft.zip\" file was created.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "A5 - MSSP - Creation of Draft.zip", "ScreenshotName": "SentinelOne-APT29-10769.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "2.A.5 - File Creation for Draft.zip", "ScreenshotName": "SentinelOne-APT29-17890.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Data Staged", "Steps count": 3, "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}]}, "T1114": {"Steps": {"17.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "psemail script block with contents", "ScreenshotName": "Elastic-APT29-1555.png"}, {"ScreenshotCaption": "outlook spawning from  svchost.exe", "ScreenshotName": "Elastic-APT29-1559.png"}, {"ScreenshotCaption": "new screenshot of outlook spawning from svhost with file created event. ", "ScreenshotName": "Elastic-APT29-1562.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed outlook.exe spawning from powershell.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3291.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13727.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection called \"Unusual Outlook Parent Process\" was generated due to Outlook being launched by a process other than explorer.exe.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 17.A.1 - Unusual Outlook Parent Process", "ScreenshotName": "FireEye-APT29-11760.png"}], "Score": 28}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell collected email information from Outlook.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 17.A", "ScreenshotName": "FireEye-APT29-13045.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "17.A.1 - outlook.exe with parent process svchost.exe", "ScreenshotName": "FireEye-APT29-11581.png"}], "Score": 10}], "Step score": 108}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-968.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1878.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_Email_Collection_Subfolders_MitreT1114\"  was generated due to the executed PowerShell script containing \"Outlook.Application.\"", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12144.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Data Theft and Exfiltration\" occurred containing evidence of email collection via PowerShell.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12927.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12315.png"}], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing outlook.exe spawning from svchost.exe.", "ScreenshotName": "CrowdStrike-APT29-10694.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red, unique symbol) called \"PowerShell access to Outlook mailbox data (ATT&CK: Collection)\" was generated due a process having access to Outlook mailbox data through use of a PowerShell script. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "17.a.1 - malop powershell.exe detectied as malicious", "ScreenshotName": "Cybereason-APT29-13286.png"}, {"ScreenshotCaption": "17.a.1 - powershell access to outlook under suspicions, marked on poewrshell not outlook.exe process", "ScreenshotName": "Cybereason-APT29-9798.png"}, {"ScreenshotCaption": "17.a.1- process tree and evidence", "ScreenshotName": "Cybereason-APT29-9797.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "17.a.1- process tree and evidence", "ScreenshotName": "Cybereason-APT29-9797.png"}], "Score": 10}], "Step score": 82}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Email Collection\" was generated containing evidence of email collection.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Email Collection", "ScreenshotName": "Symantec-APT29-12971.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "svchost.exe executed outlook.exe", "ScreenshotName": "Symantec-APT29-9835.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell interacting with Outlook.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "17.b.1 MSSP report", "ScreenshotName": "Kaspersky-APT29-12410.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "17.a.1  details", "ScreenshotName": "Kaspersky-APT29-3289.png"}, {"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3287.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of psemail Powershell function being used to read email for the user.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}, {"ScreenshotCaption": "MSSP - raw psemail function", "ScreenshotName": "F-Secure-APT29-11319.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "svchost launching outlook.exe  telemetry", "ScreenshotName": "F-Secure-APT29-10446.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": " An MSSP detection occurred for outlook using function psemail to dump outlook messages.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17561.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-199.png"}, {"ScreenshotName": "ReaQta-APT29-198.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Suspicious Activity was generated containing evidence that PowerShell function 'psemail' was used to copy emails from an Outlook inbox.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1147.png"}, {"ScreenshotName": "Microsoft-APT29-1148.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-538.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Fileless Reconnaissance of Outlook Folder data\"  was generated for powershell.exe interacting with Outlook.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4319.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) called \"Suspicious loading of Outlook .NET assembly\"  was generated for powershell.exe interacting with an Outlook DLL.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4319.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell collecting emails.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4315.png"}, {"ScreenshotName": "Carbon Black-APT29-4322.png"}], "Score": 17}], "Step score": 187}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Email Collection\" was generated when powershell.exe loaded an Outlook DLL.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "psemail scriptblock with enrichments", "ScreenshotName": "CyCraft-APT29-2478.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Email Collection\" was received that included a PowerShell script and explained that it was used to obtain the collect emails.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "17.A.1 - MDR Report Day 2, summary and psemail", "ScreenshotName": "CyCraft-APT29-2479.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Email Collection\" was generated due to PowerShell copying the HTML file. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11453.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of email collection.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12730.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11445.png"}], "Score": 10}], "Step score": 152}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3930.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1114\" occurred containing evidence of Outlook process being started from the parent process \u201csvchost.exe\u201d along with the function definition for \"psemail\".", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - outlook access and SBL", "ScreenshotName": "SentinelOne-APT29-12883.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A1 - outlook.exe spawning from svchost.exe(OSParent name)/powershell(Parent name)", "ScreenshotName": "SentinelOne-APT29-6925.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell enumerating Outlook emails via COM.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13787.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7147.png"}, {"ScreenshotName": "SecureWorks-APT29-7146.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Email Collection", "Steps count": 1, "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}]}, "T1115": {"Steps": {"7.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for \"ATT&CK T1115 Clipboard Data\" was generated for powershell.exe calling the NtUserGetClipboardData API. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "clipboard collection alert and enrichment based on api call", "ScreenshotName": "Elastic-APT29-1272.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe calling the NtUserGetClipboardData API. The detection was correlated to a parent alert for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "clipboard collection alert and enrichment based on api call", "ScreenshotName": "Elastic-APT29-1272.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"clipboard data accessed\" was generated due to the use of getclipboarddata API.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2964.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2965.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13217.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Clipboard.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 7.A", "ScreenshotName": "FireEye-APT29-13000.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "7.A.2 - Script block for Get-Clipboard", "ScreenshotName": "FireEye-APT29-11103.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"ClipboardAction\" was generated due to a process collecting Windows clipboard data. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-732.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_Clipboard_Execution_MITRET1115\" was generated due to a PowerShell payload containing Get-Clipboard.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11941.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing Get-Clipboard and Get-Keystrokes executing.", "ScreenshotName": "CrowdStrike-APT29-10413.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Clipboard Data\" was received for PowerShell executing \"Get-Clipboard\" to retrieve clipboard contents.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Clipboard Data", "ScreenshotName": "Symantec-APT29-12933.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Captured clipboard contents using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "get-clipboard ", "ScreenshotName": "F-Secure-APT29-10091.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection mapped to \"T1115\"(Clipboard Data) was generated due to powershell.exe executing Get-Clipboard.\n", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11932.png"}, {"ScreenshotName": "TrendMicro-APT29-11934.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-269.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Collection was generated containing evidence that a malicious PowerShell script was executed capturing clipboard information.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-417.png"}, {"ScreenshotName": "Microsoft-APT29-416.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-408.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"AMSI - Clipboard Monitoring\" was generated for fileless_scriptload of Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4011.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12757.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4012.png"}], "Score": 17}], "Step score": 159}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Get-Clipboard with enrichments", "ScreenshotName": "CyCraft-APT29-14850.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred containing evidence of a PowerShell script used to gather information from the clipboard.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "7.A.2 - MDR Report Day 1, Clipboard Data", "ScreenshotName": "CyCraft-APT29-12448.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) called \"Get-ClipboardContents\" was generated due to powershell.exe executing Get-Clipboard.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4133.png"}], "Score": 58}], "Step score": 58}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ClipBoardAccess\" was generated due to PowerShell executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - A2/3 - Alerts for Clipboard Access", "ScreenshotName": "SentinelOne-APT29-7216.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A2 - Powershell calling Get-Clipboard", "ScreenshotName": "SentinelOne-APT29-7206.png"}], "Score": 10}], "Step score": 75}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Collection - Clipboard Data\" occurred containing evidence of powershell.exe executing Get-Clipboard.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12609.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6667.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Clipboard Data", "Steps count": 1, "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}]}, "T1078": {"Steps": {"8.C.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "admin logons - 8c1 tele", "ScreenshotName": "Elastic-APT29-1315.png"}], "Score": 10}], "Step score": 10}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the successful logon of Pam on Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.C", "ScreenshotName": "FireEye-APT29-13013.png"}, {"ScreenshotCaption": "MSSP - 8.C", "ScreenshotName": "FireEye-APT29-13008.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed an account logged on to Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8.C.1 - Account logged on to Scranton (10.0.1.4) as user Pam.", "ScreenshotName": "FireEye-APT29-11202.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1731.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11982.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.\t", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing valid logon on Scranton (10.0.1.4) as user Pam.", "ScreenshotName": "CrowdStrike-APT29-10476.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam. The detection was correlated to a parent alert for malicious PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "8.c.1 - process tree for logon session", "ScreenshotName": "Cybereason-APT29-9641.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: PSExec for lateral movement", "ScreenshotName": "Symantec-APT29-12942.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PsExec64.exe executing python.exe with pam's login credentials on Scranton. A Kerberos ticket was generated on Scranton for pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8c1 - telemetry of pam login", "ScreenshotName": "Symantec-APT29-17670.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 8C1", "ScreenshotName": "Kaspersky-APT29-18003.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Seeing event 4624 in windows event log", "ScreenshotName": "Kaspersky-APT29-2891.png"}, {"ScreenshotCaption": "8C3 - vendor provided screenshot, use this", "ScreenshotName": "Kaspersky-APT29-13410.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}, {"ScreenshotCaption": "MSSP - command line arg for lateral movement via psexec", "ScreenshotName": "F-Secure-APT29-11295.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4624 logon events of pam on scranton", "ScreenshotName": "F-Secure-APT29-10125.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"ATT&CK T1078 Windows Logon Success\" was generated due to a valid logon on Scranton (10.0.1.4) as user Pam. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11972.png"}, {"ScreenshotName": "TrendMicro-APT29-11971.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-141.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-629.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the analyst was able to query to get a list of users logged on to remote host Scranton (10.0.1.4).", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4056.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) was generated showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Remote Logon from Nashua to Scranton as Pam within proper timestamp", "ScreenshotName": "CyCraft-APT29-2253.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Valid Accounts\" was received that showed execution of PSExec64.exe using Pam's valid credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "8.C.1, 8.C.3 - MDR Report Day 1, PSExec64 execution", "ScreenshotName": "CyCraft-APT29-12455.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of Pam successfully logging on to Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12747.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"Logon Event Detected\" was generated due to the user Pam logging on to Scranton (10.0.1.4).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3624.png"}, {"ScreenshotName": "HanSight-APT29-3627.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection \"UserLogin\" under \"Valid Accounts {T1078}\" showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "8.C.1 - Valid Accounts for pam login", "ScreenshotName": "SentinelOne-APT29-17872.png"}], "Score": 65}], "Step score": 65}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13751.png"}], "Score": 10}], "Step score": 10}}, "16.C.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "remote logon event of mscott onto new york", "ScreenshotName": "Elastic-APT29-1525.png"}], "Score": 10}], "Step score": 10}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3302.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3300.png"}], "Score": 10}], "Step score": 10}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 16.C", "ScreenshotName": "FireEye-APT29-13040.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "16.C.2 - Logon Tracker showing the mscott logon to NewYork (10.0.0.4)", "ScreenshotName": "FireEye-APT29-11549.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1871.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "An MSSP detection for \"Lateral Movement\" occurred containing evidence of logon for user MScott on NewYork through additional analysis.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12925.png"}, {"ScreenshotName": "Cylance-APT29-13187.png"}], "Score": 70}, {"DetectionNote": "No detection capability demonstrated for this procedure, though Host Interrogation was used to pull logon event logs.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12311.png"}], "Score": 3}], "Step score": 73}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell connecting to NewYork (10.0.0.4) on port 5985. Telemetry showing a successful logon on NewYork as MScott.", "ScreenshotName": "CrowdStrike-APT29-10679.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for Valid Accounts occurred containing evidence of the Successful logon on NewYork as user MScott.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - mscott logging onto newYork via winRM", "ScreenshotName": "Cybereason-APT29-10803.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "16.c.2 - details for 1 logon session", "ScreenshotName": "Cybereason-APT29-9782.png"}, {"ScreenshotCaption": "16.c.2 - user details", "ScreenshotName": "Cybereason-APT29-9783.png"}], "Score": 10}], "Step score": 80}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed wsmprovhost.exe successfully executing a program as user MScott, indicating that a valid user session was created through WinRM.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Shows the user context for the file copy and execution of m.exe using mscott", "ScreenshotName": "Symantec-APT29-9778.png"}, {"ScreenshotCaption": "m.exe injected into lsass.exe, tagged with Credential Dumping", "ScreenshotName": "Symantec-APT29-9787.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.c.1-2 MSSP report", "ScreenshotName": "Kaspersky-APT29-12408.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3246.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of lateral movement from utica to new york as the user mscott.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - winrmsession raw function", "ScreenshotName": "F-Secure-APT29-11317.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "logon events ", "ScreenshotName": "F-Secure-APT29-10423.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Windows Logon Success\" was generated for the successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12134.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for valid MScott credentials being used to logon to NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 140}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-192.png"}, {"ScreenshotName": "ReaQta-APT29-191.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-532.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the analyst was able to query the DC to get a list of users logged on.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4300.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) was generated for the successful logon event  on NewYork (10.0.0.4) as user MScott.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: Remote Logon from powershell", "ScreenshotName": "CyCraft-APT29-2362.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Valid Accounts\" was received that described the adversary establishing a WinRM session with MScott's credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.A.1 - MDR Report Day 2, summary & Get-NetDomainController", "ScreenshotName": "CyCraft-APT29-12506.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the successful logon on NewYork (10.0.0.4) as user mscott. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12729.png"}, {"ScreenshotName": "GoSecure-APT29-12728.png"}, {"ScreenshotName": "GoSecure-APT29-12727.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"Logon Event Detected\" was generated due to a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3899.png"}], "Score": 65}], "Step score": 65}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"UserLogin\" was generated when valid user MScott was used to log onto NewYork (10.0.0.4).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "C2 - UserLogin Alert generated", "ScreenshotName": "SentinelOne-APT29-6915.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1078\" occurred containing evidence of process wsmprovhost.exe creation by mscott on remote host proving valid logon.\n", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - login justification", "ScreenshotName": "SentinelOne-APT29-12880.png"}], "Score": 70}], "Step score": 135}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Privilege Escalation- Valid Accounts\" occurred containing evidence of PowerShell executing the PowerShell Invoke-Command WinRM cmdlet with valid credentials then logging onto the remote host NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13782.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7143.png"}, {"ScreenshotName": "SecureWorks-APT29-7118.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Valid Accounts", "Steps count": 2, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1059": {"Steps": {"1.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for a \"Suspicious Parent of Built-in Shells.\" The detection was correlated to a parent alert for malicious file execution. ", "Detect": "General-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "cc (strictness modification) suspicious parent of built-in shells alert", "ScreenshotName": "Elastic-APT29-1674.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed rcs.3aka.doc spawning cmd.exe. The telemetry was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Elastic-APT29-1189.png"}], "Score": 17}], "Step score": 52}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for a command line interface spawned from a process identified as malware with an active network connection.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14274.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14271.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for Command Line Interfaces \"(T1059)\" occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13201.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2666.png"}], "Score": 17}], "Step score": 152}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"CMD Execution\" was generated due to cmd.exe spawning from rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.B.1 - CMD Execution from parent rcs.3aka3.doc (bottom)", "ScreenshotName": "FireEye-APT29-10857.png"}, {"ScreenshotCaption": "1.B.1 - CMD Execution from parent rcs.3aka3.doc (top)", "ScreenshotName": "FireEye-APT29-10856.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 1.B", "ScreenshotName": "FireEye-APT29-12978.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe\u200b. This was correlated to a parent alert on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "1.B.1 - Triage view of cmd.exe from rcs.3aka3.doc", "ScreenshotName": "FireEye-APT29-10861.png"}], "Score": 17}], "Step score": 152}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13416.png"}, {"ScreenshotName": "Bitdefender-APT29-651.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning cmd.exe. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1436.png"}, {"ScreenshotName": "McAfee-APT29-1429.png"}, {"ScreenshotName": "McAfee-APT29-1425.png"}], "Score": 17}], "Step score": 17}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12895.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11827.png"}, {"ScreenshotName": "Cylance-APT29-11830.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Process tree showing rcs.3aka3.doc\u200b spawning cmd.exe.", "ScreenshotName": "CrowdStrike-APT29-10196.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - b1, b2", "ScreenshotName": "Cybereason-APT29-10771.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "1.b.1 - payload spawns cmd.exe (process tree) telemetry", "ScreenshotName": "Cybereason-APT29-7351.png"}], "Score": 17}], "Step score": 87}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc executing cmd.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "list of execution events related to doc execution", "ScreenshotName": "Symantec-APT29-7357.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called  \"Command Line Interface\" was generated due to cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2636.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of rcs.3aka3.doc\u200b spawning cmd.exe", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 1b1", "ScreenshotName": "Kaspersky-APT29-17987.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2636.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Spawned interactive cmd.exe", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection for an anomalous script occurred containing evidence of cmd spawning from rcs.3aka3.doc\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - cmd launched (not sure its close enough to what we are looking for)", "ScreenshotName": "F-Secure-APT29-11252.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for Abnormal File Modification.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "cmd parent to powershel, 3aka3 spawning cmd.", "ScreenshotName": "F-Secure-APT29-10004.png"}, {"ScreenshotCaption": "process tree with cmd.exe", "ScreenshotName": "F-Secure-APT29-9996.png"}], "Score": 17}], "Step score": 87}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14004.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11836.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-24.png"}], "Score": 17}], "Step score": 17}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. This event was correlated to a Technique detection for masquerading.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13975.png"}, {"ScreenshotName": "Microsoft-APT29-13974.png"}], "Score": 17}], "Step score": 17}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3724.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A Tactic alert detection (yellow indicator) for \"Execution\" was generated for cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "cmd.exe running from doc file", "ScreenshotName": "CyCraft-APT29-2201.png"}, {"ScreenshotCaption": "command execution", "ScreenshotName": "CyCraft-APT29-2200.png"}], "Score": 52}, {"DetectionNote": "An MSSP detection for was received that included a description of rcs.3aka3.doc spawning cmd.exe interactively.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.B.1, 1.B.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-11805.png"}, {"ScreenshotCaption": "1.B.1, 1.B.2 - MDR Report Day 1 (2)", "ScreenshotName": "CyCraft-APT29-11806.png"}], "Score": 70}], "Step score": 122}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Command-Line Interface\" was generated due to cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for rcs.3aka3.doc spawning explorer.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10820.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10827.png"}], "Score": 10}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The telemetry was correlated to a parent detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Telemetry showing cmd.exe spawning from rcs.3aka3.doc.", "ScreenshotName": "MalwareBytes-APT29-2588.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (reminder severity) called \"CommandLine Interface\" was generated due to execution of cmd.exe by rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3441.png"}, {"ScreenshotName": "HanSight-APT29-3443.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for rcs.3aka3.doc\u200b spawning cmd.exe.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "1.B.1 - rcs.3aka3.doc executing cmd.exe", "ScreenshotName": "SentinelOne-APT29-17871.png"}], "Score": 52}, {"DetectionNote": "An MSSP detection for \u201cT1059\u201d contained evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "B1/2 - MSSP - Command-line interface/powershell", "ScreenshotName": "SentinelOne-APT29-12794.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b.The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Detailed view of B1/2", "ScreenshotName": "SentinelOne-APT29-16471.png"}], "Score": 17}], "Step score": 139}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Screensaver file launches shell\" was generated due to cmd.exe spawning from rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7196.png"}, {"ScreenshotName": "SecureWorks-APT29-7198.png"}, {"ScreenshotName": "SecureWorks-APT29-6504.png"}, {"ScreenshotName": "SecureWorks-APT29-7197.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12782.png"}, {"ScreenshotName": "SecureWorks-APT29-12782.png"}, {"ScreenshotName": "SecureWorks-APT29-12582.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7213.png"}], "Score": 10}], "Step score": 145}}}, "TechniqueName": "Command-Line Interface", "Steps count": 1, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}]}, "T1112": {"Steps": {"3.C.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell command to remove DelegateExecute Registry Value.  The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "file deletion  of the registry path from powershell", "ScreenshotName": "Elastic-APT29-1211.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Modify Registry \"(T1070)\" occurred for the Deletion of the registry value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13198.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2768.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for the Deletion of the registry value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 3.C", "ScreenshotName": "FireEye-APT29-12986.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. This was correlated with a prior detection of the PowerShell parent process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "3.C.1 - Triage view of Remove-Item", "ScreenshotName": "FireEye-APT29-10960.png"}], "Score": 17}], "Step score": 87}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the command subkey.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1085.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell command to remove the DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11892.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the command subkey. The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe deleting the command subkey.", "ScreenshotName": "CrowdStrike-APT29-10282.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the command subkey.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe deleting registry key. Event in question is at the top", "ScreenshotName": "Symantec-APT29-9919.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the recursive deletion of the registry key.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - remove item", "ScreenshotName": "F-Secure-APT29-11275.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell command to remove DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17351.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for the deletion of the the command subkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11870.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the command Registry subkey.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-65.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Defense Evasion was generated containing evidence of the deletion of registry key.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-386.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell command to remove DelegateExecute Registry Value. This event was correlated to a previous detection for PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13983.png"}], "Score": 17}], "Step score": 87}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3854.png"}, {"ScreenshotName": "Carbon Black-APT29-3851.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell command to remove DelegateExecute Registry Value. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "Threat Activity - Remove registry key through PowerShell scriptblock logging", "ScreenshotName": "CyCraft-APT29-2213.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Modify Registry\" was received that included a PowerShell script and explained that it was used to delete previously created registry keys.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "3.B.1 - Modify Registry, deleting key", "ScreenshotName": "CyCraft-APT29-12437.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the command subkey.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10862.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed deletion of HKCU\\Software\\Classes\\Folder\\shell\\Open\\command value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3500.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1112\" occurred containing evidence of command subkey being removed from the Registry.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1 - removal of subkey", "ScreenshotName": "SentinelOne-APT29-12808.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "C1 - Shows powershell command used to remove the regkey via TrueContext or UID", "ScreenshotName": "SentinelOne-APT29-6520.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Defense Evasion - Modify Registry\" occurred containing evidence of the deletion of the subkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12594.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell command to remove the DelegateExecute Registry Value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6618.png"}], "Score": 10}], "Step score": 80}}, "14.A.3": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the system was interrogated and the Registry key could not be found indicating it had been deleted, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "endgame client reg delete maybe??", "ScreenshotName": "Elastic-APT29-13682.png"}], "Score": 3}], "Step score": 3}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3187.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3186.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the deletion of the command subkey Registry value. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.A", "ScreenshotName": "FireEye-APT29-13033.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell command to delete the Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "14.A.3 - Script block for Remove-Item on Registry", "ScreenshotName": "FireEye-APT29-11456.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the Registry value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-884.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell command to delete the Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12077.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe calling the bypass function.", "ScreenshotName": "CrowdStrike-APT29-10619.png"}, {"ScreenshotCaption": "Telemetry showing the powershell script block for the bypass function.", "ScreenshotName": "CrowdStrike-APT29-10627.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Modify Registry\" was received that included a PowerShell command executed by the adversary and explained that it was used to delete the Registry Key.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: UAC Bypass techniques and description", "ScreenshotName": "Symantec-APT29-12963.png"}, {"ScreenshotCaption": "MSSP Day 1: UAC Bypass details", "ScreenshotName": "Symantec-APT29-12964.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the Registry value.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe deleted registry key", "ScreenshotName": "Symantec-APT29-9871.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the deletion of the Registry value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - raw function", "ScreenshotName": "F-Secure-APT29-11313.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}], "Score": 70}], "Step score": 70}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell removing the Registry value. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12098.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the Registry value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-179.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the Registry value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-504.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the deletion of the DelegateExecute Registry value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12767.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4207.png"}, {"ScreenshotName": "Carbon Black-APT29-4205.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection was received that included a PowerShell script and explained that it was used to clean the Registry after a UAC Bypass.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.A.2 - MDR Report Day 2, UAC bypass", "ScreenshotName": "CyCraft-APT29-12498.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called \"Registry key deleted\" was generated due to the deletion of the Registry value. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11397.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed the deletion of the Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11397.png"}], "Score": 10}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the deletion of the Registry value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3786.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1112\" occurred containing evidence of \"bypass\" function definition removing Registry subkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - HI PowerShell, SBL", "ScreenshotName": "SentinelOne-APT29-12863.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe deleting the command subkey. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A1/3 - Powershell alert of bypass function containing add and delete", "ScreenshotName": "SentinelOne-APT29-7254.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Defense Evasion - Modify Registry\" occurred containing evidence of deletion of Registry value using Remote-Item.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12651.png"}, {"ScreenshotName": "SecureWorks-APT29-12785.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the deletion of the DelegateExecute subkey.\t\n", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7056.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Modify Registry", "Steps count": 2, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1113": {"Steps": {"7.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for \"Screen Capture\" was generated for powershell.exe calling the NtGdiCreateCompatibleBitmap API. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - not new rule, just updated blacklist  to show screen cap alert enrichment is same logic (some enrichments would be tagged as alert)", "ScreenshotName": "Elastic-APT29-13630.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "7A1 - vendor pic for Telem ", "ScreenshotName": "Elastic-APT29-14951.png"}], "Score": 17}], "Step score": 82}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Screen Capture - T1056\" was generated for powershell.exe making the GdiBitBlt API call. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2969.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2967.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing performing a Screen Capture.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13217.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell System.Drawing Load\" was generated due to powershell.exe loading System.Drawing.ni.dll, indicating possible Screen Capture.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 7.A.1 - PowerShell System.Drawing Load", "ScreenshotName": "FireEye-APT29-11725.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Invoke-ScreenCapture to capture screen shots.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 7.A", "ScreenshotName": "FireEye-APT29-13000.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "7.A.1 - Script block for CopyFromScreen", "ScreenshotName": "FireEye-APT29-11113.png"}, {"ScreenshotCaption": "7.A.1 - powershell.exe loading System.Drawing.ni.dll", "ScreenshotName": "FireEye-APT29-11112.png"}], "Score": 10}], "Step score": 138}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) was generated for PowerShell being used to take a screenshot. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13429.png"}, {"ScreenshotName": "Bitdefender-APT29-13430.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 68}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12249.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe triggered a ScreenshotTakenETW event. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe caused a ScreenshotTakenEtw event.", "ScreenshotName": "CrowdStrike-APT29-10405.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Screen Capture\" was received that included details about a PowerShell script used to collect screenshots.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: psversion.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12930.png"}, {"ScreenshotCaption": "MSSP Day 1: Screen Capture description", "ScreenshotName": "Symantec-APT29-12932.png"}, {"ScreenshotCaption": "MSSP Day 1: Screen Capture Technique", "ScreenshotName": "Symantec-APT29-12931.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell loading .Net assemblies to capture screenshots.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 7a1", "ScreenshotName": "Kaspersky-APT29-17998.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Captured and saved screenshots using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell taking screenshots.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - invoke screen capture (a1)", "ScreenshotName": "F-Secure-APT29-11283.png"}, {"ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2", "ScreenshotName": "F-Secure-APT29-11301.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "CopyFromScreen", "ScreenshotName": "F-Secure-APT29-10630.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"PS1.ScreenCapture T1113\" was generated due to CopyFromScreen API execution.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11931.png"}], "Score": 60}], "Step score": 60}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-265.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Collection was generated containing evidence that a malicious PowerShell script was executed capturing current screen state.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-416.png"}, {"ScreenshotName": "Microsoft-APT29-417.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13994.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator)  called \"Screen Capture using Powershell\" was generated for a powershell.exe modload for gdiplus.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4004.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection was generated containing evidence of PowerShell capturing screenshots.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12757.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4007.png"}], "Score": 17}], "Step score": 159}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for suspicious threat activity for PowerShell calling CopyFromScreen.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier raw data: Threat Activity alert for PowerShell script that ran collection. All three types", "ScreenshotName": "CyCraft-APT29-2137.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Screen Capture\" occurred containing evidence of screen capture.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "7.A.1 - MDR Report Day 1, Screen Capture (2)", "ScreenshotName": "CyCraft-APT29-12446.png"}, {"ScreenshotCaption": "7.A.1 - MDR Report Day 1, Screen Capture (1)", "ScreenshotName": "CyCraft-APT29-12447.png"}, {"ScreenshotCaption": "7.A.1 - MDR Report Day 1, Screen Capture (3)", "ScreenshotName": "CyCraft-APT29-12449.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called Screen Capture was generated due to the load of System.Drawing.dll.", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11697.png"}], "Score": 53}, {"DetectionNote": "Telemetry showed powershell.exe loading the System.Drawing.dll.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11697.png"}], "Score": 3}], "Step score": 56}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3569.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Screenshot\" generated due to CopyFromScreen API execution. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - A1 - Screencapture alert generated", "ScreenshotName": "SentinelOne-APT29-7239.png"}, {"ScreenshotCaption": "CC - A1 - Invoke-Screencapture powershell function call", "ScreenshotName": "SentinelOne-APT29-7238.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1113\" occurred containing evidence of System.Drawing.dll being loaded and Invoke-ScreenCapture called.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1 - SBL of invoke-screencapture", "ScreenshotName": "SentinelOne-APT29-12825.png"}, {"ScreenshotCaption": "MSSP - A1 - system.drawing.dll loading", "ScreenshotName": "SentinelOne-APT29-12824.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A1 - CopyFromScreen in script block", "ScreenshotName": "SentinelOne-APT29-7219.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Collection - Screen Capture\"  occurred showing evidence of a PowerShell script attempting to take screenshots.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12608.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13747.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Screen Capture", "Steps count": 1, "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}]}, "T1041": {"Steps": {"2.B.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port TCP 1234).", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "cc ntcreatefile api call (new monitoring) showing the read of draft.zip", "ScreenshotName": "Elastic-APT29-1697.png"}, {"ScreenshotCaption": "double check to make sure i got network connection info. ", "ScreenshotName": "Elastic-APT29-1177.png"}], "Score": 3}], "Step score": 3}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Exfiltration Over Command and Control Channel \"(T1041)\" occurred containing evidence that \"After the zip file is created, it\u2019s read by \u200bcod.3aka3.scr... [and] the timeline view shows a C2 connection from \u200bnashua \u200bto \u200b192.168.0.5,\u200b in which cod.3aka3.scr s\u200bent 319,936 Bytes.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13203.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2651.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2699.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-655.png"}, {"ScreenshotName": "Bitdefender-APT29-658.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "ScreenshotName": "CrowdStrike-APT29-10192.png"}, {"ScreenshotCaption": "Telemetry correlating the draft.zip file read to rcs.3aka3.doc.", "ScreenshotName": "CrowdStrike-APT29-10254.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "2b1 - draft.zip - vendor provided pic", "ScreenshotName": "Cybereason-APT29-13667.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed file accessed event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11847.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over TCP port 1234).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11676.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1041\" containing evidence of a cod.3aka3.scr reading Draft.zip and a network connection to C2 (192.168.0.5).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "B1 - MSSP - file read + network connection", "ScreenshotName": "SentinelOne-APT29-12800.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "2.B.1 - rcs.3aka3.doc network connection", "ScreenshotName": "SentinelOne-APT29-14572.png"}, {"ScreenshotCaption": "2.B.1 - rcs.3aka3.doc opening Draft.zip", "ScreenshotName": "SentinelOne-APT29-14571.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "9.B.8": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over TCP port 8443).  This event was correlated to a General detection for the execution of a malicious file (python.exe).", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "port 8443 connection ", "ScreenshotName": "Elastic-APT29-13617.png"}], "Score": 10}], "Step score": 10}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3057.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3058.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed python.exe reading working.zip and an existing C2 channel (192.168.0.4 over port 8443).", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1077.png"}, {"ScreenshotName": "Bitdefender-APT29-1078.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed python.exe reading working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9b8 - vendor provided pic", "ScreenshotName": "Cybereason-APT29-13668.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed a connection to TCP port 8443.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "port 8443 for 9b8", "ScreenshotName": "F-Secure-APT29-10143.png"}], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for service execution on python.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12010.png"}, {"ScreenshotName": "TrendMicro-APT29-12012.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of python.exe reading working.zip with established network connection to TCP port 8443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12704.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1041\" occurred containing evidence of the C2 instance of Python.exe being observed establishing a network connection to 192.168.0.4 on port 8443 (https). ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B8 - network connection", "ScreenshotName": "SentinelOne-APT29-13193.png"}, {"ScreenshotCaption": "MSSP - B5/6 - file creation event", "ScreenshotName": "SentinelOne-APT29-12839.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over TCP port 8443).", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B8 - Python.exe opening working.zip", "ScreenshotName": "SentinelOne-APT29-7242.png"}, {"ScreenshotCaption": "B8 - Python connecting to 192.168.0.4 over 8443", "ScreenshotName": "SentinelOne-APT29-6748.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Exfiltration Over Command and Control Channel", "Steps count": 2, "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}]}, "T1136": {"Steps": {"20.B.3": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"User Account Creation\" was generated for the addition of the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "user account creation alert with command line", "ScreenshotName": "Elastic-APT29-1625.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "user account creation alert with command line", "ScreenshotName": "Elastic-APT29-1625.png"}], "Score": 10}], "Step score": 75}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"created account T1136\" (high severity) was generated for net.exe with the command-line arguments to add the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3348.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3349.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13261.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3350.png"}], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Net User Add\" was generated for net.exe with the command-line arguments to add the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.B.3 - Net User Add for net user add with password redacted", "ScreenshotName": "FireEye-APT29-11694.png"}], "Score": 65}, {"DetectionNote": "A General alert detection called WinRM process activity was generated for for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "20.B.3 - WinRM Process Activity for net user add with password redacted", "ScreenshotName": "FireEye-APT29-11693.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for the creation of the user Toby on Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 20.B", "ScreenshotName": "FireEye-APT29-13057.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 180}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for local account creation using net.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1050.png"}], "Score": 65}, {"DetectionNote": "A Technique alert was generated for the net.exe process being used to create a new user. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1051.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1049.png"}], "Score": 10}], "Step score": 140}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Create Account\" was generated for the addition of the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1923.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed addition of the new user Toby based on Windows Event ID 4720.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1923.png"}, {"ScreenshotName": "McAfee-APT29-1924.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_CreateAccount_Mitre1136\" was generated for the addition of the new user Toby based on Windows Event ID 4720.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12183.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the PowerShell command to add the new User Toby to the remote host Scranton (10.0.1.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12182.png"}], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (purple hexagon) called \u201cCreate Account\u201d was generated for the addition of the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCreate Account\u201d for a user creating a new user account. A Technique detection called \u201cCreate Account\u201d for WinRM executing a file to create an account.", "ScreenshotName": "CrowdStrike-APT29-10748.png"}], "Score": 65}, {"DetectionNote": "A Technique detection called \u201cGenericCreateAccountPersistence\u201d was generated for the addition of the new user Toby.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cGenericCreateAccountPersistence\u201d for account creation of Toby on Scranton via Invoke-Command.", "ScreenshotName": "CrowdStrike-APT29-10747.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe to add a user.", "ScreenshotName": "CrowdStrike-APT29-10752.png"}], "Score": 10}], "Step score": 135}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection called \"net.exe is used to create a user or add a user to a group\" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "20.b.3 - commandline with new user created by net.exe", "ScreenshotName": "Cybereason-APT29-9849.png"}, {"ScreenshotCaption": "20.b.3 - evidence from net.exe ", "ScreenshotName": "Cybereason-APT29-9848.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "20.b.3 - commandline with new user created by net.exe", "ScreenshotName": "Cybereason-APT29-9849.png"}], "Score": 17}], "Step score": 89}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Create Account\" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "wsmprovhost.exe executed net.exe on scranton to add user toby", "ScreenshotName": "Symantec-APT29-9862.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "wsmprovhost.exe executed net.exe on scranton to add user toby", "ScreenshotName": "Symantec-APT29-9862.png"}], "Score": 10}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 20b3", "ScreenshotName": "Kaspersky-APT29-18023.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for net_user_add was generated due to net.exe being used to add a user account.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "3 - net exe detection with toby cmd line args", "ScreenshotName": "F-Secure-APT29-10530.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of new user \"Toby\" being created with net.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - invoke mimikatz and toby useradd", "ScreenshotName": "F-Secure-APT29-11323.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the user Toby being created on the scranton host. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "user create", "ScreenshotName": "F-Secure-APT29-10541.png"}], "Score": 10}], "Step score": 145}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Create Account\" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17580.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for a new user Toby being created. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17582.png"}], "Score": 10}], "Step score": 145}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (blue indicator) called \"Create Account\" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-224.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Lateral Movement was generated containing evidence a new user was created on Scranton with name 'toby'.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1151.png"}, {"ScreenshotName": "Microsoft-APT29-1152.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed addition of the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-553.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for the creation of a local user with Net.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13965.png"}, {"ScreenshotName": "Carbon Black-APT29-13966.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) was generated for a process spawned from PowerShell remoting (WinRM).", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13965.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell adding new user to the remote host Scranton (10.0.1.4) using net.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell command to add the new User Toby to the remote host Scranton (10.0.1.4). Telemetry also subsequently showed wsmprovhost.exe spawning net.exe with the command-line arguments. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4395.png"}, {"ScreenshotName": "Carbon Black-APT29-4388.png"}, {"ScreenshotName": "Carbon Black-APT29-4396.png"}], "Score": 17}], "Step score": 187}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) for \"Account Operation\" was generated for the addition of the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "New account creation with enrichments", "ScreenshotName": "CyCraft-APT29-2501.png"}, {"ScreenshotCaption": "net.exe with parent process of wsmprovhost.exe and enrichments", "ScreenshotName": "CyCraft-APT29-2500.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (orange indicator) for \"Create Account\" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for creation of a Windows Remote Management session.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "net.exe with parent process of wsmprovhost.exe and enrichments", "ScreenshotName": "CyCraft-APT29-2500.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"Create Account\" was received that described the attacker creating a new account on host Scranton (10.0.1.4) for persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.B.1 - MDR Report Day 2, pass the ticket, enter-pssession, account creation", "ScreenshotName": "CyCraft-APT29-12523.png"}], "Score": 70}], "Step score": 207}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Create Account (Net Use Command)\" was generated for net.exe with the command-line arguments to add the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11551.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11551.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection for account creation was generated for net.exe executing with the command-line arguments to add the new user Toby.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Account creation", "ScreenshotName": "MalwareBytes-APT29-2581.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Create Account\" was generated for net.exe with the command-line arguments to add the new user Toby.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3995.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (warning severity) called \"New User Account Creation via Snapshot\" was generated due to comparison of existing user accounts between snapshots taken of system account information.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3992.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (warning severity) was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3987.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 175}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1136\" occurred containing evidence of Invoke-Command with command-line arguments adding the user Toby.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - PS-session + user add", "ScreenshotName": "SentinelOne-APT29-12894.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net1.exe with the command-line arguments to add the new user Toby.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "B3 - net1.exe creating user toby", "ScreenshotName": "SentinelOne-APT29-7041.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) was generated for an account creation.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13795.png"}, {"ScreenshotName": "SecureWorks-APT29-13796.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (low severity) called \"Suspicious WinRM Remote PowerShell Net Process\" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7302.png"}, {"ScreenshotName": "SecureWorks-APT29-7303.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed addition of the new user Toby based on Windows Event ID 4720.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7308.png"}], "Score": 10}], "Step score": 110}}}, "TechniqueName": "Create Account", "Steps count": 1, "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}]}, "T1134": {"Steps": {"10.B.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed hostui.exe manipulating powershell.exe token via CreateProcessWithTokenW and that the authentication ID was that of explorer.exe. This event was correlated to a General detection for the execution of a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "hostui createprocesswithtokenW", "ScreenshotName": "Elastic-APT29-1345.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Access Token Manipulation\" was generated for thread impersonation.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3110.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3102.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3103.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13233.png"}], "Score": 70}], "Step score": 135}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) was generated for PowerShell being identified as having fake parent process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-791.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for a process created with CreateProcessWithToken.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-790.png"}, {"ScreenshotName": "Bitdefender-APT29-795.png"}], "Score": 65}], "Step score": 130}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Access Token Manipulation\" was generated for token stealing activity.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Technique detection for access token manipulation tied to the powershell.exe in process tree.", "ScreenshotName": "CrowdStrike-APT29-10557.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing with the same token (identified by the AuthenticationID) as explorer.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe executing with explorer.exe token.", "ScreenshotName": "CrowdStrike-APT29-10562.png"}], "Score": 10}], "Step score": 75}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called was generated for a mismatch between the parent and creator process on PowerShell.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "10.b.2 - evidence of powershell process", "ScreenshotName": "Cybereason-APT29-9675.png"}], "Score": 65}], "Step score": 65}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry shows powershell.exe's security_descriptor obtaining the same value as explorer.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "10b3 - telemetry on powershell security descriptor manipulation", "ScreenshotName": "Symantec-APT29-17702.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"Noteworthy Behavior T1134\" was generated for token manipulation with the low level ZwDuplicateToken (NtDuplicateToken) API, which is invoked by the CreateProcessWithToken API.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12039.png"}], "Score": 60}], "Step score": 60}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Access Token Manipulation\" was generated when hostui.exe created a powershell.exe process with the CreateProcessWithToken WinAPI function.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "hostui.exe executing from powershell.exe. Because token changed, got Access Token Manipulation enrichment", "ScreenshotName": "CyCraft-APT29-2269.png"}], "Score": 65}], "Step score": 65}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"TokenMismatch\" under \"Privilege Escalation {T1134}\" was generated when the parent process's, hostui.exe, token did not match the child token process's, powershell.exe, token. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B2/3 - hostui.exe executing powershell. Token mismatch alert", "ScreenshotName": "SentinelOne-APT29-6772.png"}], "Score": 72}], "Step score": 72}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Access Token Manipulation", "Steps count": 1, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1082": {"Steps": {"4.C.6": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection called \"Reconnaissance of Multiple WMI Classes\" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. ", "ScreenshotName": "Elastic-APT29-1237.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe executing $Gwmi Win32_OperatingSystem. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c4-6 script block event (same as above)", "ScreenshotName": "Elastic-APT29-1230.png"}, {"ScreenshotCaption": "os wmi event", "ScreenshotName": "Elastic-APT29-1234.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2838.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2870.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12992.png"}, {"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.6 - Script block for Gwmi Win32_OperatingSystem", "ScreenshotName": "FireEye-APT29-11021.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using Gwmi Win32_OperatingSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}, {"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated the OS version using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection for \"wmi-enumerating-os\" was generated due to a WMI query for OS version.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17678.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Gwmi Win32_OperatingSystem", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "wmi stuff (thp firewall, antivirus, os)", "ScreenshotName": "F-Secure-APT29-10061.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11876.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing\u200b Gwmi Win32_OperatingSystem. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-582.png"}, {"ScreenshotName": "Microsoft-APT29-13988.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to obtain the OS system information.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Get System Information\" was generated due to a suspicious process querying a WMI object.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3536.png"}, {"ScreenshotName": "HanSight-APT29-3532.png"}, {"ScreenshotName": "HanSight-APT29-3543.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3543.png"}, {"ScreenshotName": "HanSight-APT29-3532.png"}], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Local Environment Information Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "C6 - Local environment discovery via Win32_OperatingSystem discovery\n", "ScreenshotName": "SentinelOne-APT29-6535.png"}], "Score": 72}, {"DetectionNote": "A MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing Win32_OperatingSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C6 - Gwmi Win32_OperatingSystem\u200b", "ScreenshotName": "SentinelOne-APT29-12816.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing\u200b Gwmi Win32_OperatingSystem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) for System Information Discovery was generated for Powershell.exe executing Gwmi Win32_OperatingSystem.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13737.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Discovery - System Information Discovery\" occurred containing evidence of powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13738.png"}], "Score": 10}], "Step score": 145}}, "13.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "powershell cmdlet of getcomputernameex", "ScreenshotName": "Elastic-APT29-1404.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 13.A", "ScreenshotName": "FireEye-APT29-13031.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "13.A.1 - Script block for GetComputerNameEx API", "ScreenshotName": "FireEye-APT29-11429.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1931.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12288.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showed the powershell script block calling the GetComputerNameEx API.", "ScreenshotName": "CrowdStrike-APT29-10608.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection was generated for GetComputerNameEx being executed by powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "General-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "13.a.1 - malicious command alert for GetComputerNameEx (cc)", "ScreenshotName": "Cybereason-APT29-9928.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"System Information Discovery\" occurred containing evidence of the GetComputerNameEx API call.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - computername API", "ScreenshotName": "Cybereason-APT29-10791.png"}], "Score": 70}], "Step score": 105}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Information Discovery\" occurred containg evidence of PowerShell calling the GetComputerNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery techniques", "ScreenshotName": "Symantec-APT29-12960.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery script details", "ScreenshotName": "Symantec-APT29-12961.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "13.a.1 MSSP report", "ScreenshotName": "Kaspersky-APT29-12390.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 13a/b/c/d - function imports ", "ScreenshotName": "F-Secure-APT29-11312.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "API calls", "ScreenshotName": "F-Secure-APT29-10303.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Score": 3}], "Step score": 3}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-305.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for \"Suspicious Powershell commandline.\"", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-499.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-495.png"}, {"ScreenshotName": "Microsoft-APT29-494.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4182.png"}, {"ScreenshotName": "Carbon Black-APT29-13959.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated due to the execution of the comp function.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "GetComputerNameEx with enrichments", "ScreenshotName": "CyCraft-APT29-2441.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"System Information Discovery\" occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "13.A.1 - MDR Report Day 2, summary and GetComputerNameEx", "ScreenshotName": "CyCraft-APT29-12489.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3772.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1082\" occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1 - SBL", "ScreenshotName": "SentinelOne-APT29-12857.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A1 - GetComputerNameEx in powershell alert", "ScreenshotName": "SentinelOne-APT29-7248.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection  occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13771.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7033.png"}], "Score": 10}], "Step score": 80}}, "4.C.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c1-3 script block", "ScreenshotName": "Elastic-APT29-1229.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:COMPUTERNAME.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:COMPUTERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.3 - Script block for $env:COMPUTERNAME", "ScreenshotName": "FireEye-APT29-11017.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using $env:COMPUTERNAME.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}, {"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection for \"System Information Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the Computer Name.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}, {"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated the computer hostname using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "invoke-discovery", "ScreenshotName": "F-Secure-APT29-10062.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $env:COMPUTERNAME.\n\n", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $env:COMPUTERNAME. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13988.png"}, {"ScreenshotName": "Microsoft-APT29-581.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current computer name.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3532.png"}, {"ScreenshotName": "HanSight-APT29-3543.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $env:COMPUTERNAME usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1-5 - readme.ps1", "ScreenshotName": "SentinelOne-APT29-12815.png"}], "Score": 70}], "Step score": 70}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - System Information Discovery\" occurred containing evidence of powershell.exe executing: $env:COMPUTERNAME.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe executing: $env:COMPUTERNAME.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6627.png"}, {"ScreenshotName": "SecureWorks-APT29-6628.png"}], "Score": 10}], "Step score": 80}}, "11.A.4": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection for \"ATT&CK T1082 System Info Discovery\" was generated for powershell.exe querying Win32_ComputerSystem and Win32_BIOS.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "win32 computersystem wmi event  (sys info enrichment)", "ScreenshotName": "Elastic-APT29-1362.png"}], "Score": 60}, {"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\"  was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "alert for multiple wmi discovery techniques", "ScreenshotName": "Elastic-APT29-1364.png"}, {"ScreenshotCaption": "alert for multiple wmi discovery techniques", "ScreenshotName": "Elastic-APT29-1364.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "bios wmi event", "ScreenshotName": "Elastic-APT29-1358.png"}, {"ScreenshotCaption": "win32 computersystem wmi event", "ScreenshotName": "Elastic-APT29-1361.png"}], "Score": 10}], "Step score": 115}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3129.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13687.png"}], "Score": 10}], "Step score": 190}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}, {"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13024.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A - gwmi query for Win32_ComputerSystem", "ScreenshotName": "FireEye-APT29-11389.png"}, {"ScreenshotCaption": "11.A - gwmi query for Win32_BIOS", "ScreenshotName": "FireEye-APT29-11343.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for execution of a WMI system discovery command.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-811.png"}, {"ScreenshotName": "Bitdefender-APT29-809.png"}, {"ScreenshotName": "Bitdefender-APT29-798.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for getting the BIOS version via Windows Management Instrumentation.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1090.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 126}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) for WMI query operations via PowerShell was generated for a PowerShell gwmi query for Win32_BIOS.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12051.png"}], "Score": 45}, {"DetectionNote": "A Tactic alert detection (medium severity) for WMI query operations via PowerShell was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12054.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 100}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to collect information about the local system.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery Techniques", "ScreenshotName": "Symantec-APT29-12948.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery description", "ScreenshotName": "Symantec-APT29-12949.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a3 and 11a4", "ScreenshotName": "Kaspersky-APT29-18009.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process", "ScreenshotName": "F-Secure-APT29-11306.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a3-8 - thp - wmi stuff", "ScreenshotName": "F-Secure-APT29-10234.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_BIOS and Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-287.png"}, {"ScreenshotName": "ReaQta-APT29-289.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to check BIOS version and obtain system information.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1141.png"}, {"ScreenshotName": "Microsoft-APT29-1140.png"}, {"ScreenshotName": "Microsoft-APT29-1139.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-469.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4163.png"}, {"ScreenshotName": "Carbon Black-APT29-4165.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated identifying the PowerShell gwmi queries for Win32_ComputerSystem as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell wmi query of computersystem with enrichments", "ScreenshotName": "CyCraft-APT29-2421.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) was generated identifying the PowerShell gwmi query for Win32_BIOS as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell wmi query of computersystem with enrichments", "ScreenshotName": "CyCraft-APT29-2421.png"}, {"ScreenshotCaption": "Powershell wmi query of bios with enrichments", "ScreenshotName": "CyCraft-APT29-2419.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.4 - MDR Report Day 2, Win32_computersystem", "ScreenshotName": "CyCraft-APT29-12476.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 140}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Get System Information\" was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4210.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3721.png"}, {"ScreenshotName": "HanSight-APT29-3720.png"}], "Score": 10}], "Step score": 68}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection for \"Discovery\" was generated on a suspicious WMI query targeting Win32_BIOS and Win32_ComputerSystem.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "A3/4 - WMI win32_bios ", "ScreenshotName": "SentinelOne-APT29-6791.png"}, {"ScreenshotCaption": "A4/6/7 - WMI win32_computer system", "ScreenshotName": "SentinelOne-APT29-6793.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"T1082\" occurred containing evidence of WMI query targeting Win32_BIOS and Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - bios and computer system", "ScreenshotName": "SentinelOne-APT29-12844.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 125}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"WMI Queries Win32_Bios\" was generated due to PowerShell gwmi queries for Win32_BIOS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6934.png"}, {"ScreenshotName": "SecureWorks-APT29-6933.png"}, {"ScreenshotName": "SecureWorks-APT29-6931.png"}, {"ScreenshotName": "SecureWorks-APT29-6932.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (info severity) called \"WMI Queries Win32_ComputerSystem\" was generated due to PowerShell gwmi queries for Win32_ComputerSystem .", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6943.png"}, {"ScreenshotName": "SecureWorks-APT29-6944.png"}, {"ScreenshotName": "SecureWorks-APT29-6945.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Discovery - System Information Discovery\" occurred for the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13768.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17607.png"}, {"ScreenshotName": "SecureWorks-APT29-17610.png"}, {"ScreenshotName": "SecureWorks-APT29-17612.png"}, {"ScreenshotName": "SecureWorks-APT29-17611.png"}], "Score": 10}], "Step score": 210}}}, "TechniqueName": "System Information Discovery", "Steps count": 4, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1083": {"Steps": {"11.A.9": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "get item powershell cmdlet", "ScreenshotName": "Elastic-APT29-1367.png"}], "Score": 10}], "Step score": 10}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though events showed PowerShell executing the Get-Item cmdlet.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3394.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3395.png"}], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell query for current path: (Get-Item -Path \".\\\" -Verbose).FullName.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13024.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A.9 - Script block for Get-Item -Path \".\\\" -Verbose).FullName", "ScreenshotName": "FireEye-APT29-11393.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1095.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12283.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to perform discovery of the file and directory list from the local filesystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery Techniques", "ScreenshotName": "Symantec-APT29-12948.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery description", "ScreenshotName": "Symantec-APT29-12949.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Get-Item", "ScreenshotName": "F-Secure-APT29-10237.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection for \"ADS.Discover T1083\" was generated for PowerShell executing Get-Item from an Alternate Data Stream (ADS).", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12338.png"}], "Score": 53}], "Step score": 53}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-291.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to enumerate files and\ndirectories: (Get-Item -Path '.\\' -Verbose).FullName.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1139.png"}, {"ScreenshotName": "Microsoft-APT29-1141.png"}, {"ScreenshotName": "Microsoft-APT29-1140.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-470.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4168.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for PowerShell executing Get-Item for the current path.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: Powershell Get-Item for curent path", "ScreenshotName": "CyCraft-APT29-2285.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to to obtain the current path.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.9 - MDR Report Day 2, getting path", "ScreenshotName": "CyCraft-APT29-12479.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3736.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of File Enumeration relating to Get-Item function.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - SBL of all the above", "ScreenshotName": "SentinelOne-APT29-12846.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A9 - Get-Item-Path on generic powershell alert", "ScreenshotName": "SentinelOne-APT29-7244.png"}], "Score": 3}], "Step score": 73}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Discovery - File and Directory Discovery\" occurred for the PowerShell executing Get-Item to query the current path.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13768.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13765.png"}], "Score": 10}], "Step score": 80}}, "2.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "should be the same as the first screen, but showing script block again. ", "ScreenshotName": "Elastic-APT29-1198.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for PowerShell executing suspicious File and Directory Discovery commands. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14307.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14305.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for File and Directory Discovery \"(T1083)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13640.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 2.A", "ScreenshotName": "FireEye-APT29-12979.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "2.A - Get-ChildItem from PowerShell", "ScreenshotName": "FireEye-APT29-10881.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) was generated for PowerShell enumerating files and directories using environment variables. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1054.png"}, {"ScreenshotName": "Bitdefender-APT29-14019.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1118.png"}], "Score": 3}], "Step score": 68}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "An MSSP detection for \"Win_AutomatedCollection_DirScanART_MITRET1119\" occurred containing evidence of powershell.exe executing Get-ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12897.png"}, {"ScreenshotName": "Cylance-APT29-12898.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11837.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the Powershell script that was executed.  View in process explorer allows you to see that the script was executed from the Powershell process.", "ScreenshotName": "CrowdStrike-APT29-10208.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection was generated for powershell.exe executing Get-ChildItem.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "2.a.1/2 - get-ChildItem powershell (cc)", "ScreenshotName": "Cybereason-APT29-9952.png"}], "Score": 28}, {"DetectionNote": "A MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of a file event for powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)", "ScreenshotName": "Cybereason-APT29-10773.png"}], "Score": 70}], "Step score": 98}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Data from Local System\" contained evidence of PowerShell executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: automated file collection script", "ScreenshotName": "Symantec-APT29-12974.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell execution of ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]", "ScreenshotName": "Symantec-APT29-9905.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Childitem cmdlet. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - get-childitem and compress archive scriptblock", "ScreenshotName": "F-Secure-APT29-11254.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the execution of ChildItem. \n", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "command start for childitem", "ScreenshotName": "F-Secure-APT29-10008.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1083\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17552.png"}], "Score": 53}, {"DetectionNote": "An MSSP detection occurred showing evidence of PowerShell looking for certain files in a directory. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11846.png"}], "Score": 10}], "Step score": 133}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-233.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery occurred containing evidence that \"PowerShell ran commands to query files with multiple extensions and compress the found files into a zip file.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17383.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-367.png"}, {"ScreenshotName": "Microsoft-APT29-362.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection was generated for the use of ChildItem. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3751.png"}, {"ScreenshotName": "Carbon Black-APT29-3750.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (purple indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "File and Directory Discovery. Searching files through powershell.", "ScreenshotName": "CyCraft-APT29-2203.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.B.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12220.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3470.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"File Enumeration\" under \"Discovery {T1083}\" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "A.3 - Shows that file enumeration took place", "ScreenshotName": "SentinelOne-APT29-6487.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"File Enumeration\" occurred containing evidence of PowerShell searching the filesystem. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "A1 - MSSP - File Enumeration alert", "ScreenshotName": "SentinelOne-APT29-12796.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A.1/2 Shows -childitem call", "ScreenshotName": "SentinelOne-APT29-6485.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred showing evidence of powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13734.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6534.png"}], "Score": 10}], "Step score": 80}}, "9.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "get-child item with att&ck enrichment for data compressed", "ScreenshotName": "Elastic-APT29-1330.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell looking for certain files in a directory. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3042.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.B", "ScreenshotName": "FireEye-APT29-13017.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9.B.2/3 - Script block for ChildItem", "ScreenshotName": "FireEye-APT29-11224.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for PowerShell enumerating files and directories using environment variables.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1130.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 61}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Win_AutomatedCollection_DirScanART_MITRET1119\" occurred containing evidence of powershell.exe executing Get-ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12914.png"}, {"ScreenshotName": "Cylance-APT29-12915.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12005.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing Powershell.exe executing Get-ChildItem\u200b.", "ScreenshotName": "CrowdStrike-APT29-10490.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection was generated for powershell.exe executing Get-ChildItem\u200b. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "General-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "9.b.2/3 - malware alert malicious command (cc)", "ScreenshotName": "Cybereason-APT29-13287.png"}], "Score": 35}], "Step score": 35}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Collection\" was received that included ChildItem command execution searching for document and media files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9b2 - MSSP", "ScreenshotName": "Symantec-APT29-17686.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9b2 - telemetry", "ScreenshotName": "Symantec-APT29-17689.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Searched filesystem for document and media files using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - raw command - childitem", "ScreenshotName": "F-Secure-APT29-11293.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "CommandStart ChildItem", "ScreenshotName": "F-Secure-APT29-10140.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1083\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14022.png"}], "Score": 53}, {"DetectionNote": "A MSSP detection occurred for PowerShell looking for certain files in a directory. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12788.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem\u200b.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12002.png"}], "Score": 10}], "Step score": 133}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-445.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4061.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "File Discovery and Automated Collection through PowerShell scriptblock logging. Contains Compress-Archive.", "ScreenshotName": "CyCraft-APT29-2258.png"}], "Score": 42}], "Step score": 42}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3660.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"File Enumeration\" under \"Discovery {T1083}\" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B2/3/4 - File Enumeration Alert", "ScreenshotName": "SentinelOne-APT29-6751.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1083\" occurred containing evidence of enumerating directories in search for specific files. The function \u201cChildItem\u201d is observed.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2/3 -  child-item", "ScreenshotName": "SentinelOne-APT29-12838.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing ChildItem\u200b. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Configuration Change (UX)-Correlated", "Screenshots": [{"ScreenshotCaption": "CC - B2/3 - Powershell Calling child-item - Generic powershell alert", "ScreenshotName": "SentinelOne-APT29-7235.png"}], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - File and Directory Discovery\" occurred containing evidence of powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12631.png"}, {"ScreenshotName": "SecureWorks-APT29-12630.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6795.png"}], "Score": 10}], "Step score": 80}}, "12.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection for \"Stealthy PowerShell Commands\" (medium severity) was generated for PowerShell executing the timestomp function. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "stealthy powershell commands alert", "ScreenshotName": "Elastic-APT29-1388.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed powershell.exe enumerating System32. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "timestomp function in powershell event", "ScreenshotName": "Elastic-APT29-1391.png"}], "Score": 17}], "Step score": 59}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Timestomping was generated containing evidence of PowerShell enumeration of System32.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13239.png"}], "Score": 70}], "Step score": 70}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell enumeration of System32.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 12.A", "ScreenshotName": "FireEye-APT29-13027.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell enumeration of System32.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "12.A.1 - Script block for gci enumeration of System32", "ScreenshotName": "FireEye-APT29-11408.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell enumeration of System32.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1099.png"}, {"ScreenshotName": "Bitdefender-APT29-1098.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_AutomatedCollection_DirScanART_MITRET1119\" (high severity; red indicator), was generated due to powershell.exe executing Get-ChildItem.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12066.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell enumeration of System32:(gci ((gci env:windir).Value + '\\system32').", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12286.png"}], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell enumeration of System32. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell executing timestomp to enumerate System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019).", "ScreenshotName": "CrowdStrike-APT29-10598.png"}, {"ScreenshotCaption": "Telemetry showing timestomp script block which enumerates System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019).", "ScreenshotName": "CrowdStrike-APT29-10599.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that noted a PowerShell command was used to find a random file in the System32 folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp explanations", "ScreenshotName": "Symantec-APT29-12956.png"}, {"ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp techniques", "ScreenshotName": "Symantec-APT29-12955.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated the System32 directory using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell enumeration of System32.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14497.png"}, {"ScreenshotCaption": "MSSP - timestomp", "ScreenshotName": "F-Secure-APT29-11309.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell enumeration of the System32 directory. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "function timestomp in thp", "ScreenshotName": "F-Secure-APT29-10268.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell performing numerous file reads in the System32 directory. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12271.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell enumeration of System32. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-298.png"}, {"ScreenshotName": "ReaQta-APT29-295.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for suspicious PowerShell commandline.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14016.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for Timestomping was generated containing evidence of PowerShell enumeration of System32.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1144.png"}, {"ScreenshotName": "Microsoft-APT29-1143.png"}], "Score": 70}, {"DetectionNote": "Telemetry via the advanced hunting query interface showed executed script block with PowerShell enumeration of System32.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-488.png"}], "Score": 10}], "Step score": 115}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell enumeration of System32. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4145.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A Tactic alert detection for Discovery (blue icon) was genereated due to PowerShell enumeration of System32.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "gci with enrichments", "ScreenshotName": "CyCraft-APT29-2438.png"}], "Score": 45}], "Step score": 45}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"File and Directory Discovery with Powershell\" was generated due to PowerShell enumeration of env:windir.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4214.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the PowerShell enumeration of System32.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3767.png"}], "Score": 10}], "Step score": 68}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1083\" occurred containing evidence of PowerShell enumeration of System32.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1 - FileEnum + gci SBL", "ScreenshotName": "SentinelOne-APT29-12852.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell enumeration of System32.", "Detect": "Telemetry-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A1 - Powershell timestop function via generic powershell alert", "ScreenshotName": "SentinelOne-APT29-7245.png"}], "Score": 3}], "Step score": 73}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - File and Directory Discovery\" occurred containing evidence of PowerShell enumeration of System32.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12642.png"}, {"ScreenshotName": "SecureWorks-APT29-12641.png"}, {"ScreenshotName": "SecureWorks-APT29-12639.png"}, {"ScreenshotName": "SecureWorks-APT29-12643.png"}, {"ScreenshotName": "SecureWorks-APT29-12640.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell enumeration of System32.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7015.png"}], "Score": 10}], "Step score": 80}}, "4.C.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c1-3 script block", "ScreenshotName": "Elastic-APT29-1229.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:TEMP.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:TEMP.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.1 - Script block for $env:TEMP", "ScreenshotName": "FireEye-APT29-11015.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using $env:TEMP.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}, {"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection for \"File and Directory Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the TempDirectory.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated user's temporary directory path using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "invoke-discovery", "ScreenshotName": "F-Secure-APT29-10062.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions. Details showing a PowerShell command containing $env:TEMP were verified.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $env:TEMP. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-581.png"}, {"ScreenshotName": "Microsoft-APT29-13988.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current directory.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3543.png"}, {"ScreenshotName": "HanSight-APT29-3532.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection occurred for \"basic discovery\" containing evidence of $env:TEMP usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1-5 - readme.ps1", "ScreenshotName": "SentinelOne-APT29-12815.png"}], "Score": 70}], "Step score": 70}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - File and Directory Discovery\" occurred containing evidence of powershell.exe executing: $env:TEMP.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe executing: $env:TEMP.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6628.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "File and Directory Discovery", "Steps count": 5, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1081": {"Steps": {"6.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection for \"ATT&CK 1081 Credentials in Files\" was generated for accesschk.exe reading the Chrome database file for credentials . The event was correlated to a parent General detection for malicious file execution.", "Detect": "Technique-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "cc - new api monitoring on ntcreate file credential in files tag. (blacklist update + enrichment rule)", "ScreenshotName": "Elastic-APT29-1720.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "6a1 - better pic - shows correlated", "ScreenshotName": "Elastic-APT29-15105.png"}], "Score": 10}], "Step score": 70}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Browser login data access by non-browser process\" was generated when accesschk.exe accessed the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2943.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13214.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2942.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13426.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. Detection incurred a delay based on accesschk.exe executing in a malware detonation chamber where the results were later available to an analyst.", "Detect": "Telemetry-Delayed (Processing)", "Screenshots": [{"ScreenshotCaption": "Telemetry from malware detonation chamber showing strings containing PDB pathways.", "ScreenshotName": "CrowdStrike-APT29-10377.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "6.a.1 - accesschk.exe tre (cc)", "ScreenshotName": "Cybereason-APT29-9912.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11907.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-103.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Credential Access was generated containing evidence the Chrome database was read from the machine using accesschk.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17390.png"}], "Score": 70}], "Step score": 70}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed a file write of the passwordsdb output.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3981.png"}], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed accesschk.exe copying Chrome's credential database file. The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10942.png"}, {"ScreenshotName": "GoSecure-APT29-11680.png"}], "Score": 17}], "Step score": 17}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"BrowserInfoStealing\" under \"Collection {T1213}\" was generated when accesschk.exe read the Chrome database file for credentials. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "A1 - Browser info stealing via accesschk.exe ", "ScreenshotName": "SentinelOne-APT29-6564.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1081\" occurred containing evidence of accesschk.exe reading the Chrome database file for credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1/3 - asscesschk.exe usage and alerts", "ScreenshotName": "SentinelOne-APT29-12822.png"}], "Score": 70}], "Step score": 142}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred identifying the executed accesschk.exe binary as a tool for reading the Chrome database file for credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13743.png"}], "Score": 70}], "Step score": 70}}}, "TechniqueName": "Credentials in Files", "Steps count": 1, "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}]}, "T1086": {"Steps": {"11.A.12": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) was generated for powershell.exe executed with unusual arguments.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "second powershell alert - arguments, obfuscated, network activity", "ScreenshotName": "Elastic-APT29-13683.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (medium severity) was generated for powershell.exe executing an obfuscated command.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "obfustacted cmdlet alert", "ScreenshotName": "Elastic-APT29-1368.png"}], "Score": 65}, {"DetectionNote": "A Technique detection  for \"ATT&CK T1086 PowerShell\" was generated for powershell.exe spawned from a PowerShell stager.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "for 12 the powershell staging", "ScreenshotName": "Elastic-APT29-1373.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "for 12 the powershell staging", "ScreenshotName": "Elastic-APT29-1373.png"}], "Score": 10}], "Step score": 200}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing from schemas ADS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13238.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3142.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"POWERSHELL.EXE IEX ENCODED COMMAND (METHODOLOGY)\" was generated due to encoded PowerShell IEX execution.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.A - PowerShell Get-Content Command with schemas IEX", "ScreenshotName": "FireEye-APT29-11346.png"}, {"ScreenshotCaption": "11.A.12 - PowerShell IEX Encoded Command (top)", "ScreenshotName": "FireEye-APT29-11359.png"}, {"ScreenshotCaption": "11.A.12 - PowerShell IEX Encoded Command (bottom)", "ScreenshotName": "FireEye-APT29-11360.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for the PowerShell stager executing (IEX) from schemas.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for powershell.exe executed with a suspicious large command line, which led to the powershell.exe process being identified as malware.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-816.png"}, {"ScreenshotName": "Bitdefender-APT29-797.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for powershell.exe launched with the encoded command parameter.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-817.png"}, {"ScreenshotName": "Bitdefender-APT29-805.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-802.png"}], "Score": 10}], "Step score": 140}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"PowerShell\" was generated for powershell.exe spawned from a PowerShell stager.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1824.png"}, {"ScreenshotName": "McAfee-APT29-1817.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Win_Powershell_Base64_MITRE1027\" was generated on PowerShell usage of base64 encoding or decoding.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12057.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cPowerShell\u201d was generated for the executed PowerShell stager matching existing malware characteristics. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process.", "ScreenshotName": "CrowdStrike-APT29-10588.png"}, {"ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process.", "ScreenshotName": "CrowdStrike-APT29-10582.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (yellow indicator) called \u201cPowerShell\u201d was generated for powershell.exe run with a hidden window and encoded commands.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process.", "ScreenshotName": "CrowdStrike-APT29-10587.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process.", "ScreenshotName": "CrowdStrike-APT29-10582.png"}], "Score": 10}], "Step score": 140}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red; unique symbol) called \"ATT&CK Execution: PowerShell\" was generated due to powershell.exe spawned from a PowerShell stager.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.12 - powershell iex stager", "ScreenshotName": "Cybereason-APT29-9695.png"}, {"ScreenshotCaption": "11.a.2 - commandline, schemas, etc. from process tree", "ScreenshotName": "Cybereason-APT29-9689.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.2 - commandline, schemas, etc. from process tree", "ScreenshotName": "Cybereason-APT29-9689.png"}], "Score": 10}], "Step score": 75}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Powershell\" was generated for powershell.exe spawned from a PowerShell stager.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Incident report for execution of suspicious powershell.exe usage", "ScreenshotName": "Symantec-APT29-9706.png"}, {"ScreenshotCaption": "powershell.exe launching powershell.exe stager.", "ScreenshotName": "Symantec-APT29-9705.png"}, {"ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution", "ScreenshotName": "Symantec-APT29-12850.png"}, {"ScreenshotCaption": "powershell.exe executing ADS", "ScreenshotName": "Symantec-APT29-9700.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"PowerShell\" was received that included a PowerShell command executed by the adversary and explained that it was used to download and execute a PoshC2 stager located on a remote server.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: stager script explanation", "ScreenshotName": "Symantec-APT29-12954.png"}, {"ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques", "ScreenshotName": "Symantec-APT29-12953.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell.exe executing ADS", "ScreenshotName": "Symantec-APT29-9700.png"}, {"ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution", "ScreenshotName": "Symantec-APT29-12850.png"}, {"ScreenshotCaption": "Incident report for execution of suspicious powershell.exe usage", "ScreenshotName": "Symantec-APT29-9706.png"}, {"ScreenshotCaption": "powershell.exe launching powershell.exe stager.", "ScreenshotName": "Symantec-APT29-9705.png"}], "Score": 10}], "Step score": 145}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"PowerShell\" was generated for powershell.exe spawned from a PowerShell stager. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11a12 - vendor pic PS tag - technique", "ScreenshotName": "Kaspersky-APT29-13810.png"}, {"ScreenshotCaption": "11a12 - vendor pic PS tag - technique", "ScreenshotName": "Kaspersky-APT29-13802.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (high severity) called \"PDM:Exploit.Win32.Generic\" was generated for a potential threat.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.12 - exec of schemas ads would be blocked", "ScreenshotName": "Kaspersky-APT29-3155.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing from schemas ADS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a12", "ScreenshotName": "Kaspersky-APT29-18014.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a12 - vendor pic PS tag - technique", "ScreenshotName": "Kaspersky-APT29-13802.png"}, {"ScreenshotCaption": "11a12 - vendor pic PS tag - technique", "ScreenshotName": "Kaspersky-APT29-13810.png"}], "Score": 10}], "Step score": 180}, "Procedure": "Executed PowerShell stager payload", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity)  for a Powershell script launched from ads was generated due to a PowerShell script launched from an ADS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "ads with schemas", "ScreenshotName": "F-Secure-APT29-10249.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "ads with schemas", "ScreenshotName": "F-Secure-APT29-10249.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing IEX. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12049.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-166.png"}, {"ScreenshotName": "ReaQta-APT29-293.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-483.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4123.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for powershell.exe executing encoded instructions.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4121.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4121.png"}], "Score": 10}], "Step score": 140}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"PowerShell\" was generated for powershell.exe spawned from a PowerShell stager.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Connection to C2 over port 443. Just from PowerShell scriptblock logging", "ScreenshotName": "CyCraft-APT29-2436.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script via IEX.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.12-15 - MDR Report Day 2, staging remote PowerShell", "ScreenshotName": "CyCraft-APT29-12483.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"PowerShell with Invoke Expression Launched\" was generated due to the PowerShell stager executing (IEX) from schemas. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17445.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for PowerShell was generated due to a suspicious PowerShell command. ", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Technique detection for a suspicious powershell command", "ScreenshotName": "MalwareBytes-APT29-2600.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Suspicious Powershell Commandline\" was generated due to powershell.exe execution and use of IEX.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3701.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1086\" occurred containing evidence of PowerShell stager executing (IEX) from schemas via script block logs.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A10/11/12", "ScreenshotName": "SentinelOne-APT29-12848.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A1/2 - Process tree showing explorer.exe executing  powershell calling Get-Content", "ScreenshotName": "SentinelOne-APT29-6785.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called PowerShell Downloading Remote Resource was generated due to PowerShell stager executing (IEX) from schemas.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6993.png"}, {"ScreenshotName": "SecureWorks-APT29-6996.png"}, {"ScreenshotName": "SecureWorks-APT29-6995.png"}, {"ScreenshotName": "SecureWorks-APT29-6998.png"}, {"ScreenshotName": "SecureWorks-APT29-6997.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Exeuction - PowerShell\" occurred for PowerShell executing a stager with Invoke-Expression.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13768.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6855.png"}], "Score": 10}], "Step score": 145}}, "1.B.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection called \"ATT&CK T1086 PowerShell\" was generated for the execution of PowerShell. The event was correlated to a parent alert for malicious file execution. ", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "powershell enrichment with selection in resolver view (purple dot) enriched from malicious file detection (correlated)", "ScreenshotName": "Elastic-APT29-1190.png"}], "Score": 67}, {"DetectionNote": "Telemetry showed cmd.exe executing powershell.exe. The telemetry was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "powershell enrichment with selection in resolver view (purple dot) enriched from malicious file detection (correlated)", "ScreenshotName": "Elastic-APT29-1190.png"}], "Score": 17}], "Step score": 84}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Powershell \"(T1086)\" occurred containing evidence of powershell.exe spawning from cmd.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13201.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2666.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell Execution\" was generated due to powershell.exe spawning from cmd.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "1.B.2 - PowerShell Execution from parent cmd.exe", "ScreenshotName": "FireEye-APT29-10853.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for cmd.exe spawning a child process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "1.B.2 - CMD Child Process of powershell.exe (bottom)", "ScreenshotName": "FireEye-APT29-10860.png"}, {"ScreenshotCaption": "1.B.2 - CMD Child Process of powershell.exe (top)", "ScreenshotName": "FireEye-APT29-10859.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for powershell.exe spawning from cmd.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 1.B", "ScreenshotName": "FireEye-APT29-12978.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 180}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated for powershell.exe being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13415.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-653.png"}, {"ScreenshotName": "Bitdefender-APT29-13416.png"}], "Score": 17}], "Step score": 59}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (blue indicator) called \"PowerShell\" was generated due to the PowerShell command being executed from another process. The technique was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1429.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed cmd.exe launching powershell.exe. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1436.png"}], "Score": 17}], "Step score": 89}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (info severity) called \"Win_User_Execution_MITRET1204\" was generated due to a process targeting an *.exe filename.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11832.png"}, {"ScreenshotName": "Cylance-APT29-11833.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 55}, "CrowdStrike": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated when powershell.exe spawned from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "A general detection showing powershell.exe spawning from cmd.exe.", "ScreenshotName": "CrowdStrike-APT29-10204.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A general detection showing powershell.exe spawning from cmd.exe.", "ScreenshotName": "CrowdStrike-APT29-10204.png"}], "Score": 17}], "Step score": 59}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe spawning from cmd.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - b1, b2", "ScreenshotName": "Cybereason-APT29-10771.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "1.b.2 - same process tree view (telemetry) showing cmd.exe spawns powershell", "ScreenshotName": "Cybereason-APT29-7352.png"}], "Score": 17}], "Step score": 87}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"PowerShell\" was generated when cmd.exe spawned powershell.exe. The event was correlated to a parent detection cod.3aka.scr as a suspicious file.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "list of execution events related to doc execution", "ScreenshotName": "Symantec-APT29-7357.png"}, {"ScreenshotCaption": "Incident Report showing correlation of powershell execution with cod.3aka.scr", "ScreenshotName": "Symantec-APT29-12868.png"}], "Score": 67}, {"DetectionNote": "An MSSP detection for \"PowerShell\" was received that included a description of the PowerShell commands executed by the adversary.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: automated file collection script", "ScreenshotName": "Symantec-APT29-13030.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Incident Report showing correlation of powershell execution with cod.3aka.scr", "ScreenshotName": "Symantec-APT29-12868.png"}, {"ScreenshotCaption": "list of execution events related to doc execution", "ScreenshotName": "Symantec-APT29-7357.png"}], "Score": 17}], "Step score": 154}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called PowerShell was generated due to the execution of powershell.exe by cmd.exe. The alert was correlated to a parent alert for command line execution.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "1.b.2 ps launced", "ScreenshotName": "Kaspersky-APT29-2637.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection contained evidence of cmd.exe spawning powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Report Page 4 - Step 1", "ScreenshotName": "Kaspersky-APT29-11767.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1.b.2 ps launced", "ScreenshotName": "Kaspersky-APT29-2637.png"}], "Score": 10}], "Step score": 152}, "Procedure": "Spawned interactive powershell.exe", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for Abnormal Process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "cmd parent to powershel, 3aka3 spawning cmd.", "ScreenshotName": "F-Secure-APT29-10004.png"}, {"ScreenshotCaption": "powershell part of tree spawning from .doc", "ScreenshotName": "F-Secure-APT29-10571.png"}], "Score": 17}], "Step score": 17}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17548.png"}, {"ScreenshotName": "TrendMicro-APT29-17549.png"}, {"ScreenshotName": "TrendMicro-APT29-11836.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"PowerShell\" was generated when cmd.exe spawned powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-27.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe spawning powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13980.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for \"AMSI - Abnormal Fileless command-line length being executed.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3737.png"}, {"ScreenshotName": "Carbon Black-APT29-3733.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection was generated for cmd.exe spawning powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showing powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3723.png"}, {"ScreenshotName": "Carbon Black-APT29-3727.png"}], "Score": 17}], "Step score": 129}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"Powershell\" was generated when cmd.exe spawned powershell.exe. The alert was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "Additional call-graph information for seeing the payload spawning cmd and  powershell", "ScreenshotName": "CyCraft-APT29-2056.png"}, {"ScreenshotCaption": "Clear demonstration of relationships between processes, including logs of PowerShell execution mapped to ATT&CK techniques", "ScreenshotName": "CyCraft-APT29-2057.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"PowerShell\" was received that included a description of PowerShell execution and an explanation of the commands executed through it.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.B.2 - MDR Report Day 1 (2)", "ScreenshotName": "CyCraft-APT29-12222.png"}, {"ScreenshotCaption": "1.B.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12220.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"PowerShell process created\" was generated due to powershell.exe spawning from cmd.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10816.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10820.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "cmd spawning powershell", "ScreenshotName": "MalwareBytes-APT29-2593.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "A Technique detection called \"PowerShell\" was generated when cmd.exe spawned powershell.exe.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3446.png"}, {"ScreenshotName": "HanSight-APT29-3447.png"}], "Score": 60}, {"DetectionNote": "Telemetry showing powershell.exe spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 70}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for powershell.exe spawning from cmd.exe.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "1.B.2 - Execution for powershell.exe spawning from cmd.exe.", "ScreenshotName": "SentinelOne-APT29-14541.png"}], "Score": 52}, {"DetectionNote": "An MSSP detection for \u201cT1086\u201d contained evidence of powershell.exe spawning from cmd.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "B2 - MSSP - powershell", "ScreenshotName": "SentinelOne-APT29-12795.png"}, {"ScreenshotCaption": "B1/2 - MSSP - Command-line interface/powershell", "ScreenshotName": "SentinelOne-APT29-12794.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B.2 - Shows all process spawning with additional information about the execution - shows powershell", "ScreenshotName": "SentinelOne-APT29-6477.png"}], "Score": 17}], "Step score": 139}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection was generated for cmd.exe spawning powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12782.png"}, {"ScreenshotName": "SecureWorks-APT29-12582.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7213.png"}], "Score": 10}], "Step score": 80}}, "20.A.3": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (orange, medium severity) for \"PowerShell with Unusual Arguments\" was generated for the execution of PowerShell.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "powershell with unusual arguements alert", "ScreenshotName": "Elastic-APT29-13691.png"}], "Score": 65}, {"DetectionNote": "A Technique detection for \"ATT&CK T1085 PowerShell\" was generated due to the execution of PowerShell.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "powershell with unusual arguements alert", "ScreenshotName": "Elastic-APT29-13691.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed powershell.exe spawned from WMI event subscription (wmiprvse.exe) as SYSTEM. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "wmi taggin of parent powershell", "ScreenshotName": "Elastic-APT29-1618.png"}], "Score": 10}], "Step score": 135}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence of powershell.exe executing another powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15752.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a SYSTEM-level PowerShell spawning from a svchost.exe associated with the WMI service.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13731.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell Network Connection\" was generated due to the SYSTEM level PowerShell spawned from wmiprvse.exe making a network connection.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.A.3 - PowerShell Network Connection for the SYSTEM level PowerShell spawned from wmiprvse.exe (bottom)", "ScreenshotName": "FireEye-APT29-11667.png"}, {"ScreenshotCaption": "20.A.3 - PowerShell Network Connection for the SYSTEM level PowerShell spawned from wmiprvse.exe (top)", "ScreenshotName": "FireEye-APT29-11666.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for a SYSTEM-level PowerShell spawned from the WindowsParentalControlMigration WMI event subscription.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 20.A", "ScreenshotName": "FireEye-APT29-13054.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed SYSTEM-level PowerShell spawned from wmiprvse.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20.A.3 - Triage view of wmiprvse.exe spawning SYSTEM level PowerShell callbacks", "ScreenshotName": "FireEye-APT29-11668.png"}, {"ScreenshotCaption": "20.A.3 - Triage view of network connections made by those SYSTEM level callbacks", "ScreenshotName": "FireEye-APT29-11670.png"}], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for powershell.exe launched with the encoded command parameter.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1027.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) was generated for powershell.exe due to \"Suspicious Large Command Line\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1024.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) was generated for the execution of a suspicious user process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13447.png"}, {"ScreenshotName": "Bitdefender-APT29-13448.png"}], "Score": 35}], "Step score": 135}, "McAfee": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated by a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1916.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1917.png"}], "Score": 10}], "Step score": 45}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Win_Powershell_Base64_MITRET1027\" was generated for PowerShell decoding base64 information.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12172.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (medium severity) called \"Unusual PowerShell Parent Processes\" was generated for wmiprvse.exe spawning powershell.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12170.png"}], "Score": 35}], "Step score": 100}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow unique icon) called \u201cPowerShell\u201d was generated when powershell was executed with a hidden window and encoded commands. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d for WmiPrvSE.exe executing powershell with a hidden window and encoded commands.", "ScreenshotName": "CrowdStrike-APT29-10735.png"}], "Score": 65}, {"DetectionNote": "A Technique detection called \u201cPShellExploitKit2\u201d was generated by wmiprvse.exe executing powershell.exe as SYSTEM.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "A General detection called \u201cPShellExploitKit2\u201d for wmiprvse.exe executing powershell.exe as SYSTEM.", "ScreenshotName": "CrowdStrike-APT29-10740.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing WmiPrvSE.exe executing powershell.exe. Telemetry showing a SYSTEM-level PowerShell spawned from wmiprvse.exe.", "ScreenshotName": "CrowdStrike-APT29-10739.png"}], "Score": 10}], "Step score": 135}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red, unique symbol) called \"ATT&CK Execution: PowerShell\" was generated due to a SYSTEM-level PowerShell spawned from wmiprvse.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.a.3 - malops and suspicions", "ScreenshotName": "Cybereason-APT29-9832.png"}, {"ScreenshotCaption": "20.a.3 - process details and tree with system ", "ScreenshotName": "Cybereason-APT29-9834.png"}, {"ScreenshotCaption": "20.a.3 - system user from evidence", "ScreenshotName": "Cybereason-APT29-9836.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe spawned from WMI event subscription (wmiprvse.exe) as SYSTEM.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20.a.3 - process details and tree with system ", "ScreenshotName": "Cybereason-APT29-9834.png"}], "Score": 10}], "Step score": 75}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"PowerShell\" was generated due to wmiprvse.exe spawning powershell.exe.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "20A3 - technique", "ScreenshotName": "Symantec-APT29-17733.png"}], "Score": 60}, {"DetectionNote": "A General detection called \"powershell.exe contains suspicious argument\" was generated on a SYSTEM-level powershell.exe spawning from wmiprvse.exe.", "Detect": "General", "Screenshots": [{"ScreenshotCaption": "Forensics Report with process tree of wmiprvse.exe resulting in powershell callback as SYSTEM", "ScreenshotName": "Symantec-APT29-9859.png"}], "Score": 30}], "Step score": 90}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red; high severity) called PowerShell was generated due to powershell executing a SYSTEM-level powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "2nd ps with SYSTEM user", "ScreenshotName": "Kaspersky-APT29-3363.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell spawned from a WMI event subscription.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 20A3", "ScreenshotName": "Kaspersky-APT29-18022.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed execution of SYSTEM level PowerShell.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "2nd ps with SYSTEM user", "ScreenshotName": "Kaspersky-APT29-3363.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) was generated for powershell.exe running with parameters that are typically used in post-exploitation payloads.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "wmi spawning powershell", "ScreenshotName": "F-Secure-APT29-10698.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell spawned from WMI event subscription (wmiprvse.exe).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "wmiprvse executing powershell", "ScreenshotName": "F-Secure-APT29-10515.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"PowerShell\" was generated due to a SYSTEM-level PowerShell spawned from wmiprvse.exe.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17575.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for WMI event subscription executing a SYSTEM-level PowerShell instance. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12206.png"}], "Score": 10}], "Step score": 140}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"PowerShell\" was generated due to a SYSTEM-level PowerShell spawning from wmiprvse.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-222.png"}], "Score": 65}], "Step score": 65}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection for PowerShell (medium severity) was generated due to a suspicious PowerShell command-line.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-547.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for execution was generated containing evidence a SYSTEM-level PowerShell process spawned and\nexecuted the malicious payload after wmiprvse.exe executed malicious staging\npayload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1149.png"}, {"ScreenshotName": "Microsoft-APT29-1150.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-547.png"}], "Score": 10}], "Step score": 145}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4371.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for a hidden PowerShell with an Unusual Parent.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4371.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe spawning from wmiprvse.exe with SYSTEM-level integrity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4375.png"}], "Score": 10}], "Step score": 110}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicatorl) for \"Powershell\" was generated due to  a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "wmiprvse.exe executing powershell.exe", "ScreenshotName": "CyCraft-APT29-2494.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"PowerShell\" was received that described execution of powershell.exe triggered by a WMI Event Subscription.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.A.1 - MDR Report Day 2, execution of WMI event persistence", "ScreenshotName": "CyCraft-APT29-12522.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) was generated due to a suspicious PowerShell command.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "executing pshel stager (20a2)", "ScreenshotName": "MalwareBytes-APT29-2577.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (warning severity) was generated for a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3965.png"}], "Score": 35}], "Step score": 35}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"PowerShell\" occurred containing evidence of WMI Provider Host spawning PowerShell.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - WMI -> powershell", "ScreenshotName": "SentinelOne-APT29-12892.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a SYSTEM-level powershell.exe spawning from wmiprvse.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A3 - wmiprvse.exe Process tree overview of spawning processes", "ScreenshotName": "SentinelOne-APT29-6991.png"}, {"ScreenshotCaption": "A2/3 - Detailed wmiprvse.exe executing powershell stager", "ScreenshotName": "SentinelOne-APT29-6992.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7285.png"}], "Score": 10}], "Step score": 10}}, "4.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1086 Powershell\" was generated when powershell.exe spawned. The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "powersehll technique mapping enrichment", "ScreenshotName": "Elastic-APT29-1214.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "powersehll technique mapping enrichment", "ScreenshotName": "Elastic-APT29-1214.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of a new interactive session of PowerShell being created.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13205.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13208.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2786.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell Execution\" was generated due to the execution of powershell.exe, which was used to execute powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "4.A.2 - PowerShell Execution of powershell.exe", "ScreenshotName": "FireEye-APT29-10946.png"}], "Score": 65}, {"DetectionNote": "A General alert detection for PowerShell child process was generated for powershell.exe spawning a child process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.A.2 - PowerShell Child Process of powershell.exe", "ScreenshotName": "FireEye-APT29-10947.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 110}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe.  The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-680.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "A Technique detection called \"PowerShell\" was generated due to PowerShell being executed by another script. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1517.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1519.png"}, {"ScreenshotName": "McAfee-APT29-1520.png"}], "Score": 17}], "Step score": 77}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12237.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing a Powershell.exe process spawning from a powershell.exe process.  Telemetry showing file read operations for the zip file contents.", "ScreenshotName": "CrowdStrike-APT29-10290.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red; unique symbol) for \"Malicious Process powershell.exe\" was generated due to suspicious use of PowerShell. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "4.a.2 - interactive powershell process details", "ScreenshotName": "Cybereason-APT29-9597.png"}, {"ScreenshotCaption": "4.a.1 - malicious high integrity powershell", "ScreenshotName": "Cybereason-APT29-9594.png"}], "Score": 72}], "Step score": 72}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"PowerShell\" was generated when powershell.exe spawned powershell.exe.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "powershell spawning powershell, with PIDs", "ScreenshotName": "Symantec-APT29-7421.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred containing evidence of a new powershell.exe spawning from powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Remote File Copy of sysinternals tools", "ScreenshotName": "Symantec-APT29-12909.png"}], "Score": 70}], "Step score": 130}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"PowerShell\" was generated due to powershell.exe spawning a new powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "4a2 - vendor provided pic", "ScreenshotName": "Kaspersky-APT29-13797.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe spawning from powershell.exe and indicated the new PowerShell process was a meterpreter shell.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Report Page 4 - Step 4", "ScreenshotName": "Kaspersky-APT29-11778.png"}, {"ScreenshotCaption": "MSSP Report Page 3 - Step 4", "ScreenshotName": "Kaspersky-APT29-11777.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.a.2 - ps launches ps", "ScreenshotName": "Kaspersky-APT29-2735.png"}], "Score": 17}], "Step score": 159}, "Procedure": "Spawned interactive powershell.exe", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection for PowerShell (medium severity) was generated due to a suspicious PowerShell command. The detection was correlated to a parent alert for a suspicious download by PowerShell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14969.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for a suspicious download by PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14969.png"}], "Score": 17}], "Step score": 89}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11872.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-73.png"}], "Score": 17}], "Step score": 17}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-388.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3888.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A Tactic alert detection (yellow indicator) was generated for a new powershell.exe spawning from powershell.exe.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "4.b.2 = powershell discovered in high integrity", "ScreenshotName": "CyCraft-APT29-14918.png"}], "Score": 45}], "Step score": 45}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"PowerShell\" was generated due to powershell.exe spawning a new powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10877.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10887.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "powershell spawing powershell (4a2)", "ScreenshotName": "MalwareBytes-APT29-2523.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3516.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for powershell.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "4.A.2 - Execution of powershell.exe by powershell.exe", "ScreenshotName": "SentinelOne-APT29-14583.png"}], "Score": 52}, {"DetectionNote": "An MSSP detection for \"T1086\" occurred containing evidence of a new interactive session of PowerShell being created.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A2 - Process creation event", "ScreenshotName": "SentinelOne-APT29-11807.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A2 - shows HI powershell spawning powershell", "ScreenshotName": "SentinelOne-APT29-6524.png"}], "Score": 17}], "Step score": 139}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6613.png"}], "Score": 10}], "Step score": 10}}, "9.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"T1086 PowerShell\" was generated due to powershell.exe executing. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "python executing powershell with att&ck enrichment (9b1)", "ScreenshotName": "Elastic-APT29-1326.png"}, {"ScreenshotCaption": "python executing powershell with att&ck enrichment (9b1)", "ScreenshotName": "Elastic-APT29-1326.png"}], "Score": 72}, {"DetectionNote": "Telemetery showed python.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "python executing powershell with att&ck enrichment (9b1)", "ScreenshotName": "Elastic-APT29-1326.png"}], "Score": 10}], "Step score": 82}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of python spawning powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3041.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell Execution\" was generated due to python.exe spawning powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.B.1 - PowerShell Execution for python.exe spawning powershell.exe", "ScreenshotName": "FireEye-APT29-11207.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for python.exe executing powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.B", "ScreenshotName": "FireEye-APT29-13015.png"}], "Score": 70}, {"DetectionNote": "Telemetery showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.B - Triage view with python.exe executing powershell.exe", "ScreenshotName": "FireEye-APT29-11222.png"}], "Score": 17}], "Step score": 152}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetery showed python.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-772.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1755.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (info severity) called \"Win_User_Execution_MITRET1204\" was generated due to a process targeting an *.exe filename.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12008.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 55}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed Python.exe executing powershell.exe\u200b.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing Python.exe executing powershell.exe\u200b.", "ScreenshotName": "CrowdStrike-APT29-10489.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.b.1 - python spawning powershell", "ScreenshotName": "Cybereason-APT29-9651.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for PowerShell was generated when python.exe spawned powershell.exe.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "python.exe executing powershell.exe", "ScreenshotName": "Symantec-APT29-7475.png"}, {"ScreenshotCaption": "Execution of powershell.exe, tagged with PowerShell", "ScreenshotName": "Symantec-APT29-7472.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The telemetry was correlated to a parent detection python.exe as a suspicious file.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9b1 - telemetry + correlation", "ScreenshotName": "Symantec-APT29-17683.png"}], "Score": 17}], "Step score": 77}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"T1086_PowerShell\" was generated due to python.exe spawning powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Medium level alert on powershell", "ScreenshotName": "Kaspersky-APT29-2926.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of python spawning powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 9B1 and 9B5", "ScreenshotName": "Kaspersky-APT29-18007.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Medium level alert on powershell", "ScreenshotName": "Kaspersky-APT29-2926.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Spawned interactive powershell.exe", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "process tree showing python spawning powershell", "ScreenshotName": "F-Secure-APT29-10138.png"}], "Score": 17}], "Step score": 17}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe\u200b. The detection was correlated to a parent alert for service execution on python.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11995.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe\u200b. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-150.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of python.exe executing powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1135.png"}, {"ScreenshotName": "Microsoft-APT29-1134.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-441.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for the execution of a abnormal fileless command-line length. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13946.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4059.png"}], "Score": 17}], "Step score": 59}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"PowerShell\" was generated when python.exe spawned powershell.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "python.exe executed powershell.exe on Scranton with enrichments.", "ScreenshotName": "CyCraft-APT29-2257.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"PowerShell\" was received that showed execution of powershell.exe by python.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9.B.5 - MDR Report Day 1, execution of rar.exe", "ScreenshotName": "CyCraft-APT29-12461.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called PowerShell was generated due to python.exe spawning powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11078.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11078.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3652.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1086\" occurred containing evidence of python.exe executing powershell.exe\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - process tree", "ScreenshotName": "SentinelOne-APT29-12837.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe\u200b. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B1 - Process tree of python executing powershell", "ScreenshotName": "SentinelOne-APT29-6753.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Execution - PowerShell\" occurred containing evidence of python.exe executing powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12629.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6790.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "PowerShell", "Steps count": 5, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}]}, "T1084": {"Steps": {"20.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection for \"ATT&CK T1047 Windows Management Instrumentation\" was generated for PowerShell being executed via WMI. ", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "wmi taggin of parent powershell", "ScreenshotName": "Elastic-APT29-1618.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "showing lineage with process tree. ", "ScreenshotName": "Elastic-APT29-1617.png"}], "Score": 10}], "Step score": 70}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called was generated for PowerShell executing as part of a Windows Management Instrumentation Event Subscription.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3327.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3326.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was generated containing evidence of powershell.exe executing from Windows Management Instrumentation Event Subscription.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15752.png"}], "Score": 70}], "Step score": 135}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"WMI Process Creation\" was generated due to wmiprvse.exe executing the PowerShell stager as a child process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.A.2 - WMI Process Creation for the PowerShell stager (top)", "ScreenshotName": "FireEye-APT29-11645.png"}, {"ScreenshotCaption": "20.A.2 - WMI Process Creation for the PowerShell stager (bottom)", "ScreenshotName": "FireEye-APT29-11646.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for the WMI event subscription WindowsParentalControlMigration executing PowerShell upon user logon.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 20.A", "ScreenshotName": "FireEye-APT29-13054.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection called \"executepowershellthroughwmi\" was generated due to PowerShell being executed by WMI.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1110.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 68}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1916.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A General detection was generated for PowerShell having an unusual parent.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12170.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique detection for \"WmiFilterConsumerBind\" was generated due to PowerShell being executed by WMI. ", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "20a2 - new vendor screenshot", "ScreenshotName": "CrowdStrike-APT29-15009.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing WmiPrvSE.exe executing powershell.exe. Telemetry showing a SYSTEM-level PowerShell spawned from wmiprvse.exe.", "ScreenshotName": "CrowdStrike-APT29-10739.png"}], "Score": 10}], "Step score": 70}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20.a.2 - process tree with wmiprvse and powershell", "ScreenshotName": "Cybereason-APT29-9831.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing PowerShell.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Shows wmiprvse.exe executing powershell.exe, which then executes the powershell stager.", "ScreenshotName": "Symantec-APT29-9856.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"WMI Event Consumer Triggered\" was generated due to wmiprvse.exe executing powershell.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.a.2 Detection of powershell obfuscation came from unpacking of command line base64 payload by their tool", "ScreenshotName": "Kaspersky-APT29-3360.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.a.2 MSSP report", "ScreenshotName": "Kaspersky-APT29-12422.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20.a.2 - wmiprvse exe ps tree", "ScreenshotName": "Kaspersky-APT29-3357.png"}, {"ScreenshotCaption": "20.a.2 Detection of powershell obfuscation came from unpacking of command line base64 payload by their tool", "ScreenshotName": "Kaspersky-APT29-3360.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Executed WMI persistence on user login", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for WMI starting a system process it normally doesn't start.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "wmi spawning powershell", "ScreenshotName": "F-Secure-APT29-10698.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed WmiPrvSE executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "wmiprvse executing powershell", "ScreenshotName": "F-Secure-APT29-10515.png"}], "Score": 10}], "Step score": 45}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for WMI event subscription executing the PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12206.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-222.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for execution was generated containing evidence of the execution of malicious staging payload via WMI persistence, triggered by the logon of user Oscar.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1150.png"}, {"ScreenshotName": "Microsoft-APT29-1149.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-547.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a PowerShell with network connections launched by WMI.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13964.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for Windows Management Instrumentation based on wmiprvse.exe executing PowerShell stager.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13963.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for PowerShell having an unusual parent.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4371.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4358.png"}], "Score": 10}], "Step score": 175}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red alert icon) for \"Windows Management Instrumentation Event Subscription\" was generated for wmiprvse.exe executing the PowerShell stager.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20a2  -  new screenshot from feedback", "ScreenshotName": "CyCraft-APT29-15516.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" was received that described the triggering of a WMI Event Subscription upon logon of user Oscar in order to execute powershell.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.A.1 - MDR Report Day 2, execution of WMI event persistence", "ScreenshotName": "CyCraft-APT29-12522.png"}, {"ScreenshotCaption": "20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock", "ScreenshotName": "CyCraft-APT29-12521.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "wmiprvse.exe executing PowerShell stager", "ScreenshotName": "MalwareBytes-APT29-2584.png"}], "Score": 3}], "Step score": 3}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Warning severity) was generated for WMI creation of a suspicious child powershell.exe process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3965.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15134.png"}], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.A.2 - MSSP", "ScreenshotName": "SentinelOne-APT29-17876.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the WMI Provider Host executing the PowerShell stager.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A2/3 - Detailed wmiprvse.exe executing powershell stager", "ScreenshotName": "SentinelOne-APT29-6992.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) was generated for WMI launching a PowerShell downloader.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7277.png"}, {"ScreenshotName": "SecureWorks-APT29-7276.png"}, {"ScreenshotName": "SecureWorks-APT29-7275.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17652.png"}, {"ScreenshotName": "SecureWorks-APT29-17653.png"}], "Score": 10}], "Step score": 75}}, "15.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Windows Management Instrumentation Consumer Binding\" was generated due to the modification a WMI filter. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "wmi persistence via consumer binding  alert", "ScreenshotName": "Elastic-APT29-1494.png"}], "Score": 72}, {"DetectionNote": "A Technique detection for \"ATT&CK T1084 Windows Management Instrumentation Event Subscription\" was generated due to a PowerShell script containing WindowsParentalControlMigration. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "powershell event enrichment tag for peristence - T1084 wmi event subscription ", "ScreenshotName": "Elastic-APT29-1481.png"}], "Score": 67}, {"DetectionNote": "Telemetry showed a PowerShell script containing WindowsParentalControlMigration. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "script block of username", "ScreenshotName": "Elastic-APT29-1484.png"}], "Score": 17}], "Step score": 156}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for PowerShell creating a WMI event subscription.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14507.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13724.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of WMI persistence established for user Oscar.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13254.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3400.png"}], "Score": 17}], "Step score": 152}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of WMI persistence established for user Oscar.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 15.A", "ScreenshotName": "FireEye-APT29-13037.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "15.A.2 - Script block for the WMI event filter", "ScreenshotName": "FireEye-APT29-11512.png"}, {"ScreenshotCaption": "15.A.2 - Script block for the WMI event consumer", "ScreenshotName": "FireEye-APT29-11513.png"}, {"ScreenshotCaption": "15.A.2 - Script block for the binding", "ScreenshotName": "FireEye-APT29-11514.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated due to the creation of a new WMI consumer. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-918.png"}, {"ScreenshotName": "Bitdefender-APT29-913.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection was generated due to the creation of a new WMI filter. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-918.png"}, {"ScreenshotName": "Bitdefender-APT29-913.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection was generated due to the creation of a new WMI subscription. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-922.png"}, {"ScreenshotName": "Bitdefender-APT29-913.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed the creation of the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-923.png"}, {"ScreenshotName": "Bitdefender-APT29-919.png"}, {"ScreenshotName": "Bitdefender-APT29-928.png"}], "Score": 10}], "Step score": 226}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Windows Management Instrumentation Event Subscription\" was generated due to the Suspicious Indicator \"Detected WMI event subscription.\"", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1855.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1856.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_WMI_EventSubscription_Persistence_MITRET1084\" was generated due to WMI operations subscribing to an event.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12094.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12304.png"}], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique detection for \"WmiFilterConsumerBind\" was generated due to the WindowsParentalControlMigration event filter creation. ", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "15a2 - new vendor screen", "ScreenshotName": "CrowdStrike-APT29-15451.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing WMI filter command line.", "ScreenshotName": "CrowdStrike-APT29-10655.png"}, {"ScreenshotCaption": "Telemetry showing WMI filter, consumer, and binding created in root/subscription.", "ScreenshotName": "CrowdStrike-APT29-10654.png"}], "Score": 17}], "Step score": 77}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" occurred containing evidence of WindowsParentalControlMigration WMI filter.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2 - better pic", "ScreenshotName": "Cybereason-APT29-10801.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection called \"WMI Event Subscriptionmodule WindowsParentalControlMigration contains suspicious argument\" was generated on WMIProcessCreationEvent and WMIConsumerEvent being created in root/subscription. ", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "15a2 - technique ", "ScreenshotName": "Symantec-APT29-17713.png"}], "Score": 60}, {"DetectionNote": "A General alert detection called \"SEP detected: CLDownloader!gen1\" was generated on subscription:CommandLineEventConsumer.Name=WindowsParentalControlMigration.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "15a2 - General", "ScreenshotName": "Symantec-APT29-17715.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"WMI Event Subscription\" was received that included a PowerShell command executed by the adversary and explained that it was used to establish persistence through a WMI Event Subscription that executes upon user logon.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: WMI Event Subscription", "ScreenshotName": "Symantec-APT29-12966.png"}], "Score": 70}], "Step score": 165}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of WMI persistence established for user Oscar.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "15.a.2 MSSP report #2", "ScreenshotName": "Kaspersky-APT29-12405.png"}, {"ScreenshotCaption": "15.a.2 MSSP report #1", "ScreenshotName": "Kaspersky-APT29-12404.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Established WMI event subscription persistence using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of WMI persistence being installed using the PowerShell function \"wmi.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - raw wmi function", "ScreenshotName": "F-Secure-APT29-11316.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17372.png"}, {"ScreenshotCaption": "wmi stuff", "ScreenshotName": "F-Secure-APT29-10381.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (medium risk) called \"Windows Management Instrumentation Event Subscription\" was generated due to the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12123.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12120.png"}], "Score": 10}], "Step score": 75}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (green indicator) called \"WMI Event Consumer\" was generated due to the WMI subscription creation. The detection was correlated to a parent alert for WmiPrvSE.exe executing powershell.exe.", "Detect": "Technique-Alert-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-185.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (green indicator) called \"WMI Event Filter\" was generated due to the WMI subscription creation. The detection was correlated to a parent alert for WmiPrvSE.exe executing powershell.exe.", "Detect": "Technique-Alert-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-185.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the PowerShell commands to generate the WMI subscription.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-319.png"}], "Score": 3}], "Step score": 133}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Windows Management Instrumentation Event Subscription was generated due to a WMI event filter being bound to a suspicious event consumer.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-618.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for Persistence was generated containing evidence PowerShell commands were executed to use WMI to subscribe to the WindowsParentalControlMigration scheduled task start event for user 'Oscar'.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1146.png"}, {"ScreenshotName": "Microsoft-APT29-1145.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-523.png"}, {"ScreenshotName": "Microsoft-APT29-621.png"}], "Score": 10}], "Step score": 145}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for PowerShell establishing WMI event subscription persistence.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13961.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell establishing WMI event subscription persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12769.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4258.png"}, {"ScreenshotName": "Carbon Black-APT29-4264.png"}], "Score": 17}], "Step score": 152}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red alert icon) for \"Windows Management Instrumentation Event Subscription\" was generated due to the WindowsParentalControlMigration event filter creation. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Alert for WMI persistenct with powershell command and enrichments.", "ScreenshotName": "CyCraft-APT29-2458.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" was occurred containing evidence of a PowerShell script and explained that it was used establish persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "15.A.2 - MDR Report Day 2, WMI persistence command set", "ScreenshotName": "CyCraft-APT29-12504.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred for WMI event subscription being used for a persistence mechanism. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12716.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Critical severity) called \"WMI Event Filter Creation\" was generated due to the creation of a new WMI event filter.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3876.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (Reminder severity) called \"WMI __EventConsumer\" was generated due to the creation of a new WMI event consumer.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3873.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4229.png"}], "Score": 10}], "Step score": 140}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"WMI\" under \"Persistence {T1084}\" was generated when a WMI binding was created under root/subscription. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "A2 - WMI Persistence Alert of root/subscription", "ScreenshotName": "SentinelOne-APT29-6895.png"}], "Score": 72}, {"DetectionNote": "A General detection for a suspicious \"WMIOperation\" showed WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.", "Detect": "General-Correlated", "Screenshots": [{"ScreenshotCaption": "A2 - Specific WindowsParentalControlMigration in root/subscription", "ScreenshotName": "SentinelOne-APT29-6896.png"}], "Score": 37}, {"DetectionNote": "An MSSP detection for \"T1084\" occurred containing evidence of WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A2 - WMI info pt2", "ScreenshotName": "SentinelOne-APT29-12875.png"}, {"ScreenshotCaption": "MSSP - A2 - WMI info", "ScreenshotName": "SentinelOne-APT29-12874.png"}, {"ScreenshotCaption": "MSSP - A1/2 - SBL", "ScreenshotName": "SentinelOne-APT29-12876.png"}], "Score": 70}], "Step score": 179}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique detection alert (high severity) called \"WMI Persistence for Encoded PowerShell 2\" was generated due to the WindowsParentalControlMigration WMI filter and consumer.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13778.png"}, {"ScreenshotName": "SecureWorks-APT29-13779.png"}], "Score": 65}, {"DetectionNote": "A Technique detection alert (info severity) called \"WMI event consumer with base64 content\" was generated due to the WindowsParentalControlMigration WMI filter and consumer.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7106.png"}, {"ScreenshotName": "SecureWorks-APT29-7105.png"}, {"ScreenshotName": "SecureWorks-APT29-7108.png"}], "Score": 65}, {"DetectionNote": "A Technique detection alert (info severity) called \"WMI Filter to Consumer Binding\" was generated due to the WindowsParentalControlMigration WMI filter and consumer.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13791.png"}, {"ScreenshotName": "SecureWorks-APT29-13790.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the creation of the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13776.png"}, {"ScreenshotName": "SecureWorks-APT29-13777.png"}], "Score": 10}], "Step score": 205}}}, "TechniqueName": "Windows Management Instrumentation Event Subscription", "Steps count": 2, "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}]}, "T1085": {"Steps": {"20.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"RunDLL32 with Suspicious DLL Location\" was generated for rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "rundll32 with suspicious dll location alert, showing command line with .lock", "ScreenshotName": "Elastic-APT29-1613.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "rundll32 with suspicious dll location alert, showing command line with .lock", "ScreenshotName": "Elastic-APT29-1613.png"}], "Score": 10}], "Step score": 75}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence of rundll32.exe executing kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3322.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3325.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Rundll32 Execution\" was generated due to the execution of rundll32.exe on kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.A.1 - Rundll32 execution on kxwn.lock (top)", "ScreenshotName": "FireEye-APT29-11664.png"}, {"ScreenshotCaption": "20.A.1 - Rundll32 execution on kxwn.lock (bottom)", "ScreenshotName": "FireEye-APT29-11665.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection called \"Rundll32 Not Running DLL\" was generated due to rundll32.exe executing kxwn.lock, which did not have a .dll extension.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.A.1 - Rundll32 not running file with a .dll extension (top)", "ScreenshotName": "FireEye-APT29-11662.png"}, {"ScreenshotCaption": "20.A.1 - Rundll32 not running file with a .dll extension (bottom)", "ScreenshotName": "FireEye-APT29-11663.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for rundll32.exe executing kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 20.A", "ScreenshotName": "FireEye-APT29-13054.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 210}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for \"rundll32uncommonload\" due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1016.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (orange; medium risk) called \"Rundll32\" was generated due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-14750.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1915.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Win_Rundll32_Usage_MitreT1085\" was generated due to Rundll32 executing a DLL. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12169.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing rundll32.exe executing kxwn.lock.", "ScreenshotName": "CrowdStrike-APT29-10738.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20.a.1 - command line from properties from process", "ScreenshotName": "Cybereason-APT29-9830.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Rundll32\" was generated on \"malicious file kxwn.lock with heuristic signature SONAR.Module!gen3\".", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20a1 - technique detection on SONAR TRIGGERING EVENT", "ScreenshotName": "Symantec-APT29-17729.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection called \"SONAR - RunDLL32 loaded a suspicious DLL\" was generated due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Rundll32 loaded a suspicious DLL alert, tagged with Rundll32", "ScreenshotName": "Symantec-APT29-9853.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Rundll32 loaded a suspicious DLL alert, tagged with Rundll32", "ScreenshotName": "Symantec-APT29-9853.png"}], "Score": 10}], "Step score": 140}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow, medium severity) called Rundll32 Execution was generated due to rundll32.exe executing kxwn.lock. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.a.1 - rundll32 exec kxwn.lock", "ScreenshotName": "Kaspersky-APT29-3355.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of rundll32.exe executing kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.a.1 MSSP report", "ScreenshotName": "Kaspersky-APT29-12421.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20.a.1 - rundll32 exec kxwn.lock", "ScreenshotName": "Kaspersky-APT29-3355.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Executed Run key persistence payload on user login using RunDll32", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Rare DLL explicitly loaded by rundll32\" was generated due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20a1 - detection name, rundll32 /kxwn from explorer  - need to move", "ScreenshotName": "F-Secure-APT29-10499.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (medium severity) called \"Rundll32 launching a DLL in the AppData directory\" was generated due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "poshc2 tag", "ScreenshotName": "F-Secure-APT29-10526.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "rundll32 .lock", "ScreenshotName": "F-Secure-APT29-10518.png"}], "Score": 10}], "Step score": 140}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for a previously planted persistence mechanism executing rundll32.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17571.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Rundll32\" was generated due to rundll32.exe executing kxwn.lock. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-223.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (orange, suspicious tag) was generated for kxwn.lock being potential malware. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-548.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for Execution was generated containing evidence that rundll32.exe executed the VoidFunc function from file kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1149.png"}, {"ScreenshotName": "Microsoft-APT29-1150.png"}], "Score": 70}], "Step score": 105}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of rundll32.exe executing kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4364.png"}], "Score": 10}], "Step score": 80}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for rundll32.exe executing kxwn.lock.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "rundll32 executing lock file with enrichments", "ScreenshotName": "CyCraft-APT29-2491.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Rundll32\" described rundll32.exe executing kxwn.lock, triggered by Registry Run Keys / Startup Folder persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock", "ScreenshotName": "CyCraft-APT29-12521.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred for rundll32.exe executing kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12737.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"rundll32 abuse\" was generated due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "rundll32.exe executing kxwn.lock (20a1) - staging environment", "ScreenshotName": "MalwareBytes-APT29-2567.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"Rundll32\" was generated due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3963.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1085\" occurred containing evidence of rundll32.exe executing kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - rundll32.exe executing kxwn.lock", "ScreenshotName": "SentinelOne-APT29-12891.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A1 - rundll32.exe process spawning and executing kxwn.lock", "ScreenshotName": "SentinelOne-APT29-6980.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) for Rundll32 called \"PowerDuke DLL Name\" was generated due to rundll32.exe executing kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7268.png"}, {"ScreenshotName": "SecureWorks-APT29-7271.png"}, {"ScreenshotName": "SecureWorks-APT29-7267.png"}, {"ScreenshotName": "SecureWorks-APT29-7269.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17650.png"}], "Score": 10}], "Step score": 75}}}, "TechniqueName": "Rundll32", "Steps count": 1, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}]}, "T1088": {"Steps": {"14.A.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).  The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "14a2 - better pic for EG client", "ScreenshotName": "Elastic-APT29-14971.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13244.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3379.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3380.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdclt Child Process\" was generated due to sdclt.exe spawning control.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.A.2 - Sdclt Child Process of control.exe", "ScreenshotName": "FireEye-APT29-11441.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.A", "ScreenshotName": "FireEye-APT29-13033.png"}, {"ScreenshotCaption": "MSSP - 14.A", "ScreenshotName": "FireEye-APT29-13032.png"}], "Score": 70}], "Step score": 135}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Bypass User Account Control\" was generated for a suspicious process elevation.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-862.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed control.exe spawning a powershell.exe tagged as High Integrity level and possessing elevated process access privileges.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-863.png"}], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1844.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed sdclt.exe spawning control.exe, which then spawns powershell.exe.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12298.png"}], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cBypass User Account Control\u201d was generated when the parent powershell.exe process of sdclt.exe attempted to escalated privileges with UAC bypass or UAC elevation. The event was correlated to a parent Technique detection for PowerShell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cBypass User Account Control\u201d from the parent powershell.exe process of sdclt.exe attempting to escalated privileges with UAC bypass or UAC elevation.", "ScreenshotName": "CrowdStrike-APT29-10625.png"}], "Score": 72}, {"DetectionNote": "A Tactic alert detection (red indicator) called \u201cPrivilege Escalation \u2013 Access Token Manipulation\u201d was generated powershell.exe impersonated another user via access token manipulation. The event was correlated to a parent technique detection for PowerShell.", "Detect": "Tactic-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Tactic detection for \u201cPrivilege Escalation \u2013 Access Token Manipulation\u201d from a powershell.exe process escalating privileges via UAC elevation or token theft. Tactic detection for \u201cPrivilege Escalation \u2013 Access Token Manipulation\u201d from powershell.exe impersonating another user via access token manipulation.", "ScreenshotName": "CrowdStrike-APT29-10620.png"}], "Score": 52}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).  The event was correlated to a parent technique detection for PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing high integrity powershell spawned.", "ScreenshotName": "CrowdStrike-APT29-10629.png"}], "Score": 17}], "Step score": 141}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection (red; unique symbol) was generated for \"malicious use of powershell.exe\" that showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "14.a.2 - process details", "ScreenshotName": "Cybereason-APT29-9734.png"}, {"ScreenshotCaption": "14.a.2 - powershell.exe malicious use, process tree view", "ScreenshotName": "Cybereason-APT29-9731.png"}, {"ScreenshotCaption": "14.a.2 - high integrity from behavior", "ScreenshotName": "Cybereason-APT29-9733.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "14.a.2 - powershell.exe malicious use, process tree view", "ScreenshotName": "Cybereason-APT29-9731.png"}], "Score": 17}], "Step score": 59}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection for \"UAC Bypass\" was generated when the setting of registry values associated with COM Hijacking was followed by execution of a program known to be associated with UAC bypasses. The event was correlated to a parent Tactic detection called \"Execution\" that was generated when explorer.exe executed powershell.exe.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "Suspected UAC Bypass, with execution of powershell.exe", "ScreenshotName": "Symantec-APT29-9737.png"}, {"ScreenshotCaption": "Suspected UAC bypass in the context of an Incident Report. Detection is based on COM Hijacking followed by execution of UAC \"bypassable\" executables", "ScreenshotName": "Symantec-APT29-9740.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Shows lineage of processes, with change in integrity levels, and command-line arguments showing the stager.", "ScreenshotName": "Symantec-APT29-9752.png"}], "Score": 10}], "Step score": 82}, "Kaspersky": {"Detects": [{"DetectionNote": "A General alert detection (red; high severity) for \"Suspicious PowerShell\" was generated due to execution of powershell.exe by control.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "14a2 - new vendor pic", "ScreenshotName": "Kaspersky-APT29-17915.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.a.1-3 MSSP report", "ScreenshotName": "Kaspersky-APT29-12397.png"}], "Score": 70}], "Step score": 105}, "Procedure": "Executed elevated PowerShell payload", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-15071.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of executed function \"bypass.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}, {"ScreenshotCaption": "MSSP - raw function", "ScreenshotName": "F-Secure-APT29-11313.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (indicated by the true \"elev\" flag).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "true elevated tag ", "ScreenshotName": "F-Secure-APT29-10317.png"}], "Score": 10}], "Step score": 115}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for sdclt.exe spawning a High Integrity level PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent alert for  PowerShell executing an ADS.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12143.png"}, {"ScreenshotName": "TrendMicro-APT29-12099.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique detection (orange indicator) called \"Bypass User Account Control\" was generated on the PowerShell callback spawned from control.exe. The detection was correlated to a parent alert for suspicious file deobfuscation via certutil.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-176.png"}], "Score": 72}], "Step score": 72}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection for UAC bypass (medium severity) was generated. The detection included  sdclt.exe executing with elevated permissions.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17381.png"}, {"ScreenshotName": "Microsoft-APT29-502.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a High Integrity powershell.exe process executing from control.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-503.png"}], "Score": 10}], "Step score": 75}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for bypassing UAC with sdclt.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4195.png"}, {"ScreenshotName": "Carbon Black-APT29-4193.png"}, {"ScreenshotName": "Carbon Black-APT29-4194.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection was generated for supicious privilege escalation process behavior by PowerShell.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4193.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell elevating privileges via a UAC bypass using sdclt.exe and control.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12767.png"}], "Score": 70}], "Step score": 180}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated showing a new High Integrity PowerShell callback spawned from control.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: sdlct.exe executed in high integrity from powershell.exe", "ScreenshotName": "CyCraft-APT29-2320.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Bypass User Account Control\" was received that included a PowerShell script and explained that it was used to bypass UAC.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.A.2 - MDR Report Day 2, UAC bypass", "ScreenshotName": "CyCraft-APT29-12498.png"}, {"ScreenshotCaption": "14.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-12495.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (green indicator) called \"User Account Control Bypass\" was generated due to the PowerShell callback spawned from control.exe. The event was correlated to a parent General detection for a suspicious process", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11392.png"}, {"ScreenshotName": "GoSecure-APT29-11396.png"}, {"ScreenshotName": "GoSecure-APT29-11394.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The event was correlated to a parent General detection for a suspicious process", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11396.png"}], "Score": 17}], "Step score": 89}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique detection \"Bypass UAC Attempt by TokenElevationType\" (warning severity) was generated due to control.exe spawning powershell.exe with high privileges.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3818.png"}, {"ScreenshotName": "HanSight-APT29-3821.png"}], "Score": 65}], "Step score": 65}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1088\" occurred containing evidence of a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe) with TokenMismatch indicator.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - TokenMissmatch, new ps session, sdlc.exe usage (medium integrity)", "ScreenshotName": "SentinelOne-APT29-12860.png"}, {"ScreenshotCaption": "MSSP - HI PowerShell, SBL", "ScreenshotName": "SentinelOne-APT29-12863.png"}, {"ScreenshotCaption": "MSSP - sdclt -> control.exe, sdclt (high integ)", "ScreenshotName": "SentinelOne-APT29-12861.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A2 - Process tree of HI powershell spawned from control.exe spawned from sdclt.exe", "ScreenshotName": "SentinelOne-APT29-6851.png"}, {"ScreenshotCaption": "A2 - Detailed process creation of control.exe at HI as well as encoded powershell command being executed", "ScreenshotName": "SentinelOne-APT29-6850.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell elevated privileges by bypassing UAC.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13772.png"}, {"ScreenshotName": "SecureWorks-APT29-12785.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7055.png"}, {"ScreenshotName": "SecureWorks-APT29-7051.png"}], "Score": 10}], "Step score": 80}}, "3.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "endgame client search to show integrity levels of powershell. shows high, and all others medium", "ScreenshotName": "Elastic-APT29-1208.png"}, {"ScreenshotCaption": "powershell running with unusual arguments execution alert", "ScreenshotName": "Elastic-APT29-1207.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for for \"Bypass User Account Control VIA registry hijack T1088\" for control.exe creating a high integrity powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2741.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2744.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"UAC bypass (T1088)\" occurred for a new high hntegrity PowerShell callback spawning from control.exe\u200b\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13197.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdclt Child Process\" was generated due to sdclt.exe spawning control.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "3.B.2 - Sdclt Child Process for sdclt.exe spawning control.exe", "ScreenshotName": "FireEye-APT29-10908.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for a new high integrity PowerShell callback spawned from control.exe\u200b\u200b.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 3.B", "ScreenshotName": "FireEye-APT29-12984.png"}], "Score": 70}], "Step score": 135}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for Bypass User Account Control was generated for sdclt.exe being executed with a higher integrity level than its parent process. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13421.png"}, {"ScreenshotName": "Bitdefender-APT29-664.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (red indicator) was generated for powershell.exe being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-662.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed control.exe spawning a powershell.exe tagged as High Integrity level and possessing elevated process access privileges.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 124}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1468.png"}, {"ScreenshotName": "McAfee-APT29-1467.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed control.exe spawning powershell.exe.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11862.png"}], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (purple hexagon) called \"Bypass User Account Control\" was generated when control.exe spawned an elevated PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Technique detection for \"Bypass User Account Control\" showing control.exe spawning an elevated powershell correlated with res.3aka3.doc.", "ScreenshotName": "CrowdStrike-APT29-10265.png"}], "Score": 72}, {"DetectionNote": "A Tactic alert detection (purple hexagon) called \"Defense Evasion\" was generated when a process reflectively loaded a DLL associated with meterpreter using the PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Tactic-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "3.b.2 incident view mode for monkey file being read by Powershell to deobfuscate", "ScreenshotName": "CrowdStrike-APT29-10261.png"}], "Score": 52}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the integrity level of the elevated powershell process running.", "ScreenshotName": "CrowdStrike-APT29-10272.png"}], "Score": 17}], "Step score": 141}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection (red; unique symbol) for malicious PowerShell was generated for new high integrity PowerShell callback spawning from control.exe\u200b\u200b. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "3.b.2 - high integrity proess", "ScreenshotName": "Cybereason-APT29-7389.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "3.b.2 - high integrity proess", "ScreenshotName": "Cybereason-APT29-7389.png"}], "Score": 17}], "Step score": 59}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "control.exe executing powershell.exe to decode script from monkey.png", "ScreenshotName": "Symantec-APT29-7397.png"}, {"ScreenshotCaption": "Decoder event with columns for user, integrity evel, pid, and command-line arguments showing the stager", "ScreenshotName": "Symantec-APT29-7400.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "A General alert detection (red; high severity) for \"Suspicious PowerShell\" was generated due to execution of powershell.exe by control.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "3.b.2 - powershell from control with alert", "ScreenshotName": "Kaspersky-APT29-2709.png"}, {"ScreenshotCaption": "There was no indication the PowerShell process was high integrity.", "ScreenshotName": "Kaspersky-APT29-2710.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Possible UAC Bypass\" contained evidence of a new highiIntegrity PowerShell callback spawning from control.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 3b2", "ScreenshotName": "Kaspersky-APT29-17991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell spawning from control.exe\u200b\u200b.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "3.b.2 - powershell from control with alert", "ScreenshotName": "Kaspersky-APT29-2709.png"}], "Score": 10}], "Step score": 115}, "Procedure": "Executed elevated PowerShell payload", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14966.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for User DMEVALS\\pam launching a command prompt from which the sdclt.exe program was used. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - bypass uac ", "ScreenshotName": "F-Secure-APT29-11267.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17347.png"}], "Score": 10}], "Step score": 115}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell callback spawning from control.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11867.png"}, {"ScreenshotName": "TrendMicro-APT29-11869.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Bypass User Account Control\" was generated due to a high integrity PowerShell spawning from control.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-59.png"}], "Score": 72}], "Step score": 72}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection for UAC bypass (medium severity) was generated. The detection included  sdclt.exe executing with elevated permissions.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-373.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-381.png"}], "Score": 10}], "Step score": 75}, "VMware": {"Detects": [{"DetectionNote": "A Tactic alert detection was generated for \"Privilege Escalation\" based on suspicious PowerShell behavior.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3799.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection was generated for the use of sdclt.exe as a high privilege process, which called control.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12752.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3793.png"}], "Score": 17}], "Step score": 132}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"Bypass UAC\" was generated when sdclt.exe was executed in a high integrity context by cmd.exe. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier: UAC Bypass detection", "ScreenshotName": "CyCraft-APT29-2208.png"}], "Score": 72}, {"DetectionNote": "A Tactic alert detection (yellow indicator) was generated for an unprivileged process executing another program with SYSTEM permissions.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "Bypass UAC.  Shows moving from different CyCarrier: process integrity levels", "ScreenshotName": "CyCraft-APT29-2083.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"Bypass User Account Control\" was received that explained that cmd.exe (medium integrity) executed sdclt.exe (high integrity) to facilitate a UAC bypass resulting in execution of powershell.exe (High Integrity).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "3.B.1, 3.B.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12243.png"}], "Score": 70}], "Step score": 187}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Bypass User Account Control\" was generated due to PowerShell spawning from control.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10841.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10841.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Bypass UAC Attempt by TokenElevationType\" was generated due to control.exe spawning powershell.exe with high privilege.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3482.png"}, {"ScreenshotName": "HanSight-APT29-3486.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15120.png"}], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"TokenManipulation\" was generated when user Pam targeted user \"NT AUTHORITY\\SYSTEM\" in conjunction with \"setcbprivilege\" usage. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B2 - shows process integrity level", "ScreenshotName": "SentinelOne-APT29-6512.png"}, {"ScreenshotCaption": "B2 - shows integrity level of \"3\" ", "ScreenshotName": "SentinelOne-APT29-6513.png"}, {"ScreenshotCaption": "B2 - Was able to capture that token manipulation was used to escalate privs", "ScreenshotName": "SentinelOne-APT29-6516.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1088\" occurred containing evidence of new high integrity PowerShell callback spawning from control.exe\u200b\u200b (spawned from sdclt.exe).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2 - UAC Bypass info", "ScreenshotName": "SentinelOne-APT29-12806.png"}, {"ScreenshotCaption": "MSSP - B2 - UAC Bypass info", "ScreenshotName": "SentinelOne-APT29-12805.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a new high integrity PowerShell callback spawning from control.exe\u200b\u200b (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B2 - Shows tree view of processes and their integrity level. ", "ScreenshotName": "SentinelOne-APT29-6514.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection occurred for a new high integrity PowerShell callback spawned from control.exe\u200b\u200b using sdclt.exe", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12589.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6544.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Bypass User Account Control", "Steps count": 2, "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}]}, "T1057": {"Steps": {"4.B.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "get process powershell cmdlet event", "ScreenshotName": "Elastic-APT29-1220.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13209.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2833.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2832.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.B", "ScreenshotName": "FireEye-APT29-12989.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.B.1 - Script block log showing the execution of Get-Process", "ScreenshotName": "FireEye-APT29-10999.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection for \"powershellprocessdiscovery\" was generated due to powershell.exe executing Get-Process.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1058.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 61}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Win_GetSystemProcess_Powershell-MITRET1057\" was generated due to powershell.exe executing Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11904.png"}, {"ScreenshotName": "Cylance-APT29-11905.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing  powershell.exe executing Get-Process. ", "ScreenshotName": "CrowdStrike-APT29-10298.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Process Discovery name", "ScreenshotName": "Symantec-APT29-12911.png"}, {"ScreenshotCaption": "MSSP Day 1: Process Discovery description", "ScreenshotName": "Symantec-APT29-12910.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated current running processes using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "get-process", "ScreenshotName": "F-Secure-APT29-10056.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Process Discovery\" (low severity) was generated due to powershell.exe executing Get-Process.\n", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12318.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11877.png"}], "Score": 10}], "Step score": 138}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-246.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence that multiple local and domain reconnaissance operations were executed. Get-Process was specifically identified in the report.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-402.png"}, {"ScreenshotName": "Microsoft-APT29-403.png"}, {"ScreenshotName": "Microsoft-APT29-404.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13985.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3902.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated due to powershell.exe executing Get-Process. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Get-Process with enrichments", "ScreenshotName": "CyCraft-APT29-2217.png"}], "Score": 42}], "Step score": 42}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (reminder severity) called \"Process Discovery via PowerShell\" was generated due to the use of Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3527.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3526.png"}], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.1 - Process Discovery from PowerShell", "ScreenshotName": "SentinelOne-APT29-14654.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1057\" occurred containing evidence of PowerShell listing current process via \u201cGet-Process\u201d.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - Get-Process", "ScreenshotName": "SentinelOne-APT29-12811.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Configuration Change (UX)-Correlated", "Screenshots": [{"ScreenshotCaption": "CC - B1 - Generic alert for Execution of Get-Process in UI", "ScreenshotName": "SentinelOne-APT29-7189.png"}], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" occurred containing evidence of powershell.exe executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12596.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6634.png"}], "Score": 10}], "Step score": 80}}, "4.C.5": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c4-6 script block event (same as above)", "ScreenshotName": "Elastic-APT29-1230.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}], "Score": 10}], "Step score": 10}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $PID.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: $PID.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.5 - Script block for $PID", "ScreenshotName": "FireEye-APT29-11019.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using $PID.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing $PID.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}, {"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the current PID.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}, {"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated the current process ID using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "invoke-discovery", "ScreenshotName": "F-Secure-APT29-10062.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $PID. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: $PID. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-581.png"}, {"ScreenshotName": "Microsoft-APT29-13988.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current environment information.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3543.png"}, {"ScreenshotName": "HanSight-APT29-3532.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" was generated when PowerShell accessed $PID. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "C5 - Shows general discovery, no mention of environment variable.", "ScreenshotName": "SentinelOne-APT29-6536.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"basic discovery\" containing evidence of $PID usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1-5 - readme.ps1", "ScreenshotName": "SentinelOne-APT29-12815.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: $PID.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - Process Discovery\" occurred containing evidence of powershell.exe executing: $env:PID.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe executing: $env:PID.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6628.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 80}}, "14.B.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Process Discovery via WMI\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "process discovery via wmi alert", "ScreenshotName": "Elastic-APT29-13697.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "get process from script block event", "ScreenshotName": "Elastic-APT29-1449.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.B", "ScreenshotName": "FireEye-APT29-13036.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "14.B.2 - Script block for Get-Process", "ScreenshotName": "FireEye-APT29-11500.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert was generated for the execution of a PowerShell process discovery command.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1103.png"}, {"ScreenshotName": "Bitdefender-APT29-1102.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 61}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Win_GetSystemProcess_Powershell_MITRET1057\" was generated due to powershell.exe executing Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12087.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Process. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing PowerShell executing Get-Process. Telemetry showing PowerShell executing Get-WmiObject to read encoded content from Win32_AuditCode.", "ScreenshotName": "CrowdStrike-APT29-10647.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" occurred containing evidence of PowerShell Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - get process ", "ScreenshotName": "Cybereason-APT29-10795.png"}, {"ScreenshotCaption": "MSSP - description of get-process", "ScreenshotName": "Cybereason-APT29-10796.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell collecting information about running processes.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.b.2 - MSSP report", "ScreenshotName": "Kaspersky-APT29-12402.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "get process", "ScreenshotName": "F-Secure-APT29-10335.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"PS1.ProcessDiscover T1057\" was generated due to powershell.exe executing Get-Process.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12110.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for PowerShell executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12104.png"}], "Score": 10}], "Step score": 140}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-314.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Process. Script preview was truncated so an alternate view was shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-509.png"}, {"ScreenshotName": "Microsoft-APT29-510.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) was generated for PowerShell enumerating processes. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4223.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Process Discovery\" was generated for PowerShell executing Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Get-process with enrichments", "ScreenshotName": "CyCraft-APT29-2450.png"}, {"ScreenshotCaption": "get-wmiobject with enrichments in graph view", "ScreenshotName": "CyCraft-APT29-2456.png"}], "Score": 65}], "Step score": 65}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (reminder severity) called \"Process Discovery via PowerShell\"  was generated due to PowerShell executing Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3843.png"}, {"ScreenshotName": "HanSight-APT29-3844.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B2 - Process enumeration alert", "ScreenshotName": "SentinelOne-APT29-6876.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B2 - Powershell alert of command containing get-process", "ScreenshotName": "SentinelOne-APT29-7258.png"}], "Score": 10}], "Step score": 82}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Discovery - Process Discovery\" occurred containing evidence of PowerShell Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12652.png"}, {"ScreenshotName": "SecureWorks-APT29-12653.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7062.png"}, {"ScreenshotName": "SecureWorks-APT29-7057.png"}, {"ScreenshotName": "SecureWorks-APT29-7061.png"}], "Score": 10}], "Step score": 80}}, "11.A.8": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "alert for multiple wmi discovery techniques", "ScreenshotName": "Elastic-APT29-1364.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "win32 process wmi event", "ScreenshotName": "Elastic-APT29-1365.png"}], "Score": 10}], "Step score": 55}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"process discovery - T1057\" was generated for a PowerShell gwmi query for Win32_Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3137.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}, {"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13024.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A.8 - gwmi query for Win32_Process", "ScreenshotName": "FireEye-APT29-11391.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for the execution of a process discovery command via Windows Management Instrumentation.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-812.png"}, {"ScreenshotName": "Bitdefender-APT29-800.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1928.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) for a suspicious WMI query operation was generated for a WMI operation via PowerShell.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12056.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 55}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Win32 process executing...attempting to retrieve users\" occurred containing evidence of the PowerShell gwmi query for Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a8 ", "ScreenshotName": "Cybereason-APT29-10788.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate running processes on the local system.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery Techniques", "ScreenshotName": "Symantec-APT29-12948.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery description", "ScreenshotName": "Symantec-APT29-12949.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a8", "ScreenshotName": "Kaspersky-APT29-18011.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process", "ScreenshotName": "F-Secure-APT29-11306.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a3-8 - thp - wmi stuff", "ScreenshotName": "F-Secure-APT29-10234.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_Process. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-290.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to get process information on the machine: gwmi -namespace root\\cimv2 -query 'SELECT * FROM Win32_Process'.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1140.png"}, {"ScreenshotName": "Microsoft-APT29-1141.png"}, {"ScreenshotName": "Microsoft-APT29-1139.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-469.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4167.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Process Discovery\" was generated for a PowerShell gwmi query for Win32_Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell wmi query of running processes with enrichments", "ScreenshotName": "CyCraft-APT29-2424.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_Process via WMI.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.8 - MDR Report Day 2, Win32_Process", "ScreenshotName": "CyCraft-APT29-12478.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12709.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"Process Discovery via Powershell\" was generated for a PowerShell gwmi query for Win32_Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3732.png"}, {"ScreenshotName": "HanSight-APT29-3734.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated due to the PowerShell gwmi query for Win32_Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.A.8 - Process Discovery", "ScreenshotName": "SentinelOne-APT29-14983.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection for \"Discovery\" under \"SuspiciousWMIQuery\" was generated on a suspicious WMI query targeting Win32_Process. ", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "A8 - WMI win32_process", "ScreenshotName": "SentinelOne-APT29-6794.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"information discovery\" occurred containing evidence of Process Enumeration relating to WMI query targeting Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration", "ScreenshotName": "SentinelOne-APT29-12845.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A.8 - WMIOperation for Win32_Process", "ScreenshotName": "SentinelOne-APT29-17534.png"}], "Score": 10}], "Step score": 190}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"WMI Queries Win32_Process\", was generated for a PowerShell gwmi query for Win32_Process..", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6947.png"}, {"ScreenshotName": "SecureWorks-APT29-6948.png"}, {"ScreenshotName": "SecureWorks-APT29-6946.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Discovery - Process Discovery\" occurred for the PowerShell gwmi query for Win32_Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13768.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17633.png"}, {"ScreenshotName": "SecureWorks-APT29-17634.png"}], "Score": 10}], "Step score": 145}}, "8.A.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed wsmprovhost.exe executing Get-Process. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Get-process", "ScreenshotName": "Elastic-APT29-1291.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Process Discovery with PowerShell\" was generated due to powershell.exe executing Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3005.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3003.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3004.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for powershell.exe executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13221.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3007.png"}], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.A", "ScreenshotName": "FireEye-APT29-13003.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8.A.3 - Script block for Get-Process", "ScreenshotName": "FireEye-APT29-11163.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for the execution of a PowerShell process discovery command. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13435.png"}, {"ScreenshotName": "Bitdefender-APT29-13436.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1071.png"}], "Score": 3}], "Step score": 61}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Win_GetSystemProcess_Powershell_MITRET1057\"  was generated due to a PowerShell payload containing Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11960.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Command and Ad-Search.  (no execution on the Scranton host yet?)", "ScreenshotName": "CrowdStrike-APT29-10451.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection called \"Malicious Command\" was generated for wsmprovhost.exe executing Get-Process.", "Detect": "General-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "8.a.3 - malicious command alert - Get-Process (cc)", "ScreenshotName": "Cybereason-APT29-9967.png"}], "Score": 28}], "Step score": 28}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included PowerShell commands run by the adversary and explained that they were used to enumerate running processes on remote host Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: remote process discovery", "ScreenshotName": "Symantec-APT29-12975.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell being used to get process information from the remote system Scranton.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP ", "ScreenshotName": "F-Secure-APT29-11289.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "invoke command script block get-process", "ScreenshotName": "F-Secure-APT29-10113.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Process Discovery\" was generated due to powershell.exe executing Get-Process. ", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12324.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11962.png"}], "Score": 10}], "Step score": 68}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-279.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed wsmprovhost.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-421.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for Powershell or WinRM remoting activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4041.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) for \"PowerShell\" was generated due to powershell.exe using Invoke-Command to remotely execute Get-Process on host Scranton (10.0.1.4). The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Get-Process from Nashua to Scranton", "ScreenshotName": "CyCraft-APT29-2244.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to execute Get-Process on host Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "8.A.3 - MDR Report Day 1, Process Discovery", "ScreenshotName": "CyCraft-APT29-12454.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Process Discovery via Powershell\" (reminder severity) was generated due to powershell.exe executing Get-Process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3616.png"}, {"ScreenshotName": "HanSight-APT29-3620.png"}], "Score": 65}], "Step score": 65}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated due to Invoke-Command executing Get-Process. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A3 - wmirm alert - Process enumeration", "ScreenshotName": "SentinelOne-APT29-6696.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"ProcessEnumeration\" occurred containing evidence of WinRM alerting on Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - More WinRM alerts and Get-Process", "ScreenshotName": "SentinelOne-APT29-12831.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A3 - Powershell using Get-Process", "ScreenshotName": "SentinelOne-APT29-7233.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"PowerShell cmdlet with Get-Process\" occurred containing evidence of powershell.exe executing Get-Process.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12618.png"}, {"ScreenshotName": "SecureWorks-APT29-12619.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6746.png"}, {"ScreenshotName": "SecureWorks-APT29-6747.png"}], "Score": 10}], "Step score": 80}}, "13.D.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "13d1 - better vendor pic", "ScreenshotName": "Elastic-APT29-14973.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14501.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "13.D.1 - Script block for CreateToolhelp32Snapshot API", "ScreenshotName": "FireEye-APT29-11436.png"}], "Score": 10}], "Step score": 10}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"findprocess\" was generated due to PowerShell querying the list of running processes. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-843.png"}, {"ScreenshotName": "Bitdefender-APT29-870.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection was generated for the execution of a PowerShell process discovery command.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1115.png"}], "Score": 58}], "Step score": 130}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1938.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block log function definition of \"pslist\" containing the CreateToolhelp32Snapshot API.", "Detect": "Telemetry-Configuration Change (UX)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12303.png"}], "Score": 3}], "Step score": 3}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showed the powershell script block calling the CreateToolhelp32Snapshot API.", "ScreenshotName": "CrowdStrike-APT29-10615.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for a PowerShell process occurred containing evidence of the CreateToolhelp32Snapshot API call.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - API call", "ScreenshotName": "Cybereason-APT29-10794.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" occurred containing evidence of an executed PowerShell command used to enumerate running processes on the local machine.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Process Discovery", "ScreenshotName": "Symantec-APT29-12965.png"}, {"ScreenshotCaption": "MSSP Day 1: wmidump", "ScreenshotName": "Symantec-APT29-12962.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing the CreateToolhelp32Snapshot API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 13d1", "ScreenshotName": "Kaspersky-APT29-18017.png"}, {"ScreenshotCaption": "13.d.1 MSSP report #2", "ScreenshotName": "Kaspersky-APT29-12396.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the CreateToolhelp32Snapshot API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}, {"ScreenshotCaption": "MSSP - 13a/b/c/d - function imports ", "ScreenshotName": "F-Secure-APT29-11312.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the CreateToolhelp32Snapshot API call.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "api calls with powershell", "ScreenshotName": "F-Secure-APT29-10304.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12266.png"}], "Score": 3}], "Step score": 3}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-310.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-494.png"}, {"ScreenshotName": "Microsoft-APT29-495.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4189.png"}, {"ScreenshotName": "Carbon Black-APT29-4186.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for Threat Activity.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: CreateToolHelp32Snapshot in scriptblock", "ScreenshotName": "CyCraft-APT29-2316.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Process Discovery\" occurred with evidence of a PowerShell script used to enumerate processes.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "13.A.1 - MDR Report Day 2, summary and GetComputerNameEx", "ScreenshotName": "CyCraft-APT29-12489.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3777.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ProcessEnumeration\" was generated due to running processes being enumerated. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "D1 - Alert generated for process enumeration", "ScreenshotName": "SentinelOne-APT29-6846.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1057\" occurred containing evidence of Process Enumeration and \"pslist\" function which calls CreateToolhelp32Snapshot API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - D1 - pslist SBL and alert", "ScreenshotName": "SentinelOne-APT29-12859.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - D1 - Powershell alert containing call to CreateToolhelp32Snapshot API", "ScreenshotName": "SentinelOne-APT29-7252.png"}], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection  occurred containing evidence of PowerShell calling the CreateToolhelp32Snapshot API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13771.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7039.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Process Discovery", "Steps count": 6, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1119": {"Steps": {"2.A.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "should be the same as the first screen, but showing script block again. ", "ScreenshotName": "Elastic-APT29-1198.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using Get-Childitem to search the filesystem to specific file patterns.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13640.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 2.A", "ScreenshotName": "FireEye-APT29-12979.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "2.A - Get-ChildItem from PowerShell", "ScreenshotName": "FireEye-APT29-10881.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1118.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_AutomatedCollection_DirScanART_MITRET1119\" was generated due to powershell.exe executing Get-ChildItem. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11839.png"}, {"ScreenshotName": "Cylance-APT29-11838.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Win_AutomatedCollection_DirScanART_MITRET1119\" occurred containing evidence of powershell.exe executing Get-ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12897.png"}, {"ScreenshotName": "Cylance-APT29-12898.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11837.png"}], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (purple hexagon) called \"Automated Collection\" was generated when powershell.exe executed an automated search routine with Get-ChildItem. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \"Automated Collection\" showing powershell executed an automated collection routine.", "ScreenshotName": "CrowdStrike-APT29-10205.png"}], "Score": 72}, {"DetectionNote": "An MSSP alert was generated when a portable executable file used a script to collected various filetypes found on the filesystem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "An MSSP alert showing a powershell script collecting data for file types from the filesystem.", "ScreenshotName": "CrowdStrike-APT29-10262.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the Powershell script that was executed.  View in process explorer allows you to see that the script was executed from the Powershell process.", "ScreenshotName": "CrowdStrike-APT29-10208.png"}], "Score": 17}], "Step score": 159}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection for \"malicious command\" was generated on powershell.exe executing Get-ChildItem.", "Detect": "General-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "2.a.1/2 - get-ChildItem powershell (cc)", "ScreenshotName": "Cybereason-APT29-9952.png"}], "Score": 28}, {"DetectionNote": "An MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of a file event and powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)", "ScreenshotName": "Cybereason-APT29-10773.png"}], "Score": 70}], "Step score": 98}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Data from Local System\" contained evidence of PowerShell executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: automated file collection script", "ScreenshotName": "Symantec-APT29-12974.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell execution of ChildItem. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]", "ScreenshotName": "Symantec-APT29-9905.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Childitem. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - get-childitem and compress archive scriptblock", "ScreenshotName": "F-Secure-APT29-11254.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the execution of the ChildItem. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "command start for childitem", "ScreenshotName": "F-Secure-APT29-10008.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1119\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17552.png"}], "Score": 53}, {"DetectionNote": "An MSSP detection occurred showing evidence of powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14011.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11846.png"}], "Score": 10}], "Step score": 133}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-233.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Collection occurred containing evidence that \"PowerShell ran commands to query files with multiple extensions and compressed the found files into a zip file.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17383.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-362.png"}, {"ScreenshotName": "Microsoft-APT29-367.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection was generated for the use of ChildItem. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3750.png"}, {"ScreenshotName": "Carbon Black-APT29-3751.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (purple indicator) showed powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "File and Directory Discovery. Searching files through powershell.", "ScreenshotName": "CyCraft-APT29-2203.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.B.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12220.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3470.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Automated Collection\" was generated on powershell.exe executing Get-ChildItem after a short delay. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Delayed (Processing)-Alert", "Screenshots": [{"ScreenshotCaption": "A.1/2/3 - Shows high level representation of Automated Collection - May take a few minutes to populate", "ScreenshotName": "SentinelOne-APT29-6498.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"InteractivePSCommand\" contained evidence of powershell.exe executing ChildItem. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "A2/3 - MSSP - ChildItem call", "ScreenshotName": "SentinelOne-APT29-12797.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A.1/2 Shows -childitem call", "ScreenshotName": "SentinelOne-APT29-6485.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred showing evidence of powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13734.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6534.png"}], "Score": 10}], "Step score": 80}}, "9.B.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. This event was correlated to a General detection for the execution of a malicious file (python.exe).", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "get-child item with att&ck enrichment for data compressed", "ScreenshotName": "Elastic-APT29-1330.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3041.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.B", "ScreenshotName": "FireEye-APT29-13017.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9.B.2/3 - Script block for ChildItem", "ScreenshotName": "FireEye-APT29-11224.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem\u200b.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1130.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_AutomatedCollection_DirScanART_MITRET1119\" , was generated due to powershell.exe executing Get-ChildItem.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12005.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Win_AutomatedCollection_DirScanART_MITRET1119\" occurred containing evidence of powershell.exe executing Get-ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12915.png"}, {"ScreenshotName": "Cylance-APT29-12914.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Automated Collection\" was generated when powershell.exe executed Get-ChildItem. The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments.", "ScreenshotName": "CrowdStrike-APT29-10491.png"}, {"ScreenshotCaption": "A Technique detection showing powershell.exe creating the zip file using Rar.exe.", "ScreenshotName": "CrowdStrike-APT29-10493.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed Powershell.exe executing ChildItem\u200b.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing Powershell.exe executing Get-ChildItem\u200b.", "ScreenshotName": "CrowdStrike-APT29-10490.png"}], "Score": 10}], "Step score": 82}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection for \"malicious command\" was generated on powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "General-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "9.b.2/3 - malware alert malicious command (cc)", "ScreenshotName": "Cybereason-APT29-13287.png"}], "Score": 35}], "Step score": 35}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Collection\" was received that included ChildItem command execution searching for document and media files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9b2 - MSSP", "ScreenshotName": "Symantec-APT29-17686.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9b2 - telemetry", "ScreenshotName": "Symantec-APT29-17689.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - raw command - childitem", "ScreenshotName": "F-Secure-APT29-11293.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "CommandStart ChildItem", "ScreenshotName": "F-Secure-APT29-10140.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"PS1.DiscoverCollectLocal T1119\" was generated for PowerShell enumerating files and directories using ChildItem recursively.", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14022.png"}], "Score": 53}, {"DetectionNote": "A MSSP detection occurred for PowerShell looking for certain files in a directory. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12788.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem\u200b.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12002.png"}], "Score": 10}], "Step score": 133}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14000.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4061.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "File Discovery and Automated Collection through PowerShell scriptblock logging. Contains Compress-Archive.", "ScreenshotName": "CyCraft-APT29-2258.png"}], "Score": 42}], "Step score": 42}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3660.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Automated Collection\" was generated when powershell.exe accessed multiple files when using ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "9.B.3 - Automated Collection for gathering files in Pam", "ScreenshotName": "SentinelOne-APT29-17873.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1119\" occurred containing evidence of enumerating directories in search for specific files. The function \u201cChildItem\u201d is observed.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2/3 -  child-item", "ScreenshotName": "SentinelOne-APT29-12838.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing ChildItem\u200b. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B2/3 - Powershell Calling child-item - Generic powershell alert", "ScreenshotName": "SentinelOne-APT29-7235.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Collection - Automated Collection\" occurred containing evidence of powershell.exe executing ChildItem.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12630.png"}, {"ScreenshotName": "SecureWorks-APT29-12631.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe executing ChildItem.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6795.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Automated Collection", "Steps count": 2, "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}]}, "T1022": {"Steps": {"9.B.6": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator; medium severity) for \"Encrypting Files with WinRar\" \"T1022 Data Encrypted\" was generated when rar.exe used \"-hp\" command-line arguments. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "encrypting alert detail with rar.rexe data encrypted process terminated", "ScreenshotName": "Elastic-APT29-1334.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "powershell encrypted arguments for zipping file ", "ScreenshotName": "Elastic-APT29-1336.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13229.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3050.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Encrypted RAR Archive Command\" \"T1022\" was generated when rar.exe used \"-hp\" command-line arguments.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.B.6 - Encrypted RAR Archive Command", "ScreenshotName": "FireEye-APT29-11214.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.B", "ScreenshotName": "FireEye-APT29-13017.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Data Encrypted T1022\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of encryption.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-777.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-774.png"}], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1764.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Win_Data_Encryption_MITRET1022\" was generated when rar.exe used \"-hp\" command-line arguments.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12007.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (low severity) called \"One-Liner ML Module\" was generated when machine learning determined the command was suspicious.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12006.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 110}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection showing powershell.exe creating the zip file using Rar.exe.", "ScreenshotName": "CrowdStrike-APT29-10493.png"}, {"ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments.", "ScreenshotName": "CrowdStrike-APT29-10491.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.b.6 / 7 powershell executing rar.exe in process tree", "ScreenshotName": "Cybereason-APT29-9655.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection for \"Exfiltration\" was generated when rar.exe executed with command-line arguments creating working.zip.", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "9b6 - tactic", "ScreenshotName": "Symantec-APT29-17694.png"}], "Score": 40}, {"DetectionNote": "A MSSP detection for \"Data Encrypted\" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress data into an encrypted ZIP file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: PowerShell Collection (2)", "ScreenshotName": "Symantec-APT29-12945.png"}, {"ScreenshotCaption": "MSSP Day 1: PowerShell Collection (1)", "ScreenshotName": "Symantec-APT29-12946.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell.exe executing rar.exe with arguments", "ScreenshotName": "Symantec-APT29-7479.png"}], "Score": 10}], "Step score": 120}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (green; low severity) called Data Encrypted was generated due to powershell.exe executing rar.exe with command-line arguments to encrypt working.zip. The event was correlated to a parent Technique detection on powershell.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "9.b.5-7 - rar compressing files and encrypting with password", "ScreenshotName": "Kaspersky-APT29-2931.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 9b6 and 7", "ScreenshotName": "Kaspersky-APT29-18008.png"}], "Score": 70}], "Step score": 142}, "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}, {"ScreenshotCaption": "MSSP - raw command - childitem", "ScreenshotName": "F-Secure-APT29-11293.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "rar.exe with command line arguments", "ScreenshotName": "F-Secure-APT29-10139.png"}], "Score": 17}], "Step score": 87}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for rar.exe executing with command line arguments. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12685.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for service execution on python.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12004.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-148.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence a PowerShell command executed rar.exe to encrypt with password hpfGzq5yKw.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1134.png"}, {"ScreenshotName": "Microsoft-APT29-1135.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-446.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13948.png"}, {"ScreenshotName": "Carbon Black-APT29-4060.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"T1022 Data Encrypted\" was generated when rar.exe was used to create an encrypted zip archive. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Executing rar.exe from powershell with enrichments", "ScreenshotName": "CyCraft-APT29-2262.png"}], "Score": 72}], "Step score": 72}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called \"T1022 Data Encrypted\" was generated when rar.exe created working.zip.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11082.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to parent alert on New Windows Service Created.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11083.png"}], "Score": 17}], "Step score": 77}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3664.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1022\" occurred containing evidence of rar.exe being executed with an encryption password parameter passed.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B5/6 - file creation event", "ScreenshotName": "SentinelOne-APT29-12839.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B6/7 - powershell executing rar.exe", "ScreenshotName": "SentinelOne-APT29-6744.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Suspicious RAR Archive Command 8 Data Encrypted (T1022)\u200b\u200b\" was generated when rar.exe was used to create an encrypted zip archive. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6801.png"}, {"ScreenshotName": "SecureWorks-APT29-6800.png"}, {"ScreenshotName": "SecureWorks-APT29-6799.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}}, "7.B.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed Powershell.exe executing Compress-7Zip ... -password \"lolol\". The event was correlated to a parent General detection for malicious file execution.\t", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "powershel cmdlet with compress-7zip (7b3)", "ScreenshotName": "Elastic-APT29-1281.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence Invoke-Exfil was used to compress and encrypt data for exfiltration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 7.B", "ScreenshotName": "FireEye-APT29-13001.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "7.B.3 - Script block for Compress-7Zip ... lolol", "ScreenshotName": "FireEye-APT29-11139.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure though script block log were manually recovered from the system, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1675.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12202.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Exfil.", "ScreenshotName": "CrowdStrike-APT29-10426.png"}, {"ScreenshotCaption": "Telemetry showing the Invoke-Exfil script block contents.", "ScreenshotName": "CrowdStrike-APT29-10427.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence that data was compressed and password encrypted for exfiltration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Exfil execution", "ScreenshotName": "Symantec-APT29-12936.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Exfil", "ScreenshotName": "Symantec-APT29-12935.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Exfil details", "ScreenshotName": "Symantec-APT29-12937.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "Pulled the powershell script off the end system", "ScreenshotName": "Kaspersky-APT29-2863.png"}], "Score": 3}], "Step score": 3}, "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell compressing and encrypting contents of the downloads folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2", "ScreenshotName": "F-Secure-APT29-11301.png"}, {"ScreenshotCaption": "MSSP - invoke exfil ", "ScreenshotName": "F-Secure-APT29-11285.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17366.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence that the 7z file was password protected.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12680.png"}], "Score": 70}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-275.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-410.png"}, {"ScreenshotName": "Microsoft-APT29-411.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4026.png"}, {"ScreenshotName": "Carbon Black-APT29-13944.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (orange indicator) was generated due to powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "7b3 new vendor screen correlation", "ScreenshotName": "CyCraft-APT29-14986.png"}, {"ScreenshotCaption": "7b3 and 7b1 vendor submitted screenshot", "ScreenshotName": "CyCraft-APT29-14984.png"}], "Score": 42}], "Step score": 42}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing evidence of compress-7zip execution with password was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11003.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3595.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"Exfiltrate\" occurred containing evidence of Compress-7zip compressing and encrypting the download directory with 7z using the password \u201clolol.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation", "ScreenshotName": "SentinelOne-APT29-12828.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B3 - Alert for powershell execution showing Compress-Zip with password", "ScreenshotName": "SentinelOne-APT29-7224.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe compressing and encrypting data for exfiltration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13748.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6740.png"}, {"ScreenshotName": "SecureWorks-APT29-6741.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Data Encrypted", "Steps count": 2, "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}]}, "T1106": {"Steps": {"4.C.10": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "cc 4c10 config change showing the dll load library (new api monitoring) 4.c.9 not working still", "ScreenshotName": "Elastic-APT29-1711.png"}, {"ScreenshotCaption": "4c11-12 ", "ScreenshotName": "Elastic-APT29-1243.png"}], "Score": 3}], "Step score": 3}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13650.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell loading Netapi32.dll.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 4.C.10- PowerShell loading Netapi32.dll", "ScreenshotName": "FireEye-APT29-11722.png"}], "Score": 28}, {"DetectionNote": "A MSSP detection occurred for the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12992.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C - Script block showing the load of Netapi32.dll", "ScreenshotName": "FireEye-APT29-11030.png"}], "Score": 10}], "Step score": 108}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell loading the NetApi module. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13425.png"}, {"ScreenshotName": "Bitdefender-APT29-13424.png"}], "Score": 35}], "Step score": 35}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetGroups definition and execution.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12275.png"}], "Score": 3}], "Step score": 3}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process, correlated to the process tree.", "ScreenshotName": "CrowdStrike-APT29-10308.png"}, {"ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process.", "ScreenshotName": "CrowdStrike-APT29-10307.png"}, {"ScreenshotCaption": "Telemetry showing the  invoke-netusergetgroups script block contents.", "ScreenshotName": "CrowdStrike-APT29-10313.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Invoke-NetUserGetGroups (psreflect)\" occurred containing evidence of the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - netusergetgroups (9/10)", "ScreenshotName": "Cybereason-APT29-10785.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Executed API call by reflectively loading Netapi32.dll", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API function from Netapi32.dll. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Netapi namespace and methodname", "ScreenshotName": "F-Secure-APT29-10064.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}, {"ScreenshotName": "ReaQta-APT29-262.png"}, {"ScreenshotName": "ReaQta-APT29-258.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13988.png"}, {"ScreenshotName": "Microsoft-APT29-13990.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Delayed (Manual)-Host Interrogation", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3938.png"}, {"ScreenshotName": "Carbon Black-APT29-3942.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used to search for domain groups through Win32 API calls.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.9 - MDR Report Day 1, Invoke-NetUserGetGroups", "ScreenshotName": "CyCraft-APT29-12465.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15122.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API function being loaded into PowerShell from Netapi32.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6581.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 10}}, "4.C.12": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "4c11-12 ", "ScreenshotName": "Elastic-APT29-1243.png"}, {"ScreenshotCaption": "cc 4c10 config change showing the dll load library (new api monitoring) 4.c.9 not working still", "ScreenshotName": "Elastic-APT29-1711.png"}], "Score": 3}], "Step score": 3}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13652.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell loading Netapi32.dll.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 4.C.12 - PowerShell loading Netapi32.dll", "ScreenshotName": "FireEye-APT29-11723.png"}], "Score": 28}, {"DetectionNote": "A MSSP detection occurred for the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12992.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C - Script block showing the load of Netapi32.dll", "ScreenshotName": "FireEye-APT29-11030.png"}], "Score": 10}], "Step score": 108}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell loading the NetApi module. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Correlated-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13424.png"}, {"ScreenshotName": "Bitdefender-APT29-13425.png"}], "Score": 35}], "Step score": 35}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1956.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetLocalGroups definition and execution.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12276.png"}], "Score": 3}], "Step score": 3}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the  invoke-netusergetlocalgroups script block contents.", "ScreenshotName": "CrowdStrike-APT29-10312.png"}, {"ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process, correlated to the process tree.", "ScreenshotName": "CrowdStrike-APT29-10308.png"}, {"ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process.", "ScreenshotName": "CrowdStrike-APT29-10307.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A MSSP detection for \"Invoke-NetUserGetLocalGroups (psreflect)\" occurred containing evidence of the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - c11 - netusergetlocalgroup", "ScreenshotName": "Cybereason-APT29-10783.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Executed API call by reflectively loading Netapi32.dll", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API function from Netapi32.dll. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Netapi namespace and methodname", "ScreenshotName": "F-Secure-APT29-10064.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-260.png"}, {"ScreenshotName": "ReaQta-APT29-262.png"}, {"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13988.png"}, {"ScreenshotName": "Microsoft-APT29-13990.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3941.png"}, {"ScreenshotName": "Carbon Black-APT29-3938.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.9 - MDR Report Day 1, Invoke-NetUserGetLocalGroups", "ScreenshotName": "CyCraft-APT29-12467.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the NetUserGetGroups API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15122.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API function being loaded into PowerShell from Netapi32.dll.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6580.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 10}}, "16.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "convertsidtostringsid script block", "ScreenshotName": "Elastic-APT29-1506.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13255.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3390.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell Loading Advapi32.dll\" was generated for PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 16.B.2 - PowerShell Loading Advapi32.dll", "ScreenshotName": "FireEye-APT29-11757.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection occurred for the ConvertSidToStringSid API function loaded into PowerShell from Advapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 16.B", "ScreenshotName": "FireEye-APT29-13039.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "16.B.2 - Script block for PowerShell loading advapi32.dll", "ScreenshotName": "FireEye-APT29-11546.png"}], "Score": 10}], "Step score": 138}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1107.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1954.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll in order to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry-Configuration Change (UX)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12340.png"}, {"ScreenshotName": "Cylance-APT29-12339.png"}], "Score": 3}], "Step score": 3}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing ConvertSidToStringSid script block which calls ConvertSidToStringSid API.", "ScreenshotName": "CrowdStrike-APT29-10666.png"}, {"ScreenshotCaption": "Telemetry showing advapi32.dll was loaded by powershell.exe.", "ScreenshotName": "CrowdStrike-APT29-10668.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that PowerShell loaded Advapi32.dll.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "16.b.2 - advapi32.dll loaded module from powershell", "ScreenshotName": "Cybereason-APT29-9773.png"}], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Execution through API\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute the GetTokenInformation API call from Advapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: siduser techniques", "ScreenshotName": "Symantec-APT29-12967.png"}, {"ScreenshotCaption": "MSSP Day 1: siduser description", "ScreenshotName": "Symantec-APT29-12968.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "function API names being called", "ScreenshotName": "F-Secure-APT29-10401.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12267.png"}], "Score": 3}], "Step score": 3}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-327.png"}, {"ScreenshotName": "ReaQta-APT29-326.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll in order to execute the ConvertSidToStringSid API function. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17402.png"}, {"ScreenshotName": "Microsoft-APT29-526.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4293.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell script which contained ConvertSidToStringSid API function being loaded.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: ConvertSidToString", "ScreenshotName": "CyCraft-APT29-2357.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Execution through API\" was received that included a PowerShell script and explained that it was used to execute the ConvertSidToStringSid API function from Advapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.A.1 - MDR Report Day 2, summary & Get-NetDomainController", "ScreenshotName": "CyCraft-APT29-12506.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (green indicator) called \"Execution through API (DLL Load)\" was generated for PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The event was correlated to a parent detection on \"PowerShell with Encoded Command Launched.\"", "Detect": "Technique-Alert-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11672.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the load of the ConvertSidToStringSid API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12725.png"}, {"ScreenshotName": "GoSecure-APT29-12726.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The event was correlated to a parent detection on \"PowerShell with Encoded Command Launched.\"", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11672.png"}], "Score": 10}], "Step score": 145}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Critical severity) was generated for reflective loading of a PE file by PowerShell.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3895.png"}, {"ScreenshotName": "HanSight-APT29-3896.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3894.png"}], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1106\" occurred containing evidence of ConvertSidToStringSid API with Advapi32.dll.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - ConvertSidToStringSid, Advapi32.dll", "ScreenshotName": "SentinelOne-APT29-12877.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B1/2 - powershell alert of siduser function definition ", "ScreenshotName": "SentinelOne-APT29-7265.png"}, {"ScreenshotCaption": "CC - B1/2 - Powershell alert of ConvertSidToStringSid being used in script", "ScreenshotName": "SentinelOne-APT29-7264.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Execution - Execution through API\" occurred containing evidence of PowerShell reflectively loading Advapi32.dll and executing APIs.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12661.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-10676.png"}, {"ScreenshotName": "SecureWorks-APT29-7155.png"}, {"ScreenshotName": "SecureWorks-APT29-10675.png"}], "Score": 10}], "Step score": 80}}, "10.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed hostui.exe executing powershell.exe via CreateProcessWithTokenW. This event was correlated to a General detection for the execution of a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "hostui createprocesswithtokenW", "ScreenshotName": "Elastic-APT29-1345.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13233.png"}], "Score": 70}], "Step score": 70}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a process created with CreateProcessWithToken.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-790.png"}, {"ScreenshotName": "Bitdefender-APT29-795.png"}], "Score": 65}], "Step score": 65}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.", "Detect": "None", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1793.png"}, {"ScreenshotName": "McAfee-APT29-1800.png"}], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "10.b.2 - creation from svchostexe process ", "ScreenshotName": "Cybereason-APT29-9674.png"}], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "sequence of process creation.", "ScreenshotName": "Symantec-APT29-7499.png"}, {"ScreenshotCaption": "services.exe launched svchost.exe with seclogon command line parameters", "ScreenshotName": "Symantec-APT29-7498.png"}], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "seclogon", "ScreenshotName": "F-Secure-APT29-10173.png"}], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"Noteworthy Behavior T1134\" was generated for token manipulation with the low level ZwDuplicateToken (NtDuplicateToken) API, which is invoked by the CreateProcessWithToken API.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12039.png"}], "Score": 60}], "Step score": 60}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning PowerShell.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-570.png"}], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe interacting with powershell.exe via OpenProcess.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13954.png"}], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Execution through API", "Steps count": 4, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}]}, "T1140": {"Steps": {"14.B.6": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class.  The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "b6 get wmi object in cmdlet event", "ScreenshotName": "Elastic-APT29-1457.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13247.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13252.png"}], "Score": 70}], "Step score": 70}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.B", "ScreenshotName": "FireEye-APT29-13036.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "14.B.6 - Script block for Get-WmiObject", "ScreenshotName": "FireEye-APT29-11508.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1105.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1945.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12089.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing PowerShell executing Get-Process. Telemetry showing PowerShell executing Get-WmiObject to read encoded content from Win32_AuditCode.", "ScreenshotName": "CrowdStrike-APT29-10647.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Deobfuscate/Decode Files or Information\" occurred containing evidence of the PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - auditcode, not what were testing for directly, but capturing for now", "ScreenshotName": "Cybereason-APT29-10798.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "getwmiobject", "ScreenshotName": "F-Secure-APT29-10362.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12108.png"}], "Score": 10}], "Step score": 10}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-316.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. Script preview was truncated so an alternate view was shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-516.png"}, {"ScreenshotName": "Microsoft-APT29-517.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4244.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell reading encoded content from the WMI class. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "get-wmiobject with enrichments in graph view", "ScreenshotName": "CyCraft-APT29-2456.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.B.5 - MDR Report Day 2, writing mimikatz output", "ScreenshotName": "CyCraft-APT29-12502.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3867.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1027\" occurred containing evidence of \"wmidump\" function definition and WMI indicators reading from Win32_AuditCode.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - WMIDUMP SBL", "ScreenshotName": "SentinelOne-APT29-12872.png"}, {"ScreenshotCaption": "MSSP - WMI read audit of code", "ScreenshotName": "SentinelOne-APT29-12873.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B6 - Powershell alert of Get-WmiObject", "ScreenshotName": "SentinelOne-APT29-7261.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell reading encoded content from the WMI class. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13774.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7057.png"}, {"ScreenshotName": "SecureWorks-APT29-7062.png"}, {"ScreenshotName": "SecureWorks-APT29-7061.png"}], "Score": 10}], "Step score": 80}}, "11.A.10": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1140 Deobfuscate/Decode Files or Information\" was generated for certutil.exe encoding or decoding files.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "command line of known.lock", "ScreenshotName": "Elastic-APT29-1371.png"}, {"ScreenshotCaption": "certutil.exe enrihment for deobfuscae/decode files", "ScreenshotName": "Elastic-APT29-1372.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "command line of known.lock", "ScreenshotName": "Elastic-APT29-1371.png"}, {"ScreenshotCaption": "decoding via certutil alert with file created of known.lock", "ScreenshotName": "Elastic-APT29-1370.png"}], "Score": 10}], "Step score": 75}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) for \"encoding information using Windows certificate management tool\" was generated due to certutil decoding the kwxn.lock payload.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3149.png"}], "Score": 35}, {"DetectionNote": "A MSSP detection occurred for certutil.exe decoding kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13237.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3153.png"}], "Score": 10}], "Step score": 115}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Certutil Decode\" was generated due to the use of certutil to decode file content.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.A.10 - Certutil Decode on blob to kxwn.lock", "ScreenshotName": "FireEye-APT29-11349.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection was generated for certutil.exe writing a fake certificate identified as an encoded binary.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "CERTUTIL with fake cert with encoded header", "ScreenshotName": "FireEye-APT29-11374.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for certutil.exe decoding kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13026.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 210}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) was generated for cerutil.exe decoding a payload. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13412.png"}, {"ScreenshotName": "Bitdefender-APT29-13413.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (yellow indicator) was generated for the execution of the certutil.exe process, which was identified as suspicious.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-803.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-804.png"}], "Score": 10}], "Step score": 110}, "McAfee": {"Detects": [{"DetectionNote": "A Technique detection was generated for a file being decoded via certutil. ", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-14747.png"}], "Score": 53}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1823.png"}], "Score": 10}], "Step score": 63}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Win_Certutil_Deobfuscation-DecodeFilesOrInformation_MITRET1140\" was generated when certutil.exe decoded the payload with command-line arguments.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12045.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \u201cDeobfuscate/Decode Files or Information\u201d was generated when certutil.exe decoded a malicious payload.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A technique detection called \u201cDeobfuscate/Decode Files or Information\u201d on the certutil.exe process.", "ScreenshotName": "CrowdStrike-APT29-10581.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding PE file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing certutil.exe decoding kwxn.lock. Telemetry showing powershell.exe making a network connection to 192.168.0.4 to port 443.", "ScreenshotName": "CrowdStrike-APT29-10585.png"}], "Score": 10}], "Step score": 75}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Certutil.exe used to decode data\" was generated for certutil decoding the payload with command-line arguments.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.10 - evidence, commandline of certutil and decode", "ScreenshotName": "Cybereason-APT29-9691.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.10 - evidence, commandline of certutil and decode", "ScreenshotName": "Cybereason-APT29-9691.png"}], "Score": 10}], "Step score": 75}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information\" was generated when certutil decoded data and created an executable file.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Certutil execeution, created an executable file. Tagged with Deobfuscated File or Information", "ScreenshotName": "Symantec-APT29-9709.png"}, {"ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution", "ScreenshotName": "Symantec-APT29-12850.png"}, {"ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution", "ScreenshotName": "Symantec-APT29-12902.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Deobfuscate/Decode Files or Information\" was received that included details on execution of certutil.exe by the adversary and explained that it was used to decode a fake certificate file into a DLL.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Deobfuscate", "ScreenshotName": "Symantec-APT29-12950.png"}, {"ScreenshotCaption": "MSSP Day 1: Deobfuscate description", "ScreenshotName": "Symantec-APT29-12951.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution", "ScreenshotName": "Symantec-APT29-12850.png"}, {"ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution", "ScreenshotName": "Symantec-APT29-12902.png"}, {"ScreenshotCaption": "Certutil execeution, created an executable file. Tagged with Deobfuscated File or Information", "ScreenshotName": "Symantec-APT29-9709.png"}], "Score": 10}], "Step score": 145}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow; medium severity) called \"suspicious_certutil_usage_decoding\" was generated due to certutil.exe decoding kxwn.lock. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.10 - certutil cmd line decode", "ScreenshotName": "Kaspersky-APT29-3145.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of certutil.exe decoding the kxwn.lock payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a10", "ScreenshotName": "Kaspersky-APT29-18012.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.10 - certutil cmd line decode", "ScreenshotName": "Kaspersky-APT29-3145.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) was generated for certutil with decode switch usage.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-15053.png"}], "Score": 65}, {"DetectionNote": "An MSSP occurred containing evidence of certutil.exe decoding kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - certutil (a10)", "ScreenshotName": "F-Secure-APT29-11307.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "certuil summary", "ScreenshotName": "F-Secure-APT29-10243.png"}], "Score": 10}], "Step score": 145}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection (high severity) called \"Certutil Execution (Suspicious use)\" was generated identifying suspicious use of certutil.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12065.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for certutil.exe being used to decode the payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 115}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Deobfuscate/Decode Files or Information\" was generated due to \"suspicious file deobfuscation\" via certutil.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-166.png"}, {"ScreenshotName": "ReaQta-APT29-172.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Deobfuscate/Decode Files or Information\" was generated due to certutil.exe decoding kxwn.lock.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-475.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-475.png"}], "Score": 10}], "Step score": 75}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information - certuil\" was generated for the use of certutil.exe decoding a payload.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4126.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information\" was generated for the use of certutil.exe decoding a payload.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4126.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) was generated for a executable file found in memory.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14754.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12763.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4170.png"}, {"ScreenshotName": "Carbon Black-APT29-4127.png"}], "Score": 10}], "Step score": 245}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (purple indicator) was generated identifying the execution of certutil.exe with command-line parameters for decoding the payload as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell execution of certutil decoding lock file ", "ScreenshotName": "CyCraft-APT29-2427.png"}, {"ScreenshotCaption": "execution of certutil with enrichments", "ScreenshotName": "CyCraft-APT29-2426.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.10 - MDR Report Day 2, decoding base64", "ScreenshotName": "CyCraft-APT29-12480.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Deobfuscate/Decode Files or Information (Certutil executed with suspicious commands)\" was generated for certutil decoding the payload with command-line arguments.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11330.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11332.png"}, {"ScreenshotName": "GoSecure-APT29-11330.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "certutil decode (11a10)", "ScreenshotName": "MalwareBytes-APT29-2560.png"}], "Score": 3}], "Step score": 3}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (Warning severity) was generated for certutil usage.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3744.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1140\" occurred containing evidence of certutil.exe decoding kxwn.lock with command-line arguments.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A10/11/12", "ScreenshotName": "SentinelOne-APT29-12848.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A10 - Certutil calling decode on kxwn.lock", "ScreenshotName": "SentinelOne-APT29-6784.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Certutil Decode Command Execution\" was generated due to process activity associated with the certutil decode command.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6975.png"}, {"ScreenshotName": "SecureWorks-APT29-6976.png"}, {"ScreenshotName": "SecureWorks-APT29-6977.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Defense Evasion- Deobfuscate/Decode Files or Information\" occurred for the cerutil utility decoding a writing a payload to disk.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13768.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the certutil.exe process decoding the kxwn.lock payload. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17638.png"}], "Score": 10}], "Step score": 145}}, "4.A.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive. The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "expand archive script block event", "ScreenshotName": "Elastic-APT29-1215.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13208.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and the corresponding file writes. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13644.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2789.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell file write.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.A.3 - Example write for Bginfo64.exe (bottom)", "ScreenshotName": "FireEye-APT29-10957.png"}, {"ScreenshotCaption": "4.A.3 - PowerShell File Write for extraction (top)", "ScreenshotName": "FireEye-APT29-10949.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing files via Expand-Archive. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.A", "ScreenshotName": "FireEye-APT29-12987.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent alert for a PowerShell process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.A.3 - Triage view indicating the alerts for PowerShell File Write", "ScreenshotName": "FireEye-APT29-10966.png"}, {"ScreenshotCaption": "4.A.3 - Script block logging for Expand-Archive", "ScreenshotName": "FireEye-APT29-10970.png"}], "Score": 17}], "Step score": 122}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell writing unknown executable files. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-680.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-681.png"}], "Score": 17}], "Step score": 59}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1526.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12329.png"}, {"ScreenshotName": "Cylance-APT29-12238.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The event was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe decompressing via Expand-Archive.", "ScreenshotName": "CrowdStrike-APT29-10293.png"}, {"ScreenshotCaption": "Telemetry showing powershell.exe file write operations from decompressing via Expand-Archive.", "ScreenshotName": "CrowdStrike-APT29-10295.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.a.3 - we have the events with the files from the expand archive ", "ScreenshotName": "Cybereason-APT29-9599.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection was generated for \"PowerShell created a suspicious file\" on PowerShell writing the files that were decompressed from the ZIP. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Gen alert 4a3", "ScreenshotName": "Symantec-APT29-17583.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "List of file creations by powershell.exe", "ScreenshotName": "Symantec-APT29-7411.png"}], "Score": 10}], "Step score": 45}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 4A3", "ScreenshotName": "Kaspersky-APT29-17993.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.a.3 - files created (22) #2", "ScreenshotName": "Kaspersky-APT29-2734.png"}, {"ScreenshotCaption": "4.a.2 - ps launches ps", "ScreenshotName": "Kaspersky-APT29-2735.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell unzipping and moving SysInternals tools.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14345.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "sysinternals exe", "ScreenshotName": "F-Secure-APT29-10052.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17353.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11875.png"}, {"ScreenshotName": "TrendMicro-APT29-11873.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-244.png"}, {"ScreenshotName": "ReaQta-APT29-79.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-389.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) for powershell.exe fileless script or command was generated for \"code_drop\" and \"detected_pup_app\". ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3883.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive as well as the subsequent file writes. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3892.png"}, {"ScreenshotName": "Carbon Black-APT29-13939.png"}], "Score": 17}], "Step score": 52}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated due to powershell.exe decompressing the ZIP via Expand-Archive. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "4a3 -new vendor screenshot correlation", "ScreenshotName": "CyCraft-APT29-14998.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection was occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.A.3 - MDR Report Day 1, Expand-Archive", "ScreenshotName": "CyCraft-APT29-12439.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP.  The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10888.png"}, {"ScreenshotName": "GoSecure-APT29-10885.png"}], "Score": 17}], "Step score": 17}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP.  The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "file writes 1", "ScreenshotName": "MalwareBytes-APT29-2526.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (Reminder severity) was generated for powershell.exe decompressing via Expand-Archive in the Downloads directory.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3514.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1140\" occurred containing evidence of the extracted root folder being created, and the contents extracted.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A3- file unzipping", "ScreenshotName": "SentinelOne-APT29-12810.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A3 - Shows the unzipped files being created", "ScreenshotName": "SentinelOne-APT29-6523.png"}, {"ScreenshotCaption": "CC - A3 - Generic alert created for Expand-Archive execution", "ScreenshotName": "SentinelOne-APT29-7187.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Defense Evasion - Deobfuscate/Decode Files or Information\" occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12597.png"}, {"ScreenshotName": "SecureWorks-APT29-12595.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6633.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Deobfuscate/Decode Files or Information", "Steps count": 3, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1028": {"Steps": {"20.B.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"WMI Lateral Movement via PowerShell over WinRM\" was generated for PowerShell executing on a remote host over WinRM. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "wmi lateral movement via powershell over winrm, with connection over 5985", "ScreenshotName": "Elastic-APT29-1624.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "20b2 - telemetry ", "ScreenshotName": "Elastic-APT29-15096.png"}], "Score": 10}], "Step score": 75}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13261.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. Telemetry also showed the WinRM process on Scranton (10.0.1.4) exchanging data with Utica (10.0.1.5).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3351.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13732.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"WinRM Network Connection\" was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "20.B.2 - WinRM Network Connection for the WinRM connection to Scranton (10.0.1.4) over port 5985", "ScreenshotName": "FireEye-APT29-11688.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for PowerShell making a URL request when the WinRM connection was made to Scranton (10.0.1.4) over port 5985.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "20.B.2 - PowerShell URL Request for the WinRM connection", "ScreenshotName": "FireEye-APT29-11687.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for the WinRM session to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 20.B", "ScreenshotName": "FireEye-APT29-13057.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 180}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for the opening of a WinRM connection. The alert showed an outbound network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1046.png"}, {"ScreenshotName": "Bitdefender-APT29-1045.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection was generated for the WSMProvHost process on the remote host Scranton (10.0.1.4), which is indicative of the execution of a remote PowerShell command.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1048.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 140}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Windows Remote Management\" was generated for a \"PowerShell script doing Windows Remote Management (WinRM) activity.\"", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1925.png"}, {"ScreenshotName": "McAfee-APT29-1921.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1925.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Win_WinRM_Invoke-Command_MitreT1028\" was generated when PowerShell executed a command on the remote host Scranton (10.0.1.4).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12182.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell execution of Enter-PSSession and the corresponding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12333.png"}, {"ScreenshotName": "Cylance-APT29-12323.png"}], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cExecution via Windows Remote Management\u201d was generated for WinRM execution based on the WSMProvHost process on the remote host Scranton (10.0.1.4).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": " A technique detection called \u201cExecution via Windows Remote Management\u201d for WinRM executing net.exe on Scranton.", "ScreenshotName": "CrowdStrike-APT29-10753.png"}], "Score": 65}, {"DetectionNote": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d was generated based on PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4).", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing Enter-PSSession to Scranton, then invoking a command.", "ScreenshotName": "CrowdStrike-APT29-10746.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "activity app network connections from powershell", "ScreenshotName": "CrowdStrike-APT29-10751.png"}], "Score": 10}], "Step score": 135}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "20.b.2 process tree with the connection details over port 5985", "ScreenshotName": "Cybereason-APT29-9846.png"}, {"ScreenshotCaption": "20.b.2 - connection details contin", "ScreenshotName": "Cybereason-APT29-9845.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.b.2-3 MSSP report #1", "ScreenshotName": "Kaspersky-APT29-12428.png"}, {"ScreenshotCaption": "20.b.2-3 MSSP report #2", "ScreenshotName": "Kaspersky-APT29-12429.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (informational severity) was generated for PowerShell using Windows Remote Management. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "2 / 3 ", "ScreenshotName": "F-Secure-APT29-10699.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell execution of Enter-PSSession and the corresponding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "enter-pssesion", "ScreenshotName": "F-Secure-APT29-10550.png"}, {"ScreenshotCaption": "2 - ip and port", "ScreenshotName": "F-Secure-APT29-10544.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Identified Usage of Windows Remote Management\" was generated due to the WinRM session to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17578.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (low severity) called \"Windows Remote Management\" was generated for PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12213.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for a golden ticket being used to establish a WinRM connection to host Scranton (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12693.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 210}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the Enter-PSSession cmdlet and the subsequent network connection to the remote host Scranton (10.0.1.4).", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-226.png"}, {"ScreenshotName": "ReaQta-APT29-341.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Lateral Movement was generated containing evidence a new PowerShell session was initiated from host Utica (10.0.1.5) to Scranton (10.0.1.4) and a session was created under the local administrator account (RID 500).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1152.png"}, {"ScreenshotName": "Microsoft-APT29-1151.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-551.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Powershell or WinRM remoting activity\" was generated for a powershell WinRM session on the remote host Scranton (10.0.1.4).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4387.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection (red indicator) called for remote PowerShell activity was generated for a PowerShell WinRM session. ", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4387.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell create a WinRM session to remote host Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12778.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4). The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4393.png"}, {"ScreenshotName": "Carbon Black-APT29-4392.png"}], "Score": 17}], "Step score": 197}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated identifying PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4) as threat activity. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "enter-pssession with enrichments", "ScreenshotName": "CyCraft-APT29-2498.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (orange indicator) for execution and tagged with \"Windows Remote Management\" was generated when net.exe was executed remotely on Scranton by wsmprovhost.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "net.exe with parent process of wsmprovhost.exe and enrichments", "ScreenshotName": "CyCraft-APT29-2500.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Windows Remote Management\" was received that described the adversary using a golden ticket to establish a WinRM session to Scranton (10.0.1.4)", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "20.B.1 - MDR Report Day 2, pass the ticket, enter-pssession, account creation", "ScreenshotName": "CyCraft-APT29-12523.png"}, {"ScreenshotCaption": "20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock", "ScreenshotName": "CyCraft-APT29-12521.png"}], "Score": 70}], "Step score": 140}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Windows Remote Management\"  was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.\n", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11550.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection (orange indicator) called \"Powershell: established network connections\" was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11550.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11550.png"}], "Score": 10}], "Step score": 120}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"WinRM via common port\" was generated due to WinRM being used to access the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3982.png"}, {"ScreenshotName": "HanSight-APT29-3980.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1028\" occurred containing evidence of Enter-PSSession to create WinRM session to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - PS-session + user add", "ScreenshotName": "SentinelOne-APT29-12894.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B2 - Powershell connecting to Scranton over port 5985 via wsman protocol", "ScreenshotName": "SentinelOne-APT29-7016.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Windows Remote Management\" occurred containing evidence of PowerShell using Enter-PSSession to create WinRM session.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12672.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell execution of Enter-PSSession and the correpsonding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7312.png"}, {"ScreenshotName": "SecureWorks-APT29-7298.png"}], "Score": 10}], "Step score": 80}}, "8.A.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator; medium severity) for \"WMI Lateral Movement via PowerShell over WinRM\" was generated for the user Pam invoking a WMI PowerShell cmdlet. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "wmi invoked on another host alert", "ScreenshotName": "Elastic-APT29-1293.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "port 5985 to DC", "ScreenshotName": "Elastic-APT29-1287.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13221.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from a temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3001.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"WinRM Network Connection\" was generated due to a connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "8.A.2 - WinRM Network Connection to Scranton (10.0.1.4)", "ScreenshotName": "FireEye-APT29-11153.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for PowerShell making a URL request, which contained indications the network connection was using WinRM.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "8.A.2 - PowerShell URL Request containing WinRM information", "ScreenshotName": "FireEye-APT29-11156.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.A", "ScreenshotName": "FireEye-APT29-13004.png"}, {"ScreenshotCaption": "MSSP - 8.A", "ScreenshotName": "FireEye-APT29-13003.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 180}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection called \"powershellinvokedwinrm\" was generated for Windows Remote Management Service Invoked by PowerShell script.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1072.png"}], "Score": 58}, {"DetectionNote": "A Technique alert detection called \"remotepowershellsession\" was generated for WSMProvHost Process Started that could indicate a remote PowerShell command has been executed.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-750.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-759.png"}], "Score": 17}], "Step score": 140}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) on port 5985. The detection was correlated to a parent alert for PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1718.png"}], "Score": 17}], "Step score": 17}, "Cylance": {"Detects": [{"DetectionNote": "An MSSP detection for \"Lateral Movement\" occurred containing evidence of Invoke-WinRMSession with a \"Win_WinRM_Invoke-Command_MITRET1028\" alert.  ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12908.png"}, {"ScreenshotName": "Cylance-APT29-13186.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12259.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port 5985. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe establishing network connections over port 5985 and port 389.", "ScreenshotName": "CrowdStrike-APT29-10454.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Windows Remote Management\" was generated due to the connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "8.a.2 - powershell and local address with port 5985", "ScreenshotName": "Cybereason-APT29-9632.png"}, {"ScreenshotCaption": "8.a.2 -  see loaded ps", "ScreenshotName": "Cybereason-APT29-9633.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"Windows Remote Management\" occurred containing evidence of the connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2, winRM", "ScreenshotName": "Cybereason-APT29-10779.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8.a.2 - powershell and local address with port 5985", "ScreenshotName": "Cybereason-APT29-9632.png"}], "Score": 10}], "Step score": 152}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985 via HTTP.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe connected to scranton on port 5985, via service HTTP (WinRM)", "ScreenshotName": "Symantec-APT29-9931.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "A General alert detection (red; high severity) was generated for \"PowerShell with network activity\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2880.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2880.png"}, {"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2880.png"}], "Score": 10}], "Step score": 45}, "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) was generated due to PowerShell using WinRM.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Invoke command username powershell", "ScreenshotName": "F-Secure-APT29-10111.png"}, {"ScreenshotCaption": "using winrm detection", "ScreenshotName": "F-Secure-APT29-10110.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Invoke-Command and connected to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "5985 port number", "ScreenshotName": "F-Secure-APT29-10109.png"}, {"ScreenshotCaption": "invoke command script block get-process", "ScreenshotName": "F-Secure-APT29-10113.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Powershell Remote Command Execution Via WinRM\" was generated due to a connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11959.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-132.png"}, {"ScreenshotName": "ReaQta-APT29-133.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over TCP port 5985. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17395.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for \"Powershell or WinRM remoting activity\" based on wsmprovhost.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4040.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection called \"Remote powershell activity\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Tactic-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14748.png"}, {"ScreenshotName": "Carbon Black-APT29-14749.png"}], "Score": 52}, {"DetectionNote": "A Tactic alert detection called \"Remote Services\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4036.png"}], "Score": 52}, {"DetectionNote": "A General alert detection (red indicator) was generated for suspicious fileless execution not originating from PowerShell.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4040.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4034.png"}], "Score": 17}], "Step score": 221}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called Windows Remote Management was generated due to the connection to Scranton (10.0.1.4) over TCP port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11013.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed HTTP connections to remote host Scranton (10.0.1.4) over TCP port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11010.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"WinRM Remote Execution\" was generated due to the execution of wsmprovhost.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3612.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (yellow; reminder severity) called \"WinRM via common port\" was generated due a network connection to remote host Scranton (10.0.1.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3598.png"}, {"ScreenshotName": "HanSight-APT29-3607.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 140}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"WinRMSession\" under \"Lateral Movement {T1028}\" was generated when a connection to remote host Scranton (10.0.1.4) from host Nashua (10.0.1.6) over port 5985 using the wsman protocol was issued.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A2 -  Connection from Nashua to Scranton over port 5985", "ScreenshotName": "SentinelOne-APT29-6698.png"}, {"ScreenshotCaption": "A2 - wmirm alert - Lateral movement", "ScreenshotName": "SentinelOne-APT29-6695.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1028\" occurred containing evidence of Lateral Movement via WinRM with wsman network connection to host Scranton (10.0.1.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - ldap, wsman, SBL of AD-Search", "ScreenshotName": "SentinelOne-APT29-12830.png"}, {"ScreenshotCaption": "MSSP - More WinRM alerts and Get-Process", "ScreenshotName": "SentinelOne-APT29-12831.png"}], "Score": 70}], "Step score": 135}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Windows Remote Management - WinRM Usage\" was generated due to a connection to remote host Scranton over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6703.png"}, {"ScreenshotName": "SecureWorks-APT29-6702.png"}, {"ScreenshotName": "SecureWorks-APT29-6701.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over TCP port 5985. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6900.png"}, {"ScreenshotName": "SecureWorks-APT29-6902.png"}, {"ScreenshotName": "SecureWorks-APT29-6904.png"}], "Score": 10}], "Step score": 75}}, "16.C.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"WMI Lateral Movement via PowerShell over WinRM\" was generated for WMI invoked on another host via a PowerShell WMI cmdlet. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "wmi lateral movement via powershell over winrm alert", "ScreenshotName": "Elastic-APT29-1511.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (medium severity) for \"First Seen Process in an Environment\" was generated for the execution of the WinRM process (wsmprovhost.exe).", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "mscott on new york execution alert - first seen process in environment alert", "ScreenshotName": "Elastic-APT29-1514.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Windows script.\t\n", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "endgame client view  showing port 5985", "ScreenshotName": "Elastic-APT29-1521.png"}], "Score": 17}], "Step score": 124}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13256.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3249.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"WinRM Network Connection\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "16.C.1 - WinRM Network Connection to NewYork (10.0.0.4)", "ScreenshotName": "FireEye-APT29-11555.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for a PowerShell URL request to NewYork (10.0.0.4) on port 5895.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "16.C.1 - PowerShell URL Request to NewYork (10.0.0.4)", "ScreenshotName": "FireEye-APT29-11556.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 16.C", "ScreenshotName": "FireEye-APT29-13040.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 180}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-940.png"}, {"ScreenshotName": "Bitdefender-APT29-938.png"}, {"ScreenshotName": "Bitdefender-APT29-934.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1000.png"}, {"ScreenshotName": "Bitdefender-APT29-993.png"}], "Score": 17}], "Step score": 82}, "McAfee": {"Detects": [{"DetectionNote": "A Technique detection alert (orange indicator) called \"Windows Remote Management\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1867.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1869.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) called \"Win_WinRM_Invoke-Command_MITRET1028\"  was generated for the PowerShell Invoke-Command WinRM cmdlet.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12137.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Lateral Movement\" occurred containing evidence of Invoke-WinRMSession with a \"Win_WinRM_Invoke-Command_MITRET1028\" alert. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12923.png"}, {"ScreenshotName": "Cylance-APT29-13187.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12308.png"}], "Score": 10}], "Step score": 115}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d was generated when powershell.exe executed Invoke-WinRMSession to connect to remote host NewYork (10.0.0.4) with credentials for user MScott. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell executing invoke-winrmsession to NewYork (10.0.0.4). A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing invoke-winrmsession to connect to NewYork (10.0.0.4) with credentials for user MScott.", "ScreenshotName": "CrowdStrike-APT29-10672.png"}, {"ScreenshotCaption": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing logging onto NewYork successfully with user MScott.", "ScreenshotName": "CrowdStrike-APT29-10678.png"}], "Score": 67}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell connecting to NewYork (10.0.0.4) on port 5985. Telemetry showing a successful logon on NewYork as MScott.", "ScreenshotName": "CrowdStrike-APT29-10679.png"}, {"ScreenshotCaption": "Telemetry showing powershell executing invoke-winrmsession to NewYork (10.0.0.4). A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing invoke-winrmsession to connect to NewYork (10.0.0.4) with credentials for user MScott.", "ScreenshotName": "CrowdStrike-APT29-10672.png"}], "Score": 17}], "Step score": 84}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - c1", "ScreenshotName": "Cybereason-APT29-10805.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "16.c.1 - port 5985 details from the process tree", "ScreenshotName": "Cybereason-APT29-9779.png"}], "Score": 17}], "Step score": 87}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of WinRM usage via invoke-winrmsession with command-line arguments.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16c1 - mssp - winrm", "ScreenshotName": "Symantec-APT29-17722.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe connected to 10.0.0.4 over port 5985 via HTTP (WinRM)", "ScreenshotName": "Symantec-APT29-9872.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "A General detection alert (red; high severity) for PowerShell with network activity was generated for to powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "16.c.1 - connection with full tree", "ScreenshotName": "Kaspersky-APT29-3256.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.c.1-2 MSSP report", "ScreenshotName": "Kaspersky-APT29-12408.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "16C2 - new vendor pic with port", "ScreenshotName": "Kaspersky-APT29-18093.png"}], "Score": 10}], "Step score": 115}, "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (informational severity) for Windows Remote Management was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14506.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "5985 again, ty Skype, ty Microsoft", "ScreenshotName": "F-Secure-APT29-10418.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Powershell Remote Command Execution Via WinRM\" (low severity) was generated due to a connection to host NewYork (10.0.0.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14498.png"}], "Score": 65}, {"DetectionNote": "A Technique detection called \"WinRM Service Detected\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12130.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for \"Powershell remote command execution via WinRM\". ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 205}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-189.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-532.png"}, {"ScreenshotName": "Microsoft-APT29-529.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4302.png"}], "Score": 65}, {"DetectionNote": "A Tactic alert detection (yellow indicator) was generated for powershell.exe accessing the network. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4298.png"}], "Score": 52}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4298.png"}], "Score": 17}], "Step score": 134}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) for threat activity was generated for powershell.exe executing the Invoke-WinRMSession command.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: invoke-winrm with credentials and IP", "ScreenshotName": "CyCraft-APT29-2358.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Windows Remote Management\" was received that included a PowerShell command and explained that it was used to create a WinRM session to host Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.A.1 - MDR Report Day 2, summary & Get-NetDomainController", "ScreenshotName": "CyCraft-APT29-12506.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called \"Windows Remote Management wsman in HTTP Request\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The event was correlated to a parent detection on \"PowerShell with Execution Bypass Command Launched.\"\n", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11424.png"}], "Score": 67}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.  The event was correlated to a parent detection on \"PowerShell with Execution Bypass Command Launched.\"", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11424.png"}], "Score": 17}], "Step score": 84}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"WinRM via common port\" was generated due to WinRM usage to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3905.png"}, {"ScreenshotName": "HanSight-APT29-3906.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"WinRMSession\" was generated for the creation of a WinRM session. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "C1 - WinRM Session alert generated", "ScreenshotName": "SentinelOne-APT29-6913.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1028\" occurred containing evidence of a connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol, and a WinRM indicator for Lateral Movement.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - network information", "ScreenshotName": "SentinelOne-APT29-12879.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "C1 - Connection to NewYork over 5985", "ScreenshotName": "SentinelOne-APT29-6910.png"}, {"ScreenshotCaption": "16.C.1 - Correlation of WinRM to prior context", "ScreenshotName": "SentinelOne-APT29-15014.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Execution - Windows Remote Management\" occurred containing evidence of PowerShell executing the PowerShell Invoke-Command WinRM cmdlet then the subsequent connection to remote host NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13782.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing the PowerShell Invoke-Command WinRM cmdlet then the subsequent connection to remote host NewYork (10.0.0.4) over port 5985.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7119.png"}, {"ScreenshotName": "SecureWorks-APT29-7117.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Windows Remote Management", "Steps count": 3, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}]}, "T1069": {"Steps": {"4.C.11": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Invoke-NetUserGetLocalGroups. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c7-8 script block (same as above, but scrolled down the invoke discovery a little)", "ScreenshotName": "Elastic-APT29-1231.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13652.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}], "Score": 17}], "Step score": 17}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing the NetUserGetLocalGroups API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12992.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.11 - Script block for NetUserGetLocalGroups", "ScreenshotName": "FireEye-APT29-11037.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1956.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetLocalGroups definition and execution.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12246.png"}, {"ScreenshotName": "Cylance-APT29-12276.png"}], "Score": 3}], "Step score": 3}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the  invoke-netusergetlocalgroups script block contents.", "ScreenshotName": "CrowdStrike-APT29-10312.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A MSSP detection for \"Invoke-NetUserGetLocalGroups (psreflect)\" occurred containing evidence of the NetUserGetLocalGroups API call.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - c11 - netusergetlocalgroup", "ScreenshotName": "Cybereason-APT29-10783.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection for \"Permissions Groups Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of local groups.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API call. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Netapi namespace and methodname", "ScreenshotName": "F-Secure-APT29-10064.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing NetUserGetLocalGroups API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11896.png"}], "Score": 10}], "Step score": 10}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}, {"ScreenshotName": "ReaQta-APT29-260.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence of PowerShell executing Invoke-NetUserGetLocalGroups.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1159.png"}, {"ScreenshotName": "Microsoft-APT29-1162.png"}, {"ScreenshotName": "Microsoft-APT29-1161.png"}, {"ScreenshotName": "Microsoft-APT29-1160.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13988.png"}, {"ScreenshotName": "Microsoft-APT29-13990.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3938.png"}, {"ScreenshotName": "Carbon Black-APT29-3941.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.9 - MDR Report Day 1, Invoke-NetUserGetLocalGroups", "ScreenshotName": "CyCraft-APT29-12467.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the NetUserGetLocalGroups API. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3532.png"}, {"ScreenshotName": "HanSight-APT29-3543.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API calls.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6580.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 10}}, "4.C.9": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Invoke-NetUserGetGroups. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4c7-8 script block (same as above, but scrolled down the invoke discovery a little)", "ScreenshotName": "Elastic-APT29-1231.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13650.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12992.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetGroups API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.9 - Script block for NetUserGetGroups", "ScreenshotName": "FireEye-APT29-11031.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetGroups definition and execution.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12275.png"}, {"ScreenshotName": "Cylance-APT29-12244.png"}], "Score": 3}], "Step score": 3}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the  invoke-netusergetgroups script block contents.", "ScreenshotName": "CrowdStrike-APT29-10313.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Enumeration Invoke-Discovery\" occurred containing evidence of the NetUserGetGroups API call.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - invoke-discovery (firewall, antivirus)", "ScreenshotName": "Cybereason-APT29-10786.png"}, {"ScreenshotCaption": "MSSP - netusergetgroups (9/10)", "ScreenshotName": "Cybereason-APT29-10785.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection for \"Permissions Groups Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of global groups.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}, {"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API call. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Netapi namespace and methodname", "ScreenshotName": "F-Secure-APT29-10064.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing NetUserGetGroups API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11896.png"}], "Score": 10}], "Step score": 10}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetGroups API.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-258.png"}, {"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Yttrium High Active Alert related to Discovery\non a machine in your environment\" occurred containing evidence of PowerShell command Invoke-NetUserGetGroups.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1160.png"}, {"ScreenshotName": "Microsoft-APT29-1161.png"}, {"ScreenshotName": "Microsoft-APT29-1159.png"}, {"ScreenshotName": "Microsoft-APT29-1162.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Invoke-NetUserGetGroups. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13988.png"}, {"ScreenshotName": "Microsoft-APT29-582.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3942.png"}, {"ScreenshotName": "Carbon Black-APT29-3938.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetGroups command to search for domain groups through Win32 API calls.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.9 - MDR Report Day 1, Invoke-NetUserGetGroups", "ScreenshotName": "CyCraft-APT29-12465.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17440.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing the NetUserGetGroups API.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3543.png"}, {"ScreenshotName": "HanSight-APT29-3532.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API calls and dll loads.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6581.png"}, {"ScreenshotName": "SecureWorks-APT29-6627.png"}], "Score": 10}], "Step score": 10}}}, "TechniqueName": "Permission Groups Discovery", "Steps count": 2, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1102": {"Steps": {"18.A.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) for \"Accessing Windows Network Shares\" was generated for net.exe with command-line arguments. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "port 443 connetion from net", "ScreenshotName": "Elastic-APT29-14357.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "port 443 connetion from net", "ScreenshotName": "Elastic-APT29-14357.png"}, {"ScreenshotCaption": "scriptblock net use command", "ScreenshotName": "Elastic-APT29-14378.png"}], "Score": 17}], "Step score": 59}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) called \"Non-browser access to a web service\" was generated when net.exe made an HTTPS connection to a OneDrive URL. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3318.png"}], "Score": 42}, {"DetectionNote": "A General alert detection (red indicator) called \"WebDAV drive mount from net.exe over HTTPS\" was generated when net.exe made an HTTPS connection. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3318.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection contained evidence of net.exe connection to OneDrive over TCP port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13260.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3318.png"}], "Score": 17}], "Step score": 171}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Web Service C2\" was generated due to an abnormal application making requests for common web services.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 18.A.1 - Web Service C2 from net.exe", "ScreenshotName": "FireEye-APT29-11761.png"}], "Score": 58}, {"DetectionNote": "A General alert detection was generated for execution of the \"net use\" command.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "18.A - Net Use Command Execution", "ScreenshotName": "FireEye-APT29-11610.png"}], "Score": 35}, {"DetectionNote": "A General alert detection was generated for WebDav activity when mapping the OneDrive URL.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "18.A - WebDav activity to OneDrive", "ScreenshotName": "FireEye-APT29-11611.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for net.exe connecting to a OneDrive URL.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 18.A", "ScreenshotName": "FireEye-APT29-13047.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. This detection was correlated to a parent alert for a PowerShell process than ran net.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "18.A.1 - Triage view of net.exe making connections to public IPs on port 443", "ScreenshotName": "FireEye-APT29-11623.png"}], "Score": 17}], "Step score": 215}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection (orange indicator) was generated for an attempt to connect to a remote share via net.exe. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-984.png"}, {"ScreenshotName": "Bitdefender-APT29-977.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-973.png"}, {"ScreenshotName": "Bitdefender-APT29-1003.png"}, {"ScreenshotName": "Bitdefender-APT29-989.png"}], "Score": 17}], "Step score": 59}, "McAfee": {"Detects": [{"DetectionNote": "A Tactic alert detection (yellow indicator) called \"Collection\" was generated for net.exe having active network connections. ", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1905.png"}], "Score": 45}, {"DetectionNote": "A General detection was generated for a socket opened by a \"process that commonly does not do it\".", "Detect": "General", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1898.png"}], "Score": 30}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1898.png"}], "Score": 10}], "Step score": 85}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (low severity) called \"One-Liner ML Module\" was generated for a suspicious use of a scripting engine.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12154.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Data Theft and Exfiltration\" occurred containing evidence of \"One-Liner ML Module\" that identified details of mapping a OneDrive URL to the Y: drive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12934.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12319.png"}], "Score": 10}], "Step score": 115}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent technique detection for PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing net.exe making network connections to public IP over port 443.", "ScreenshotName": "CrowdStrike-APT29-10709.png"}, {"ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command line arguments.", "ScreenshotName": "CrowdStrike-APT29-10708.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated due to net.exe conducting suspicious activity and connecting to a well known port. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "18.a.1 - network connection over port 443", "ScreenshotName": "Cybereason-APT29-9812.png"}, {"ScreenshotCaption": "18.a.1 - net process tree", "ScreenshotName": "Cybereason-APT29-9807.png"}], "Score": 42}], "Step score": 42}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Web Service\" was received that included a PowerShell command executed by the adversary and explained that it was used to exfiltrate locally staged data to a remote WebDav share.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Exfil using Web Service", "ScreenshotName": "Symantec-APT29-12973.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe executed net.exe to map the OneDrive share", "ScreenshotName": "Symantec-APT29-9839.png"}, {"ScreenshotCaption": "net.exe connection to internet, followed by transfer of data via TLS", "ScreenshotName": "Symantec-APT29-9885.png"}, {"ScreenshotCaption": "Shows lineage of events related to mapping the network drive from the WebDav share on OneDrive", "ScreenshotName": "Symantec-APT29-9838.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "18a1 - telemetry - vendor pic", "ScreenshotName": "Kaspersky-APT29-13803.png"}], "Score": 10}], "Step score": 10}, "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (informational severity) was generated for net.exe making a network connection. It included details of net.exe executing and connecting to a public IP over port 443. This is correlated to a previous detection for PowerShell.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-10478.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive \"Y:\".", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - move to B- copy-item", "ScreenshotName": "F-Secure-APT29-11320.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "a1 - remote ip and port", "ScreenshotName": "F-Secure-APT29-10462.png"}, {"ScreenshotCaption": "a1 - net use ", "ScreenshotName": "F-Secure-APT29-10460.png"}], "Score": 10}], "Step score": 122}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection (low severity) for \"Shared Resource Mapping (net use)\" was generated for net.exe making a network connection to public IP over port 443.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12173.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12200.png"}], "Score": 17}], "Step score": 52}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for suspicious file deobfuscation via certutil.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-209.png"}], "Score": 17}], "Step score": 17}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated by Microsoft Cloud App Security due to an unsanctioned or unknown Cloud app (identified as Microsoft OneDrive) being accessed.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17404.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-543.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection was generated for net.exe making network connections. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14759.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4333.png"}, {"ScreenshotName": "Carbon Black-APT29-4334.png"}], "Score": 17}], "Step score": 59}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Web Service\" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "18.A.1 - MDR Report Day 2, summary & powershell execution of net use", "ScreenshotName": "CyCraft-APT29-12518.png"}, {"ScreenshotCaption": "18.A.1 - MDR Report Day 2, net use execution and copy-item", "ScreenshotName": "CyCraft-APT29-12519.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "A General alert detection (orange indicator) was generated for an outbound connection network operation over a commonly used port. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11487.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The event was correlated to a parent detection on \"Bypass User Account Control.\"", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11487.png"}, {"ScreenshotName": "GoSecure-APT29-11472.png"}], "Score": 17}], "Step score": 59}, "Malwarebytes": {"Detects": [{"DetectionNote": "A General alert detection for a \"data gathering PowerShell command\" was generated for net.exe with command-line arguments to connect to a OneDrive URL.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "net.exe", "ScreenshotName": "MalwareBytes-APT29-2572.png"}], "Score": 28}], "Step score": 28}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3950.png"}, {"ScreenshotName": "HanSight-APT29-3948.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1102\" occurred containing evidence of net.exe with command-line arguments connecting to OneDrive public IP and URL over port 443 using HTTPS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - Outlook network information", "ScreenshotName": "SentinelOne-APT29-12887.png"}, {"ScreenshotCaption": "MSSP - net.exe CLI ARGs", "ScreenshotName": "SentinelOne-APT29-12886.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A1 - net.exe making connection to OneDrive domain", "ScreenshotName": "SentinelOne-APT29-6952.png"}, {"ScreenshotCaption": "A1 - Network connection information port, ip, protocol using Net Command and shows HTTPS", "ScreenshotName": "SentinelOne-APT29-6955.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of net.exe mounting a share from OneDrive and connecting to a Microsoft IP.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13787.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7174.png"}, {"ScreenshotName": "SecureWorks-APT29-7170.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Web Service", "Steps count": 1, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1045": {"Steps": {"8.B.2": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though python.exe was manually recovered from the system by the analyst, and it was identified as UPX packed. This is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "8b2-rebuttal pic details", "ScreenshotName": "Elastic-APT29-18081.png"}, {"ScreenshotCaption": "8b2 rebuttal pic of hunt", "ScreenshotName": "Elastic-APT29-18080.png"}], "Score": 3}], "Step score": 3}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Software Packing - T1045\" was generated for the file creation event for python.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3013.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3012.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3014.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13223.png"}], "Score": 70}], "Step score": 135}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.B", "ScreenshotName": "FireEye-APT29-13006.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed that python.exe had entropy, indicating the file was packed.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8.B.2 - Entropy value near 1 suggests python.exe is packed", "ScreenshotName": "FireEye-APT29-11174.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for python.exe being identified as a packed payload. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-764.png"}], "Score": 65}], "Step score": 65}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed python.exe was packed via static analysis. Detection incurred a delay due to file being uploaded for sandbox analysis.", "Detect": "Telemetry-Delayed (Processing)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12205.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Software Packing\" was generated when python.exe was written to disk. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "defense evasion via software packing", "ScreenshotName": "CrowdStrike-APT29-10468.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a packed executable written event for python.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing PackedExecutableWritten on Nashua matching the PeFileWritten on Scranton.", "ScreenshotName": "CrowdStrike-APT29-10458.png"}, {"ScreenshotCaption": "Telemetry showing the FileSubType_decimal is 4 (UPX) for python.exe.", "ScreenshotName": "CrowdStrike-APT29-10461.png"}], "Score": 10}], "Step score": 75}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Defense Evasion - Software Packing\" showed python.exe was packed.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - b2 - python is packed", "ScreenshotName": "Cybereason-APT29-10780.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Software Packing\" was generated when python.exe was executed by PSExec.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "Software packing tag for python.exe", "ScreenshotName": "Symantec-APT29-7457.png"}], "Score": 60}, {"DetectionNote": "Telemetry from automated file analysis showed python.exe was UPX packed. Detection incurred a delay based on additional data processing of python.exe to determine it was UPX packed.", "Detect": "Telemetry-Delayed (Processing)", "Screenshots": [{"ScreenshotCaption": "identification of python.exe as UPX packed", "ScreenshotName": "Symantec-APT29-7488.png"}], "Score": 10}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "8.b.2 - file hex dump shows upx (host interrogation)", "ScreenshotName": "Kaspersky-APT29-2887.png"}], "Score": 3}], "Step score": 3}, "Procedure": "python.exe payload was packed with UPX", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the analyst was able to retrieve the file, and demonstrate that it is UPX packed, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "UPX - downloaded file and looking at binary", "ScreenshotName": "F-Secure-APT29-10126.png"}], "Score": 3}], "Step score": 3}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12787.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed python.exe is packed. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11970.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-426.png"}], "Score": 70}], "Step score": 70}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"Software Packing\" was generated for the file creation event for python.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "File Creation event for python.exe. Enriched as Software Packing", "ScreenshotName": "CyCraft-APT29-14901.png"}], "Score": 65}], "Step score": 65}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"UPXProcess\" under \"Defense Evasion {T1045}\" was generated due to python.exe being packed with UPX.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "B2 - UPX Packing Alert", "ScreenshotName": "SentinelOne-APT29-6725.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2 - python.exe being packed", "ScreenshotName": "SentinelOne-APT29-12833.png"}], "Score": 70}], "Step score": 135}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12622.png"}, {"ScreenshotName": "SecureWorks-APT29-12623.png"}], "Score": 70}], "Step score": 70}}}, "TechniqueName": "Software Packing", "Steps count": 1, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1107": {"Steps": {"4.B.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "draft.zip file deletion", "ScreenshotName": "Elastic-APT29-1226.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13211.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2830.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2831.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete Draft.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.3 - Sdelete Command Execution on Draft.zip", "ScreenshotName": "FireEye-APT29-10995.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.3 -  PowerShell Child Process for sdelete64.exe on Draft.zip (bottom)", "ScreenshotName": "FireEye-APT29-10991.png"}, {"ScreenshotCaption": "4.B - PowerShell Child Process of sdelete64.exe (top)", "ScreenshotName": "FireEye-APT29-10988.png"}], "Score": 35}, {"DetectionNote": "A General alert detection was generated for the execution of a Sysinternals utility.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.3 - Sysinternals Utility Execution for Draft.zip", "ScreenshotName": "FireEye-APT29-10985.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.B", "ScreenshotName": "FireEye-APT29-12990.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.B.3 - Alphabetic rollovers from SDelete of Draft.zip", "ScreenshotName": "FireEye-APT29-11009.png"}], "Score": 10}], "Step score": 215}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-686.png"}, {"ScreenshotName": "Bitdefender-APT29-707.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated due to sdelete64.exe deleting Draft.Zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1544.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1547.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Sdelete Usage\" was generated due to sdelete64.exe deleting Draft.Zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11911.png"}, {"ScreenshotName": "Cylance-APT29-11906.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Evading Detection\" occurred containing evidence of sdelete64.exe deleting files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12899.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12241.png"}], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for user execution of Draft.zip.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc.", "ScreenshotName": "CrowdStrike-APT29-10296.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.b.2 / 3 / 4 - filenames from path", "ScreenshotName": "Cybereason-APT29-9601.png"}, {"ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete deleting files", "ScreenshotName": "Cybereason-APT29-9603.png"}, {"ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete 64 process tree", "ScreenshotName": "Cybereason-APT29-9602.png"}, {"ScreenshotCaption": "4.b.2 / 3 /4 - sdelete deleting the files", "ScreenshotName": "Cybereason-APT29-9605.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\Draft.Zip.", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "Sdelete execution for all files", "ScreenshotName": "Symantec-APT29-7428.png"}], "Score": 40}, {"DetectionNote": "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting Draft.Zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: File Deletion description", "ScreenshotName": "Symantec-APT29-12913.png"}, {"ScreenshotCaption": "MSSP Day 1: File Deletion name", "ScreenshotName": "Symantec-APT29-12912.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "File deletion events for zip files and pupy payload", "ScreenshotName": "Symantec-APT29-9921.png"}, {"ScreenshotCaption": "Sdelete execution for all files", "ScreenshotName": "Symantec-APT29-7428.png"}], "Score": 10}], "Step score": 120}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of sdelete64.exe deleting Draft.Zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 4b2-4 (file deletes)", "ScreenshotName": "Kaspersky-APT29-17994.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2755.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Deleted Draft.zip on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for PowerShell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "rdr sysinternals.zip and draft.zip", "ScreenshotName": "F-Secure-APT29-10607.png"}, {"ScreenshotCaption": "the next one for sdelte.command line cut it off", "ScreenshotName": "F-Secure-APT29-10059.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - all 3 sdeletes", "ScreenshotName": "F-Secure-APT29-11277.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting Draft.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "sdelete doing its thing", "ScreenshotName": "F-Secure-APT29-10057.png"}], "Score": 10}], "Step score": 152}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection called \"File Deletion\" (medium severity) was generated due to sdelete64.exe deleting Draft.zip. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11882.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.Zip. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11885.png"}], "Score": 17}], "Step score": 152}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"File Deletion\" was generated for sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process. ", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-81.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence of sdelete64.exe deleting Draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-404.png"}, {"ScreenshotName": "Microsoft-APT29-403.png"}, {"ScreenshotName": "Microsoft-APT29-402.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-392.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\"  was generated due to Sdelete64.exe deleting Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3911.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3911.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13941.png"}, {"ScreenshotName": "Carbon Black-APT29-3903.png"}], "Score": 17}], "Step score": 161}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "4b3 new vendor screenshot correlated", "ScreenshotName": "CyCraft-APT29-14996.png"}], "Score": 72}], "Step score": 72}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to the use of SDelete to delete rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10892.png"}, {"ScreenshotName": "GoSecure-APT29-10893.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10892.png"}, {"ScreenshotName": "GoSecure-APT29-10893.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for File Deletion was generated due to sdelete.exe deleting Draft.Zip. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Technique-Correlated-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Alert for sdelete", "ScreenshotName": "MalwareBytes-APT29-2592.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "deletion of roaming 2 (4b3)", "ScreenshotName": "MalwareBytes-APT29-2530.png"}], "Score": 10}], "Step score": 75}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"SDelete usage by Process Monitor\"  was generated due to sdelete64.exe process creation used to delete Draft.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3522.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt1", "ScreenshotName": "SentinelOne-APT29-12812.png"}, {"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt2", "ScreenshotName": "SentinelOne-APT29-12813.png"}, {"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt3", "ScreenshotName": "SentinelOne-APT29-12814.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip", "ScreenshotName": "SentinelOne-APT29-6527.png"}, {"ScreenshotCaption": "B2/3/4 - Deleting files (sdelete.exe writing over path names)", "ScreenshotName": "SentinelOne-APT29-6528.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"SDelete64 Usage\" was generated due to Sdelete64.exe deleting Draft.Zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7225.png"}, {"ScreenshotName": "SecureWorks-APT29-7226.png"}, {"ScreenshotName": "SecureWorks-APT29-7223.png"}, {"ScreenshotName": "SecureWorks-APT29-7227.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}}, "4.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "making sure i got the .scr deletion", "ScreenshotName": "Elastic-APT29-1225.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting ?cod.3aka.scr.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13211.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2835.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.2 - Sdelete Command Execution on rcs.3aka3.doc", "ScreenshotName": "FireEye-APT29-10994.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.B - PowerShell Child Process of sdelete64.exe (top)", "ScreenshotName": "FireEye-APT29-10988.png"}, {"ScreenshotCaption": "4.B.2 - PowerShell Child Process for sdelete64.exe on rcs.3aka3.doc (bottom)", "ScreenshotName": "FireEye-APT29-10992.png"}], "Score": 35}, {"DetectionNote": "A General alert detection was generated for the execution of a Sysinternals utility.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.2 - Sysinternals Utility Execution for rcs.3aka3.doc", "ScreenshotName": "FireEye-APT29-10986.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting the file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.B", "ScreenshotName": "FireEye-APT29-12990.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.B.2 - Alphabetic rollovers from SDelete of rcs.3aka3.doc", "ScreenshotName": "FireEye-APT29-11005.png"}], "Score": 10}], "Step score": 215}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection was generated for an unusual file write in the user directory. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-684.png"}, {"ScreenshotName": "Bitdefender-APT29-13411.png"}], "Score": 42}, {"DetectionNote": "A General alert detection was generated for the SDelete process being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-14013.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and subsequently writing to the file. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-683.png"}, {"ScreenshotName": "Bitdefender-APT29-706.png"}, {"ScreenshotName": "Bitdefender-APT29-682.png"}], "Score": 17}], "Step score": 101}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated due to sdelete64.exe deleting rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1545.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1548.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Sdelete Usage\" was generated due to sdelete64.exe deleting cod.3aka3.scr. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11912.png"}, {"ScreenshotName": "Cylance-APT29-11906.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Evading Detection\" occurred containing evidence of sdelete64.exe deleting files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12899.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12240.png"}], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"File Deletion\" was generated due to sdelete64.exe deleting rcs.3aka3.doc. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "4.b sdelete alert of the suspicious file", "ScreenshotName": "CrowdStrike-APT29-10360.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename events. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc.", "ScreenshotName": "CrowdStrike-APT29-10296.png"}, {"ScreenshotCaption": "Telemetry showing the file rename and delete operations for rcs.3aka3.doc.", "ScreenshotName": "CrowdStrike-APT29-10328.png"}], "Score": 17}], "Step score": 89}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete deleting files", "ScreenshotName": "Cybereason-APT29-9603.png"}, {"ScreenshotCaption": "4.b.2 / 3 / 4 - filenames from path", "ScreenshotName": "Cybereason-APT29-9601.png"}, {"ScreenshotCaption": "4.b.2 / 3 /4 - sdelete deleting the files", "ScreenshotName": "Cybereason-APT29-9605.png"}, {"ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete 64 process tree", "ScreenshotName": "Cybereason-APT29-9602.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete rcs.3aka3.doc.", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "Sdelete execution for the doc file", "ScreenshotName": "Symantec-APT29-7427.png"}, {"ScreenshotCaption": "Sdelete execution for all files", "ScreenshotName": "Symantec-APT29-7428.png"}], "Score": 40}, {"DetectionNote": "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: File Deletion name", "ScreenshotName": "Symantec-APT29-12912.png"}, {"ScreenshotCaption": "MSSP Day 1: File Deletion description", "ScreenshotName": "Symantec-APT29-12913.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Sdelete execution for the doc file", "ScreenshotName": "Symantec-APT29-7427.png"}, {"ScreenshotCaption": "File deletion events for zip files and pupy payload", "ScreenshotName": "Symantec-APT29-9921.png"}, {"ScreenshotCaption": "Sdelete execution for all files", "ScreenshotName": "Symantec-APT29-7428.png"}], "Score": 10}], "Step score": 120}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of sdelete64.exe deleting rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 4b2-4 (file deletes)", "ScreenshotName": "Kaspersky-APT29-17994.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.b.2 rcs file deleted", "ScreenshotName": "Kaspersky-APT29-2752.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for PowerShell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": ".scr sdeletee", "ScreenshotName": "F-Secure-APT29-10058.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - all 3 sdeletes", "ScreenshotName": "F-Secure-APT29-11277.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting rcs.3aka3.doc.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "sdelete doing its thing", "ScreenshotName": "F-Secure-APT29-10057.png"}], "Score": 10}], "Step score": 152}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection called \"File Deletion\" (medium severity) was generated due to sdelete64.exe deleting rcs.3aka3.doc. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11886.png"}, {"ScreenshotName": "TrendMicro-APT29-11879.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11886.png"}, {"ScreenshotName": "TrendMicro-APT29-14014.png"}], "Score": 17}], "Step score": 152}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"File Deletion\" was generated for sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-81.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence of sdelete64.exe deleting rcs.3aka3.doc.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-403.png"}, {"ScreenshotName": "Microsoft-APT29-404.png"}, {"ScreenshotName": "Microsoft-APT29-402.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-391.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3915.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3915.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3903.png"}, {"ScreenshotName": "Carbon Black-APT29-13940.png"}], "Score": 17}], "Step score": 161}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "4b2 - new vendor screen", "ScreenshotName": "CyCraft-APT29-15479.png"}], "Score": 72}], "Step score": 72}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to the use of SDelete to delete rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10890.png"}, {"ScreenshotName": "GoSecure-APT29-10892.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10890.png"}, {"ScreenshotName": "GoSecure-APT29-10892.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for File Deletion was generated due to sdelete.exe deleting ?cod.3aka3.scr. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Technique-Alert-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Alert for sdelete", "ScreenshotName": "MalwareBytes-APT29-2592.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "deletion of 3aka3", "ScreenshotName": "MalwareBytes-APT29-2532.png"}], "Score": 10}], "Step score": 75}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"SDelete usage by Process Monitor\" was generated due to sdelete64.exe process creation used to delete rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3523.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt3", "ScreenshotName": "SentinelOne-APT29-12814.png"}, {"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt2", "ScreenshotName": "SentinelOne-APT29-12813.png"}, {"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt1", "ScreenshotName": "SentinelOne-APT29-12812.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.  The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B2/3/4 - Deleting files (sdelete.exe writing over path names)", "ScreenshotName": "SentinelOne-APT29-6528.png"}, {"ScreenshotCaption": "B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip", "ScreenshotName": "SentinelOne-APT29-6527.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"SDelete64 Usage\" was generated due to Sdelete64.exe deleting rcs.3aka3.doc.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7218.png"}, {"ScreenshotName": "SecureWorks-APT29-7221.png"}, {"ScreenshotName": "SecureWorks-APT29-7222.png"}, {"ScreenshotName": "SecureWorks-APT29-7220.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}}, "4.B.4": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "delete of sysinternals", "ScreenshotName": "Elastic-APT29-1228.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13211.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2829.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete SysinternalsSuite.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.4 - Sdelete Command Execution on SysinternalsSuite.zip", "ScreenshotName": "FireEye-APT29-10996.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.4 - PowerShell Child Process for sdelete64.exe on SysinternalsSuite.zip (bottom)", "ScreenshotName": "FireEye-APT29-10990.png"}, {"ScreenshotCaption": "4.B - PowerShell Child Process of sdelete64.exe (top)", "ScreenshotName": "FireEye-APT29-10988.png"}], "Score": 35}, {"DetectionNote": "A General alert detection was generated for the execution of a Sysinternals utility.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.B.4 - Sysinternals Utility Execution for SysinternalsSuite.zip", "ScreenshotName": "FireEye-APT29-10982.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.B", "ScreenshotName": "FireEye-APT29-12990.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.B.4 - Alphabetic rollovers from SDelete of SysinternalsSuite.zip", "ScreenshotName": "FireEye-APT29-11007.png"}], "Score": 10}], "Step score": 215}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-708.png"}, {"ScreenshotName": "Bitdefender-APT29-687.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated due to sdelete64.exe deleting SysinterlsSuite.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1539.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1549.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Sdelete Usage\" was generated due to sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11906.png"}, {"ScreenshotName": "Cylance-APT29-11908.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Evading Detection\" occurred containing evidence of sdelete64.exe deleting files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12899.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12242.png"}], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed file rename and delete operations from sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert for user execution of SysinternalsSuite.zip.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc.", "ScreenshotName": "CrowdStrike-APT29-10296.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.b.2 / 3 / 4 - filenames from path", "ScreenshotName": "Cybereason-APT29-9601.png"}, {"ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete deleting files", "ScreenshotName": "Cybereason-APT29-9603.png"}, {"ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete 64 process tree", "ScreenshotName": "Cybereason-APT29-9602.png"}, {"ScreenshotCaption": "4.b.2 / 3 /4 - sdelete deleting the files", "ScreenshotName": "Cybereason-APT29-9605.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete SysinternalsSuite.zip.", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "Sdelete execution for all files", "ScreenshotName": "Symantec-APT29-7428.png"}], "Score": 40}, {"DetectionNote": "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: File Deletion description", "ScreenshotName": "Symantec-APT29-12913.png"}, {"ScreenshotCaption": "MSSP Day 1: File Deletion name", "ScreenshotName": "Symantec-APT29-12912.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Sdelete execution for all files", "ScreenshotName": "Symantec-APT29-7428.png"}, {"ScreenshotCaption": "File deletion events for zip files and pupy payload", "ScreenshotName": "Symantec-APT29-9921.png"}], "Score": 10}], "Step score": 120}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 4b2-4 (file deletes)", "ScreenshotName": "Kaspersky-APT29-17994.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.b.4 - sysinternalssuite.zip deleted", "ScreenshotName": "Kaspersky-APT29-2758.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for file deletion  was generated due to sdelete64.exe deleting SysinternalsSuite.zip. This was correlated to a previous detection for PowerShell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "rdr sysinternals.zip and draft.zip", "ScreenshotName": "F-Secure-APT29-10607.png"}, {"ScreenshotCaption": "the next one for sdelte.command line cut it off", "ScreenshotName": "F-Secure-APT29-10059.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - all 3 sdeletes", "ScreenshotName": "F-Secure-APT29-11277.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting SysinternalsSuite.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "sdelete doing its thing", "ScreenshotName": "F-Secure-APT29-10057.png"}], "Score": 10}], "Step score": 152}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection called \"File Deletion\" (medium severity) was generated due to sdelete64.exe deleting SysinternalsSuite.zip. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11881.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with commTelemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11883.png"}], "Score": 17}], "Step score": 152}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"File Deletion\" was generated for sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-81.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-404.png"}, {"ScreenshotName": "Microsoft-APT29-403.png"}, {"ScreenshotName": "Microsoft-APT29-402.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-393.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3914.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3914.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection was generated for the of SysinternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12754.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13942.png"}, {"ScreenshotName": "Carbon Black-APT29-3903.png"}], "Score": 17}], "Step score": 231}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) was generated due to sdelete64.exe deleting  SysinternalsSuite.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "4b4 vendor added screenshot correlated", "ScreenshotName": "CyCraft-APT29-14994.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"File Deletion\" was received that included a PowerShell script and explained that it was used to execute sdelete64.exe to delete SysInternalsSuite.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.B.4 - MDR Report Day 1, Sdelete of SysInternalsSuite", "ScreenshotName": "CyCraft-APT29-12440.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated due to the use of SDelete to delete SysinternalsSuite.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10892.png"}, {"ScreenshotName": "GoSecure-APT29-10894.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10894.png"}, {"ScreenshotName": "GoSecure-APT29-10892.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for File Deletion  was generated due to sdelete.exe deleting SysinternalsSuite.zip. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Technique-Correlated-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Alert for sdelete", "ScreenshotName": "MalwareBytes-APT29-2592.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file . The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "deletion of sysinternals", "ScreenshotName": "MalwareBytes-APT29-2534.png"}], "Score": 10}], "Step score": 75}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"SDelete usage by Process Monitor\" was generated due to sdelete64.exe process creation used to delete SysinternalsSuite.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3521.png"}, {"ScreenshotName": "HanSight-APT29-3521.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt2", "ScreenshotName": "SentinelOne-APT29-12813.png"}, {"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt1", "ScreenshotName": "SentinelOne-APT29-12812.png"}, {"ScreenshotCaption": "MSSP - B2/3/4 - File delete info pt3", "ScreenshotName": "SentinelOne-APT29-12814.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip", "ScreenshotName": "SentinelOne-APT29-6527.png"}, {"ScreenshotCaption": "B2/3/4 - Deleting files (sdelete.exe writing over path names)", "ScreenshotName": "SentinelOne-APT29-6528.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"SDelete64 Usage\" was generated due to Sdelete64.exe deleting SysinternalsSuite.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6606.png"}, {"ScreenshotName": "SecureWorks-APT29-6603.png"}, {"ScreenshotName": "SecureWorks-APT29-6605.png"}, {"ScreenshotName": "SecureWorks-APT29-6604.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}}, "9.C.3": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1107 File Deletion\" was generated when sdelete64.exe made a NtSetInformationFile API call deleting Roaming\\working.zip. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "cc - file deletion enrichment for 9.c.3 based on api monitoring", "ScreenshotName": "Elastic-APT29-1766.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "cc - commandline for the  enrichment above", "ScreenshotName": "Elastic-APT29-1767.png"}], "Score": 17}], "Step score": 82}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the deletion of roaming\\working.zip by SDelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3085.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.C.3 - Sdelete Command Execution for C:\\Users\\pam\\AppData\\Roaming\\working.zip", "ScreenshotName": "FireEye-APT29-13996.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Roaming\\working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.C", "ScreenshotName": "FireEye-APT29-13019.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. This event was correlated to a prior detection on the python.exe parent process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.C.3 - Triage view of sdelete64.exe deleting C:\\Users\\pam\\AppData\\Roaming\\working.zip and associated alphabetical rollovers", "ScreenshotName": "FireEye-APT29-11241.png"}], "Score": 17}], "Step score": 152}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection called \"Unusual File Written in User Directory\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-784.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-783.png"}], "Score": 10}], "Step score": 45}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1772.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to a parent alerts of a suspicious python.exe process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1777.png"}], "Score": 17}], "Step score": 82}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Evading Detection\" occurred containing evidence of sdelete64.exe deleting files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12916.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12029.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10511.png"}, {"ScreenshotCaption": "Telemetry showing cmd.exe spawning sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10512.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.c.3 sdelete deleting appdata working zip file", "ScreenshotName": "Cybereason-APT29-9664.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. ", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "9c1/2/3 - tactic/technique ", "ScreenshotName": "Symantec-APT29-17696.png"}], "Score": 40}, {"DetectionNote": "Telemetry showed sdelete64.exe executing with command-line arguments to delete Roaming\\working.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9c1/2/3 - tactic/technique ", "ScreenshotName": "Symantec-APT29-17696.png"}], "Score": 10}], "Step score": 50}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Similar false positive with Data Compressed, likely due to zip in the filename.", "ScreenshotName": "Kaspersky-APT29-2950.png"}], "Score": 10}], "Step score": 10}, "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "working .zip being delteed twice.", "ScreenshotName": "F-Secure-APT29-10146.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete deleting Roaming\\working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - file deletes", "ScreenshotName": "F-Secure-APT29-11298.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to a Technique detection on python.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "sdeltee rar.exe", "ScreenshotName": "F-Secure-APT29-10144.png"}], "Score": 17}], "Step score": 152}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Possible SDELETE\" (medium severity) was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14026.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Roaming\\working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14023.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting Roaming\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12017.png"}], "Score": 10}], "Step score": 145}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. The detection was correlated to a parent alert for powershell.exe compressing data.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "syoder-1-RQ-9.C.1-T1107-1.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence sdelete64.exe deleted working.zip from C:\\Users\\USER_NAME\\AppData\\Roaming.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1134.png"}, {"ScreenshotName": "Microsoft-APT29-1135.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to Roaming\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14001.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13952.png"}, {"ScreenshotName": "Carbon Black-APT29-4076.png"}], "Score": 17}], "Step score": 59}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "sdelete appdata working.zip with enrichments", "ScreenshotName": "CyCraft-APT29-2265.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9.C.1 - MDR Report Day 1, description", "ScreenshotName": "CyCraft-APT29-12464.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technnique alert detection (red indicator) called \"Sdelete Tool Ran\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11092.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of working.zip by SDelete.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12703.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to parent alert on New Windows Service Created.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11092.png"}], "Score": 17}], "Step score": 152}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Indicator Removal on Host\" was generated when sdelete64.exe with command-line arguments was used to delete working.zip. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3673.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete working.zip. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1 - sdelete", "ScreenshotName": "SentinelOne-APT29-12840.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "C3 - sdelete64.exe removing of appdata/working.zip ", "ScreenshotName": "SentinelOne-APT29-6769.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique detection alert (low severity) called \"SDelete64 Usage\" \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6822.png"}, {"ScreenshotName": "SecureWorks-APT29-6820.png"}, {"ScreenshotName": "SecureWorks-APT29-6819.png"}, {"ScreenshotName": "SecureWorks-APT29-6821.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}}, "9.C.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9c2 - file delete working.zip", "ScreenshotName": "Elastic-APT29-15005.png"}], "Score": 10}], "Step score": 10}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"file deletion T1107\"  was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3086.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of Desktop\\working.zip by SDelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file delete event for sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3088.png"}], "Score": 17}], "Step score": 152}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.C.2 - Sdelete Command Execution for C:\\Users\\pam\\Desktop\\working.zip", "ScreenshotName": "FireEye-APT29-11232.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Desktop\\working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.C", "ScreenshotName": "FireEye-APT29-13019.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-785.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1773.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to a parent alerts of a suspicious python.exe process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1775.png"}], "Score": 17}], "Step score": 82}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Sdelete Usage\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12025.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Evading Detection\" occurred containing evidence of sdelete64.exe deleting files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12916.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12031.png"}, {"ScreenshotName": "Cylance-APT29-12030.png"}], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10511.png"}, {"ScreenshotCaption": "Telemetry showing cmd.exe spawning sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10512.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9c1 / 2 sdelete deleting the rar.exe file and working.zip file", "ScreenshotName": "Cybereason-APT29-9661.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. ", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "9c1/2/3 - tactic/technique ", "ScreenshotName": "Symantec-APT29-17696.png"}], "Score": 40}, {"DetectionNote": "Telemetry showed sdelete64.exe executing with command-line arguments to delete Desktop\\working.zip. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9c1/2/3 - tactic/technique ", "ScreenshotName": "Symantec-APT29-17696.png"}], "Score": 10}], "Step score": 50}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2952.png"}], "Score": 10}], "Step score": 10}, "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "working .zip being delteed twice.", "ScreenshotName": "F-Secure-APT29-10146.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete deleting Desktop\\working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - file deletes", "ScreenshotName": "F-Secure-APT29-11298.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to a Technique detection on python.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "sdeltee rar.exe", "ScreenshotName": "F-Secure-APT29-10144.png"}], "Score": 17}], "Step score": 152}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection for \"SysInternal Tools License Suppression\" (low severity) was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14025.png"}], "Score": 35}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Desktop\\working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14023.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12013.png"}], "Score": 10}], "Step score": 115}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The detection was correlated to a parent alert for powershell.exe compressing data.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "syoder-1-RQ-9.C.1-T1107-1.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence sdelete64.exe deleted working.zip from Desktop.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1134.png"}, {"ScreenshotName": "Microsoft-APT29-1135.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17398.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4075.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4075.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4075.png"}, {"ScreenshotName": "Carbon Black-APT29-4074.png"}], "Score": 17}], "Step score": 203}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "sdelete Desktop\\working.zip with enrichments", "ScreenshotName": "CyCraft-APT29-2266.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration, including C:\\Users\\pam\\Desktop\\working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9.C.1 - MDR Report Day 1, description", "ScreenshotName": "CyCraft-APT29-12464.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technnique alert detection (red indicator) called \"Sdelete Tool Ran\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11092.png"}, {"ScreenshotName": "GoSecure-APT29-11089.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of working.zip by SDelete.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12703.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to parent alert on New Windows Service Created.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11089.png"}, {"ScreenshotName": "GoSecure-APT29-11092.png"}], "Score": 17}], "Step score": 152}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Indicator Removal on Host\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3672.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments used to delete Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1 - sdelete", "ScreenshotName": "SentinelOne-APT29-12840.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to Desktop\\working.zip. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "C2 - sdelete64.exe removing of Desktop/working.zip ", "ScreenshotName": "SentinelOne-APT29-6765.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique detection alert (low severity) called \"SDelete64 Usage\" \"File Deletion T1107\" was generated  when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6817.png"}, {"ScreenshotName": "SecureWorks-APT29-6819.png"}, {"ScreenshotName": "SecureWorks-APT29-6818.png"}, {"ScreenshotName": "SecureWorks-APT29-6816.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}}, "9.C.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"ATT&CK T1107 File Deletion\" was generated when sdelete64.exe made a NtSetInformationFile API call deleting rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "cc - file deletion enrichment for 9.c.3 based on api monitoring", "ScreenshotName": "Elastic-APT29-1766.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "rar.exe file delete", "ScreenshotName": "Elastic-APT29-1341.png"}], "Score": 17}], "Step score": 82}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the deletion of Rar.exe by SDelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3066.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.C.1 - Sdelete Command Execution for Rar.exe", "ScreenshotName": "FireEye-APT29-13995.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for the file deletion of rar.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.C", "ScreenshotName": "FireEye-APT29-13019.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-782.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1771.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to a parent alerts of a suspicious python.exe process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1779.png"}], "Score": 17}], "Step score": 82}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Sdelete Usage\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12026.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Evading Detection\" occurred containing evidence of sdelete64.exe deleting files.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12916.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12028.png"}], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10511.png"}, {"ScreenshotCaption": "Telemetry showing cmd.exe spawning sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10512.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9c1 / 2 sdelete deleting the rar.exe file and working.zip file", "ScreenshotName": "Cybereason-APT29-9661.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. ", "Detect": "Tactic", "Screenshots": [{"ScreenshotCaption": "9c1/2/3 - tactic/technique ", "ScreenshotName": "Symantec-APT29-17696.png"}], "Score": 40}, {"DetectionNote": "Telemetry showed sdelete64.exe executing with command-line arguments to delete Rar.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9c1/2/3 - tactic/technique ", "ScreenshotName": "Symantec-APT29-17696.png"}], "Score": 10}], "Step score": 50}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9.c.3 - sdelete64 deleting roaming\\working.zip", "ScreenshotName": "Kaspersky-APT29-2949.png"}], "Score": 10}], "Step score": 10}, "Procedure": "Deleted rar.exe on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "rar.exe and working.zip", "ScreenshotName": "F-Secure-APT29-10145.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to a Technique detection on python.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "sdeltee rar.exe", "ScreenshotName": "F-Secure-APT29-10144.png"}], "Score": 17}], "Step score": 82}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection for \"SysInternal Tools License Suppression\" (low severity) was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14024.png"}], "Score": 35}, {"DetectionNote": "A MSSP detection occurred for the file deletion of rar.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14023.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe deleting rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12013.png"}], "Score": 10}], "Step score": 115}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe. The detection was correlated to a parent alert for powershell.exe compressing data.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-153.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence sdelete64.exe deleted rar.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1135.png"}, {"ScreenshotName": "Microsoft-APT29-1134.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-450.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13949.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13949.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4078.png"}, {"ScreenshotName": "Carbon Black-APT29-4074.png"}], "Score": 17}], "Step score": 203}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "9c1-vendor submitted screenshot", "ScreenshotName": "CyCraft-APT29-14982.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9.C.1 - MDR Report Day 1, description", "ScreenshotName": "CyCraft-APT29-12464.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technnique alert detection (red indicator) called \"Sdelete Tool Ran\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11090.png"}, {"ScreenshotName": "GoSecure-APT29-11089.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of Rar.exe by SDelete.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12703.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to parent alert on New Windows Service Created.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11089.png"}, {"ScreenshotName": "GoSecure-APT29-11090.png"}], "Score": 17}], "Step score": 152}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Indicator Removal on Host\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3671.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments used to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1 - sdelete", "ScreenshotName": "SentinelOne-APT29-12840.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file deletion event for secure file delete deleting rar.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "C1 - sdelete64 removing Temp/rar.exe", "ScreenshotName": "SentinelOne-APT29-6767.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique detection alert (low severity) called \"SDelete64 Usage\" \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13760.png"}, {"ScreenshotName": "SecureWorks-APT29-13759.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13758.png"}], "Score": 10}], "Step score": 75}}, "9.C.4": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1107 File Deletion\" was generated when cmd.exe deleted sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "sdlete64.exe file delete ", "ScreenshotName": "Elastic-APT29-1340.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "rar.exe file delete", "ScreenshotName": "Elastic-APT29-1341.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"file deletion T1107\" was generated when cmd.exe deleted sdelete.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13664.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of SDelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3089.png"}], "Score": 17}], "Step score": 152}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed deletion of sdelete64.exe. The event was correlated to a parent alerts of a suspicious python.exe process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1781.png"}], "Score": 17}], "Step score": 17}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed a DeleteOnClose event for cmd.exe removing sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12027.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed an ExecutableDeleted event for sdelete64.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10511.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.c.4 cmd.exe deleting the sdelete", "ScreenshotName": "Cybereason-APT29-13290.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe. Processing was triggered by human action and not initiated automatically.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9c4 - telem - delayed", "ScreenshotName": "Symantec-APT29-17698.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Deleted SDelete on disk using cmd.exe del command", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the deletion of sdelete.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14496.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file deletion of sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "deted a file - sdelete64.exe", "ScreenshotName": "F-Secure-APT29-10148.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"File Deletion\" was generated when cmd.exe used to delete sdelete64.exe. The detection was correlated to a parent alert for powershell.exe compressing data.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "syoder-1-RQ-9.C.1-T1107-1.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13951.png"}, {"ScreenshotName": "Carbon Black-APT29-13950.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and filemod(delete) event. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4079.png"}], "Score": 17}], "Step score": 59}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The event was correlated to parent alert on New Windows Service Created.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11094.png"}], "Score": 17}], "Step score": 17}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"executing a deletion\" occurred containing evidence of cmd.exe being run to delete sdelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1 - sdelete", "ScreenshotName": "SentinelOne-APT29-12840.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file deletion event on \"Windows Command Processor\" deleting sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "C4 - \"Windows Command Processor\" removing Temp/sdelete64.exe", "ScreenshotName": "SentinelOne-APT29-6766.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "19.C.1": {"Elastic": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Deleted staged data on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}}, "19.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}}, "19.B.1": {"Elastic": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Deleted exfiltrated data on disk using SDelete", "F-Secure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "Detect": "N/A", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "File Deletion", "Steps count": 10, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1043": {"Steps": {"11.A.13": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium detection) for \"Command and Control\" with the rule name \"PowerShell Network Activity\" was generated for powershell.exe opening a network connection.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "same alert at (30) but with full tele view", "ScreenshotName": "Elastic-APT29-1380.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell network comms over 443 with enrichment of c2", "ScreenshotName": "Elastic-APT29-1377.png"}], "Score": 10}], "Step score": 55}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13238.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3140.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3142.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell making a network connection.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "11.A.13 - PowerShell Network Connection, with port 443", "ScreenshotName": "FireEye-APT29-11386.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for PowerShell making network connection to C2 (192.168.0.4) over port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13022.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 115}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-819.png"}, {"ScreenshotName": "Bitdefender-APT29-807.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "A General detection was generated identifying a socket opened by a process that normally does not.", "Detect": "General", "Screenshots": [], "Score": 30}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1834.png"}, {"ScreenshotName": "McAfee-APT29-1827.png"}], "Score": 10}], "Step score": 40}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Win_Network_CommonPorts_MITRET1043\"  was generated when powershell.exe made a network connection to C2 (192.168.0.4) over port 443.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12059.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.13 - connection activity app view", "ScreenshotName": "CrowdStrike-APT29-10575.png"}, {"ScreenshotCaption": "Telemetry showing certutil.exe decoding kwxn.lock. Telemetry showing powershell.exe making a network connection to 192.168.0.4 to port 443.", "ScreenshotName": "CrowdStrike-APT29-10585.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.13 - connection over port 443, process tree", "ScreenshotName": "Cybereason-APT29-9723.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Commonly Used Port\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 over port 443. A detailed analysis of the script was also provided.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: stager script explanation", "ScreenshotName": "Symantec-APT29-12954.png"}, {"ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques", "ScreenshotName": "Symantec-APT29-12953.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443. ", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)", "ScreenshotName": "Symantec-APT29-9867.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called Commonly Used Port was generated for powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.13 - connection to 192.168.0.4:443 - tree", "ScreenshotName": "Kaspersky-APT29-3172.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.a.13-5 MSSP report #2", "ScreenshotName": "Kaspersky-APT29-12385.png"}, {"ScreenshotCaption": "new mssp 11a13", "ScreenshotName": "Kaspersky-APT29-18015.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.13 - connection to 192.168.0.4:443", "ScreenshotName": "Kaspersky-APT29-3166.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP occurred containing evidence of a connection back to the C2 server 192.168.0.4 over port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - lnk being executed with iex/schemas", "ScreenshotName": "F-Secure-APT29-11305.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14657.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Commonly Used Port\" was generated due for powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12075.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for the network connection over port 443. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12061.png"}], "Score": 10}], "Step score": 140}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Commonly Used Port\" was generated for PowerShell making a network connection to the C2 server (192.168.0.4) over port 443.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-166.png"}], "Score": 65}, {"DetectionNote": " A General alert detection (medium severity) was generated for PowerShell behaving like a RAT.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-173.png"}, {"ScreenshotName": "ReaQta-APT29-13977.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 110}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-484.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for .NET attempting to make suspicious network connections.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4119.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4110.png"}], "Score": 10}], "Step score": 45}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script from 192.168.0.4 over port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.12-15 - MDR Report Day 2, staging remote PowerShell", "ScreenshotName": "CyCraft-APT29-12483.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Commonly Used Port (Outbound connection established)\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over TCP port 443.\n", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11333.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (orange indicator) called \"Powershell: established network connections\" was generated due to PowerShell making network connection to C2 (192.168.0.4) over TCP port 443.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11333.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11333.png"}], "Score": 10}], "Step score": 110}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3749.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1043\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A13/14/15 - network information", "ScreenshotName": "SentinelOne-APT29-12849.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection", "ScreenshotName": "SentinelOne-APT29-6810.png"}, {"ScreenshotCaption": "A11 - Regkey software/windows/CurrentVersion/run being added", "ScreenshotName": "SentinelOne-APT29-6786.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Command and Control - Commonly Used Port\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13768.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6999.png"}], "Score": 10}], "Step score": 80}}, "3.B.3": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Detected Command and Control\" was generated due to PowerShell connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Tactic-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "3b3 - tactic - vendor new pic", "ScreenshotName": "Elastic-APT29-14508.png"}], "Score": 52}, {"DetectionNote": "A General alert detection (medium severity) was generated for the first network connection for a known process. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "3b3 - general vendor new pic", "ScreenshotName": "Elastic-APT29-14509.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "command and control enrichment", "ScreenshotName": "Elastic-APT29-1209.png"}], "Score": 17}], "Step score": 111}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Commonly Used Port was\ngenerated containing evidence monkey.png performed C&C over port 443 to IP address 192.168.0.5.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13197.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2745.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2757.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A General detection was generated for PowerShell making a network connection.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "3.B.3 - PowerShell Network Connection", "ScreenshotName": "FireEye-APT29-10917.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 3.B", "ScreenshotName": "FireEye-APT29-12985.png"}], "Score": 70}], "Step score": 105}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-668.png"}, {"ScreenshotName": "Bitdefender-APT29-1087.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1467.png"}, {"ScreenshotName": "McAfee-APT29-1477.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (info severity) called \"Powershell Network Connections\" was generated for PowerShell making a network connection to 192.168.0.5 over port 443.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11851.png"}, {"ScreenshotName": "Cylance-APT29-11852.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP 443.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "An MSSP report showed sdclt.exe spawned a process that connected to 192.168.0.5 on port 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "Telemetry showing an overwatch alert for the outbound connection by powershell.exe.", "ScreenshotName": "CrowdStrike-APT29-10285.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the powershell.exe processing opening and. closing a network connection to 192.168.0.5 on port 443.", "ScreenshotName": "CrowdStrike-APT29-10275.png"}], "Score": 17}], "Step score": 87}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "3.b.3 - connection over port 443 process details", "ScreenshotName": "Cybereason-APT29-7390.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell connected to 192.168.0.5 on port 443.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.", "ScreenshotName": "Symantec-APT29-7402.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.", "ScreenshotName": "Symantec-APT29-7402.png"}], "Score": 10}], "Step score": 45}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"Commonly Used Port\" was generated due to powershell.exe connecting to 192.168.0.5 on TCP 443. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2717.png"}, {"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2717.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2717.png"}], "Score": 10}], "Step score": 75}, "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "F-Secure": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "port 443 with 192.168.0.5", "ScreenshotName": "F-Secure-APT29-10035.png"}], "Score": 10}], "Step score": 10}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Commonly Used Port\" was generated due to powershell.exe connecting to 192.168.0.5 on TCP 443. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11866.png"}, {"ScreenshotName": "TrendMicro-APT29-11869.png"}], "Score": 67}, {"DetectionNote": "An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14012.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11869.png"}], "Score": 17}], "Step score": 154}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Commonly Used Port\" was generated for powershell.exe connecting to 192.168.0.5 on TCP 443. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-61.png"}, {"ScreenshotName": "ReaQta-APT29-59.png"}], "Score": 72}, {"DetectionNote": " A General alert detection (medium severity) was generated for PowerShell behaving like a RAT.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13976.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 117}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Defense Evasion was generated containing evidence monkey.png performed C&C over port 443 to IP address 192.168.0.5.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-386.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-381.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3824.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert (red indicator) was generated for powershell.exe execution, which included connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "Standard application layer protocol connection to port 443 with enrichments.", "ScreenshotName": "CyCraft-APT29-2211.png"}], "Score": 42}], "Step score": 42}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called Commonly Used Port was generated due to powershell.exe connecting to 192.168.0.5 on TCP port 443. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10849.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The event is correlated to a parent alert on PowerShell Invoke Expression Launched.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10848.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3498.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1043\" occurred containing evidence of powershell.exe connecting to 192.168.0.5 on TCP 443.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B3/4/5 - port information", "ScreenshotName": "SentinelOne-APT29-12807.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting outbound to 192.168.0.5 on TCP 443. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B3/4/5 - Network connection, powershell exchanging data with host over https", "ScreenshotName": "SentinelOne-APT29-6515.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443 using shellcode that loads WinInet.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12589.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6693.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Commonly Used Port", "Steps count": 2, "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}]}, "T1105": {"Steps": {"16.D.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for the creation of a malicious file (m.exe). The detection was correlated to a parent alert for the \"First Seen Process  in an Environment\".", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "and better still with the file create of wsmprovhost.exe", "ScreenshotName": "Elastic-APT29-1531.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed a file write event for m.exe in the System32 directory by wsmprovhost.exe. The detection was correlated to a parent alert for the \"First Seen Process  in an Environment\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "and better still with the file create of wsmprovhost.exe", "ScreenshotName": "Elastic-APT29-1531.png"}], "Score": 17}], "Step score": 59}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13257.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3280.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 16.D", "ScreenshotName": "FireEye-APT29-13042.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of m.exe to System32 directory by wsmprovhost.exe. The detection was correlated to parent alert on the wsmprovhost.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "16.D.1 - Triage view of the m.exe file write", "ScreenshotName": "FireEye-APT29-11575.png"}], "Score": 17}], "Step score": 87}, "Bitdefender": {"Detects": [{"DetectionNote": "A General alert detection was generated for PowerShell writing a file to an uncommon location.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1001.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a file write event for m.exe (identified as Mimikatz by the file metadata) in the System32 directory.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-941.png"}], "Score": 10}], "Step score": 45}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed creation of m.exe (identified as Mimikatz by the file metadata) in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1876.png"}, {"ScreenshotName": "McAfee-APT29-1872.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed a file create event for m.exe in the System32 directory.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12142.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed a file write of m.exe to System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe copied m.exe to winrm session.", "ScreenshotName": "CrowdStrike-APT29-10683.png"}, {"ScreenshotCaption": "Telemetry showing a file write of m.exe to System32 directory by wsmprovhost.exe.", "ScreenshotName": "CrowdStrike-APT29-10689.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed the file write of m.exe to the System32 directory by wsmprovhost.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "16.d.1 - file event wsmprovhost.exe process tree, process marked as malicious", "ScreenshotName": "Cybereason-APT29-9790.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Remote File Copy\" was generated when SMB traffic from another host was received and then immediately followed by a file write for m.exe by wsmprovhost.exe.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "Incident Report for Credential Dumping, including execution of m.exe. Done from HI  powershell.exe process", "ScreenshotName": "Symantec-APT29-9735.png"}, {"ScreenshotCaption": "Remote File Copy event, and network connection from utice > newyork. File Copy tag is based on network connection followed by file creation by wsmprovhost.", "ScreenshotName": "Symantec-APT29-9774.png"}, {"ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe", "ScreenshotName": "Symantec-APT29-9775.png"}], "Score": 60}, {"DetectionNote": "A General alert detection called \"Malicious file detected\" was generated on sandbox detection analysis of m.exe. Detection incurred a delay based on sandbox detonation processing.", "Detect": "General-Delayed (Processing)-Alert", "Screenshots": [{"ScreenshotCaption": "16d1 - general - sandbox detection", "ScreenshotName": "Symantec-APT29-17725.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Remote File Copy\" was received that included a PowerShell command executed by the adversary and explained that it was used to copy mimikatz to a remote PowerShell session.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: remote mimikatz copy description", "ScreenshotName": "Symantec-APT29-12970.png"}, {"ScreenshotCaption": "MSSP Day 1: remote mimikatz copy techniques", "ScreenshotName": "Symantec-APT29-12969.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file create event for m.exe in the System32 directory by \"Host process for WinRM plug-ins\".", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe", "ScreenshotName": "Symantec-APT29-9775.png"}], "Score": 10}], "Step score": 175}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.d.1-2 MSSP report", "ScreenshotName": "Kaspersky-APT29-12409.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "16.d.1 - details", "ScreenshotName": "Kaspersky-APT29-3263.png"}, {"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3261.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the file write of m.exe to System32.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - copy item", "ScreenshotName": "F-Secure-APT29-11318.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "m.exe file create", "ScreenshotName": "F-Secure-APT29-10428.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A General detection was generated for \"Microsoft Windows - System .dll or .exe files modified\".", "Detect": "General", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12148.png"}], "Score": 30}, {"DetectionNote": "A General detection was generated for \"Suspicious Files Detected in Operating System Directories\".", "Detect": "General", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14499.png"}], "Score": 30}, {"DetectionNote": "An MSSP detection occurred for the file write of m.exe to remote host NewYork (10.0.0.4). ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12694.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed  the file write of m.exe to System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 140}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique detection called \"Executable Dropped\" was generated for wsmprvhost.exe creating m.exe (identified as Mimikatz by the file metadata).", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-196.png"}, {"ScreenshotName": "ReaQta-APT29-195.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed a file write event for m.exe in the System32 directory.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 70}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (low severity) \"Hacktool Mimikatz detected\" was generated when m.exe was written to disk.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-536.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-537.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a code drop of m.exe (identified as Mimikatz by the file metadata).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4271.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a filemod for the creation of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4308.png"}], "Score": 10}], "Step score": 75}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (purple indicator) for File Movement was generated indicating that m.exe was moved from host Utica (10.0.1.5) to host NewYork (10.0.0.4).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "File movement of m.exe from UTICA to NEWYORK", "ScreenshotName": "CyCraft-APT29-2473.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Remote File Copy\" was received that described the adversary moving m.exe from host Utica (10.0.1.5) to host NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.D.1 - MDR Report Day 2, file creation", "ScreenshotName": "CyCraft-APT29-12511.png"}, {"ScreenshotCaption": "16.D.1 - MDR Report Day 2, m.exe movement", "ScreenshotName": "CyCraft-APT29-12510.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) for a malicious file was generated for the file create of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11427.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the file create of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11425.png"}], "Score": 10}], "Step score": 45}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the file create event of m.exe in the System32 directory by wsmprovhost.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3920.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated identifying m.exe as a threat file.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Summary view m.exe is actually mimikatz", "ScreenshotName": "SentinelOne-APT29-6917.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"File Creation\" occurred containing evidence of file write of m.exe to System32 directory by WinRM.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - file creation, cli args, ", "ScreenshotName": "SentinelOne-APT29-12881.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file write event for m.exe in the System32 directory by \"Host process for WinRM plug-ins\". The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "D1 - m.exe being dropped to disk", "ScreenshotName": "SentinelOne-APT29-6918.png"}], "Score": 17}], "Step score": 122}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "8.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (high severity; red indicator) was generated for the malicious file create event of python.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "python.exe in temp - malicious file ", "ScreenshotName": "Elastic-APT29-1302.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a file create event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "python.exe in temp - malicious file ", "ScreenshotName": "Elastic-APT29-1302.png"}], "Score": 10}], "Step score": 45}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cExecutable copied to remote host via $ share\u201d was generated for python.exe being copied from Nashua to Scranton. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3008.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) called \"Remote File Copy\" was generated for python.exe being copied Scranton (10.0.1.4).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3010.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13222.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event of python.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [], "Score": 17}], "Step score": 224}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"File Write to Network Share\" was generated due to a file write event for python.exe to a remote network share.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "8.B.1 - File Write to Network Share for python.exe", "ScreenshotName": "FireEye-APT29-11170.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection called \"WebDav Network Request\" was generated due to a WebDav user-agent used to GET python.exe from a WebDav network share.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "8.B.1 - WebDav Network Request to GET python.exe", "ScreenshotName": "FireEye-APT29-11169.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for classifying python.exe as malware, which also showed it was written by PowerShell to a remote network share.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "8.B.1 - Malware detection for python.exe (bottom)", "ScreenshotName": "FireEye-APT29-11177.png"}, {"ScreenshotCaption": "8.B.1 - Malware detection for python.exe (top)", "ScreenshotName": "FireEye-APT29-11178.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection showed the file write event of python.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 8.B", "ScreenshotName": "FireEye-APT29-13006.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "8.B.1 - Triage view of PowerShell writing python.exe over a network share", "ScreenshotName": "FireEye-APT29-11172.png"}], "Score": 10}], "Step score": 245}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a suspicious file being written/accesses through the SMB protocol. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13439.png"}, {"ScreenshotName": "Bitdefender-APT29-13440.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (red indicator) for Antimalware was generated identifying the resource download as malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-752.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the HTTP GET request for python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-752.png"}], "Score": 10}], "Step score": 117}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed the file create event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1727.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection was generated identifying python.exe as malware. Detection incurred a delay due to file being uploaded for sandbox analysis.", "Detect": "General-Delayed (Processing)-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11967.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a file write event of python.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11973.png"}], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed a file write event of python.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing a PeFileWritten and NewExecutableWritten events on Scranton for python.exe.", "ScreenshotName": "CrowdStrike-APT29-10457.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed a file write event of python.exe. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "8.b.1 - copies of each other ^^", "ScreenshotName": "Cybereason-APT29-9635.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Remote File Copy\" was generated data being sent over SMB2 to Scranton (10.0.1.4) creating a .exe file.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "8b1 - technique remote file copy", "ScreenshotName": "Symantec-APT29-17664.png"}], "Score": 60}, {"DetectionNote": "A General alert detection for \"Malicious file detected python.exe\" was generated on sandbox detection evaluation of python.exe. Detection incurred a delay based on sandbox detonation processing.", "Detect": "General-Delayed (Processing)-Alert", "Screenshots": [{"ScreenshotCaption": "8b1-general delayed sandbox detonation", "ScreenshotName": "Symantec-APT29-17662.png"}], "Score": 35}], "Step score": 95}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 8b1", "ScreenshotName": "Kaspersky-APT29-18002.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence that python.exe was copied to remote host Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}, {"ScreenshotCaption": "MSSP - webdav stuff", "ScreenshotName": "F-Secure-APT29-11294.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file create event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "python.exe file create", "ScreenshotName": "F-Secure-APT29-10112.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection (suspicious severity) was generated for the file write event of python.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11965.png"}], "Score": 42}, {"DetectionNote": "A General detection was generated for python.exe being a potential virus or malware. ", "Detect": "General", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11968.png"}], "Score": 30}, {"DetectionNote": "Telemetry showed the file write event of python.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed the file create event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13999.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the filemod event for the creation of python.exe on the remote host Scranton (10.0.1.4). Telemetry also showed the file write from the local host. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4044.png"}, {"ScreenshotName": "Carbon Black-APT29-4042.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (orange indicator) for \"Remote Access\" was generated for the file copy of python.exe from host Nashua (10.0.1.6) to host Scranton (10.0.1.4).", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Remotely copying Python.exe from Nashua to Scranton", "ScreenshotName": "CyCraft-APT29-14872.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (yellow indicator) for \"File Creation\" for the file create event of python.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "File Creation event for python.exe. Enriched as Software Packing", "ScreenshotName": "CyCraft-APT29-14901.png"}], "Score": 35}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "A General alert detection (skull indicator) called \"hiddenShare.admin\" was generated due to the file creation of python.exe in an admin share.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11038.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed a file create event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11038.png"}, {"ScreenshotName": "GoSecure-APT29-11034.png"}, {"ScreenshotName": "GoSecure-APT29-11035.png"}], "Score": 10}], "Step score": 45}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Remote File Copy was generated due to the creation of python.exe. The event was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Technique-Correlated-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "file write of python", "ScreenshotName": "MalwareBytes-APT29-2537.png"}, {"ScreenshotCaption": "Alert view", "ScreenshotName": "MalwareBytes-APT29-9980.png"}], "Score": 65}], "Step score": 65}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the file write event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3622.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection for \"AdminShareAccess\" was generated when python.exe was written from host Nashua (10.0.1.6) to the ADMIN$ share on host Scranton (10.0.1.4), indicating Lateral Movement.  The detection was correlated to a parent grouping of malicious activity.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "A1 extra info - Shows access to the share", "ScreenshotName": "SentinelOne-APT29-6697.png"}], "Score": 52}, {"DetectionNote": "An MSSP detection for \"T1105\" occurred containing evidence of python.exe file creation. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - file write of python.exe", "ScreenshotName": "SentinelOne-APT29-12832.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event of python.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Unknown File creation (does show \"related to threat\" as false)", "ScreenshotName": "SentinelOne-APT29-6699.png"}], "Score": 10}], "Step score": 132}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "14.B.3": {"Elastic": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) for \"Suspicious Download Command via PowerShell\" was generated for the PowerShell command to download m.exe. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "suspicious download alert pulling down mimikatz", "ScreenshotName": "Elastic-APT29-13638.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "m file create event from powershell", "ScreenshotName": "Elastic-APT29-1450.png"}], "Score": 17}], "Step score": 59}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for an executable created by a Windows scripting engine. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13720.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13245.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe as well as the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13715.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3189.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell File Write\" was generated for PowerShell writing m.exe to disk.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.3 - PowerShell File Write for m.exe (top)", "ScreenshotName": "FireEye-APT29-11484.png"}, {"ScreenshotCaption": "14.B.3 - PowerShell File Write for m.exe (bottom)", "ScreenshotName": "FireEye-APT29-11485.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection called \"PowerShell URL Request\" was generated due to a URL request from PowerShell for m.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.3 - PowerShell URL Request for m.exe", "ScreenshotName": "FireEye-APT29-11473.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection was generated for suspicious PowerShell usage with encoded commands associated with download cradles.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.1 - PowerShell Encoded Remote Download (bottom)", "ScreenshotName": "FireEye-APT29-11463.png"}, {"ScreenshotCaption": "14.B.1 - PowerShell Encoded Remote Download (top)", "ScreenshotName": "FireEye-APT29-11462.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.B", "ScreenshotName": "FireEye-APT29-13035.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file write event for m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 275}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique detection was generated for a resource being downloaded via HTTP.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-896.png"}], "Score": 60}, {"DetectionNote": "A General alert detection (red indicator) was generated for powershell.exe writing a binary in a suspicious location. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-876.png"}, {"ScreenshotName": "Bitdefender-APT29-894.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed a HTTP GET request over port 8080 to download m.exe. Telemetry also showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-897.png"}, {"ScreenshotName": "Bitdefender-APT29-879.png"}], "Score": 17}], "Step score": 119}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1850.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file create event for m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-13860.png"}, {"ScreenshotName": "Cylance-APT29-12082.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "A General detection called \"NewExecutableWritten\" was generated was generated for the PowerShell command to download m.exe.", "Detect": "General", "Screenshots": [{"ScreenshotCaption": "14b3-new vendor screenshot", "ScreenshotName": "CrowdStrike-APT29-15003.png"}], "Score": 30}, {"DetectionNote": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert for Execution via Powershell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe with an executable write and a file written event for m.exe.", "ScreenshotName": "CrowdStrike-APT29-10634.png"}], "Score": 17}], "Step score": 47}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection (unique symbol) was generated for using PowerShell to execute suspicious 'download' commands. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "14.b.3 - alerts list, mimikatz", "ScreenshotName": "Cybereason-APT29-9742.png"}], "Score": 42}], "Step score": 42}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Remote File Copy\" was generated when powershell.exe generated network traffic immediately followed by creation of an executable file. The event was correlated to a previous event showing wmiprvse.exe executing powershell.exe.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "Shows sequence of network connection and file creation of m.exe", "ScreenshotName": "Symantec-APT29-9759.png"}, {"ScreenshotCaption": "Highlighted text indicates that Remote File Copy tag was due to network traffic immediately followed by file creation.", "ScreenshotName": "Symantec-APT29-9758.png"}, {"ScreenshotCaption": "Incident report showing events correlated to wmiprvse.exe executing powershell.exe", "ScreenshotName": "Symantec-APT29-12906.png"}], "Score": 67}, {"DetectionNote": "An MSSP detection for \"Remote File Copy\" was received that included a PowerShell command executed by the adversary and explained that it was used to download m.exe from a remote server.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: wmidump", "ScreenshotName": "Symantec-APT29-12962.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "reputation request and file creation event for m.exe, tagged with Remote File Copy", "ScreenshotName": "Symantec-APT29-9757.png"}, {"ScreenshotCaption": "Shows sequence of network connection and file creation of m.exe", "ScreenshotName": "Symantec-APT29-9759.png"}], "Score": 10}], "Step score": 147}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3227.png"}, {"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3225.png"}], "Score": 10}], "Step score": 10}, "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) was generated for a suspicious download by PowerShell.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "ip address and port 443 and HTTPS ", "ScreenshotName": "F-Secure-APT29-10250.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of the download and file write of m.exe into System32 folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Summary", "ScreenshotName": "F-Secure-APT29-13276.png"}, {"ScreenshotCaption": "MSSP - wc function - no context", "ScreenshotName": "F-Secure-APT29-11314.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for m.exe in the System32 folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "file create of m.exe", "ScreenshotName": "F-Secure-APT29-10346.png"}], "Score": 10}], "Step score": 145}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for \"Malicious content\" due to the HTTP download of m.exe. ", "Detect": "General-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12365.png"}], "Score": 28}, {"DetectionNote": "An MSSP detection occurred for PowerShell downloading m.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12100.png"}], "Score": 17}], "Step score": 115}, "ReaQta": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated for \"Executable Dropped,\" which showed the download and file write of m.exe into the System32 folder via PowerShell.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-181.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-511.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for .Net attempting suspicious network connections. The detection was correlated to a parent alert for Windows Management Instrumentation.\t", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4232.png"}], "Score": 42}, {"DetectionNote": "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.\t", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14756.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) was generated for PowerShell with network connections spawned by WMI. The detection was correlated to a parent alert for Windows Management Instrumentation.\t", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4237.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4242.png"}, {"ScreenshotName": "Carbon Black-APT29-4219.png"}], "Score": 17}], "Step score": 136}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (purple indicator) was generated identifying the PowerShell command to download m.exe as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: scriptblock for wmidump, 3,5.", "ScreenshotName": "CyCraft-APT29-2339.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (purple indicator) was generated showed the file write event for m.exe into the System32 folder.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "File Creation of m.exe with enrichments", "ScreenshotName": "CyCraft-APT29-2452.png"}, {"ScreenshotCaption": "CyCarrier Raw Data: File creation of m.exe", "ScreenshotName": "CyCraft-APT29-2342.png"}], "Score": 35}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12714.png"}, {"ScreenshotName": "GoSecure-APT29-12715.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder. The event was correlated to a parent detection on \"PowerShell with Encoded Command Launched.\"", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11399.png"}], "Score": 17}], "Step score": 87}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Reminder severity) called \"Suspicious Powershell Download\" was generated for the PowerShell command to download m.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3847.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"FileModification\" occurred containing evidence of file write and analysis of m.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - powershell, get-process, m.exe being dropped.", "ScreenshotName": "SentinelOne-APT29-12867.png"}, {"ScreenshotCaption": "MSSP - M.exe analysis", "ScreenshotName": "SentinelOne-APT29-12869.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "14.B.3 - File creation for m.exe", "ScreenshotName": "SentinelOne-APT29-17875.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of Powershell creating m.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13773.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe into the System32 folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7069.png"}], "Score": 10}], "Step score": 80}}, "3.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "maybe something with monkey.png obfuscated????", "ScreenshotName": "Elastic-APT29-1201.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Remote File Copy \"(T1105)\" occurred containing evidence that cod.3aka3.scr\u200b has downloaded and wrote a file named\u200b monkey.png\u200b to \u200bC:\\Users\\pam\\Downloads.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13195.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-17855.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection called \"User Directory File Write\" was generated due to the file monkey.png being written to the user's desktop.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 3.A.1 - User Directory File Write for monkey.png", "ScreenshotName": "FireEye-APT29-11729.png"}], "Score": 28}, {"DetectionNote": "An MSSP detection occurred containing evidence of rcs.3aka3.doc creating the monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 3.A", "ScreenshotName": "FireEye-APT29-12981.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "3.A.1 - rcs.3aka3.doc creating monkey.png", "ScreenshotName": "FireEye-APT29-10900.png"}], "Score": 10}], "Step score": 108}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-657.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1464.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11850.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc reading file monkey.png. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing a file read operation for the monkey.png by rcs.3aka3.doc.", "ScreenshotName": "CrowdStrike-APT29-10256.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "3.a.1 - monkey png again", "ScreenshotName": "Cybereason-APT29-7379.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png, with the file path reversed due to the Unicode right-to-left override character.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "File creation for monkey.png", "ScreenshotName": "Symantec-APT29-9907.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The event was correlated to a parent detection for masquerading. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "3.A.1", "ScreenshotName": "Kaspersky-APT29-2681.png"}], "Score": 17}], "Step score": 17}, "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (informational) was generated due to a suspicious download by PowerShell. The detection was correlated to a parent alert for Abnormal File Modification.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "process tree, powershell payload, sus download ", "ScreenshotName": "F-Secure-APT29-10016.png"}], "Score": 42}], "Step score": 42}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11861.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-47.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Defense Evasion occurred containing evidence of monkey.png being uploaded to Nashua.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-386.png"}], "Score": 70}], "Step score": 70}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3780.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of rcs.3aka3.doc creating the monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12705.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10829.png"}], "Score": 10}], "Step score": 80}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc writing monkey.png. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "creation of monkey.png", "ScreenshotName": "MalwareBytes-APT29-2398.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3474.png"}, {"ScreenshotName": "HanSight-APT29-3473.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1105\" occurred containing evidence of rcs.3aka3.doc creating monkey.png.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1/2 - File creation and stego", "ScreenshotName": "SentinelOne-APT29-12801.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating new file monkey.png. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A.1 -Process tree of money.png being created", "ScreenshotName": "SentinelOne-APT29-6500.png"}, {"ScreenshotCaption": "A.1 -  Detailed view of file being created", "ScreenshotName": "SentinelOne-APT29-6499.png"}, {"ScreenshotCaption": "A.1 - File creation of monkey.png", "ScreenshotName": "SentinelOne-APT29-6501.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "4.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "making sure i got the full file create details for sysinternals zip", "ScreenshotName": "Elastic-APT29-1213.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection was generated for the creation of a file identified as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14323.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14322.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for Remote File Copy \"(T1105)\" was received. The alert stated the privileged Powershell.exe created a zip file named SysInternalsSuite.zip in the Downloads folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13205.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2784.png"}], "Score": 17}], "Step score": 129}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection was generated for a ZIP archive being written to disk. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "4.A.1 - Zip Archive Created for SysinternalsSuite.zip (top)", "ScreenshotName": "FireEye-APT29-10943.png"}, {"ScreenshotCaption": "4.A.1 - Zip Archive Created for SysinternalsSuite.zip (bottom)", "ScreenshotName": "FireEye-APT29-10944.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of  file write of the ZIP by PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.A", "ScreenshotName": "FireEye-APT29-12987.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for a PowerShell process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.A.1 - Triage view of PowerShell creating SysinternalsSuite.zip", "ScreenshotName": "FireEye-APT29-11001.png"}], "Score": 17}], "Step score": 122}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-678.png"}], "Score": 17}], "Step score": 17}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1508.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11889.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing ZipFileWritten (file creation) for the zip file SysinternalsSuite.zip.", "ScreenshotName": "CrowdStrike-APT29-10291.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for malicious PowerShell.  ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "4.a.1 - we can see sysinternalsuite.zip in the file event from the process tree", "ScreenshotName": "Cybereason-APT29-9596.png"}, {"ScreenshotCaption": "4.a.1 - malicious high integrity powershell", "ScreenshotName": "Cybereason-APT29-9594.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Symantec-APT29-7416.png"}, {"ScreenshotCaption": "MITRE tagged file creation event for sysinternal.zip file", "ScreenshotName": "Symantec-APT29-7419.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the file write of the ZIP by PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Report Page 2 - Step 4", "ScreenshotName": "Kaspersky-APT29-11776.png"}, {"ScreenshotCaption": "MSSP Report Page 3 - Step 4", "ScreenshotName": "Kaspersky-APT29-11777.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for suspicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2729.png"}], "Score": 17}], "Step score": 87}, "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated for PowerShell downloading a significant amount of data using HTTP(S).", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "powershell downloaded a significiant amount of data using HTTPS - https based off of ", "ScreenshotName": "F-Secure-APT29-10036.png"}], "Score": 35}], "Step score": 35}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the file write of the ZIP by PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11872.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "A General detection alert (orange indicator) was generated for powershell.exe creating a compressed file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process. ", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-73.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-76.png"}], "Score": 17}], "Step score": 59}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-387.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for \"Sysinternals Tools Downloaded via Command Interpreter.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3885.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3890.png"}], "Score": 17}], "Step score": 89}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "A General detection was generated for \"File archive created\" due to PowerShell creating a compressed archive. The event is correlated to a parent alert on Bypass User Account Control.", "Detect": "General-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10875.png"}], "Score": 37}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The event is correlated to a parent alert on Bypass User Account Control.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10875.png"}], "Score": 17}], "Step score": 54}, "Malwarebytes": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated due to PowerShell creating a compressed archive.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "alert for data staged", "ScreenshotName": "MalwareBytes-APT29-2521.png"}], "Score": 28}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "File write of sysinternals", "ScreenshotName": "MalwareBytes-APT29-2522.png"}], "Score": 10}], "Step score": 38}, "HanSight": {"Detects": [{"DetectionNote": "A General alert detection (reminder severity) was generated for \"Data Compress Extension\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3504.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1105\" occurred containing evidence of the file write of the ZIP by PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1 - powershell.exe creating SysinternalsSuite.zip ", "ScreenshotName": "SentinelOne-APT29-12809.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A1 - Shows file creation of SysInternalsSuite without .zip", "ScreenshotName": "SentinelOne-APT29-6521.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of a remote file write of the ZIP by PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12595.png"}], "Score": 70}], "Step score": 70}}, "9.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed file created event for python.exe creating rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "rar.exe created ignore some of the ones above he moved fast ", "ScreenshotName": "Elastic-APT29-1324.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for python.exe writing rar.exe to C:\\Windows\\Temp. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3032.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred for python.exe creating rar.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13226.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file write event for python.exe creating rar.exe from a named pipe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13659.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13661.png"}], "Score": 17}], "Step score": 129}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection called \"Temp Directory PE Write\" was generated due to python.exe writing rar.exe to C:\\Windows\\Temp.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 9.A.1 - Temp Directory PE Write for Rar.exe", "ScreenshotName": "FireEye-APT29-11742.png"}], "Score": 28}, {"DetectionNote": "An MSSP detection occurred for python.exe creating rar.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.A", "ScreenshotName": "FireEye-APT29-13014.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file write event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9.A - python.exe file writes for Rar.exe and sdelete64.exe", "ScreenshotName": "FireEye-APT29-11206.png"}], "Score": 10}], "Step score": 108}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed an executable file write event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-770.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed a file created event for rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1751.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11999.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed an executable file write event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing python.exe writing Rar.exe and sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10487.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed a create file event for python.exe creating rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.a.1 and 2 rar.exe and sdeltee64 file vents", "ScreenshotName": "Cybereason-APT29-9650.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Remote File Copy - Suspicious N-Gram\" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9a1 - ngram + technique", "ScreenshotName": "Symantec-APT29-17864.png"}, {"ScreenshotCaption": "9a1 - ngram + technique", "ScreenshotName": "Symantec-APT29-17864.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "list of rar.exe creations and python.exe connected, with remote file copy", "ScreenshotName": "Symantec-APT29-7468.png"}], "Score": 10}], "Step score": 75}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of rar.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 9a1 - remote file copy", "ScreenshotName": "Kaspersky-APT29-18005.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9a1 - vendor better pic", "ScreenshotName": "Kaspersky-APT29-13798.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence that rar.exe was copied to remote host Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - pythong and rar", "ScreenshotName": "F-Secure-APT29-11297.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed FILE_CREATE event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip", "ScreenshotName": "F-Secure-APT29-10136.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe. The detection was correlated to a parent alert for service execution on python.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11993.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed an Executable Dropped event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-147.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence of python.exe uploading rar.exe. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1135.png"}, {"ScreenshotName": "Microsoft-APT29-1134.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed created file event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-628.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for rar.exe by python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4058.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe downloaded from 192.164.0.4 port 8443.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11066.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed a file create event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3650.png"}, {"ScreenshotName": "HanSight-APT29-3651.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"Python spawns PowerShell which then writes rar.exe and sdelete64.exe\" occurred containing evidence of file write events for rar.exe and sdelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1/2 - File writes", "ScreenshotName": "SentinelOne-APT29-12836.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file creation event for python.exe creating rar.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A1 - python processes creating rar.exe", "ScreenshotName": "SentinelOne-APT29-6738.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "9.A.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed File Created event for python.exe creating sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "sdelete created", "ScreenshotName": "Elastic-APT29-1325.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A MSSP detection occurred for python.exe creating sdelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13226.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed File Write/Create events for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3036.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A General alert detection called \"Temp Directory PE Write\" was generated due to python.exe writing sdelete64.exe to C:\\Windows\\Temp.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 9.A.2 - Temp Directory PE Write for sdelete64.exe", "ScreenshotName": "FireEye-APT29-11743.png"}], "Score": 28}, {"DetectionNote": "A MSSP detection occurred for python.exe creating sdelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.A", "ScreenshotName": "FireEye-APT29-13014.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed File Write event for python.exe creating sdelete64.exe", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9.A - python.exe file writes for Rar.exe and sdelete64.exe", "ScreenshotName": "FireEye-APT29-11206.png"}], "Score": 10}], "Step score": 108}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed Executable File Write event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-771.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed File Created event for sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1752.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed File Create event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11998.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed Executable File Write event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing python.exe writing Rar.exe and sdelete64.exe.", "ScreenshotName": "CrowdStrike-APT29-10487.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed a create file event for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.a.1 and 2 rar.exe and sdeltee64 file vents", "ScreenshotName": "Cybereason-APT29-9650.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection for \"Suspicious N-Gram\" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created sdelete64.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "9a2 - ngram + general", "ScreenshotName": "Symantec-APT29-17867.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed Created File event for python.exe connecting to 192.168.0.4 port 8443 and then immediately creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "python.exe created file sdelete.exe", "ScreenshotName": "Symantec-APT29-7471.png"}], "Score": 10}], "Step score": 45}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of sdelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 9a2 sdelete create", "ScreenshotName": "Kaspersky-APT29-18006.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file create event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "9.a.2 - python.exe creating sdelete64.exe", "ScreenshotName": "Kaspersky-APT29-2917.png"}], "Score": 10}], "Step score": 80}, "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence that sdelete.exe was copied to remote host Scranton (10.0.1.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14495.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed FILE_CREATE event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip", "ScreenshotName": "F-Secure-APT29-10136.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed File Create event for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for service execution on python.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11993.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed an Executable Dropped event for python.exe, connected to 192.168.0.4 port 8443, creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-145.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence of python.exe uploading sdelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1134.png"}, {"ScreenshotName": "Microsoft-APT29-1135.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Created File event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-439.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for sdelete64.exe by python.exe.  The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4058.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed File Create event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11070.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for python.exe creating sdelete64.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3648.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"Python spawns PowerShell which then writes Rar.exe and sdelete64.exe\" occurred containing evidence of file write events for rar.exe and sdelete64.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A1/2 - File writes", "ScreenshotName": "SentinelOne-APT29-12836.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed File Creation event for python.exe creating sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A2 - python processes creating sdelete64.exe", "ScreenshotName": "SentinelOne-APT29-6739.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Remote File Copy", "Steps count": 7, "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}]}, "T1122": {"Steps": {"3.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection (red label) for \"Registry Preparation of UAC Bypass\" was generated due to the addition of the DelegateExecute Registry Value. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Technique-Correlated-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "cc loosening rule logic to get the bypass uac enrichment and new alert. ", "ScreenshotName": "Elastic-APT29-1710.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "showing the registry modified of the delegateexecute", "ScreenshotName": "Elastic-APT29-1204.png"}], "Score": 17}], "Step score": 82}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection was generated identifying the Registry modification as a malware behavior threat. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13643.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13642.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred containing evidence of addition of DelegateExecute \u200bsubkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13196.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13197.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2767.png"}], "Score": 17}], "Step score": 129}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the addition of the DelegateExecute Registry Value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 3.B", "ScreenshotName": "FireEye-APT29-12984.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "3.B.1 - Addition of the DelegateExecute Registry Value", "ScreenshotName": "FireEye-APT29-10928.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecution Registry Value. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1056.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1476.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed a PowerShell command to add the DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12233.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the  registry modification adding the new delegrate execute value", "ScreenshotName": "CrowdStrike-APT29-10257.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"COM Hijacking (T1122)\" occurred containing evidence of the addition of the DelegateExecute Registry Value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - b1 - reg key", "ScreenshotName": "Cybereason-APT29-10777.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "3.b.1 - delegate execute registry entry (cc) ", "ScreenshotName": "Cybereason-APT29-9902.png"}], "Score": 3}], "Step score": 73}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe creating DelegateExecute registry key", "ScreenshotName": "Symantec-APT29-9910.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the addition of DelegateExecute value in the Registry.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 3b1 ", "ScreenshotName": "Kaspersky-APT29-17990.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry Value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14338.png"}, {"ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt1", "ScreenshotName": "F-Secure-APT29-11300.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a Registry write of the command subkey.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "shell open command reg write", "ScreenshotName": "F-Secure-APT29-10024.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection \"Noteworthy Behavior T1122\" was generated due to the addition of the DelegateExecute Registry Value. ", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12314.png"}], "Score": 53}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17559.png"}], "Score": 10}], "Step score": 63}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-58.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated due to a change in Registry value of command key.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-369.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for Defense Evasion was generated due to a Registry key being enabled to permit Component Object Model Hijacking.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-386.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-377.png"}], "Score": 10}], "Step score": 115}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection was generated for the Registry Modification of the command subkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12752.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the Registry modifications of the DelegateExecute \u200bRegistry value. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3795.png"}, {"ScreenshotName": "Carbon Black-APT29-3797.png"}, {"ScreenshotName": "Carbon Black-APT29-13937.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for the addition of the DelegateExecute Registry Value.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Registry edits ", "ScreenshotName": "CyCraft-APT29-2106.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Component Object Model Hijacking\" was received that included a PowerShell script and explained that it was used to modify a COM component to delegate execution.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "3.B.1 - COM Hijacking, New-Item", "ScreenshotName": "CyCraft-APT29-12435.png"}, {"ScreenshotCaption": "3.B.1 - COM Hijacking, Set-ItemProperty", "ScreenshotName": "CyCraft-APT29-12434.png"}, {"ScreenshotCaption": "3.B.1, 3.B.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12243.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection for Component Object Model Hijacking contained evidence of the DelegateExecute subkey added to the Registry.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12702.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11677.png"}], "Score": 10}], "Step score": 80}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3492.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1122\" occurred containing evidence of DelegateExecute subkey being added to the Registry.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - Registry additions", "ScreenshotName": "SentinelOne-APT29-12804.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B.1 - shows creation of new regkey, AND mention DelegateExecute", "ScreenshotName": "SentinelOne-APT29-6508.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of addition of DelegateExecute \u200bsubkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12593.png"}, {"ScreenshotName": "SecureWorks-APT29-12589.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell command to add DelegateExecute Registry Value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6623.png"}, {"ScreenshotName": "SecureWorks-APT29-6620.png"}, {"ScreenshotName": "SecureWorks-APT29-6622.png"}], "Score": 10}], "Step score": 80}}, "14.A.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "registry modify event", "ScreenshotName": "Elastic-APT29-1439.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the addition of DelegateExecute subkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13244.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3186.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3187.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": " An MSSP detection occurred for the addition of the DelegateExecute Registry value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.A", "ScreenshotName": "FireEye-APT29-13032.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "14.A.1 - Script block for bypass function (bottom), DelegateExecute value above Remote-Item highlight", "ScreenshotName": "FireEye-APT29-11455.png"}, {"ScreenshotCaption": "14.A.1 - Script block for bypass function (top)", "ScreenshotName": "FireEye-APT29-11452.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Tactic alert detection (red indicator) was generated for the setting of a Registry key used by User Account Control (UAC). The alert was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Tactic-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-852.png"}, {"ScreenshotName": "Bitdefender-APT29-845.png"}], "Score": 52}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. The telemetry was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-844.png"}], "Score": 17}], "Step score": 69}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1847.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell script block to add the DelegateExecute subkey into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12077.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe calling the bypass function.", "ScreenshotName": "CrowdStrike-APT29-10619.png"}, {"ScreenshotCaption": "Telemetry showing the powershell script block for the bypass function.", "ScreenshotName": "CrowdStrike-APT29-10627.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. ", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "powershell.exe set DelegateExecute registry value", "ScreenshotName": "Symantec-APT29-9870.png"}], "Score": 10}], "Step score": 10}, "Kaspersky": {"Detects": [{"DetectionNote": "A MSSP detection occurred containing evidence for a well-known UAC bypass technique. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.a.1-3 MSSP report", "ScreenshotName": "Kaspersky-APT29-12397.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of executed function \"bypass.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}, {"ScreenshotCaption": "MSSP - raw function", "ScreenshotName": "F-Secure-APT29-11313.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a Registry command to add a new value, DelegateExecute. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "function bypass", "ScreenshotName": "F-Secure-APT29-10309.png"}, {"ScreenshotCaption": "delegateexecute and sdclt and open command", "ScreenshotName": "F-Secure-APT29-10311.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the addition of the DelegateExecute subkey to enable COM hijacking. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12091.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-177.png"}, {"ScreenshotName": "ReaQta-APT29-178.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated due to a change in Registry value of command key.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-500.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-501.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry value.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12767.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4207.png"}, {"ScreenshotName": "Carbon Black-APT29-13960.png"}, {"ScreenshotName": "Carbon Black-APT29-4206.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe loading code that creates the DelegateExecute Registry key. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Addition of DelegateExecute registry key through powershell scriptblok logging with enrichments", "ScreenshotName": "CyCraft-APT29-2446.png"}, {"ScreenshotCaption": "CyCarrier Raw Data: setting DelegateExecute key", "ScreenshotName": "CyCraft-APT29-2319.png"}], "Score": 35}], "Step score": 35}, "GoSecure": {"Detects": [{"DetectionNote": "A Tactic alert detection (green indicator) called \"T1088: User Account Control Bypass (\\Folder\\shell\\open\\command registry key)\" was generated for the setting of a Registry key used by User Account Control (UAC).", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11392.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11392.png"}], "Score": 10}], "Step score": 55}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3813.png"}, {"ScreenshotName": "HanSight-APT29-3785.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1122\" occurred containing evidence of \"bypass\" function definition with Software\\classes\\folder Registry key being modified and leveraged in COM hijacking.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - HI PowerShell, SBL", "ScreenshotName": "SentinelOne-APT29-12863.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell function definition of \"bypass\" which adds the DelegateExecute subkey. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A1/3 - Powershell alert of bypass function containing add and delete", "ScreenshotName": "SentinelOne-APT29-7254.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the addition of DelegateExecute subkey.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12651.png"}, {"ScreenshotName": "SecureWorks-APT29-12650.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute subkey.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7056.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Component Object Model Hijacking", "Steps count": 2, "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}]}, "T1002": {"Steps": {"9.B.7": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"T1002 Data Compressed\" was generated when rar.exe used \"-hp\" command-line arguments. This event was correlated to a General detection for the execution of a malicious file (python.exe).", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "another working.zip file file create with enrichments for data compressed, data encrypted", "ScreenshotName": "Elastic-APT29-1335.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a General detection for the execution of a malicious file (python.exe).", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "encrypted rar command line args tele", "ScreenshotName": "Elastic-APT29-1332.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Scripting engine creates compressed file under suspicious folder\" was generated when rar.exe was used to create an compressed zip archive in %APPDATA%. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3051.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13229.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3050.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Rar Execution\" \"T1002\" was generated when powershell.exe executed rar.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.B.7 - Rar used to compress data", "ScreenshotName": "FireEye-APT29-11212.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 9.B", "ScreenshotName": "FireEye-APT29-13017.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Data Compressed T1002\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-776.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-774.png"}], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1764.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (low severity) called \"One-Liner ML Module\" was generated when machine learning determined the command was suspicious.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12006.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12007.png"}], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (purple indicator) called \"Data Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection showing powershell.exe creating the zip file using Rar.exe.", "ScreenshotName": "CrowdStrike-APT29-10493.png"}, {"ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments.", "ScreenshotName": "CrowdStrike-APT29-10491.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments.", "ScreenshotName": "CrowdStrike-APT29-10491.png"}, {"ScreenshotCaption": "9.b.5/6/7 rar creating the rar file and being spawn from powershell in the activity app", "ScreenshotName": "CrowdStrike-APT29-10492.png"}], "Score": 17}], "Step score": 82}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "9.b.6 / 7 powershell executing rar.exe in process tree", "ScreenshotName": "Cybereason-APT29-9655.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for Data Compressed was generated when rar.exe created working.zip.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "powershell.exe executing rar.exe with arguments", "ScreenshotName": "Symantec-APT29-7479.png"}], "Score": 60}, {"DetectionNote": "A MSSP detection for \"Data Staged\" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress compress data into working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: PowerShell Collection (2)", "ScreenshotName": "Symantec-APT29-12945.png"}, {"ScreenshotCaption": "MSSP Day 1: PowerShell Collection (1)", "ScreenshotName": "Symantec-APT29-12946.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell.exe executing rar.exe with arguments", "ScreenshotName": "Symantec-APT29-7479.png"}], "Score": 10}], "Step score": 140}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (green; low severity) called \"T1002_Data_Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "9.b.5-7 - rar compressing files and encrypting with password", "ScreenshotName": "Kaspersky-APT29-2931.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 9b6 and 7", "ScreenshotName": "Kaspersky-APT29-18008.png"}], "Score": 70}], "Step score": 135}, "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - raw command - childitem", "ScreenshotName": "F-Secure-APT29-11293.png"}, {"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14494.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "process tree showing python spawning powershell", "ScreenshotName": "F-Secure-APT29-10138.png"}, {"ScreenshotCaption": "rar.exe with command line arguments", "ScreenshotName": "F-Secure-APT29-10139.png"}], "Score": 17}], "Step score": 87}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for Data Compressed generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12685.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe. The detection was correlated to a parent alert for service execution on python.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12004.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Data Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-148.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for suspicious activity was generated containing evidence rar.exe compressed files into working.zip", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1134.png"}, {"ScreenshotName": "Microsoft-APT29-1135.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-446.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated due to powershell.exe executing rar.exe creating a filemod event for working.zip.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4070.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13948.png"}, {"ScreenshotName": "Carbon Black-APT29-4060.png"}], "Score": 17}], "Step score": 82}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"T1002 Data Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.  The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Executing rar.exe from powershell with enrichments", "ScreenshotName": "CyCraft-APT29-2262.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"Data Compressed\" was received that showed execution of rar.exe by powershell.exe and explained that it was used to compress data for exfiltration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "9.B.5 - MDR Report Day 1, execution of rar.exe", "ScreenshotName": "CyCraft-APT29-12461.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called \"T1002 Data Compressed\" was generated when rar.exe created working.zip.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11082.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to parent alert on New Windows Service Created.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11083.png"}], "Score": 17}], "Step score": 77}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (reminder severity) called \"Data Compress Extension\" \"T1002\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. ", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4140.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3664.png"}], "Score": 10}], "Step score": 68}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Compression\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "9.B.7 - Data Compressed into Desktop\\working.zip", "ScreenshotName": "SentinelOne-APT29-14735.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1002\" occurred containing evidence of powershell.exe executing rar.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B5/6 - file creation event", "ScreenshotName": "SentinelOne-APT29-12839.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B6/7 - powershell executing rar.exe", "ScreenshotName": "SentinelOne-APT29-6744.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique detection alert (medium severity) called \"Suspicious RAR Archive Command 8 Data Compressed (T1002)\u200b\u200b\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6884.png"}, {"ScreenshotName": "SecureWorks-APT29-6882.png"}, {"ScreenshotName": "SecureWorks-APT29-6883.png"}, {"ScreenshotName": "SecureWorks-APT29-6885.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}}, "7.B.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for malicious file execution.\t", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "file create for officesupplies.7z", "ScreenshotName": "Elastic-APT29-1280.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious location\" was generated for the file creation event of a .7z file in %APPDATA%. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2976.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13219.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2975.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"7-Zip Archive Created\" was generated due a 7-Zip file being written to disk.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "7.B.2 - 7-Zip Archive Created for OfficeSupplies.7z", "ScreenshotName": "FireEye-APT29-11129.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 7.B", "ScreenshotName": "FireEye-APT29-13002.png"}, {"ScreenshotCaption": "MSSP - 7.B", "ScreenshotName": "FireEye-APT29-13001.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z. This detection was correlated to a parent alert on the parent PowerShell process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "7.B.2 - Triage view for file creation of OfficeSupplies.7z", "ScreenshotName": "FireEye-APT29-11138.png"}], "Score": 17}], "Step score": 152}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection for Data Compressed was generated due to PowerShell loading a module capable of zipping files.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1129.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-739.png"}], "Score": 17}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1690.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12253.png"}], "Score": 10}], "Step score": 10}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "7zip compress and file open (7zipfilewritten)", "ScreenshotName": "CrowdStrike-APT29-10432.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "7.b.2 - office supplies.7z information from events", "ScreenshotName": "Cybereason-APT29-9623.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Data Compressed\" was generated when powershell.exe created OfficeSupplies.7z.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "temporary zip created, 7ZIP installation", "ScreenshotName": "Symantec-APT29-7447.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for \"Data Compressed\" containing evidence of Invoke-Exfil function using 7-zip with password \"lolol\" to compressed downloads directory into OfficeSupplies.7z.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - data compression", "ScreenshotName": "Symantec-APT29-17645.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of OfficeSupplies.7z.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "temporary zip created, 7ZIP installation", "ScreenshotName": "Symantec-APT29-7447.png"}], "Score": 10}], "Step score": 140}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.", "Detect": "MSSP", "Screenshots": [{"ScreenshotCaption": "new mssp 7b2", "ScreenshotName": "Kaspersky-APT29-18000.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z. The detection was correlated to a parent alert for suspicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "7.b.2 - officesupplies.7z file created", "ScreenshotName": "Kaspersky-APT29-2861.png"}], "Score": 17}], "Step score": 87}, "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the OfficeSupplies.7z file create. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12680.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11940.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-127.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-409.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the file creation event for OfficeSupplies.7z. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4028.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection for Data Compressed was generated due to the file creation event for OfficeSupplies.7z. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10997.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed the file creation event for OfficeSupplies.7z. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10997.png"}], "Score": 10}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Creation of 7z (7b2)", "ScreenshotName": "MalwareBytes-APT29-2553.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (reminder severity) called \"Data Compress Extension\" was generated due to creation of a compressed file.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4137.png"}], "Score": 58}], "Step score": 58}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"exfiltrate\" occurred containing evidence of OfficeSupplies.7z being created.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation", "ScreenshotName": "SentinelOne-APT29-12828.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B2 - Powershell file creation of OfficeSupplies.7z", "ScreenshotName": "SentinelOne-APT29-6670.png"}], "Score": 17}], "Step score": 87}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "17.C.1": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "zipfilename powershell script block event", "ScreenshotName": "Elastic-APT29-1568.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection for Data Staged was generated when the WindowsParentalControlMigration.tmp file was compressed.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3303.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3305.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of data compression.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13259.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-17857.png"}], "Score": 17}], "Step score": 122}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Zip Archive Created\" was generated due to the creation of the ZIP archive WindowsParentalControlMigration.tmp on disk.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "17.C.1 - Zip Archive Creation (bottom)", "ScreenshotName": "FireEye-APT29-11591.png"}, {"ScreenshotCaption": "17.C.1 - Zip Archive Creation (top)", "ScreenshotName": "FireEye-APT29-11590.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of data compression.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 17.C", "ScreenshotName": "FireEye-APT29-13046.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "17.C.1 - Script block for the \"zip\" function", "ScreenshotName": "FireEye-APT29-11602.png"}], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for Powershell creating a compressed archive.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13445.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1108.png"}], "Score": 3}], "Step score": 61}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1885.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"GUARD: Common File Archive Exfiltration Staging\"  was generated due to the zip archive creation.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12151.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Data Theft and Exfiltration\" occurred containing evidence of zip archive creation.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12928.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method and the subsequent ZipFileWritten event. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing ZipFileWritten event for powershell on WindowsParentalControlMigration. Telemetry showing PowerShell prepending the GIF file header to the compressed file.", "ScreenshotName": "CrowdStrike-APT29-10701.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A MSSP detection for Data Compressed occurred containing evidence of PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - function zip - c1", "ScreenshotName": "Cybereason-APT29-10807.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of commands used to copy and compress data.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: zip function", "ScreenshotName": "Symantec-APT29-12972.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred contained evidence of data compression.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "17.c.1 - MSSP report", "ScreenshotName": "Kaspersky-APT29-12412.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Compressed a staging directory using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell compressing WindowsParentalControlMigration.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}, {"ScreenshotCaption": "MSSP - move to B- copy-item", "ScreenshotName": "F-Secure-APT29-11320.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "set-content", "ScreenshotName": "F-Secure-APT29-10453.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of data compression.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell loading a DLL associated with compression and the subsequent creation of the tmp folder (identified as a ZIP).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17565.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-333.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-540.png"}, {"ScreenshotName": "Microsoft-APT29-541.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell compressed a staging directory.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4331.png"}, {"ScreenshotName": "Carbon Black-APT29-4326.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell script which included compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "CyCarrier Raw Data: PowerShell execution of zip command", "ScreenshotName": "CyCraft-APT29-2386.png"}, {"ScreenshotCaption": "zip scriptblock log with enrichments", "ScreenshotName": "CyCraft-APT29-2481.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of data compression.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "17.B.1 - MDR Report Day 2,staging obfsucation and collection", "ScreenshotName": "CyCraft-APT29-12516.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3937.png"}, {"ScreenshotName": "HanSight-APT29-3937.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Data Compressed\" was generated due to an entropy calculation of WindowsParentalControlMigration.tmp. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "C1 - Alert showing file is compressed", "ScreenshotName": "SentinelOne-APT29-6950.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1002\" occurred containing evidence of \"zip\" function compressing collection via ZipFile.CreateFromDirectory .NET method.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - alert, SBL", "ScreenshotName": "SentinelOne-APT29-12885.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - C2 - powershell alert showing zip function definition ", "ScreenshotName": "SentinelOne-APT29-7273.png"}], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell compressing collection.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13787.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7152.png"}, {"ScreenshotName": "SecureWorks-APT29-7153.png"}], "Score": 10}], "Step score": 80}}, "2.A.4": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection for \"Data Compressed\" was generated for powershell.exe compressing via Compress-Archive. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "data compressed  enrichment, showing the childitem - since it stemed  off the malicious file execution and enrichments, correlated to that", "ScreenshotName": "Elastic-APT29-1195.png"}], "Score": 67}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "data compressed  enrichment, showing the childitem - since it stemed  off the malicious file execution and enrichments, correlated to that", "ScreenshotName": "Elastic-APT29-1195.png"}], "Score": 17}], "Step score": 84}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious folder\" was generated due identifying Draft.zip as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2674.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for Data Compressed \"(T1002)\" occurred containing evidence that the files \"C:\\Users\\pam\\Links\\Downloads.lnk, C:\\Users\\pam\\Links\\Desktop.lnk, C:\\Users\\pam\\Favorites\\Bing.url, and C:\\Users\\pam\\Desktop\\Microsoft Edge.lnk\" were compressed into a zip file draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13640.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"ZIP Archive Created - T1002\" was generated due to Draft.zip being identified as compressed.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "2.A.5 - ZIP Archive Created for Draft.zip (bottom)", "ScreenshotName": "FireEye-APT29-10871.png"}, {"ScreenshotCaption": "2.A.5 - ZIP Archive Created for Draft.zip (top)", "ScreenshotName": "FireEye-APT29-10870.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for powershell.exe compressing via Compress-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 2.A", "ScreenshotName": "FireEye-APT29-12979.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "2.A.4 - PowerShell executing Compress-Archive in script block", "ScreenshotName": "FireEye-APT29-10884.png"}], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) was generated for PowerShell being used to created a compressed archive. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Alert-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13420.png"}, {"ScreenshotName": "Bitdefender-APT29-13419.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1118.png"}], "Score": 3}], "Step score": 68}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_Data_Compressed_ART_MITRET1002\"  was generated due to PowerShell payload containing \"Compress-Archive\" and \"-DestinationPath\".", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11837.png"}, {"ScreenshotName": "Cylance-APT29-11834.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-Archive. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe compressing via Compress-Archive.", "ScreenshotName": "CrowdStrike-APT29-10216.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of powershell.exe compressing via Compress-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a5 (draft.zip create)", "ScreenshotName": "Cybereason-APT29-10772.png"}, {"ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)", "ScreenshotName": "Cybereason-APT29-10773.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Data Compressed\" was generated when Draft.zip was identified as compressed. The event was correlated to a parent detection cod.3aka.scr as a malicious file.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection + correlation", "ScreenshotName": "Symantec-APT29-17539.png"}], "Score": 67}, {"DetectionNote": "An MSSP detection for \"Data Compressed \"was received that included an explanation of the PowerShell script used to compress files and store the results in Draft.zip.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "Powershell Scriptblock log for all commands used in 2.A. Human generated mappings based on the evidence included in the report.", "ScreenshotName": "Symantec-APT29-9903.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]", "ScreenshotName": "Symantec-APT29-9905.png"}], "Score": 10}], "Step score": 147}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (green indicator; low severity) called Data Compressed was generated due to the creation of Draft.Zip by powershell.exe.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "2.a.5 - CC ps creates Draft.Zip - details", "ScreenshotName": "Kaspersky-APT29-3419.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection contained evidence of draft.zip being created and compressed by PowerShell. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-17988.png"}], "Score": 70}], "Step score": 128}, "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of the Compress-Archive cmdlet being executed.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - get-childitem and compress archive scriptblock", "ScreenshotName": "F-Secure-APT29-11254.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Draft.Zip at the end of the CommandStart", "ScreenshotName": "F-Secure-APT29-10009.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred showing evidence of powershell.exe compressing via Compress-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14011.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11846.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-233.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery occurred containing evidence that PowerShell ran commands to query files with certain extensions and compress the found files into a zip file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17383.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-367.png"}, {"ScreenshotName": "Microsoft-APT29-363.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated for a file modification with the .zip extension. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3776.png"}, {"ScreenshotName": "Carbon Black-APT29-3779.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3759.png"}, {"ScreenshotName": "Carbon Black-APT29-3751.png"}], "Score": 17}], "Step score": 89}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (purple indicator) was generated for powershell.exe executing Compress-Archive. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Compress Archive for Data Compressed", "ScreenshotName": "CyCraft-APT29-2205.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Data Compressed\" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6) and then archive them as DRAFT.ZIP.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.B.2 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-12220.png"}], "Score": 70}], "Step score": 112}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of powershell.exe compressing via Compress-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12745.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell creating a compressed archive. The event was correlated to a parent Technique detection for Masquerading on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "alert for data staged (2a5)", "ScreenshotName": "MalwareBytes-APT29-2392.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (reminder severity) called \"Data Compress via PowerShell\" was generated due to powershell.exe compressing via Compress-Archive.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3459.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Data Compressed. MITRE Exfiltration {T1002}\" was generated on powershell.exe compressing via Compress-Archive. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "A.4 - Shows that data compression has occurred", "ScreenshotName": "SentinelOne-APT29-6486.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred for powershell.exe compressing via Compress-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 2.A.4", "ScreenshotName": "SentinelOne-APT29-14545.png"}, {"ScreenshotCaption": "MSSP - 2.A.4", "ScreenshotName": "SentinelOne-APT29-14544.png"}, {"ScreenshotCaption": "MSSP - 2.A.4", "ScreenshotName": "SentinelOne-APT29-14546.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "2.A.4 - Script block", "ScreenshotName": "SentinelOne-APT29-14542.png"}, {"ScreenshotCaption": "2.A.4 - Script block expanded", "ScreenshotName": "SentinelOne-APT29-14543.png"}], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred showing evidence of powershell.exe compressing via Compress-Archive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13734.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6534.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Data Compressed", "Steps count": 4, "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}]}, "T1003": {"Steps": {"16.D.2": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Process Injection\" was generated for the injection into lsass.exe. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\".", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "process injection alert related to cred dump", "ScreenshotName": "Elastic-APT29-1532.png"}, {"ScreenshotCaption": "target of process injection  with timstomping alert", "ScreenshotName": "Elastic-APT29-13700.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for the \"First Seen Process in an Environment\".", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "and now with cmdline", "ScreenshotName": "Elastic-APT29-1534.png"}], "Score": 72}], "Step score": 144}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3282.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated for m.exe reading lsass.exe process memory.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3272.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3273.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3271.png"}], "Score": 65}, {"DetectionNote": "A General alert detection called \"heuristic.b.mimikatz_lsadump_inject\" was generated for possible Mimikatz activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3285.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) was generated for a rare child process spawned from wsmprovhost.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3282.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13258.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed m.exe injecting a thread into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3283.png"}], "Score": 10}], "Step score": 280}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)\" was generated due to command line arguments indicating the use of Mimikatz.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "16.D.2 - Mimikatz detection via process arguments", "ScreenshotName": "FireEye-APT29-11562.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection called \"Vaultcli.dll Load\" was generated due to a non-standard process, m.exe, loading a Windows credential management library (vaultcli.dll).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "16.D.2 - m.exe loading vaultcli.dll (bottom)", "ScreenshotName": "FireEye-APT29-11564.png"}, {"ScreenshotCaption": "16.D.2 - m.exe loading vaultcli.dll (top)", "ScreenshotName": "FireEye-APT29-11563.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for m.exe being identified as Mimikatz malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "16.D.2 - Mimikatz malware alert, with signature information (bottom)", "ScreenshotName": "FireEye-APT29-11568.png"}, {"ScreenshotCaption": "16.D.2 - Mimikatz malware alert (top)", "ScreenshotName": "FireEye-APT29-11567.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for Mimikatz usage to dump credentials for the krbtgt account.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 16.D", "ScreenshotName": "FireEye-APT29-13042.png"}], "Score": 70}], "Step score": 235}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called  \"ReadProcessMemoryCritical\" was generated for m.exe reading memory from a critical process. The alert was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-946.png"}, {"ScreenshotName": "Bitdefender-APT29-932.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection was generated for injection into the lsass.exe process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-956.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) was generated for a m.exe (Mimikatz) loading a credentials-related DLL (samlib.dll), identified as a possible attempt to dump credentials. The detection was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-944.png"}, {"ScreenshotName": "Bitdefender-APT29-932.png"}], "Score": 42}, {"DetectionNote": "A General alert detection (red indicator) was generated for injection into a critical system process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-961.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) was generated identifying m.exe as the Mimikatz malware. The detection was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13444.png"}], "Score": 42}], "Step score": 256}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Credential Dumping\" was generated due to the Suspicious Indicator \"LSASS process memory read by other process.\" ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1873.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (yellow indicator) called \"Credential Access\" was generated for m.exe injecting code into a foreign process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1875.png"}], "Score": 35}], "Step score": 100}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"GUARD: Possible Mimikatz\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12139.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated identifying an exploit attempt when m.exe attempted to create a remote thread.\t\n", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12141.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Data Theft and Exfiltration\" occurred containing evidence of \"lsadump\" with command-line arguments identified as Possible Mimikatz usage.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12926.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed m.exe injecting a thread into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12142.png"}], "Score": 10}], "Step score": 180}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when a remote thread was written to LSASS memory by m.exe (mimikatz).", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for a thread injecting into LSASS from a signed executable with untrusted root authority. A Technique detection called \u201cCredential Dumping\u201d for a remote thread was being written to LSASS memory by m.exe (mimikatz).", "ScreenshotName": "CrowdStrike-APT29-10687.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when a thread was injected into LSASS from a signed executable with untrusted root authority.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for a thread injecting into LSASS from a signed executable with untrusted root authority. A Technique detection called \u201cCredential Dumping\u201d for a remote thread was being written to LSASS memory by m.exe (mimikatz).", "ScreenshotName": "CrowdStrike-APT29-10687.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe allocated executable memory inside of LSASS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe accessing LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for m.exe injecting code into the LSASS process. A Technique detection called \u201cCredential Dumping\u201d for m.exe allocating executable memory inside of LSASS.", "ScreenshotName": "CrowdStrike-APT29-10686.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe injected code into the LSASS process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe accessing LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for m.exe injecting code into the LSASS process. A Technique detection called \u201cCredential Dumping\u201d for m.exe allocating executable memory inside of LSASS.", "ScreenshotName": "CrowdStrike-APT29-10686.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection  (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe (mimikatz) accessed LSASS memory.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe accessing LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for m.exe injecting code into the LSASS process. A Technique detection called \u201cCredential Dumping\u201d for m.exe allocating executable memory inside of LSASS.", "ScreenshotName": "CrowdStrike-APT29-10686.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe read LSASS memory.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) read LSASS process memory. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files. A Technique detection called \u201cCredential Dumping\u201d for a signed executable with untrusted root authority accessing LSASS.", "ScreenshotName": "CrowdStrike-APT29-10685.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated identifying m.exe as Mimikatz.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe (mimikatz) was launching.", "ScreenshotName": "CrowdStrike-APT29-10688.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (orange indicator) called \u201cMachine Learning via Sensor-based ML\u201d was generated when m.exe met machine learning-based on-sensor AV protection\u2019s high confidence threshold for malicious files.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) read LSASS process memory. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files. A Technique detection called \u201cCredential Dumping\u201d for a signed executable with untrusted root authority accessing LSASS.", "ScreenshotName": "CrowdStrike-APT29-10685.png"}], "Score": 35}], "Step score": 460}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red, unique symbol) called Credential Theft was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "16.d.2 - command line with the lsadump injection from the process details", "ScreenshotName": "Cybereason-APT29-9794.png"}, {"ScreenshotCaption": "16.d.2 - suspicion highlighted", "ScreenshotName": "Cybereason-APT29-9795.png"}], "Score": 65}], "Step score": 65}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated for a suspicious injection into LSASS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe", "ScreenshotName": "Symantec-APT29-9775.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when a suspicious process loaded a cryptographic DLL and accessed LSASS memory.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe", "ScreenshotName": "Symantec-APT29-9775.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when a suspicious process opened LSASS and wrote to a file.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe", "ScreenshotName": "Symantec-APT29-9775.png"}], "Score": 65}, {"DetectionNote": "A Technique detection for \"Credential Dumping\" was generated when m.exe injected into lsass.exe.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "Incident Report for Credential Dumping, including execution of m.exe. Done from HI  powershell.exe process", "ScreenshotName": "Symantec-APT29-9735.png"}, {"ScreenshotCaption": "m.exe injected into lsass.exe, tagged with Credential Dumping", "ScreenshotName": "Symantec-APT29-9787.png"}], "Score": 60}, {"DetectionNote": "A General alert detection for \"Process Injection\" was generated on \"Untrusted process attempted to open a thread in a Microsoft process\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "16d2 - general + correlation -  suspected mimikatz credential theft", "ScreenshotName": "Symantec-APT29-17724.png"}], "Score": 35}, {"DetectionNote": "A General detection was generated for a \"Suspected Mimikatz credential theft activity\". The event was correlated to a parent General detection on m.exe.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "16d2 - general + correlation -  suspected mimikatz credential theft", "ScreenshotName": "Symantec-APT29-17724.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute mimikatz to retrieve the krbtgt hash from host NewYork (10.0.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: remote mimikatz copy techniques", "ScreenshotName": "Symantec-APT29-12969.png"}, {"ScreenshotCaption": "MSSP Day 1: remote mimikatz copy description", "ScreenshotName": "Symantec-APT29-12970.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed m.exe injecting into lsass.exe", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe", "ScreenshotName": "Symantec-APT29-9775.png"}], "Score": 10}], "Step score": 412}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red; high severity) for Credential Dumping was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "16.d.2 - both detections based on command pattern", "ScreenshotName": "Kaspersky-APT29-3265.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.d.1-2 MSSP report", "ScreenshotName": "Kaspersky-APT29-12409.png"}], "Score": 70}], "Step score": 135}, "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for Credential Dumping was generated due to a known password dumper being executed. This event was correlated to a parent detection for privilege escalation.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "more mimi process tree", "ScreenshotName": "F-Secure-APT29-10438.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated due to lsass memory dump. This detection was correlated to a parent detection for privilege escalation.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "best mimikatz view lsass stuff too", "ScreenshotName": "F-Secure-APT29-10441.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated due to Mimikatz command-line parameters being executed. This event was correlated to a parent detection for privilege escalation.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "best mimikatz view lsass stuff too", "ScreenshotName": "F-Secure-APT29-10441.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of Mimikatz dumping the KRBTGT hash.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}, {"ScreenshotCaption": "MSSP - copy item", "ScreenshotName": "F-Secure-APT29-11318.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed m.exe injecting a thread into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "threat injection lsass", "ScreenshotName": "F-Secure-APT29-10435.png"}], "Score": 10}], "Step score": 296}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Credential Dumping\" was generated due to LSASS having a suspicious process access mask. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12150.png"}, {"ScreenshotName": "TrendMicro-APT29-12149.png"}], "Score": 60}], "Step score": 60}, "ReaQta": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated for m.exe injecting into a process.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-196.png"}], "Score": 35}], "Step score": 35}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for Credential Dumping  was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-535.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (medium severity) for Credential Dumping was generated due to suspected credential theft activity.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-534.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed m.exe opening lsass.exe with OpenProcess.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17884.png"}], "Score": 10}], "Step score": 140}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13962.png"}], "Score": 65}, {"DetectionNote": "A General detection was generated for process injection by m.exe. The detection was correlated to a parent alert for a code drop of m.exe.", "Detect": "General-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4274.png"}], "Score": 37}, {"DetectionNote": "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for a code drop of m.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4271.png"}], "Score": 17}], "Step score": 119}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Execution of m.exe on NEWYORK", "ScreenshotName": "CyCraft-APT29-2475.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (yellow indicator) was generated identifying m.exe as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Threat Activity alery for execution of m.exe on NEWYORK", "ScreenshotName": "CyCraft-APT29-2474.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that described the adversary remotely executing m.exe to dump the krbtgt hash.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "16.D.1 - MDR Report Day 2, invoke-command & lsass access", "ScreenshotName": "CyCraft-APT29-12513.png"}, {"ScreenshotCaption": "16.D.1 - MDR Report Day 2, execution & behavior of m.exe", "ScreenshotName": "CyCraft-APT29-12514.png"}, {"ScreenshotCaption": "16.A.1 - MDR Report Day 2, summary & Get-NetDomainController", "ScreenshotName": "CyCraft-APT29-12506.png"}], "Score": 70}], "Step score": 170}, "GoSecure": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) called \"Malicious File Executed\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11430.png"}], "Score": 35}, {"DetectionNote": "A General alert detection (red indicator) called \"Remote Process Compromise\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11432.png"}], "Score": 35}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for credential dumping was generated for m.exe  executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Credential dumping alert 1", "ScreenshotName": "MalwareBytes-APT29-2579.png"}, {"ScreenshotCaption": "Credential dumping alert 2", "ScreenshotName": "MalwareBytes-APT29-2580.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Warning severity) called \"Credential Dumping via lsass access\" was generated due to m.exe accessing to lsass.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3925.png"}, {"ScreenshotName": "HanSight-APT29-3927.png"}], "Score": 65}], "Step score": 65}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "D2 - Sensitive memory access alert or LSASS", "ScreenshotName": "SentinelOne-APT29-6922.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"SensitiveMemoryAccess\" occurred containing evidence of mimikatz lsadump::lsa /inject /name:krbtgt via m.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - SensitiveMemoryAccess", "ScreenshotName": "SentinelOne-APT29-12882.png"}, {"ScreenshotCaption": "MSSP - file creation, cli args, ", "ScreenshotName": "SentinelOne-APT29-12881.png"}], "Score": 70}, {"DetectionNote": "Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "16.D.2 - RemoteInjection into LSASS", "ScreenshotName": "SentinelOne-APT29-17880.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) called \"Mimikatz Activity - lsadump\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.  ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7131.png"}, {"ScreenshotName": "SecureWorks-APT29-7132.png"}, {"ScreenshotName": "SecureWorks-APT29-7130.png"}, {"ScreenshotName": "SecureWorks-APT29-7129.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (critical severity) called \"Mimikatz Activity - privilege\" was generated for m.exe with command-line arguments indicative of Mimikatz credential theft.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13784.png"}, {"ScreenshotName": "SecureWorks-APT29-13783.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (critical severity) called \"Mimikatz lsadump PowerShell Script Block\" was generated due to a script block event associated with Mimikatz dumping local secrets.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7126.png"}, {"ScreenshotName": "SecureWorks-APT29-7127.png"}, {"ScreenshotName": "SecureWorks-APT29-7128.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed m.exe injecting a thread into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13785.png"}, {"ScreenshotName": "SecureWorks-APT29-13786.png"}], "Score": 10}], "Step score": 205}}, "6.A.2": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for accesschk.exe making Windows API call: CryptUnprotectedData.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 6.A", "ScreenshotName": "FireEye-APT29-12996.png"}], "Score": 70}], "Step score": 70}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Credential Access was generated containing evidence the CryptUnprotectData API was invoked in order to perform decryption on password data.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17390.png"}], "Score": 70}], "Step score": 70}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection was generated for the execution of accesschk.exe to dump passwords.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12755.png"}], "Score": 70}], "Step score": 70}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection for \"Credential Dumping\" contained evidence of accesschk.exe dumping credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12696.png"}, {"ScreenshotName": "GoSecure-APT29-12695.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "6.C.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated for lsass.exe memory access. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "cred dumping alert - shows its high", "ScreenshotName": "Elastic-APT29-1262.png"}, {"ScreenshotCaption": "cred dumping alert - shows lsass.exe is the target", "ScreenshotName": "Elastic-APT29-1263.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (low severity) for \"Credential Access: SAM Registry Reads\" was generated for lsass.exe reading the SAM database through the registry.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "cc  - cred access alert (existing) fired because of fixing black list - \n alert for sam registry reads", "ScreenshotName": "Elastic-APT29-1729.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed lsass.exe accessing the NtOpenKey API. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "cc  - cred access alert (existing) fired because of fixing black list - \n alert for sam registry reads", "ScreenshotName": "Elastic-APT29-1729.png"}], "Score": 3}], "Step score": 133}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Credentials in Registry\" was generated due to a group owner child process querying the User SAM registry keys. Detection incurred a delay based on additional data processing to generate the behavioral threat.", "Detect": "Technique-Delayed (Processing)-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2959.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2958.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Mimikatz\" was received that described PowerShell dumping credentials from LSASS process memory.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13216.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13214.png"}], "Score": 70}], "Step score": 135}, "FireEye": {"Detects": [{"DetectionNote": "A General detection in Process Guard Watcher was generated due to powershell.exe injecting into lsass.exe. ", "Detect": "General", "Screenshots": [{"ScreenshotCaption": "6.C.1 - Shows agent ID corresponds to Nashua", "ScreenshotName": "FireEye-APT29-11716.png"}, {"ScreenshotCaption": "6.C.1 - Process Guard Watcher showing powershell.exe accessing lsass.exe", "ScreenshotName": "FireEye-APT29-11715.png"}], "Score": 30}, {"DetectionNote": "An MSSP detection identified PowerShell injecting into the LSASS process. This activity was labeled as credential harvesting.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 6.C - Analysis based on Process Guard Watcher detection", "ScreenshotName": "FireEye-APT29-12999.png"}], "Score": 70}], "Step score": 100}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection for Credential Dumping was generated for injection into Lsass.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13427.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (yellow indicator) was generated due to process injection into lsass.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-735.png"}], "Score": 42}], "Step score": 107}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Credential Dumping\" was generated due to Suspicious Indicator \"LSASS process memory read by another process.\" ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1646.png"}], "Score": 65}], "Step score": 65}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_lsass_Injection_MITRET1003\" was generated when powershell.exe targeted and injected into lsass.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11937.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe injecting a malicious payload into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12349.png"}], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (red hexagon indicator) for \"Credential Dumping\" was generated when powershell.exe injected into LSASS. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "Telemetry showing detections associated with powershell.exe dumping credentials from LSASS.", "ScreenshotName": "CrowdStrike-APT29-10389.png"}, {"ScreenshotCaption": "Technique detection showing credential dump and access alerts correlated to the initial incident.", "ScreenshotName": "CrowdStrike-APT29-10386.png"}, {"ScreenshotCaption": "Technique detection logic showing powershell.exe dumping credentials.", "ScreenshotName": "CrowdStrike-APT29-10395.png"}], "Score": 72}], "Step score": 72}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red; unique symbol) called \"Credential Theft\" was generated due to powershell.exe injection into lsass.exe. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "evidence behind the process", "ScreenshotName": "Cybereason-APT29-9619.png"}, {"ScreenshotCaption": "alert for powershell credential theft", "ScreenshotName": "Cybereason-APT29-9618.png"}], "Score": 72}], "Step score": 72}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when PowerShell attempted injection into lsass.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "6c1 - tech alert for inject lsass", "ScreenshotName": "Symantec-APT29-17862.png"}], "Score": 65}, {"DetectionNote": "A General alert detection for \"Process Injection\" was generated on \"PowerShell injected into Microsoft signed process\".", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell injecting into lsass.exe tagged with Tactic and Technique.", "ScreenshotName": "Symantec-APT29-7446.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed powershell.exe injecting into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Powershell injecting into lsass.exe tagged with Tactic and Technique.", "ScreenshotName": "Symantec-APT29-7446.png"}], "Score": 10}], "Step score": 110}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for a possible LSASS memory dump was generated due powershell.exe opening handles to lsass.exe in a pattern that happens when a minidump of a process is generated.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "rdr lsass", "ScreenshotName": "F-Secure-APT29-10626.png"}], "Score": 65}], "Step score": 65}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (red 'x' indicator; high severity) called \"Credential Dumping (lsass read)\" was generated due to powershell.exe calling ReadProcessMemory on lsass.exe. \n", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11918.png"}, {"ScreenshotName": "TrendMicro-APT29-11919.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection identified PowerShell injecting into the LSASS process. This activity was labeled as Credential Dumping.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-14015.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe calling ReadProcessMemory on lsass.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11918.png"}], "Score": 10}], "Step score": 145}, "ReaQta": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) called \"Cross-Process Operation\" was generated due to powershell.exe injecting into lsass.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-117.png"}], "Score": 35}], "Step score": 35}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) for \"suspicious process injection was observed\" was generated due to powershell.exe injecting into lsass.exe. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13993.png"}], "Score": 35}, {"DetectionNote": "Telemetry shows powershell.exe using CreateRemoteThread API call to inject into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-624.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe opening a handle to a lsass.exe thread. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4017.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) for \"Credential Dumping\" was generated when powershell.exe attempted to read the lsass.exe process memory. The event was correlated to a parent Technique detection for User Execution on rcs.3aka3.doc\u200b.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Threat Activity for PS dumping lsass process memory.", "ScreenshotName": "CyCraft-APT29-2233.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that described PowerShell dumping credentials from LSASS process memory.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "6.C.1 - MDR Report Day 1, Credential Dumping.", "ScreenshotName": "CyCraft-APT29-12445.png"}], "Score": 70}], "Step score": 142}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called \"Credential Theft\" was generated due to lsass.exe reading SAM Registry keys.", "Detect": "Technique-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11695.png"}], "Score": 53}, {"DetectionNote": "Telemetry showed lsass.exe reading SAM Registry keys.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11696.png"}], "Score": 3}], "Step score": 56}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when PowerShell read sensitive information from LSASS. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "C1 - Shows powershell doing sensitive memory access ", "ScreenshotName": "SentinelOne-APT29-6573.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1003\" occurred containing evidence of credential dumping as indicated by \u201cInfostealer.\u201d", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C1 - lsass access info", "ScreenshotName": "SentinelOne-APT29-12823.png"}], "Score": 70}, {"DetectionNote": "Telemetry shows a remote process injection into lsass.exe by powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "6.C.1 - RemoteInjection into LSASS", "ScreenshotName": "SentinelOne-APT29-17881.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) called \"Credential Dumping T1003\" was generated due to powershell.exe injecting into lsass.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6639.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe injecting into lsass.exe", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6641.png"}], "Score": 10}], "Step score": 75}}, "14.B.4": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\" was generated for the execution of m.exe executing with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "cred dumping alert for m.exe-lsass.exe,  showing details", "ScreenshotName": "Elastic-APT29-1453.png"}, {"ScreenshotCaption": "cred dumping alert, shows high sev", "ScreenshotName": "Elastic-APT29-1452.png"}], "Score": 72}], "Step score": 72}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for Credential Dumping was generated for PowerShell reading credentials from Lsass memory.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3192.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3191.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3193.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3190.png"}], "Score": 72}, {"DetectionNote": "A General alert was generated identifying m.exe as malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13719.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13250.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13246.png"}], "Score": 70}], "Step score": 242}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)\" was generated for the execution of m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.4 - Process arguments indicating Mimikatz", "ScreenshotName": "FireEye-APT29-11474.png"}], "Score": 65}, {"DetectionNote": "A General alert detection called \"Vaultcli.dll Load\" was generated due to a non-standard process, m.exe, loading vaultcli.dll.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.4 - Vaultcli.dll load by m.exe (top)", "ScreenshotName": "FireEye-APT29-11482.png"}, {"ScreenshotCaption": "14.B.4 - Vaultcli.dll load by m.exe (bottom)", "ScreenshotName": "FireEye-APT29-11483.png"}], "Score": 35}, {"DetectionNote": "A General alert detection was generated for m.exe being Mimikatz malware.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.4 - Mimikatz malware alert for m.exe", "ScreenshotName": "FireEye-APT29-11491.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz dumping credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 14.B", "ScreenshotName": "FireEye-APT29-13036.png"}, {"ScreenshotCaption": "MSSP - 14.B", "ScreenshotName": "FireEye-APT29-13035.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a process access into lsass.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "14.B.4 - Process Guard Watcher for m.exe access to lsass.exe", "ScreenshotName": "FireEye-APT29-11489.png"}], "Score": 10}], "Step score": 215}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a process memory read. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-901.png"}, {"ScreenshotName": "Bitdefender-APT29-881.png"}, {"ScreenshotName": "Bitdefender-APT29-902.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (red indicator) was generated for m.exe loading a credential related DLL, identified as a possible attempt to dump credentials. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-900.png"}, {"ScreenshotName": "Bitdefender-APT29-881.png"}], "Score": 42}, {"DetectionNote": "A General alert detection (red indicator) was generated identifying powershell.exe executing m.exe as Mimikatz malware. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-878.png"}], "Score": 42}], "Step score": 156}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Credential Dumping\" was generated due the suspicious indicator \"Mimikatz executed a credential dumping module.\"", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1851.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (yellow indicator) called \"Credential Dumping\" was generated due the suspicious indicator \"LSASS process memory read by other process.\"", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1852.png"}], "Score": 65}], "Step score": 130}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"GUARD: Possible Mimikatz\" was generated when command-line arguments contained \"sekurlsa\".", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12081.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (medium severity) called \"Win_Process_Dump_MITRET1005\" was generated based on the detection of the dumping of process memory.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12086.png"}], "Score": 35}], "Step score": 100}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated LSASS process was accessed by Mimikatz (m.exe). The detection was correlated to a parent alert for Execution via Powershell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe reading LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process.", "ScreenshotName": "CrowdStrike-APT29-10635.png"}, {"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files.", "ScreenshotName": "CrowdStrike-APT29-10641.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated when m.exe read LSASS memory. The detection was correlated to a parent alert for Execution via Powershell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe reading LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process.", "ScreenshotName": "CrowdStrike-APT29-10635.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated when Mimikatz (m.exe) launched. The detection was correlated to a parent alert for Execution via Powershell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) launching. A Technique detection called \u201cCredential Dumping\u201d for an encoded powershell payload script launching a mimikatz process (m.exe).", "ScreenshotName": "CrowdStrike-APT29-10643.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated when the encoded powershell payload script launched a mimikatz process (m.exe) . The detection was correlated to a parent alert for Execution via Powershell.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) launching. A Technique detection called \u201cCredential Dumping\u201d for an encoded powershell payload script launching a mimikatz process (m.exe).", "ScreenshotName": "CrowdStrike-APT29-10643.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (red indicator) called \u201cMachine Learning via Sensor-based ML\u201d was generated when m.exe met machine learning-based on-sensor AV protection\u2019s high confidence threshold for malicious files. The detection was correlated to a parent alert for Execution via Powershell.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files.", "ScreenshotName": "CrowdStrike-APT29-10641.png"}], "Score": 42}], "Step score": 330}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Credential Theft\" was generated for command-line arguments indicative of Mimikatz credential dumping and accessing Lsass. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "14.b.4 - commandline with sekurlsa logonpasswords", "ScreenshotName": "Cybereason-APT29-9750.png"}, {"ScreenshotCaption": "14.b.4 - evidence with process access to lsass", "ScreenshotName": "Cybereason-APT29-9751.png"}], "Score": 72}], "Step score": 72}, "Symantec": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when m.exe read Lsass memory. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "14b4 - technique - reading of lsass", "ScreenshotName": "Symantec-APT29-17709.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when powershell.exe loaded cryptography DLLs and attempted to inject into lsass.exe, and again when powershell.exe successfully injected into lsass.exe. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "Incident report including triggering event of execution of mimikatx, preceded by file execution", "ScreenshotName": "Symantec-APT29-9762.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that included a PowerShell command executed by the adversary to download Mimikatz and execute it with a sequence of commands.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: wmidump", "ScreenshotName": "Symantec-APT29-12962.png"}], "Score": 70}], "Step score": 214}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"mimikatz_command_patterns\" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.b.4 - m.exe with cmd line args", "ScreenshotName": "Kaspersky-APT29-3231.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz dumping credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.b.4 MSSP report", "ScreenshotName": "Kaspersky-APT29-12403.png"}], "Score": 70}], "Step score": 135}, "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Mimikatz command line parameters\" was generated due to m.exe executing with command-line arguments indicative of Mimikatz credential dumping. This detection was correlated to a parent alert for privilege escalation.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "m.exe executing password udmper executed", "ScreenshotName": "F-Secure-APT29-10348.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (medium severity) called \"Password Dumper Executed\" was generated due to a known password hash dumper running. This detection was correlated to a parent alert for privilege escalation.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "m.exe executing password udmper executed", "ScreenshotName": "F-Secure-APT29-10348.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of Mimikatz execution.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Summary", "ScreenshotName": "F-Secure-APT29-13276.png"}, {"ScreenshotCaption": "MSSP - wc function - no context", "ScreenshotName": "F-Secure-APT29-11314.png"}], "Score": 70}], "Step score": 214}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Credential Dumping\" was generated due for a Lsass read.\n", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12097.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection occurred for Mimikatz (m.exe) being used to access credentials in memory. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12690.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a process accessing lsass.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 140}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed a process event for m.exe (identified as Mimikatz) with command-line arguments and binary metadata.", "Detect": "None", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-183.png"}], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) for \"Credential Dumping\"  was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-515.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (medium severity) for \"Credential Dumping\"  was generated due to suspected credential theft activity.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-514.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed m.exe opening lsass.exe with OpenProcess.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17882.png"}], "Score": 10}], "Step score": 140}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4238.png"}, {"ScreenshotName": "Carbon Black-APT29-4239.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4219.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Mimikatz to obtain login credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12768.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4225.png"}], "Score": 17}], "Step score": 194}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) of \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "execution of m.exe with enrichments in graph view", "ScreenshotName": "CyCraft-APT29-2453.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (yellow indicator) of \"Credential Dumping\" was generated for dumping credentials/keys from Lsass process memory", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Threat activity alert for m.exe with enrichments", "ScreenshotName": "CyCraft-APT29-2454.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that described the adversary executing m.exe to access LSASS process memory.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.B.3,4 - MDR Report Day 2, m.exe creation & access lsass", "ScreenshotName": "CyCraft-APT29-12501.png"}], "Score": 70}], "Step score": 200}, "GoSecure": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for a \"Malicious file executed\" for the execution of m.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11402.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection contained evidence of the execution of m.exe with Mimikatz arguments.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12714.png"}, {"ScreenshotName": "GoSecure-APT29-12715.png"}], "Score": 70}], "Step score": 105}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Credential Dumping\"  was generated due to m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "Credential dumping alert", "ScreenshotName": "MalwareBytes-APT29-2571.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Warning severity) called \"Credential Dumping Commandline\" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3863.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (Warning severity) called \"Credential Dumping via lsass access\" was generated due to m.exe requesting access to lsass.exe with Access Mask 0x1010.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3857.png"}, {"ScreenshotName": "HanSight-APT29-3859.png"}], "Score": 65}], "Step score": 130}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B4 - Sensitive memory Access alert for m.exe", "ScreenshotName": "SentinelOne-APT29-6870.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1003\" occurred containing evidence of Mimikatz sekurlsa::logonpasswords usage via m.exe.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - m.exe CLI args, wmidump call/definition", "ScreenshotName": "SentinelOne-APT29-12870.png"}], "Score": 70}, {"DetectionNote": "Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) called \"Credential Dumping\" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7074.png"}, {"ScreenshotName": "SecureWorks-APT29-7072.png"}, {"ScreenshotName": "SecureWorks-APT29-7073.png"}, {"ScreenshotName": "SecureWorks-APT29-7071.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (critical severity) called \"Credential Dumping\" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7077.png"}, {"ScreenshotName": "SecureWorks-APT29-7079.png"}, {"ScreenshotName": "SecureWorks-APT29-7078.png"}, {"ScreenshotName": "SecureWorks-APT29-7080.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Mimikatz to obtain login credentials.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12656.png"}], "Score": 70}], "Step score": 200}}}, "TechniqueName": "Credential Dumping", "Steps count": 4, "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}]}, "T1005": {"Steps": {"17.B.1": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell opening MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for malicious use of PowerShell.", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "17.b.1 - malops 2 processes (cc)", "ScreenshotName": "Cybereason-APT29-9934.png"}, {"ScreenshotCaption": "17.b.1 - full path (cc)", "ScreenshotName": "Cybereason-APT29-9935.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Read and collected a local file using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for a file collected from C:\\Users\\oscar\\Documents. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12691.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file access of MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for  PowerShell executing an ADS.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17563.png"}], "Score": 17}], "Step score": 87}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the file read of MITRE-ATTACK-EVALS.HTML. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-201.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. PowerShell execution of Copy-Item was observed, but this does not count as a detection since file activity was not observed.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-539.png"}], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for Data from Local System was generated for a process reading MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "CC - B1 - File Read to C:\\Windows\\Temp\\WindowsParentalControlMigration\\ MITRE-ATTACK-EVALS.HTML", "ScreenshotName": "SentinelOne-APT29-7266.png"}], "Score": 65}], "Step score": 65}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "2.A.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "files found from the file read for 2.a.3 (users\\pam)", "ScreenshotName": "Elastic-APT29-1200.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for Data From Local System \"(T1005)\" occurred containing evidence that a discovery script was executed file read operations on local folder \u200bC:\\Users\\Pam. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2679.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13417.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe reading files from  C:\\Users\\Pam\\*.", "ScreenshotName": "CrowdStrike-APT29-10221.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"PowerShell activity looking for files in a directory T1005\" occurred containing evidence of a file event for powershell.exe reading files from Pam's system.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)", "ScreenshotName": "Cybereason-APT29-10773.png"}, {"ScreenshotCaption": "MSSP - a5 (draft.zip create)", "ScreenshotName": "Cybereason-APT29-10772.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent General detection rcs.3aka3.doc being identified as unknown malware.", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "2.a.3 powershell executed process, opened files (cc)", "ScreenshotName": "Cybereason-APT29-9887.png"}, {"ScreenshotCaption": "2.a.3 - files from pams system (cc)", "ScreenshotName": "Cybereason-APT29-9889.png"}], "Score": 10}], "Step score": 80}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11845.png"}], "Score": 17}], "Step score": 17}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-42.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "A Tactic detection for \"T1119 Possible Data Collection (file reads)\" was generated on file reads of C:\\Users\\Pam\\*.", "Detect": "Tactic-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11673.png"}], "Score": 33}, {"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11673.png"}], "Score": 3}], "Step score": 36}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Data from Local System {T1005}\" was generated on powershell.exe executing Get-ChildItem and reading C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - A3 - All files being read in C:\\users\\pam\\links\\*", "ScreenshotName": "SentinelOne-APT29-7164.png"}, {"ScreenshotCaption": "CC - A3 - File open alert of file in C:\\users\\pam\\links\\desktop.lnk", "ScreenshotName": "SentinelOne-APT29-7161.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"PowerShell is seen enumerating the system and searching for files\" contained evidence of file reads to C:/Users/Pam/*.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "A2/3 - MSSP - ChildItem call", "ScreenshotName": "SentinelOne-APT29-12797.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe reading files from C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - A3 - All files being read in C:\\users\\pam\\links\\*", "ScreenshotName": "SentinelOne-APT29-7164.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "9.B.4": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. This event was correlated to a Technique detection for the creation of psexesvc.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "compress-archive powershell event -- 9b4", "ScreenshotName": "Elastic-APT29-1337.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe reading files in C:\\Users\\Pam.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3045.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed file opens of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": "9.b.4 - (cc)", "ScreenshotName": "Cybereason-APT29-9973.png"}, {"ScreenshotCaption": "9.b.4 - process tree (cc)", "ScreenshotName": "Cybereason-APT29-9972.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "Telemetry showed file accesses of C:\\Users\\Pam\\*.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12009.png"}], "Score": 10}], "Step score": 10}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-151.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "A Tactic detection for \"T1119 Possible Data Collection (file reads)\" was generated on file reads of C:\\Users\\Pam\\*.", "Detect": "Tactic-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11699.png"}], "Score": 33}, {"DetectionNote": "Telemetry showed file reads by powershell.exe in Pam's user directory. The event was correlated to parent alert on New Windows Service Created.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11699.png"}], "Score": 10}], "Step score": 43}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"OpenedFile\" under \"Data from Local System {T1005}\" was generated when a known malicious powershell.exe read files in C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Configuration Change (Detections)-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "CC - B4 -  enumeration of C:/users/pam via OpenFile alert", "ScreenshotName": "SentinelOne-APT29-7240.png"}, {"ScreenshotCaption": "CC - B4 -  enumeration of C:/users/pam via OpenFile alert", "ScreenshotName": "SentinelOne-APT29-7241.png"}], "Score": 65}], "Step score": 65}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}, "7.B.1": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13219.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2983.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection called PowerShell Read Document was generated for powershell.exe process reading file contents. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-745.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing Powershell.exe reading files from C:\\Users\\pam\\Downloads.", "ScreenshotName": "CrowdStrike-APT29-10433.png"}, {"ScreenshotCaption": "Telemetry showing the Invoke-Exfil script block contents.", "ScreenshotName": "CrowdStrike-APT29-10427.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Configuration Change (Detections)-Correlated", "Screenshots": [{"ScreenshotCaption": " full path sysinternalssuite.zip (cc)", "ScreenshotName": "Cybereason-APT29-9966.png"}, {"ScreenshotCaption": " files from powershell sysinterals (cc) ", "ScreenshotName": "Cybereason-APT29-9965.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Read data in the user's Downloads directory using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12680.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Powershell.exe accessing files from C:\\Users\\pam\\Downloads. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11947.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-122.png"}, {"ScreenshotName": "ReaQta-APT29-126.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11698.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Data from Local System {T1005}\" was generated due to powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "7.B.1 - Process file reads in Downloads", "ScreenshotName": "SentinelOne-APT29-14732.png"}], "Score": 65}, {"DetectionNote": "No detection capability demonstrated for this procedure, though data showing file reads was retrieved from the encrypted cache on the host by an analyst.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "B1 - Host query of to be zipped files being accessed", "ScreenshotName": "SentinelOne-APT29-6686.png"}], "Score": 3}], "Step score": 68}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Data from Local System", "Steps count": 4, "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}]}, "T1060": {"Steps": {"5.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1060 Registry Run Keys / Startup Folder\" was generated due to powershell.exe creating hostui.lnk. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "hostui enrichments (bottom) shows full startup path and startup folder enrichment", "ScreenshotName": "Elastic-APT29-1251.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (medium severity) for \"Shortcut File Written by Suspicious Process\" was generated due to powershell.exe creating hostui.lnk. The event was correlated to a parent General detection for malicious file execution.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "shortcut file written alert", "ScreenshotName": "Elastic-APT29-1252.png"}], "Score": 42}, {"DetectionNote": "Telemetry showed powershell.exe creating the hostui.lnk file in the Startup folder. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "hostui enrichments (bottom) shows full startup path and startup folder enrichment", "ScreenshotName": "Elastic-APT29-1251.png"}], "Score": 17}], "Step score": 131}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"registry run key or file in start up folder created - T1060\" was generated due to powershell.exe creating the hostui.lnk file. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2935.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2924.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13199.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a file create event for hostui.lnk in the Startup folder. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2933.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Startup Folder Persistence\" was generated due to the creation of a file in the Start Menu Startup folder.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "5.B.1 - Startup Folder Persistence (bottom)", "ScreenshotName": "FireEye-APT29-13986.png"}, {"ScreenshotCaption": "5.B.1 - Startup Folder Persistence (top)", "ScreenshotName": "FireEye-APT29-13984.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated due to a suspicious LNK file. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "5.B.1 - Suspicious LNK File for hostui.lnk (bottom)", "ScreenshotName": "FireEye-APT29-11056.png"}, {"ScreenshotCaption": "5.B.1 - Suspicious LNK File for hostui.lnk (top)", "ScreenshotName": "FireEye-APT29-11054.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 5.B", "ScreenshotName": "FireEye-APT29-12994.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell creating the hostui.lnk file in the Startup folder. The event was correlated to a parent detection for PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "5.B.1 - Triage view of the file write of hostui.lnk to the startup folder", "ScreenshotName": "FireEye-APT29-11062.png"}], "Score": 17}], "Step score": 187}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called Startup Item was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-724.png"}, {"ScreenshotName": "Bitdefender-APT29-727.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-716.png"}], "Score": 17}], "Step score": 89}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Registry Run Keys / Startup Folder\" was generated due to an application being set to run when Windows starts. \n", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-14580.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the creation of hostui.lnk in the Startup folder. The event was correlated to a parent alert for a suspicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1604.png"}], "Score": 17}], "Step score": 82}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Win_Persist__MITRET1060\" was generated due to hostui.lnk being written to the Startup folder. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11927.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Persistence Mechanisms\" occurred containing evidence of hostui.lnk creation in Startup folder with persistence alert.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12907.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe creating hostui.lnk in the start-up folder correlated to the process tree.", "ScreenshotName": "CrowdStrike-APT29-10347.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Invoke-Persistence (persistence via shortcut/run key)\" occurred containing evidence of the  PowerShell creating the hostui.lnk file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - javamtsup executed/created", "ScreenshotName": "Cybereason-APT29-10787.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "5.b.1 - powershell create the file hostui.lnk", "ScreenshotName": "Cybereason-APT29-9610.png"}], "Score": 17}], "Step score": 87}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Registry Run Keys / Startup Folder\" was generated due to powershell.exe creating the hostui.lnk file.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "File creation of hostui.lnk in startup folder, tagged with \"Registry Run Keys / Startup Folder\".", "ScreenshotName": "Symantec-APT29-7433.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed creation of hostui.lnk in the Startup folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "File creation of hostui.lnk in startup folder, tagged with \"Registry Run Keys / Startup Folder\".", "ScreenshotName": "Symantec-APT29-7433.png"}], "Score": 10}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence of the creation of hostui.lnk.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 5b", "ScreenshotName": "Kaspersky-APT29-17996.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe creating the hostui.lnk file in the Startup folder. The event was correlated to a parent General detection for suspicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "javamtsup added to registry in Services -> indicates service is created.", "ScreenshotName": "Kaspersky-APT29-2798.png"}, {"ScreenshotCaption": "5.b.1 hostui.lnk file created", "ScreenshotName": "Kaspersky-APT29-2802.png"}], "Score": 17}], "Step score": 87}, "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "F-Secure": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated for a shortcut file (hostui.lnk) being modified. The event was correlated to a parent alert for suspicious powershell.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "hostui.lnk rdr", "ScreenshotName": "F-Secure-APT29-10618.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred containing evidence of the creation of the hostui.lnk file in the Startup folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2", "ScreenshotName": "F-Secure-APT29-11301.png"}, {"ScreenshotCaption": "MSSP - hostui stuff", "ScreenshotName": "F-Secure-APT29-11280.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed Startup folder registry modification for hostui.lnk.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "hostui.lnk", "ScreenshotName": "F-Secure-APT29-10068.png"}], "Score": 10}], "Step score": 122}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Registry Run Keys / Startup Folder\" was generated due to PowerShell creating the hostui.lnk file. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11900.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for PowerShell dropping the hostui.lnk file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-1154.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Registry Run Keys/Startup Folder was generated due to the file write of hostui.lnk in the Startup folder. This detection was correlated to a parent General detection of rcs.3aka3.doc being identified as 'patpoopy' backdoor.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-574.png"}], "Score": 72}, {"DetectionNote": "A General alert detection (low severity) was generated for \"a link file (LNK) with unusual characteristics was opened.\" This detection was correlated to a parent General detection that rcs.3aka3.doc was identified as a patpoopy.backdoor.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-573.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection for Persistence was generated due to hostui.lnk being placed inside the Startup folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13992.png"}], "Score": 70}], "Step score": 184}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Persistence - PowerShell Startup Folder\" was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3985.png"}, {"ScreenshotName": "Carbon Black-APT29-3984.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3983.png"}], "Score": 17}], "Step score": 89}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (green indicator) for \"Registry Run Keys / Startup Folder\" was generated due to hostui.lnk being written to the Startup folder.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Registry Creation event for Startup Folder persistence with enrichments.", "ScreenshotName": "CyCraft-APT29-2232.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a Registry Created event for addition of hostui.lnk to the Startup folder. Additional analysis was received that included a PowerShell script and explained that it used the Invoke-Persistence command to create a LNK file in the Startup folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "5.B.1 - MDR Report Day 1,Startup Folder persistence.", "ScreenshotName": "CyCraft-APT29-12443.png"}, {"ScreenshotCaption": "5.B.1 - MDR Supplemental Report, Invoke-Persistence Startup Folder persistence.", "ScreenshotName": "CyCraft-APT29-12469.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) called \"Registry Run Keys or Startup Folder\" was generated due to the creation of hostui.lnk in the Startup folder.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10937.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the creation of hostui.lnk in the Startup folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10937.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Registry Run Keys/Startup Folder was generated due to the creation of hostui.lnk in the StartUp folder. The event was correlated to a parent Technique detection for masquerading for rcs.3aka3.doc.", "Detect": "Technique-Alert-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Alert view", "ScreenshotName": "MalwareBytes-APT29-9979.png"}, {"ScreenshotCaption": ".lnk creation (5b1)", "ScreenshotName": "MalwareBytes-APT29-2525.png"}], "Score": 65}], "Step score": 65}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (warning severity) called \"Startup Folder Object Creation\" was generated due to the file creation of hostui.lnk in the Startup folder.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3554.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-15123.png"}], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"StartupDirectory\" under was generated due to the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B1 - Additional indicator of persistence ", "ScreenshotName": "SentinelOne-APT29-6559.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"T1060\" occurred containing evidence of PowerShell placing LNK in startup folder, gaining persistence to launch hostui.bat.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - powershell SBL", "ScreenshotName": "SentinelOne-APT29-12821.png"}, {"ScreenshotCaption": "MSSP - B1 - houstui.lnk/.bat/.exe", "ScreenshotName": "SentinelOne-APT29-12820.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "5.B.1 - File Creation for hostui.lnk in Startup", "ScreenshotName": "SentinelOne-APT29-14685.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Persistence - Registry Run Keys / Startup Folder\" occurred for the creation of the hostui.lnk file in the Startup folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13740.png"}, {"ScreenshotName": "SecureWorks-APT29-13742.png"}, {"ScreenshotName": "SecureWorks-APT29-13741.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6677.png"}, {"ScreenshotName": "SecureWorks-APT29-6672.png"}, {"ScreenshotName": "SecureWorks-APT29-6676.png"}, {"ScreenshotName": "SecureWorks-APT29-6673.png"}], "Score": 10}], "Step score": 80}}, "11.A.11": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection for \"ATT&CK T1060 Registry Run Keys / Startup Folder\" was generated for powershell.exe adding Run key persistence into the Registry", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "registry modify for kxwn.lock with enrichment", "ScreenshotName": "Elastic-APT29-1375.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "registry modify for kxwn.lock with enrichment", "ScreenshotName": "Elastic-APT29-1375.png"}], "Score": 10}], "Step score": 70}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"commonly abused process creates a new autostart Registry key\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3163.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3164.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) called \"New entry added to startup related Registry keys by signed binary\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3163.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3164.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13237.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 210}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Run Key Persistence\" was generated due to the modification of \"run\" Registry persistence keys.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.A.11 - Run Key Persistence for Webcache subkey (top)", "ScreenshotName": "FireEye-APT29-11352.png"}, {"ScreenshotCaption": "11.A.11 - Run Key Persistence for Webcache subkey (bottom)", "ScreenshotName": "FireEye-APT29-11353.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13025.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"RegSigStartup\" was generated for Registry Run Keys / Startup Folder persistence.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-800.png"}, {"ScreenshotName": "Bitdefender-APT29-815.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for a suspicious process writing a Startup item Registry key.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-820.png"}, {"ScreenshotName": "Bitdefender-APT29-800.png"}], "Score": 65}, {"DetectionNote": "A Technique detection was generated showing Registry write event of the Webcache subkey by powershell.exe, identified as a Startup or Autorun.", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-813.png"}, {"ScreenshotName": "Bitdefender-APT29-814.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 200}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Win_Persist_MITRET1060\" was generated when Webcache subkey was added to the Registry Run key.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12050.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe added a Webcache subkey added to Registry.", "ScreenshotName": "CrowdStrike-APT29-10574.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Registry key modification (ATT&CK Persistence)\" was generated when the Webcache subkey was added to the Registry Run key. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "11.a.11 - registry event with more details, machine name, process name", "ScreenshotName": "Cybereason-APT29-9696.png"}, {"ScreenshotCaption": "11.a.11 - registry technique, process tree", "ScreenshotName": "Cybereason-APT29-9693.png"}], "Score": 65}], "Step score": 65}, "Symantec": {"Detects": [{"DetectionNote": "A Technique detection for \"Registry Run Keys / Startup Folder\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "powershell.exe setting registry key, tagged with Registry Run Key persistence.", "ScreenshotName": "Symantec-APT29-9714.png"}, {"ScreenshotCaption": "Details of registry key creation event.", "ScreenshotName": "Symantec-APT29-9713.png"}], "Score": 60}, {"DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a PowerShell command executed by the adversary and explained that it was used to set a Registry Run Key. A detailed analysis of the malicious payload was also provided. [SE: see comment]", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Registry Run Keys", "ScreenshotName": "Symantec-APT29-12952.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "powershell.exe setting registry key, tagged with Registry Run Key persistence.", "ScreenshotName": "Symantec-APT29-9714.png"}, {"ScreenshotCaption": "powershel.exe setting registry value for persistence with kxwn.lock file, tagged with Registry Run Keys / Startup Folder", "ScreenshotName": "Symantec-APT29-9716.png"}], "Score": 10}], "Step score": 140}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow tag) called Registy Run Keys Startup Folder  was generated due to powershell.exe adding the Webcache subkey Run key persistence into the Registry. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3152.png"}, {"ScreenshotCaption": "11.a.12 - exec of schemas ads would be blocked", "ScreenshotName": "Kaspersky-APT29-3155.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a11", "ScreenshotName": "Kaspersky-APT29-18013.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.a.12 - exec of schemas ads would be blocked", "ScreenshotName": "Kaspersky-APT29-3155.png"}, {"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3117.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Established Registry Run key persistence using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) was generated for a detected process performing a Registry write that looks like a launchpoint. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "possible persistence, .lock file", "ScreenshotName": "F-Secure-APT29-10246.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of the creation of a registry value named \"Webcache.\"", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a11 - webcache", "ScreenshotName": "F-Secure-APT29-11308.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a Registry write event of the Webcache subkey identified as an Autorun.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "webcache ", "ScreenshotName": "F-Secure-APT29-10248.png"}], "Score": 10}], "Step score": 145}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Registry Run Keys / Startup Folder\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12067.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred for PowerShell creating persistence by modifying the Registry which launches at startup. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12688.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (orange indicator) was generated for \"Registry Run Keys / Startup Folder\" based on the Webcache subkey addition.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-166.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-292.png"}], "Score": 3}], "Step score": 68}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Execution was generated containing evidence a Registry key was created for persistence under HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1136.png"}, {"ScreenshotName": "Microsoft-APT29-1137.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-479.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for Registry Run Keys was generated based on powershell.exe modifying the Run key.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4124.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4171.png"}], "Score": 10}], "Step score": 75}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Registry Run Keys / Startup Folder\" was generated for a Registry Creation event associated with establishing Registry Run Key persistence.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Creation of .lock file with enrichments", "ScreenshotName": "CyCraft-APT29-2437.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a PowerShell script and explained that it was used to establish Registry Run Key persistence.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.1 - MDR Report Day 2, registry key created", "ScreenshotName": "CyCraft-APT29-12497.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (green indicator) called \"Registry Run Keys / Startup Folder\" was generated due to Run key persistence added into the Registry", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11331.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11331.png"}], "Score": 10}], "Step score": 75}, "Malwarebytes": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) for Registry Run Keys/Startup Folder was generated due to the addition of the Run key persistence into the Registry. ", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "Addition of webcache", "ScreenshotName": "MalwareBytes-APT29-2594.png"}], "Score": 58}], "Step score": 58}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Warning severity) for \"Registry Run Keys\" was generated due to the the Webcache subkey being added as a Registry run key.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3745.png"}, {"ScreenshotName": "HanSight-APT29-3746.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"RegistryAutorun\" under \"Persistence {T1060}\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A11 - Regkey software/windows/CurrentVersion/run being added", "ScreenshotName": "SentinelOne-APT29-6786.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1060\" occurred containing evidence of Webcache subkey added to Registry.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - A10/11/12", "ScreenshotName": "SentinelOne-APT29-12848.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A11 - Regkey software/windows/CurrentVersion/run being added", "ScreenshotName": "SentinelOne-APT29-6786.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (critical severity) called \"Powerduke Persistence 2\"  was generated for a persistence event associated with a run key used by PowerDuke.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6971.png"}, {"ScreenshotName": "SecureWorks-APT29-6972.png"}, {"ScreenshotName": "SecureWorks-APT29-6973.png"}, {"ScreenshotName": "SecureWorks-APT29-6970.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Persistence- Registry Run Keys / Startup Folder\" occurred for PowerShell registering a Registry Run key.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13768.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6974.png"}], "Score": 10}], "Step score": 145}}, "10.B.1": {"Elastic": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "hostui.bat ", "ScreenshotName": "Elastic-APT29-1343.png"}], "Score": 3}], "Step score": 3}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred for hostui.lnk executing from Startup Folder. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13232.png"}], "Score": 70}], "Step score": 70}, "FireEye": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "10.B.1 - Audit Viewer for explorer.exe spawning cmd.exe to run hostui.bat", "ScreenshotName": "FireEye-APT29-11284.png"}, {"ScreenshotCaption": "10.B.1 - explorer.exe spawning cmd.exe to run hostui.bat", "ScreenshotName": "FireEye-APT29-11259.png"}], "Score": 0}], "Step score": 0}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed hostui.lnk executing from the Startup Folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing hostui.lnk executing from the startup folder and launch cmd to spawn hostui.bat.", "ScreenshotName": "CrowdStrike-APT29-10552.png"}], "Score": 10}], "Step score": 10}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" occurred containing evidence of hostui.lnk executing from Startup Folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - b1 - .lnk in startup folder", "ScreenshotName": "Cybereason-APT29-10781.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "explorer launched cmd.exe to run hostui.bat", "ScreenshotName": "Symantec-APT29-7495.png"}], "Score": 0}], "Step score": 0}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for hostui.lnk executing from Startup Folder. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12682.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed hostui.lnk executing from the Startup Folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12042.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Microsoft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "Detect": "None", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13953.png"}], "Score": 0}], "Step score": 0}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "Detect": "None", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11100.png"}], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "Detect": "None", "Screenshots": [{"ScreenshotCaption": "process tree - host.exe", "ScreenshotName": "MalwareBytes-APT29-2541.png"}], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"StartedFromLnk\" under \"Registry Run Keys / Startup Folder {T1060}\" was generated due to hostui.lnk triggering on login from the StartUp Folder.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "CC - B1 - hostui.lnk in startup folder - StartedFromLnk indicator", "ScreenshotName": "SentinelOne-APT29-7243.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection for \"startup persistence\" occurred containing evidence of hostui.lnk executing from Startup Folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - .lnk ", "ScreenshotName": "SentinelOne-APT29-12842.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed hostui.lnk executing from the Startup Folder.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "CC - B1 - hostui.lnk in startup folder - StartedFromLnk indicator", "ScreenshotName": "SentinelOne-APT29-7243.png"}], "Score": 10}], "Step score": 138}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed hostui.bat executing from a persistent Startup Menu shortcut.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13763.png"}], "Score": 10}], "Step score": 10}}}, "TechniqueName": "Registry Run Keys / Startup Folder", "Steps count": 3, "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}]}, "T1145": {"Steps": {"6.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection for \"ATT&CK T1145 Private Keys\" was generated for powershell.exe creating the $RandomFileName.pfx file. The event was correlated to a parent General detection for malicious file execution.\t", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "pfx file creation with private keys enrichment ", "ScreenshotName": "Elastic-APT29-1258.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed powershell.exe creating the $RandomFileName.pfx file. The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "whole message of script block for get privatekeys", "ScreenshotName": "Elastic-APT29-1260.png"}], "Score": 17}], "Step score": 89}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"New certificate file has been created\" was generated for the file creation event of the lotu40lg.b0j.pfx file.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2954.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection was generated for the creation of the $RandomFileName.pfx file. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13215.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2979.png"}], "Score": 17}], "Step score": 159}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Private Key - T1145\" was generated due to the creation of the $RandomFileName.pfx file. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "6.B.1 - Private Key alert with the pfx file creation", "ScreenshotName": "FireEye-APT29-11091.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was generated for the creation of the $RandomFileName.pfx file. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 6.B", "ScreenshotName": "FireEye-APT29-12998.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection called \"privatekeyread\" was generated due to the $RandomFileName.pfx file being accessed by an uncommon process.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-696.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed file write event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-714.png"}], "Score": 17}], "Step score": 82}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Private Keys\" was generated due to Suspicious Indicator \"A new Private Key file with pfx/p12 extension was created.\"", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1965.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for PowerShell. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1642.png"}], "Score": 17}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Win_PrivateKey_Modification_MITRET1145\"  was generated when the new $RandomFileName.pfx file was created.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11935.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "file event details with random file name from process tree", "ScreenshotName": "Cybereason-APT29-9616.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Private Keys\" occurred containing evidence of readme.ps1 analysis indicating Get-PrivateKeys execution writing a .pfx file.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 6B1", "ScreenshotName": "Symantec-APT29-17593.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe.", "Detect": "Telemetry-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "6B1 - powershell creating PFX file", "ScreenshotName": "Symantec-APT29-9927.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent General detection for suspicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-2821.png"}], "Score": 17}], "Step score": 17}, "Procedure": "Exported a local certificate to a PFX file using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the Master File Table (MFT) was manually pulled in order to locate the written pfx private key file.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "grepping the table for the pfx", "ScreenshotName": "F-Secure-APT29-10632.png"}], "Score": 3}], "Step score": 3}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique alert detection (low severity) called \"Private Keys\"  was generated due to Export-PfxCertificate. ", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12330.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection occurred for the function Get-Private keys used to create $RandomFileName.pfx. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12679.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12270.png"}], "Score": 17}], "Step score": 145}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-109.png"}], "Score": 10}], "Step score": 10}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Credential Access was generated containing evidence the private key was exported using PowerShell to the user download folder.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-413.png"}, {"ScreenshotName": "Microsoft-APT29-415.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-576.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated for \"PFX Extraction via PowerShell\" on filemod of the $RandomFileName.pfx file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "General-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4015.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection was generated for a file create event of $RandomFileName.pfx file by powershell.exe. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12756.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-13943.png"}, {"ScreenshotName": "Carbon Black-APT29-4016.png"}], "Score": 17}], "Step score": 129}, "Cycraft": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"T1145: Private Keys\" was generated due to a file create event for the $RandomFileName.pfx file by powershell.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10961.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed a file creation event for the $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent detection on \"Bypass User Account Control\".", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10961.png"}], "Score": 17}], "Step score": 82}, "Malwarebytes": {"Detects": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent Technique detection for Masquerading on rcs.3aka3.doc.", "Detect": "Telemetry-Correlated-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "creation of pfx", "ScreenshotName": "MalwareBytes-APT29-2550.png"}], "Score": 10}], "Step score": 10}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3560.png"}, {"ScreenshotName": "HanSight-APT29-3559.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B1 - File creation of $RandomFileName.pfx with full path", "ScreenshotName": "SentinelOne-APT29-6570.png"}], "Score": 17}], "Step score": 17}, "Secureworks": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the execution of the PowerShell function to locate and export private keys.", "Detect": "None", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13746.png"}, {"ScreenshotName": "SecureWorks-APT29-13745.png"}], "Score": 0}], "Step score": 0}}}, "TechniqueName": "Private Keys", "Steps count": 1, "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}]}, "T1048": {"Steps": {"18.A.2": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "copy item script block", "ScreenshotName": "Elastic-APT29-1588.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection contained evidence  WindowsParentalControlMigration.tmp file was written to the mapped OneDrive network share.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13260.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3321.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A General detection alert was generated for a file write to a network share.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "18.A.2 - File Write to Network Share for WindowsParentalControlMigration.tmp (top)", "ScreenshotName": "FireEye-APT29-11618.png"}, {"ScreenshotCaption": "18.A.2 - File Write to Network Share for WindowsParentalControlMigration.tmp (bottom)", "ScreenshotName": "FireEye-APT29-11619.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred for the WindowsParentalControlMigration.tmp file being written to the mapped OneDrive network share.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 18.A", "ScreenshotName": "FireEye-APT29-13047.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent alert on the PowerShell process.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "18.A.2 - Triage view of PowerShell copying WindowsParentalControlMigration.tmp to the Y drive", "ScreenshotName": "FireEye-APT29-11622.png"}], "Score": 17}], "Step score": 122}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1109.png"}], "Score": 3}], "Step score": 3}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.  ", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) called \"Win_CopyOperation_MITRET1074\" was generated for PowerShell copying files.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12155.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Data Theft and Exfiltration\" occurred containing evidence of Copy-Item to the Y drive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12940.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 115}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry from Scriptblock logging showing powershell.exe executing Copy-Item.", "ScreenshotName": "CrowdStrike-APT29-10704.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "A General alert detection (unique symbol) was generated for PowerShell executing a malicious command. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "General-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "18.a.2 - malicious command  Alert (cc)", "ScreenshotName": "Cybereason-APT29-9942.png"}, {"ScreenshotCaption": "18.a.2 - malicious powershell process tree with tmp file from the command line", "ScreenshotName": "Cybereason-APT29-9814.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for Exfiltration Over Alternative Protocol occurred containing evidence of PowerShell using Copy-Item to the Y drive.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2", "ScreenshotName": "Cybereason-APT29-10809.png"}], "Score": 70}], "Step score": 105}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Exfiltration Over Alternative Protocol\" was received that included a PowerShell command executed by the adversary and explained that it was used to copy a file to a drive mapped to a WebDav share.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Exfil using Web Service", "ScreenshotName": "Symantec-APT29-12973.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive \"Y:\".", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - move to B- copy-item", "ScreenshotName": "F-Secure-APT29-11320.png"}, {"ScreenshotCaption": "MSSP - day2 executive summary - pt2", "ScreenshotName": "F-Secure-APT29-11303.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "a2 - copy item of the .tmp", "ScreenshotName": "F-Secure-APT29-10464.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though events showed the creation of the exfiltrated data within the previously mapped Y drive.", "Detect": "None", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17569.png"}], "Score": 0}], "Step score": 0}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-336.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated by Microsoft Cloud App Security due to an unsanctioned or unknown Cloud app (identified as Microsoft OneDrive) being accessed.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17404.png"}], "Score": 35}], "Step score": 35}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-14758.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a OneDrive account, along with the creation of the exfiltrated data within the OneDrive. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4344.png"}, {"ScreenshotName": "Carbon Black-APT29-4341.png"}], "Score": 17}], "Step score": 87}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (blue indicator) was generated identifying PowerShell executing Copy-Item as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "copy-item of .tmp file with enrichment", "ScreenshotName": "CyCraft-APT29-2485.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Exfiltration Over Alternative Protocol\" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "18.A.1 - MDR Report Day 2, net use execution and copy-item", "ScreenshotName": "CyCraft-APT29-12519.png"}, {"ScreenshotCaption": "18.A.1 - MDR Report Day 2, summary & powershell execution of net use", "ScreenshotName": "CyCraft-APT29-12518.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The event was correlated to a parent detection for \"Bypass User Account Control.\"", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11477.png"}], "Score": 17}], "Step score": 17}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3951.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection for \"T1048\" occurred containing evidence of PowerShell executing Copy-Item on WindowsParentalControlMigration.tmp.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - Outlook network information", "ScreenshotName": "SentinelOne-APT29-12887.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - A2 - Generic powershell alert showing Copy-Item call", "ScreenshotName": "SentinelOne-APT29-7282.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13787.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-16055.png"}], "Score": 10}], "Step score": 80}}, "7.B.4": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4). The event was correlated to a parent General detection for malicious file execution.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "copy item to webdav (4)", "ScreenshotName": "Elastic-APT29-1282.png"}], "Score": 17}], "Step score": 17}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) called \"File being written to remote path\" was generated for the file OfficeSupplies.7z being written a WebDav share at 192.168.0.4.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "General-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2977.png"}], "Score": 42}, {"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network via WebDav to 192.168.0.4. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13219.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2975.png"}], "Score": 17}], "Step score": 129}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"WebDav Network Request\" was generated due to a WebDav user-agent being used to PUT OfficeSupplies.7z on a WebDav network share.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "7.B.4 - WebDav Network Request to PUT OfficeSupplies.7z", "ScreenshotName": "FireEye-APT29-11125.png"}], "Score": 65}, {"DetectionNote": "A General alert detection was generated for the file write of OfficeSupplies.7z to a remote adversary WebDav network share (192.168.0.4).", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "7.B.4 - File write of OfficeSupplies.7z to the WebDav network share ", "ScreenshotName": "FireEye-APT29-11127.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 7.B", "ScreenshotName": "FireEye-APT29-13002.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4).", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 180}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for a compressed file being transferred over the network.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13434.png"}], "Score": 58}, {"DetectionNote": "A General alert detection was generated for a network connection to remote WebDav network share.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1079.png"}], "Score": 28}, {"DetectionNote": "Telemetry showed an event for PowerShell reading OfficeSupplies.7z as well as an active connection to a remote adversary WebDav network share (192.168.0.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-742.png"}, {"ScreenshotName": "Bitdefender-APT29-754.png"}], "Score": 10}], "Step score": 96}, "McAfee": {"Detects": [{"DetectionNote": "A General alert detection (low severity) was generated due to rundll32.exe connecting to 192.168.0.4 via WebDav.", "Detect": "General-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1966.png"}], "Score": 28}], "Step score": 28}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (info severity) was generated for Powershell making a network connection.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11952.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11950.png"}], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network to a remote adversary WebDav network share (192.168.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "overwatch information", "ScreenshotName": "CrowdStrike-APT29-10442.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell Copy-Item to a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Exfil.", "ScreenshotName": "CrowdStrike-APT29-10426.png"}, {"ScreenshotCaption": "Telemetry showing the Invoke-Exfil script block contents.", "ScreenshotName": "CrowdStrike-APT29-10427.png"}], "Score": 17}], "Step score": 87}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for malicious PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "7.b.2 - office supplies.7z information from events", "ScreenshotName": "Cybereason-APT29-9623.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Exfiltration over Alternative Protocol\" occurred containing evidence of exfiltration to remote WebDav network share (192.168.0.4).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Exfil execution", "ScreenshotName": "Symantec-APT29-12936.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Exfil details", "ScreenshotName": "Symantec-APT29-12937.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Exfil", "ScreenshotName": "Symantec-APT29-12935.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a .7z file creation to a remove file share.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "telem - file write of .7z to fileshare", "ScreenshotName": "Symantec-APT29-17654.png"}], "Score": 10}], "Step score": 80}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Report Page 6 - Step 7", "ScreenshotName": "Kaspersky-APT29-11792.png"}], "Score": 70}, {"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "7.b.3 - pwd lolol", "ScreenshotName": "Kaspersky-APT29-2864.png"}], "Score": 3}], "Step score": 73}, "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PoweShell Copy-Item to remote WebDav network share (192.168.0.4)", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - invoke exfil ", "ScreenshotName": "F-Secure-APT29-11285.png"}, {"ScreenshotCaption": "MSSP - executive overview (lots of steps alert) pt2", "ScreenshotName": "F-Secure-APT29-11301.png"}], "Score": 70}], "Step score": 70}, "TrendMicro": {"Detects": [{"DetectionNote": "A General alert detection for \"Suspicious Behavior\" (low severity) was generated due to OfficeSupplies.7z being copied to remote WebDav network share (192.168.0.4:80).", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11943.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4).", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4) as well as the network share connection to 192.168.0.4:80.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-128.png"}, {"ScreenshotName": "ReaQta-APT29-275.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-412.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4028.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (yellow indicator) was generated due to rundll32.exe executing the API Call DavSetCookie in daclnt.dll to map a share using WebDav.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "rundll mapping the webdav share", "ScreenshotName": "CyCraft-APT29-2242.png"}, {"ScreenshotCaption": "webdav screenshot 7.b.4", "ScreenshotName": "CyCraft-APT29-2241.png"}], "Score": 35}], "Step score": 35}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10997.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell Copy-Item used to mount a remote WebDav network share (192.168.0.4) as well as the network share connection to 192.168.0.4:80.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3582.png"}, {"ScreenshotName": "HanSight-APT29-3595.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of exfiltration via WebDav.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B4 - wmi and network connection", "ScreenshotName": "SentinelOne-APT29-12829.png"}, {"ScreenshotCaption": "MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation", "ScreenshotName": "SentinelOne-APT29-12828.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotCaption": "CC - B4 -Powershell alert containing Copy-Item and also password used by redteam", "ScreenshotName": "SentinelOne-APT29-7231.png"}], "Score": 10}], "Step score": 80}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection for \"Exfiltration - Exfiltration Over Alternative Protocol\" occurred containing evidence of PoweShell Copy-Item to remote WebDav network share (192.168.0.4:80).", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13749.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4).", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6741.png"}, {"ScreenshotName": "SecureWorks-APT29-6760.png"}, {"ScreenshotName": "SecureWorks-APT29-6740.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Exfiltration Over Alternative Protocol", "Steps count": 2, "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}]}, "T1063": {"Steps": {"4.C.7": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic detection called \"Reconnaissance of Multiple WMI Classes\" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. ", "ScreenshotName": "Elastic-APT29-1237.png"}], "Score": 52}, {"DetectionNote": "Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class AntiVirusProduct. The event was correlated to a parent General detection for malicious file execution. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "antivirus wmi event", "ScreenshotName": "Elastic-APT29-1233.png"}], "Score": 17}], "Step score": 69}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) was generated for PowerShell performing suspicious Security Software Discovery.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13648.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13649.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2858.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2868.png"}], "Score": 17}], "Step score": 152}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}, {"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12992.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.7 - Script block for Get-WmiObject ...\u200b -Class AntiVirusProduct", "ScreenshotName": "FireEye-APT29-11025.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique detection (yellow indicator) was generated for Windows Management Instrumentation being used for AV discovery. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.", "Detect": "Technique-Configuration Change (Detections)-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1124.png"}, {"ScreenshotName": "Bitdefender-APT29-1121.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 68}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1957.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Win_SecSoftwareEnum_Powershell_MITRETT1063\" was generated when powershell.exe called Get-WMIObject with AntiVirusProduct. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection (medium severity) called \"Win_WMI_SecProduct_Enum_NonSYS_MITRET1063\" was generated when a WMI query targeted AntiVirusProduct.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11916.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using Get-WMIObject with AntiVirusProduct. An alert for \"Win_SecSoftwareEnum_Powershell_MITRETT1063\" was shown.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12901.png"}, {"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 210}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}, {"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for Security Software Discovery occurred containing evidence of powershell executing Get-WmiObject and -Class AntiVirusProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - invoke-discovery (firewall, antivirus)", "ScreenshotName": "Cybereason-APT29-10786.png"}, {"ScreenshotCaption": "MSSP - c7 - antivirus", "ScreenshotName": "Cybereason-APT29-10790.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}, {"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated anti-virus software using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection labeled wmi-enumeration-av was generated due to a WMI query for AntivirusProduct.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "wmi stuff, wmi enum", "ScreenshotName": "F-Secure-APT29-10081.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17355.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11876.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell executing Get-WmiObject  ...\u200b -Class AntiVirusProduct.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-582.png"}, {"ScreenshotName": "Microsoft-APT29-13988.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Security Software Discovery\" was received that included a PowerShell script and explained that it was used to detect the installed anti-virus product.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3532.png"}, {"ScreenshotName": "HanSight-APT29-3543.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Security Software Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing AntiVirusProduct.  The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "C7 - Security software using suspicious wmi query - Antivirus product", "ScreenshotName": "SentinelOne-APT29-6532.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing AntiVirusProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C7/8 - Gwmi AntiVirus and Firewall queries.", "ScreenshotName": "SentinelOne-APT29-12817.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct. ", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - Security Software Discovery\" occurred containing evidence of powershell.exe Get-WmiObject ...\u200b -Class AntiVirusProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13738.png"}], "Score": 10}], "Step score": 80}}, "12.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique detection (medium severity) for \"ATT&CK T1063 Security Software Discovery\"  was generated due to PowerShell executing the detectav function. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Technique-Correlated-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotCaption": "cc - powershell enrichment change to security software discovery. ", "ScreenshotName": "Elastic-APT29-1807.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "wmi  event for av product", "ScreenshotName": "Elastic-APT29-1395.png"}], "Score": 17}], "Step score": 82}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection (high severity) called \"Security Software Discovery\" was generated due to powershell executing a gwmi query for AntiVirusProduct.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3183.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3180.png"}], "Score": 65}, {"DetectionNote": "A MSSP detection occurred containing evidence of security software discovery attempts. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13240.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing PowerShell gwmi query for AntiVirusProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 12.B", "ScreenshotName": "FireEye-APT29-13028.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "12.B.1 - gwmi query for AntiVirusProduct", "ScreenshotName": "FireEye-APT29-11421.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"WMIAntiVirusDiscovery\" was generated due to PowerShell gwmi query for AntiVirusProduct. The alert was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-871.png"}, {"ScreenshotName": "Bitdefender-APT29-868.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) called \"Win_WMI_SecProduct_Enum_NonSYS_MITRET1063\" was generated due to PowerShell gwmi query for AntiVirusProduct.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12072.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique detection called \u201cGenericSecuritySoftwareDiscovery\u201d was generated due to PowerShell gwmi query for AntiVirusProduct. ", "Detect": "Technique", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cGenericSecuritySoftwareDiscovery\u201d on powershell.exe process when the detectav function is loaded.", "ScreenshotName": "CrowdStrike-APT29-10603.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A Technique detection called \u201cGenericSecuritySoftwareDiscovery\u201d on powershell.exe process when the detectav function is loaded.", "ScreenshotName": "CrowdStrike-APT29-10603.png"}], "Score": 10}], "Step score": 70}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Security Software Discovery\" was occurred containing evidence WMI was used to enumerate installed AntiVirus products.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Security Software Discovery", "ScreenshotName": "Symantec-APT29-12957.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of a PowerShell gwmi query for AntiVirusProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "12.b.1 MSSP report", "ScreenshotName": "Kaspersky-APT29-12389.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated registered AV products using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (informational severity) was generated for for WMI querying information about anti-virus products. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-14505.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for AntiVirusProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - day2 executive summary pt1", "ScreenshotName": "F-Secure-APT29-11302.png"}, {"ScreenshotCaption": "MSSP - detectav ", "ScreenshotName": "F-Secure-APT29-11310.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "antivirusproduct", "ScreenshotName": "F-Secure-APT29-10270.png"}], "Score": 10}], "Step score": 145}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell enumerating registered AV products. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12689.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12058.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-300.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) was generated for script with suspicious content.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-14017.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-492.png"}, {"ScreenshotName": "Microsoft-APT29-493.png"}], "Score": 10}], "Step score": 45}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4150.png"}, {"ScreenshotName": "Carbon Black-APT29-4151.png"}], "Score": 17}], "Step score": 17}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red icon) for \"Security Software Discovery\" was generated due to powershell.exe loading a custom script that contained code to detect installed antivirus products.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "detectav with enrichments", "ScreenshotName": "CyCraft-APT29-2439.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Security Software Discovery\" was received that included PowerShell gwmi query for AntiVirusProduct", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "12.B.1 - MDR Report Day 2, detectav & software scriptblock", "ScreenshotName": "CyCraft-APT29-12487.png"}, {"ScreenshotCaption": "12.A.1 - MDR Report Day 2, summary and timestomp", "ScreenshotName": "CyCraft-APT29-12485.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of security software discovery attempts. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-12744.png"}], "Score": 70}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (Critical severity) called \"Anti-Virus Software Discovery\" was generated due to the gwmi query for AntiVirusProduct.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4216.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3770.png"}], "Score": 10}], "Step score": 68}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"Discovery {T1063}\" was generated when PowerShell gwmi queried for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B1 - Suspicious WMI alert with query for AntiVirusProduct", "ScreenshotName": "SentinelOne-APT29-6830.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection occurred containing evidence of gwmi query being used to enumerate AV software via \"detectav\" PowerShell function.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - General WMI alert", "ScreenshotName": "SentinelOne-APT29-12854.png"}, {"ScreenshotCaption": "MSSP  - B1 - SBL", "ScreenshotName": "SentinelOne-APT29-12855.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"Security Software Discovery - Enumerating AntiVirus Software\" was generated due to the PowerShell  gwmi query for AntiVirusProduct.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7023.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7026.png"}, {"ScreenshotName": "SecureWorks-APT29-7024.png"}], "Score": 10}], "Step score": 75}}, "4.C.8": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic detection called \"Reconnaissance of Multiple WMI Classes\" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.", "Detect": "Tactic-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. ", "ScreenshotName": "Elastic-APT29-1237.png"}], "Score": 52}, {"DetectionNote": "Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class FireWallProduct. The event was correlated to a parent General detection for malicious file execution.\t", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "firewall wmi event", "ScreenshotName": "Elastic-APT29-1235.png"}], "Score": 17}], "Step score": 69}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class FireWallProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2869.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2858.png"}], "Score": 17}], "Step score": 87}, "FireEye": {"Detects": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12992.png"}, {"ScreenshotCaption": "MSSP - 4.C", "ScreenshotName": "FireEye-APT29-12991.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "4.C.8 - Script block for Get-WmiObject ...\u200b\u200b -Class FireWallProduct", "ScreenshotName": "FireEye-APT29-11023.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1958.png"}], "Score": 3}], "Step score": 3}, "Cylance": {"Detects": [{"DetectionNote": "A MSSP detection for \"Environment Enumeration\" occurred containing evidence of \"Invoke-Discovery\" function definition using Get-WmiObject targeting FireWallProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12900.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject targeting FireWallProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11917.png"}], "Score": 10}], "Step score": 80}, "CrowdStrike": {"Detects": [{"DetectionNote": "A Technique detection called \"GenericSoftwareSystemDiscovery\" was generated when WMI was used to query information about firewall products. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "4c8 - new vendor screenshot", "ScreenshotName": "CrowdStrike-APT29-15008.png"}], "Score": 67}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class FireWallProduct. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing invoke-discovery function executing.", "ScreenshotName": "CrowdStrike-APT29-10306.png"}, {"ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents.", "ScreenshotName": "CrowdStrike-APT29-10305.png"}], "Score": 17}], "Step score": 84}, "Cybereason": {"Detects": [{"DetectionNote": "An MSSP detection for \"Enumeration Invoke-Discovery\" occurred containing evidence of powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - invoke-discovery (firewall, antivirus)", "ScreenshotName": "Cybereason-APT29-10786.png"}], "Score": 70}], "Step score": 70}, "Symantec": {"Detects": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)", "ScreenshotName": "Symantec-APT29-12919.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution", "ScreenshotName": "Symantec-APT29-12922.png"}, {"ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques", "ScreenshotName": "Symantec-APT29-12921.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Procedure": "Enumerated firewall software using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for WMI being used to query information about firewall products.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17358.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17360.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12676.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11876.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed powershell executing Get-WmiObject ...\u200b\u200b -Class FireWallProduct. ", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-13284.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class FireWallProduct. Script preview was truncated so an alternate view is shown.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-582.png"}, {"ScreenshotName": "Microsoft-APT29-13988.png"}], "Score": 10}], "Step score": 10}, "VMware": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3935.png"}], "Score": 3}], "Step score": 3}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Security Software Discovery\" was received that included a PowerShell script and explained that it was used to detect the installed firewall product.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "4.C.1-8 - MDR Report Day 1, Invoke-Discovery", "ScreenshotName": "CyCraft-APT29-12466.png"}], "Score": 70}], "Step score": 70}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.", "Detect": "None-Host Interrogation-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-17389.png"}], "Score": 3}], "Step score": 3}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ... -Class FireWallProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3532.png"}, {"ScreenshotName": "HanSight-APT29-3543.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"Security Software Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing FireWallProduct. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "C8 - using suspicious wmi query - Firewall product", "ScreenshotName": "SentinelOne-APT29-6533.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing FireWallProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - C7/8 - Gwmi AntiVirus and Firewall queries.", "ScreenshotName": "SentinelOne-APT29-12817.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 152}, "Secureworks": {"Detects": [{"DetectionNote": "A MSSP detection for \"Discovery - Security Software Discovery\" occurred containing evidence of powershell.exe Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13736.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13739.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Security Software Discovery", "Steps count": 3, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1497": {"Steps": {"11.A.3": {"Elastic": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) called \"Reconnaissance of Multiple WMI Classes\" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "alert for multiple wmi discovery techniques", "ScreenshotName": "Elastic-APT29-1364.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "bios wmi event", "ScreenshotName": "Elastic-APT29-1358.png"}], "Score": 10}], "Step score": 55}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3129.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_BIOS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}, {"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13024.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A - gwmi query for Win32_BIOS", "ScreenshotName": "FireEye-APT29-11343.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection was generated for getting the BIOS version via Windows Management Instrumentation.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1090.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 61}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) for a WMI query operation via PowerShell was generated for a PowerShell gwmi query for Win32_BIOS.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12051.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 55}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Virtualization/Sandbox Evasion\" was received that included a PowerShell command executed by the adversary and explained that it was used to query BIOS information.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery Techniques", "ScreenshotName": "Symantec-APT29-12948.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery description", "ScreenshotName": "Symantec-APT29-12949.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "new mssp 11a3 and 11a4", "ScreenshotName": "Kaspersky-APT29-18009.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_BIOS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process", "ScreenshotName": "F-Secure-APT29-11306.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a3-8 - thp - wmi stuff", "ScreenshotName": "F-Secure-APT29-10234.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_BIOS. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-287.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated containing evidence PowerShell ran command to check BIOS version\nand serial numbers gwmi -namespace root\\cimv2\n-query 'SELECT * FROM Win32_BIOS'.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1140.png"}, {"ScreenshotName": "Microsoft-APT29-1141.png"}, {"ScreenshotName": "Microsoft-APT29-1139.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-469.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4163.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Virtualization/Sandbox Evasion\" was generated for the PowerShell gwmi query for Win32_BIOS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell wmi query of bios with enrichments", "ScreenshotName": "CyCraft-APT29-2419.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Virtualization/Sandbox Evasion\" was received that included a PowerShell script and explained that it was used to check for virtualization.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}, {"ScreenshotCaption": "11.A.3 - MDR Report Day 2, virtualization", "ScreenshotName": "CyCraft-APT29-12475.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3720.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Tactic alert detection for \"Discovery\" under \"SuspiciousWMIQuery\" was generated on a suspicious WMI query targeting Win32_BIOS.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotCaption": "A3/4 - WMI win32_bios ", "ScreenshotName": "SentinelOne-APT29-6791.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"T1497\" occurred containing evidence of WMI query targeting Win32_BIOS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - bios and computer system", "ScreenshotName": "SentinelOne-APT29-12844.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 125}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique alert detection (info severity) called \"WMI Queries Win32_Bios\" was generated for a PowerShell gwmi query for Win32_BIOS.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6932.png"}, {"ScreenshotName": "SecureWorks-APT29-6934.png"}, {"ScreenshotName": "SecureWorks-APT29-6931.png"}, {"ScreenshotName": "SecureWorks-APT29-6933.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Discovery - Virtualization/Sandbox Evasion\" occurred for the PowerShell gwmi query for Win32_BIOS.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13768.png"}, {"ScreenshotName": "SecureWorks-APT29-13766.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17610.png"}, {"ScreenshotName": "SecureWorks-APT29-17607.png"}, {"ScreenshotName": "SecureWorks-APT29-17607.png"}], "Score": 10}], "Step score": 145}}}, "TechniqueName": "Virtualization/Sandbox Evasion", "Steps count": 1, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1065": {"Steps": {"1.A.3": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "double check to make sure i got network connection info. ", "ScreenshotName": "Elastic-APT29-1177.png"}], "Score": 10}], "Step score": 10}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection for an Uncommonly used port \"(T1065)\" occurred containing evidence of rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13200.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2651.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"Uncommon Port Connection\" was generated due to  rcs.3aka3.doc connecting to remote port 1234.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotCaption": "CC - 1.A.3 - Uncommon Port Connection for 1234", "ScreenshotName": "FireEye-APT29-11721.png"}], "Score": 58}, {"DetectionNote": "An MSSP detection occurred for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 1.A", "ScreenshotName": "FireEye-APT29-12976.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1.A.3 - Network connection to 192.168.0.5:1234", "ScreenshotName": "FireEye-APT29-10843.png"}], "Score": 10}], "Step score": 138}, "Bitdefender": {"Detects": [{"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-647.png"}, {"ScreenshotName": "Bitdefender-APT29-644.png"}], "Score": 10}], "Step score": 10}, "McAfee": {"Detects": [{"DetectionNote": "A Technique alert detection (blue indicator) called \"Commonly Used Port\" showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1402.png"}, {"ScreenshotName": "McAfee-APT29-1401.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1402.png"}], "Score": 10}], "Step score": 75}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (low severity) called \"Unsigned Application Network Beaconing\" was generated when the rcs.3aka3.doc process made a network connection.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-11816.png"}, {"ScreenshotName": "Cylance-APT29-11817.png"}], "Score": 45}, {"DetectionNote": "An MSSP detection for \"Unsigned Application Network Beaconing\" occurred containing evidence of rcs.3aka3.doc process connecting to C2(192.168.0.5) on port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12896.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 125}, "CrowdStrike": {"Detects": [{"DetectionNote": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP alert showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "ScreenshotName": "CrowdStrike-APT29-10190.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Telemetry showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "ScreenshotName": "CrowdStrike-APT29-10192.png"}], "Score": 10}], "Step score": 80}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1.a.3 - process details showing the network connection over port 1234", "ScreenshotName": "Cybereason-APT29-7334.png"}], "Score": 10}], "Step score": 10}, "Symantec": {"Detects": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when rcs.3aka3.doc connected to 192.168.0.5 on port 1234.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "1.A.1 details of pupy execution", "ScreenshotName": "Symantec-APT29-7338.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1.A.1 details of pupy execution", "ScreenshotName": "Symantec-APT29-7338.png"}], "Score": 10}], "Step score": 45}, "Kaspersky": {"Detects": [{"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1.a.3 - connection to 192.168.0.5:1234", "ScreenshotName": "Kaspersky-APT29-2632.png"}], "Score": 10}], "Step score": 10}, "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of cod.3aka3.scr connecting to 192.168.0.5 on port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - a2/3 - rtlo and network connection ", "ScreenshotName": "F-Secure-APT29-11250.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed a network connection to 192.168.0.5 over port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "1234 port", "ScreenshotName": "F-Secure-APT29-9993.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12674.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-11815.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (blue/yellow indicators) for \"Uncommonly Used Port\" was generated for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-19.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-15.png"}], "Score": 10}], "Step score": 75}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Uncommonly Used Port\" was generated due to rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-13973.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-353.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-12751.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 over TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-3717.png"}, {"ScreenshotName": "Carbon Black-APT29-3709.png"}], "Score": 10}], "Step score": 80}, "Cycraft": {"Detects": [{"DetectionNote": "An MSSP detection for \"Uncommonly Used Port\" was received that included a description of rcs.3aka3.doc and explained that it established a network connection to 192.168.0.5:1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "1.A.1, 1.A.3 - MDR Report Day 1", "ScreenshotName": "CyCraft-APT29-11803.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "Network connection of malicious file. Identifies IP and port of C2 server. Also identifies Process Injection and other stuff by monitoring suspicious use of API calls. Suspicious code markings are memory locations with suspicious code.", "ScreenshotName": "CyCraft-APT29-2051.png"}], "Score": 10}], "Step score": 80}, "GoSecure": {"Detects": [{"DetectionNote": "A Technique detection called \"T1043: Commonly Used Port\" showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10814.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-10814.png"}, {"ScreenshotName": "GoSecure-APT29-10813.png"}], "Score": 10}], "Step score": 70}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3435.png"}], "Score": 10}], "Step score": 10}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"T1065 - Uncommonly Used Port\" was generated for rcs.3aka3.doc due to TCP port 1234 being used.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "Shows full story at a higher level in the UI", "ScreenshotName": "SentinelOne-APT29-6462.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 1.A.3", "ScreenshotName": "SentinelOne-APT29-14534.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "A.3 - Shows uncommon port", "ScreenshotName": "SentinelOne-APT29-6468.png"}], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-12782.png"}, {"ScreenshotName": "SecureWorks-APT29-12582.png"}, {"ScreenshotName": "SecureWorks-APT29-12782.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7230.png"}], "Score": 10}], "Step score": 80}}}, "TechniqueName": "Uncommonly Used Port", "Steps count": 1, "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}]}, "T1120": {"Steps": {"11.A.5": {"Elastic": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "win32 pnpentity wmi event", "ScreenshotName": "Elastic-APT29-1363.png"}], "Score": 10}], "Step score": 10}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence execution of an WMI query for Win32_PnPEntity.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13686.png"}], "Score": 10}], "Step score": 80}, "FireEye": {"Detects": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13024.png"}, {"ScreenshotCaption": "MSSP - 11.A", "ScreenshotName": "FireEye-APT29-13023.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11.A.5 - gwmi query for Win32_PnPEntity", "ScreenshotName": "FireEye-APT29-11390.png"}], "Score": 10}], "Step score": 80}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for getting the plug and play devices via Windows Management Instrumentation.", "Detect": "Technique-Configuration Change (Detections)-Alert", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-1093.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [], "Score": 3}], "Step score": 61}, "McAfee": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cylance": {"Detects": [{"DetectionNote": "A Tactic alert detection (medium severity) for WMI query operations via PowerShell.", "Detect": "Tactic-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12055.png"}], "Score": 45}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 55}, "CrowdStrike": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Cybereason": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Symantec": {"Detects": [{"DetectionNote": "An MSSP detection for \"Peripheral Device Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate Plug and Play devices.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: Discovery Techniques", "ScreenshotName": "Symantec-APT29-12948.png"}, {"ScreenshotCaption": "MSSP Day 1: Discovery description", "ScreenshotName": "Symantec-APT29-12949.png"}], "Score": 70}], "Step score": 70}, "Kaspersky": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence for the execution of an WMI query for Win32_PnPEntity.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.a.3-5 MSSP report", "ScreenshotName": "Kaspersky-APT29-12376.png"}, {"ScreenshotCaption": "11.a.3-5 MSSP report", "ScreenshotName": "Kaspersky-APT29-12376.png"}], "Score": 70}], "Step score": 70}, "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_PnPEntity.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - enumeration - bios, pnpentity, computer system, process", "ScreenshotName": "F-Secure-APT29-11306.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "11a3-8 - thp - wmi stuff", "ScreenshotName": "F-Secure-APT29-10234.png"}], "Score": 10}], "Step score": 80}, "TrendMicro": {"Detects": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Win32_PnPEntity. ", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12687.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12071.png"}], "Score": 10}], "Step score": 80}, "ReaQta": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-288.png"}], "Score": 3}], "Step score": 3}, "Microsoft": {"Detects": [{"DetectionNote": "An MSSP detection for Discovery was generated  containing evidence PowerShell ran commands to pull properties of Plug and Play devices: gwmi -namespace root\\cimv2 -query 'SELECT * FROM Win32_PnPEntity'.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-1141.png"}, {"ScreenshotName": "Microsoft-APT29-1140.png"}, {"ScreenshotName": "Microsoft-APT29-1139.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-469.png"}], "Score": 10}], "Step score": 80}, "VMware": {"Detects": [{"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4164.png"}], "Score": 10}], "Step score": 10}, "Cycraft": {"Detects": [{"DetectionNote": "A General alert detection (red indicator) was generated identifying a PowerShell gwmi query for Win32_PnPEntity as threat activity.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotCaption": "Powershell wmi query of pnpentity with enrichments", "ScreenshotName": "CyCraft-APT29-2423.png"}], "Score": 35}, {"DetectionNote": "An MSSP detection for \"Peripheral Device Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_PnPEntity via WMI.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "11.A.5 - MDR Report Day 2, Win32_PnPEntity", "ScreenshotName": "CyCraft-APT29-12477.png"}, {"ScreenshotCaption": "11.A.1 - MDR Report Day 2, summary", "ScreenshotName": "CyCraft-APT29-2503.png"}], "Score": 70}], "Step score": 105}, "GoSecure": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection (reminder severity) called \"Peripheral Device Discovery\" was generated for a PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Technique-Alert-Configuration Change (Detections)", "Screenshots": [{"ScreenshotName": "HanSight-APT29-4212.png"}], "Score": 58}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3722.png"}], "Score": 10}], "Step score": 68}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"{T1120}\" (Peripheral Device Discovery) was generated due to a suspicious WMI query for Win32_PnPEntity.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "A5 - WMI win32_pnpEntity", "ScreenshotName": "SentinelOne-APT29-6792.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"T1120\" occurred containing evidence of WMI query targeting Win32_PnPEntity.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - pnp, process enumeration, win32_process, file enumeration", "ScreenshotName": "SentinelOne-APT29-12845.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 145}, "Secureworks": {"Detects": [{"DetectionNote": "A Technique detection alert (info severity) called \"WMI Queries Win32_PnPEntity\" was generated due to the WMI query for Win32_PnPEntity.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-6937.png"}, {"ScreenshotName": "SecureWorks-APT29-6935.png"}, {"ScreenshotName": "SecureWorks-APT29-6936.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Discovery - Peripheral Device Discovery\" occurred for the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-13766.png"}, {"ScreenshotName": "SecureWorks-APT29-13767.png"}, {"ScreenshotName": "SecureWorks-APT29-13768.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-17626.png"}, {"ScreenshotName": "SecureWorks-APT29-17625.png"}], "Score": 10}], "Step score": 145}}}, "TechniqueName": "Peripheral Device Discovery", "Steps count": 1, "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}]}, "T1047": {"Steps": {"14.B.1": {"Elastic": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Potential Code Execution via WMI-based PowerShell Cmdlet\" was generated for PowerShell using WMI. The event was correlated to a parent General detection for a suspicious Windows script.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "potential code execution via wmi alert", "ScreenshotName": "Elastic-APT29-1444.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (medium severity) for \"Suspicious Execution via WMI\" was generated for PowerShell using WMI. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotCaption": "suspicious execution via wmi (from powershell) win32 process create", "ScreenshotName": "Elastic-APT29-1462.png"}], "Score": 72}, {"DetectionNote": "A Technique detection for \"ATT&CK T1047 Windows Management Instrumentation\" was generated for PowerShell using WMI. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Technique-Correlated", "Screenshots": [{"ScreenshotCaption": "process created via wmi event for child powershell with wmi enrichment", "ScreenshotName": "Elastic-APT29-1445.png"}], "Score": 67}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for a suspicious Windows script.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "potential code execution via wmi alert", "ScreenshotName": "Elastic-APT29-1444.png"}], "Score": 17}], "Step score": 228}, "PaloAltoNetworks": {"Detects": [{"DetectionNote": "Telemetry showed powershell.exe executed by WMI. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detect": "Telemetry-Correlated-Configuration Change (UX)", "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3383.png"}], "Score": 10}], "Step score": 10}, "FireEye": {"Detects": [{"DetectionNote": "A Technique alert detection called \"PowerShell WMI Activity\" was generated for WmiPrvSE.exe executing powershell.exe. ", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.1 - PowerShell WMI Activity", "ScreenshotName": "FireEye-APT29-11470.png"}], "Score": 65}, {"DetectionNote": "A Technique alert detection called \"WMI Process Creation\" was generated due to a process being started by WMI.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14.B.1 - WMI Process Creation of powershell.exe", "ScreenshotName": "FireEye-APT29-11467.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 140}, "Bitdefender": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a local process created using WMI. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-888.png"}, {"ScreenshotName": "Bitdefender-APT29-874.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection (red indicator) was generated for a WMI action using a custom provider. The detection was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-907.png"}, {"ScreenshotName": "Bitdefender-APT29-875.png"}], "Score": 72}, {"DetectionNote": "A Technique alert detection was generated for PowerShell executed using WMI. The alert was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-13414.png"}, {"ScreenshotName": "Bitdefender-APT29-905.png"}], "Score": 72}, {"DetectionNote": "A Technique alert was generated for the creation of a new WMI class. The alert was correlated to a parent alert identifying the powershell.exe process as malware.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "Bitdefender-APT29-886.png"}, {"ScreenshotName": "Bitdefender-APT29-887.png"}, {"ScreenshotName": "Bitdefender-APT29-874.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 298}, "McAfee": {"Detects": [{"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "McAfee-APT29-1854.png"}], "Score": 10}], "Step score": 10}, "Cylance": {"Detects": [{"DetectionNote": "A General alert detection (medium severity) called \"GUARD: Unusual Powershell Parent Process\" was generated on powershell.exe with parent process WmiPrvSE.exe.", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Cylance-APT29-12083.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 45}, "CrowdStrike": {"Detects": [{"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for execution via PowerShell.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "Telemetry showing WmiPrvSE.exe executed powershell.exe.", "ScreenshotName": "CrowdStrike-APT29-10633.png"}], "Score": 17}], "Step score": 17}, "Cybereason": {"Detects": [{"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "14.b.1 - process tree with wmiprvse.exe", "ScreenshotName": "Cybereason-APT29-9749.png"}], "Score": 17}], "Step score": 17}, "Symantec": {"Detects": [{"DetectionNote": "A Tactic detection called \"Execution\" was generated when wmiprvse.exe launched powershell.exe.", "Detect": "Tactic-Correlated", "Screenshots": [{"ScreenshotCaption": "14b1 - tactic execution", "ScreenshotName": "Symantec-APT29-17707.png"}], "Score": 47}, {"DetectionNote": "An MSSP detection for \"WMI\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute PowerShel through WMI that downloads and executes mimikatz.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP Day 1: wmidump", "ScreenshotName": "Symantec-APT29-12962.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "wmiprvse.exe executing powershell.exe stager", "ScreenshotName": "Symantec-APT29-9755.png"}], "Score": 10}], "Step score": 127}, "Kaspersky": {"Detects": [{"DetectionNote": "A Technique alert detection (red; high severity) called \"commandline_wmi_event_consumer_triggered\"  was generated due to WmiPrvSE.exe executing powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3210.png"}, {"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3208.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection contained evidence of WmiPrvSE.exe executing powershell.exe to execute the Win32_AuditCode WMI class.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.b.1 MSSP report #1", "ScreenshotName": "Kaspersky-APT29-12398.png"}, {"ScreenshotCaption": "14.b.1 MSSP report #2", "ScreenshotName": "Kaspersky-APT29-12399.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "Kaspersky-APT29-3210.png"}], "Score": 10}], "Step score": 145}, "Procedure": "Created and executed a WMI class using PowerShell", "F-Secure": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Windows Management Instrumentation was generated due to WMI starting a system process it normally doesn\u2019t start.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "wmi doest start a process it normally starts", "ScreenshotName": "F-Secure-APT29-10342.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe", "Detect": "Telemetry", "Screenshots": [{"ScreenshotCaption": "", "ScreenshotName": "F-Secure-APT29-17370.png"}], "Score": 10}], "Step score": 75}, "TrendMicro": {"Detects": [{"DetectionNote": "A Technique detection called \"Windows Management Instrumentation\" was generated due to WmiPrvSE.exe executing powershell.exe. ", "Detect": "Technique", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-12096.png"}], "Score": 60}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "TrendMicro-APT29-17676.png"}], "Score": 10}], "Step score": 70}, "ReaQta": {"Detects": [{"DetectionNote": "A Technique alert detection (red incator) called \"WMI Process Created\" was generated for WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for suspicious file deobfuscation via certutil.exe.", "Detect": "Technique-Alert-Correlated", "Screenshots": [{"ScreenshotName": "ReaQta-APT29-180.png"}], "Score": 72}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 82}, "Microsoft": {"Detects": [{"DetectionNote": "A Technique alert detection (medium severity) for Windows Management Instrumentation was generated from WmiPrvSE.exe executing powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-506.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Microsoft-APT29-17400.png"}], "Score": 10}], "Step score": 75}, "VMware": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) for Windows Management Instrumentation was generated for WmiPrvSE.exe executing powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4236.png"}, {"ScreenshotName": "Carbon Black-APT29-4235.png"}], "Score": 65}, {"DetectionNote": "A General alert detection (red indicator) for Privilege Escalation was generated for suspicious PowerShell behavior. ", "Detect": "General-Alert", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4232.png"}], "Score": 35}, {"DetectionNote": "Telemetry showed WmiPrvSe.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "Carbon Black-APT29-4223.png"}, {"ScreenshotName": "Carbon Black-APT29-4221.png"}], "Score": 10}], "Step score": 110}, "Cycraft": {"Detects": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Execution\" with \"T1047 Windows Management Instrumentation\" label was generated for WmiPrvSE.exe executing powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotCaption": "14b1_2 new image from vendor", "ScreenshotName": "CyCraft-APT29-14975.png"}, {"ScreenshotCaption": "14b1_1 new image from vendor", "ScreenshotName": "CyCraft-APT29-14976.png"}], "Score": 65}, {"DetectionNote": "An MSSP detection for \"Windows Management Instrumentation\" was received that included a PowerShell script and explained that it was used to set up execution of Mimikatz.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "14.B.1 - MDR Report Day 2, WMI dump", "ScreenshotName": "CyCraft-APT29-12499.png"}, {"ScreenshotCaption": "14.B.1 - MDR Report Day 2, invoke wmidump", "ScreenshotName": "CyCraft-APT29-12500.png"}], "Score": 70}], "Step score": 135}, "GoSecure": {"Detects": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing powershell.exe. ", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "GoSecure-APT29-11398.png"}], "Score": 10}], "Step score": 10}, "Malwarebytes": {"Detects": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "Detect": "None", "Screenshots": [], "Score": 0}], "Step score": 0}, "HanSight": {"Detects": [{"DetectionNote": "A Technique alert detection called \"WMI create child process\" (Warning severity) was generated for WmiPrvSE.exe executing powershell.exe.", "Detect": "Technique-Alert", "Screenshots": [{"ScreenshotName": "HanSight-APT29-3829.png"}], "Score": 65}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [], "Score": 10}], "Step score": 75}, "SentinelOne": {"Detects": [{"DetectionNote": "A Technique alert detection for \"WMI Operation\" under \"Execution {T1047}\" was generated on Win32_AuditCode usage. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Technique-Correlated-Alert", "Screenshots": [{"ScreenshotCaption": "B1/5/6 - WMI operation has occured", "ScreenshotName": "SentinelOne-APT29-6874.png"}], "Score": 72}, {"DetectionNote": "An MSSP detection for \"WMI Operation\" occurred containing evidence of Win32_AuditCode usage. WmiPrvSE.exe executed powershell.exe with decoded payload.", "Detect": "MSSP-Delayed (Manual)", "Screenshots": [{"ScreenshotCaption": "MSSP - B1 - WMI usage", "ScreenshotName": "SentinelOne-APT29-12864.png"}, {"ScreenshotCaption": "MSSP - powershell parent process", "ScreenshotName": "SentinelOne-APT29-12866.png"}, {"ScreenshotCaption": "MSSP - SBL and process creation", "ScreenshotName": "SentinelOne-APT29-12865.png"}], "Score": 70}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detect": "Telemetry-Correlated", "Screenshots": [{"ScreenshotCaption": "B1- wmiPrvSe.exe executing powershell", "ScreenshotName": "SentinelOne-APT29-6880.png"}], "Score": 17}], "Step score": 159}, "Secureworks": {"Detects": [{"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "Detect": "Telemetry", "Screenshots": [{"ScreenshotName": "SecureWorks-APT29-7067.png"}], "Score": 10}], "Step score": 10}}}, "TechniqueName": "Windows Management Instrumentation", "Steps count": 1, "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}]}}