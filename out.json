{"T1012": {"TechniqueName": "Query Registry", "Steps count": 5, "Steps": {"12.E.1.7": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment-Tainted", "Indicator of Compromise"], "Screenshots": {"": "", "PA-12.E.1.6-1.png": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo", "PA-12.E.1.7-1.png": "Enrichment of the enumeration of system information via a Registry query as suspicious (tainted by a parent alert on wscript.exe)"}, "Score": 32}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-05.png": "Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-12.E.1.6.1-1.png": "Telemetry showing the Get-Sysinfo function"}, "Score": 10}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "13.C.1": {"F-Secure": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CC-13.A.1-1.png": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance", "CC-12.G.1-2.png": "Telemetry showing powershell.exe executing reg.exe with command-line arguments"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-13.C.1-1.png": "Telemetry showing execution of reg.exe and command-line arguments", "MS-13.C.1-2.png": "Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-13.B.3-1.png": "Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on wscript.exe)", "PA-13.B.3-2.png": "Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)", "FE-13.C.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-13-1.png": "Telemetry showing execution of reg.exe and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-13-3.png": "Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-13.C.1-1.png": "Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-13.A.1-2.png": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry", "": "", "MC-13.A.1-1.png": "Telemetry showed powershell.exe executing reg.exe (tainted by parent alert on wscript.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-13.A.1-1.png": "Telemetry showing execution of reg.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-13.C.1-4.png": "Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-13.C.1-2.png": "OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)", "CS-13.C.1-3.png": "OverWatch General Behavior alert indicating reg query was suspicious", "CS-E-8.png": "Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)"}, "Score": 58}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-13.C.1-10.png": "Telemetry showing reg.exe with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire:\u00a0'reg query' via PowerShell to enumerate a specific Registry key", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-13.C.1-1.png": "Telemetry showing process tree with reg.exe and command-line arguments", "": "", "CB-13.C.1-2.png": "Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)"}, "Score": 25}}, "2.H.1": {"F-Secure": {"Detects": ["Enrichment", "General Behavior", "Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-2.H.1-1.png": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance", "CC-2.H.1-2.png": "Telemetry showing reg.exe with command-line arguments", "CC-2.G.2-99.png": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-2.G.2-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg) "}, "Score": 85}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-2.H.1-2.png": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)", "MS-2.H.1-1.png": "Telemetry showing execution sequence for reg.exe with command-line arguments"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-2.H.1-2.png": "Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)", "PA-2.H.1-1.png": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)", "FE-2.H.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)", "FE-2.H.1-2.png": "Excerpt from the Managed Defense Report with additional details about reg"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-4.png": "Telemetry showing reg.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-15.png": "Telemetry showing reg.exe with command-line arguments (tainted by parent Malicious File Detection)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-2.H.1-1.png": "Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment"], "Screenshots": {"": "", "MC-2.A.1-99.png": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery).", "MC-2.A.1-26.png": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)"}, "Score": 37}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.H.1-1.png": "Telemetry showing reg.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (reg query not specifically shown)", "": "", "CS-2.G.1-1.png": "Telemetry showing reg with command-line arguments", "CS-E-3.png": "Email excerpt from the OverWatch team indicating reg query was a reconnaissance command (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-2.H.1-11.png": "Telemetry showing cmd.exe executing reg with command-line arguments", "CR-2.H.1-10.png": "Telemetry within a process tree showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)"}, "Score": 7}, "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-2.H.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments", "": "", "CB-2.H.1-2.png": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}, "Score": 25}}, "17.A.1": {"F-Secure": {"Detects": ["Telemetry", "Enrichment", "General Behavior"], "Screenshots": {"": "", "CC-17.A.1-1.png": "Telemetry showing reg.exe with command-line arguments", "CC-17.A.1-2.png": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance", "CC-17.A.1-3.png": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-17.A.1-2.png": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query", "MS-17.A.1-1.png": "Telemetry showing reg.exe executing with command-line arguments"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"PA-17.A.1-1.png": "Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)", "": "", "PA-17.A.1-3.png": "Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).", "PA-17.A.1-2.png": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-17.A.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-17-1.png": "Telemetry showing reg.exe execution"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"EG-17-2.png": "Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)", "": "", "EG-17-1.png": "Event tree view showing tainted powershell.exe with reg.exe child process"}, "Score": 16}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-17.A.1-1.png": "Telemetry showing powershell.exe executing reg.exe (tainted by the parent \\\"New Windows service created\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-17.A.1-2.png": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)", "MC-17.A.1-9.png": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-17.A.1-4.png": "Threat story graph showing telemetry of reg.exe executing (tainted by prior lateral movement alert by Group ID)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-17.A.1-1.png": "Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-17.A.1-10.png": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-17.A.1-2.png": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)", "CB-17.A.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments"}, "Score": 25}}, "6.A.1": {"F-Secure": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "CC-6.A.1-1.png": "Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon", "CC-6.A.1-2.png": "Telemetry showing reg.exe with command-line arguments"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-6.A.1-2.png": "Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)", "MS-6.A.1-1.png": "Telemetry showing execution sequence for reg.exe with command-line arguments"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-6.A.1-2.png": "Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)", "PA-6.A.1-3.png": "Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)", "PA-6.A.1-1.png": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-6.A.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)", "FE-6.A.1-2.png": "File Write To Named Pipe  alert for write to remote named pipe from reg.exe", "FE-6.A.1-3.png": "Additional details on named pipe alert", "FE-6.A.1-4.png": "Excerpt from the Managed Defense Report with additional details about reg query", "FE-2.A.1-3.png": "Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"RSA-06-1.png": "Telemetry showing reg.exe with command-line arguments", "": ""}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-06-1.png": "Telemetry showing reg with command-line arguments", "EG-06-4.png": "Event tree view of telemetry showing reg with command-line arguments (tainted by parent Process Injection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-6.A.1-2.png": "Telemetry showing PIPEs created (tainted by the parent \\\"Powershell process created\\\" alert)", "": "", "CT-6.A.1-1.png": "Telemetry showing reg.exe with command-line arguments (tainted by the parent \\\"Powershell process created\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment", "General Behavior-Delayed"], "Screenshots": {"MC-6.A.1-11.png": "Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)", "": "", "MC-6.A.1-7.png": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility", "MC-6.A.1-5.png": "General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage"}, "Score": 49}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-6.A.1-1.png": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed-Tainted"], "Screenshots": {"": "", "CS-6.A.1-1.png": "Telemetry showing reg with command-line arguments", "CS-6.A.1-2.png": "OverWatch General Behavior alert identifying reg query as suspicious as well as reg.exe process (tainted by previous detection by orange line indicating medium severity)"}, "Score": 31}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-6.A.1-10.png": "Telemetry showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)"}, "Score": 7}, "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-6.A.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments", "CB-6.A.1-2.png": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}, "Score": 25}}}, "TacticGroup": "Discovery"}, "T1059": {"TechniqueName": "Command-Line Interface", "Steps count": 23, "Steps": {"2.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.A.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.D.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.D.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.E.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.E.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.F.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-20.A.1-4.png": "General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-16.F.1-1.png": "Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.F.1-1.png": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by parent PowerShell alerts)", "MS-16.D.1-4.png": "Parent alert for PowerShell script with suspicious content tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.D.1-5.png": "Parent alert for malicious PowerShell cmdlet tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.D.1-3.png": "Parent alert for PowerShell with suspicious command-line tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment", "Indicator of Compromise"], "Screenshots": {"": "", "PA-16.F.1-3.png": "Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality", "PA-16.F.1-2.png": "Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).", "PA-16.F.1-1.png": "Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, "Score": 42}, "FireEye": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"FE-16.F.1-1.png": "Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)", "": "", "FE-16.F.1-2.png": "Telemetry showing cmd.exe executing autoupdate.vbs"}, "Score": 25}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-6.png": "Telemetry showing cmd.exe and executing autoupdate.vbs as user Kmitnick"}, "Score": 10}, "Endgame": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-16-11.png": "Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)", "EG-16-10.png": "Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "EG-16-9.png": "Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)"}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-16.F.1-3.png": "Telemetry showing wscript.exe execute autoupate.vbs and resulting powershell.exe (tainted by the parent \\\"Powershell executed remote commands\\\" alert)", "CT-16.F.1-2.png": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)", "CT-16.F.1-1.png": "Telemetry showing svchost.exe creating cmd.exe and executing autoupdate.vbs as user Kmitnick", "": ""}, "Score": 7}, "McAfee": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "MC-16.F.1-1.png": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick", "MC-16.F.1-2.png": "Enrichment of wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface)"}, "Score": 25}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.F.1-1.png": "Telemetry showing cmd.exe launching autoupdate.vbs (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CS-16.F.1-2.png": "Telemetry showing wscript.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)", "": "", "CS-16.F.1-1.png": "Telemetry showing cmd.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-16.F.1-13.png": "Parent alert on Malicious PowerShell Command (Invoke-RunAs)", "": "", "CR-16.F.1-11.png": "Telemetry showing cmd.exe executing autoupdate.vbs though wscript.exe (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00a0", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-16.F.1-1.png": "Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob", "CB-16.F.1-3.png": "Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)", "CB-16.F.1-2.png": "Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick"}, "Score": 25}}, "2.F.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.F.3": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.C.2 ": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.G.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.G.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.F.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "7.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "8.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "8.A.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.H.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "4.A.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "6.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "4.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "4.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "4.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Execution"}, "T1007": {"TechniqueName": "System Service Discovery", "Steps count": 7, "Steps": {"12.D.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.D.1-1.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "": ""}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"MS-12.D.1-2.png": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments", "": "", "MS-12.D.1-1.png": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments", "MS-12.A.1-3.png": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\"", "MS-12.E.1-4.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "General Behavior-Tainted"], "Screenshots": {"": "", "PA-12.D.1-1.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)", "PA-12.D.1-3.png": "General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)", "PA-12.D.1-2.png": "Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)"}, "Score": 46}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.D.1-1.png": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-1.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed"], "Screenshots": {"": "", "EG-12-2.png": "Telemetry showing net.exe with command-line arguments", "EG-12-1.png": "Enriched event tree showing enrichment of  net.exe with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)\u00a0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-12.D.1-1.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Script File Created alert)", "": ""}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment", "General Behavior"], "Screenshots": {"": "", "MC-12.A.1-99.png": "General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)", "MC-12.A.1-3.png": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)", "MC-12.A.1-2.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe"}, "Score": 52}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-12.A.1-3.png": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)", "": "", "S1-12.A.1-1.png": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-E-6.png": "Email excerpt from the OverWatch team indicating net start was part of basic reconnaissance activity (General Behavior)", "CS-12.D.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "": ""}, "Score": 34}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"CR-12.D.1-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)", "": "", "CR-12.D.1-1.png": "Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)"}, "Score": 37}, "Procedure": "Empire: 'net start' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-12.A.D.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments"}, "Score": 10}}, "17.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-17.A.1-1.png": "Telemetry showing reg.exe with command-line arguments"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-17.A.1-2.png": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query", "MS-17.A.1-1.png": "Telemetry showing reg.exe query for terminal server setting"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"PA-17.A.1-1.png": "Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)", "": "", "PA-17.A.1-3.png": "Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).", "PA-17.A.1-2.png": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, "Score": 34}, "FireEye": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "FE-17.A.1-1.png": "Telemetry showing reg.exe executing with command-line arguments (tainted by parent Reg Execution alert)"}, "Score": 7}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-17-1.png": "Telemetry showing reg.exe query for terminal server setting"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"EG-17-2.png": "Telemetry from event tree showing reg.exe", "": "", "EG-17-1.png": "Event tree view showing tainted powershell.exe with reg.exe child process"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-17.A.1-1.png": "Telemetry showing powershell.exe executing reg.exe (tainted by the parent \\\"New Windows service created\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment"], "Screenshots": {"": "", "MC-17.A.1-99.png": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP", "MC-17.A.1-2.png": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)", "MC-17.A.1-9.png": "Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry"}, "Score": 37}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-17.A.1-4.png": "Threat story graph showing telemetry of reg.exe with query for terminal server setting (tainted by prior lateral movement alert by Group ID)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-17.A.1-1.png": "Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-17.A.1-20.png": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-17.A.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments"}, "Score": 10}}, "16.J.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.D.1-4.png": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.J.1-1.png": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-16.J.1-2.png": "Enrichment of powershell.exe executing sc.exe as enumeration of services via the command line (tainted by a parent alert on wscript.exe)", "PA-16.J.1-1.png": "Telemetry showing powershell.exe executing sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 19}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-16.J.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-7.png": "Telemetry showing execution of sc.exe to query the AdobeUpdater service on 10.0.0.4 (Creeper)"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-16-14.png": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-16.J.1-1.png": "Enrichment showing powershell.exe executing sc.exe query AdobeUpdater service on Creeper (enriched with condition SC QC Reconnaissance Command, tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-16.J.1-4.png": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)", "": "", "MC-16.J.1-3.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried. "}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.J.1-1.png": "Telemetry showing execution of sc.exe to query AdobeUpdater service on Creeper (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service (Specific Behavior)", "CS-16.J.1-1.png": "Telemetry showing sc.exe execution to query the AdobeUpdater service on Creeper process tree view (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 64}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-16.J.1-10.png": "Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-16.J.1-1.png": "Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper", "": "", "CB-16.H.1-3.png": "Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)"}, "Score": 25}}, "2.D.2": {"F-Secure": {"Detects": ["General Behavior", "Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-2.D.2-3.png": "Telemetry showing net.exe with command-line arguments", "CC-2.D.2-98.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-2.D.2-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) "}, "Score": 70}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-2.D.2-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments", "": "", "MS-2.D.2-2.png": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-2.D.2-1.png": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.D.2-3.png": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 19}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-2.D.2-2.png": "Excerpt from the Managed Defense Report with additional details about net", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)", "FE-2.D.2-1.png": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery) ", "": ""}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-2.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-7.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-2.D.2-1.png": "Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)", "MC-2.B.1-5.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-7.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net start not specifically shown)", "": "", "CS-2.D.2-1.png": "Telemetry showing net with command-line arguments"}, "Score": 7}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-2.D.2-10.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)", "CR-2.B.1-10.png": "Telemetry showing cmd.exe executing net with command-line arguments"}, "Score": 22}, "Procedure": "Cobalt Strike: 'net start' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.D.2-2.png": "Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)", "CB-2.D.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments"}, "Score": 25}}, "2.D.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-2.D.2-1.png": "General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.A.1-4.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe", "MS-2.D.1-1.png": "Telemetry showing execution sequence for sc.exe with command-line arguments", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-2.D.1-1.png": "Telemetry showing cmd.exe executing sc with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-2.D.1-1.png": "Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)", "FE-2.D.1-3.png": "Excerpt from the Managed Defense Report with additional details about sc", "FE-2.D.1-2.png": "Additional details from enrichment of sc.exe", "": ""}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-2.png": "Telemetry showing sc.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-6.png": "Telemetry showing sc.exe with command-line arguments (tainted by parent Malicious File Detection)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-2.D.1-1.png": "Enrichment of sc.exe with condition SC Query Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-1.png": "Process tree within trace detection containing cmd.exe executing the sc.exe (tainted by a parent alert on Resume Viewer.exe)", "MC-2.A.1-23.png": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-6.png": "Telemetry showing sc.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (sc query not specifically shown)", "": "", "CS-E-3.png": "Email excerpt from the OverWatch team indicating sc query was a reconnaissance command (General Behavior)", "CS-2.B.1-1.png": "Telemetry showing sc with command-line arguments"}, "Score": 34}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-2.B.1-10.png": "Telemetry showing cmd.exe executing sc with command-line arguments", "CR-2.D.1-10.png": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'sc query' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.D.1-1.png": "Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)", "CB-2.A-ALL.png": "Telemetry from process tree showing sc.exe with command-line arguments"}, "Score": 25}}, "12.E.1.8": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-12.E.1-2.png": "Telemetry of execution sequence showing Get-Service invocation"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-12.E.1.8-1.png": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-06.png": "Interactive Shell events showing the WinEnum script and the Services function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of services", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.H.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-16.H.1-2.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-16.D.1-1.png": "Telemetry showing powershell.exe executing sc.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.D.1-4.png": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.H.1-1.png": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "General Behavior-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-16.H.1-1.png": "Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)", "PA-16.H.1-3.png": "Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)", "PA-16.H.1-2.png": "General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)"}, "Score": 49}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-16.H.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-7.png": "Telemetry showing execution of sc.exe to query services on 10.0.0.4 (Creeper)"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-16-14.png": "Enrichment of sc.exe execution to query services on Creeper with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)  (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)", "EG-16-12.png": "Telemetry showing sc.exe execution to query services on Creeper"}, "Score": 16}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"CT-16.H.1-1.png": "Enrichment showing powershell.exe executing sc.exe to query services on Creeper (enriched with condition SC Query Reconnaissance Command, tainted by the parent \\\"Powershell executed remote commands\\\" alert)", "": ""}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-16.J.1-4.png": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)", "": "", "MC-16.J.1-3.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.H.1-1.png": "Telemetry showing execution of sc.exe to query services on Creeper (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "CS-16.H.1-1.png": "Telemetry from process tree showing sc.exe execution to query services on Creeper (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service on Creeper (Specific Behavior)"}, "Score": 64}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-16.H.1-10.png": "Telemetry of sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-16.H.1-3.png": "Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)", "CB-16.H.1-2.png": "Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)", "CB-16.H.1-1.png": "Telemetry from process tree showing sc.exe execution for the service query"}, "Score": 25}}}, "TacticGroup": "Discovery"}, "T1222": {"TechniqueName": "File Permissions Modification", "Steps count": 2, "Steps": {"17.B.1": {"F-Secure": {"Detects": ["Telemetry", "Specific Behavior", "General Behavior"], "Screenshots": {"": "", "CC-17.A.1-1.png": "Telemetry showing takeown.exe with command-line arguments", "CC-17.A.1-2.png": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable", "CC-17.A.1-3.png": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}, "Score": 100}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-17.B.1-1.png": "Telemetry showing takeown.exe execution with magnify.exe in command-line arguments", "": "", "MS-17.A.1-2.png": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to takeown.exe"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-17.B.1-2.png": "Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)", "PA-17.B.1-3.png": "Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).", "PA-17.B.1-1.png": "Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-17.B.1-1.png": "Enrichment of takeown.exe with Takeown Execution alert"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-17-1.png": "Telemetry showing takeown.exe execution with magnify.exe in command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-17-1.png": "Telemetry from event tree showing takeown.exe (tainted by parent alerts on powershell.exe)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-17.B.1-1.png": "Telemetry showing powershell.exe executing takeown.exe (tainted by the parent \\\"New Windows service created\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-17.A.1-9.png": "Enrichment of takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory", "MC-17.A.1-1.png": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 22}, "SentinelOne": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "S1-17.A.1-1.png": "Enrichment showing takeown.exe execution (tainted by prior lateral movement alert by Group ID)"}, "Score": 12}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-17.B.1-1.png": "Telemetry from process tree view showing execution of takeown.exe (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed takeown.exe executed to bypass Windows logon (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"CR-17.B.1-10.png": "General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)", "": ""}, "Score": 37}, "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment-Configuration Change"], "Screenshots": {"": "", "CB-17.A.1-2.png": "Enrichment of takeown.exe execution with tag \\\"Permission modifications\\\"", "CB-17.B.1-1.png": "Telemetry from process tree showing takeown.exe with command-line arguments"}, "Score": 22}}, "17.B.2": {"F-Secure": {"Detects": ["Telemetry", "Specific Behavior", "General Behavior"], "Screenshots": {"": "", "CC-17.A.1-1.png": "Telemetry showing icacls.exe with command-line arguments", "CC-17.A.1-2.png": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable", "CC-17.A.1-3.png": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}, "Score": 100}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-17.B.2-1.png": "Telemetry showing icacls.exe execution with magnify.exe in command-line arguments", "MS-17.A.1-2.png": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-17.B.2-1.png": "Telemetry showing powershell.exe executing icacls with command-line arguments (tainted by a parent alert on cmd.exe)", "PA-17.B.2-2.png": "Enrichment of icacls.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."}, "Score": 22}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-17.B.2-1.png": "Enrichment of icacls.exe with Icacls Execution alert"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-17-1.png": "Telemetry showing icacls.exe execution with magnify.exe in command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-17-1.png": "Telemetry from event tree showing icacls.exe (tainted by parent alerts on powershell.exe)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-17.B.2-1.png": "Telemetry showing powershell.exe executing icacls.exe (tainted by the parent \\\"New Windows service created\\\" alert)", "": ""}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-17.A.1-9.png": "Enrichment of icacls.exe with a suspicious indicator that full access permissions were given to certain users", "MC-17.A.1-1.png": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-17.A.1-3.png": "Telemetry showing icacls.exe execution (tainted by prior lateral movement alert by Group ID)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-17.B.2-1.png": "Telemetry from process tree view showing execution of icacls.exe (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed icacls.exe executed to bypass Windows logon (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-17.B.2-10.png": "Telemetry showing icacls.exe executing\u00a0 with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment-Configuration Change"], "Screenshots": {"": "", "CB-17.A.1-2.png": "Enrichment of icacls.exe execution with tag \\\"Permission modifications\\\"", "CB-17.B.2-1.png": "Telemetry from process tree showing icacls.exe with command-line arguments"}, "Score": 22}}}, "TacticGroup": "Defense Evasion"}, "T1036": {"TechniqueName": "Masquerading", "Steps count": 3, "Steps": {"19.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-19.A.1-1.png": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH", "MS-19.A.1-2.png": "Binary reputation and metadata for recycler.exe showing WinRAR information"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-19.A.1-1.png": "Telemetry showing file create/write and hash values of recycler.exe (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-19.A.1-1.png": "Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)", "FE-19.A.1-2.png": "Telemetry showing MD5 hash of recycler.exe"}, "Score": 64}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-19.A.1-1.png": "Telemetry showing the MD5/SHA256 hash value of recycler.exe"}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-19.A.1-1.png": "Telemetry showing file write of recycler.exe with file hashes", "S1-19.A.1-2.png": "Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-19.A.1-2.png": "Telemetry showing SHA256 hash of recycler.exe"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-19.A.1-100.png": "Telemetry showing recycler.exe identified as WinRAR via file metadata (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing filemod creation of recycler.exe", "": "", "CB-19.A.1-2.png": "Binary metadata showing recycler.exe is WinRAR.exe based on digital signature and file version information"}, "Score": 10}}, "16.I.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.I.1-1.png": "Telemetry showing execution sequence of sc.exe AdobeUpdater remote service creation", "MS-16.D.1-4.png": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-16.I.1-5.png": "Telemetry showed execution of sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-16.I.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with related correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-7.png": "Telemetry showing execution of sc.exe to create the AdobeUpdater service and set its description"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-16-14.png": "Telemetry of sc.exe executions to create and set the description of a new service on Creeper (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.I.1-1.png": "Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MC-16.J.1-4.png": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)", "": ""}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.I.1-1.png": "Telemetry showing execution of sc.exe to create the AdobeUpdater service and set the description (partially shown one line above; both tainted by prior threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-16.H.1-3.png": "Telemetry from process tree showing sc.exe execution with the AdobeUpdater service description (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-16.H.1-4.png": "Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-16.I.1-21.png": "Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-16.I.1-2.png": "Telemetry from process tree showing sc.exe execution setting the AdobeUpdater service description", "CB-16.I.1-1.png": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}, "Score": 10}}, "19.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-19.B.1-4.png": "Telemetry showing recycler.exe metadata, which identified it as WinRAR"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-19.B.1-1.png": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression indicating it is WinRAR", "MS-19.A.1-3.png": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-19.B.1-1.png": "Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)", "PA-19.B.1-2.png": "Enrichment of recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading)"}, "Score": 22}, "FireEye": {"Detects": ["General Behavior", "Enrichment", "Enrichment", "General Behavior", "Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-19.B.1-2.png": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)", "FE-19.B.1-3.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.B.1-1.png": "General Behavior alert for Execution from Suspicious Directory", "FE-19.B.1-4.png": "General Behavior alert for File Write To Root Of Recycle Bin", "FE-19.B.1-5.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)", "": ""}, "Score": 162}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-19-1.png": "Telemetry showing execution of recycler.exe with command-line arguments indicating it is WinRAR"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted"], "Screenshots": {"": "", "EG-19-1.png": "Telemetry showing execution of recycler.exe with command-line arguments and creation of old.rar output (tainted by Windows Script Executing PowerShell alert)", "EG-19-4.png": "Specific Behavior alert for the execution of recycler.exe named \\\"Exfiltration-Encrypting Files with WinRar\\\" (tainted by Windows Script Executing PowerShell alert)"}, "Score": 64}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change", "Telemetry-Tainted"], "Screenshots": {"": "", "CT-19.B.1-1.png": "Enrichment showing recycler.exe creating old.rar (enriched with \\\"Data Exfiltration Archiving\\\", tainted by parent \\\"Powershell executed encoded command\\\" alerts)", "CT-19.B.1-3.png": "Telemetry showing recycler.exe with full command-line (tainted by parent \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts)"}, "Score": 16}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-19.A.1-2.png": "Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)", "MC-19.A.1-3.png": "Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)"}, "Score": 7}, "SentinelOne": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "S1-19.A.1-2.png": "Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID", "S1-19.B.1-1.png": "Enrichment showing the execution of recycler.exe with process name identified as \\\"Command line RAR\\\""}, "Score": 12}, "CrowdStrike": {"Detects": ["Specific Behavior-Tainted", "Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-19.B.1-1.png": "Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)", "CS-19.B.1-3.png": "Additional alert details showing recycler.exe was signed by win.rar GmbH", "": ""}, "Score": 124}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-19.B.1-20.png": "Telemetry showing recycler.exe execution\u00a0(tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR", "": "", "CB-19.B.1-5.png": "Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process"}, "Score": 70}}}, "TacticGroup": "Defense Evasion"}, "T1035": {"TechniqueName": "Service Execution", "Steps count": 1, "Steps": {"16.L.1": {"F-Secure": {"Detects": ["Telemetry", "Specific Behavior", "General Behavior"], "Screenshots": {"CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments", "CC-16.D.1-3.png": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}, "Score": 100}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MS-16.D.1-4.png": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.L.1-2.png": "Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)", "MS-16.L.1-3.png": "Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper", "MS-16.L.1-1.png": "Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper"}, "Score": 67}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"PA-16.L.1-1.png": "Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)", "": "", "PA-16.L.1-3.png": "Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution)", "PA-16.L.1-2.png": "Telemetry showing cmd.exe executing update.vbs on 10.0.0.4 (Creeper)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-16.I.1-3.png": "Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)", "FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-8.png": "Telemetry showing the execution of update.vbs on 10.0.0.4 (Creeper)", "RSA-16-9.png": "Telemetry showing the execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper)"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted", "Specific Behavior"], "Screenshots": {"EG-16-15.png": "Specific Behavior alert \\\"Service Command Lateral Movement\\\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)", "EG-16-14.png": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)", "": ""}, "Score": 76}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.L.1-1.png": "Telemetry showing powershell.exe executing sc.exe start AdobeUpdater service on Creeper (tainted by the parent \\\"Powershell executed remote commands\\\" alert)", "CT-16.L.1-2.png": "Telemetry showing AdobeUpdater service starting on Creeper (tainted by the parent \\\"\\\"New Windows service created\\\"\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-16.J.1-4.png": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)", "": "", "MC-16.J.1-3.png": "Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted", "General Behavior"], "Screenshots": {"": "", "S1-16.L.1-1.png": "Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)", "S1-16.G.1-1.png": "Lateral movement alert generated by the remote service start on Creeper"}, "Score": 37}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed execution of update.vbs following the AdobeUpdater service start (Specific Behavior)", "CS-16.L.1-1.png": "Telemetry showing sc start in the process tree view (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 64}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-16.L.1-12.png": "Telemetry showing cmd.exe executing update.vbs", "CR-16.L.1-100.png": "Telemetry showing sc.exe executing the service\u00a0(tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-16.L.1-1.png": "Telemetry from process tree showing sc.exe execution to start the AdobeUpdater service on Creeper"}, "Score": 10}}}, "TacticGroup": "Execution"}, "T1033": {"TechniqueName": "System Owner/User Discovery", "Steps count": 4, "Steps": {"2.B.1": {"F-Secure": {"Detects": ["General Behavior", "Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-2.B.1-99.png": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-2.B.1-2.png": "Telemetry showing cmd.exe executing the echo command", "CC-2.B.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command) "}, "Score": 70}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-2.B.1-1.png": "Telemetry showing execution sequence for echo with command-line arguments", "MS-2.A.1-5.png": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-2.B.1-1.png": "Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.B.1-2.png": "Enrichment of cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery)"}, "Score": 22}, "FireEye": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"FE-2.B.1-3.png": "Excerpt from the Managed Defense Report with additional details about echo", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)", "FE-2.B.1-1.png": "Telemetry showing echo with command-line arguments", "": ""}, "Score": 67}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-1.png": "Telemetry showing echo with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-4.png": "Telemetry showing echo with command-line arguments (tainted by parent Malicious File Detection)", "EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "": "", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-2.B.1-1.png": "Telemetry showing echo with command-line arguments (tainted by the parent Script File Created alert)", "": ""}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-1.png": "Process tree within trace detection containing cmd.exe executing the echo command (tainted by a parent alert on Resume Viewer.exe)", "MC-2.A.1-3.png": "Telemetry showing cmd.exe executing the echo command", "MC-2.A.1-23.png": "Enrichment of echo command with a correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-4.png": "Telemetry showing echo with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (echo not specifically shown)", "": "", "CS-E-3.png": "Email excerpt from the OverWatch team indicating echo was a reconnaissance command (General Behavior)", "CS-2.B.1-1.png": "Telemetry showing echo with command-line arguments"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-2.B.1-100.png": "Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent Injected Shellcode alert)", "": ""}, "Score": 7}, "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-2.B.1-1.png": "Telemetry from process tree showing echo with command-line arguments"}, "Score": 10}}, "20.B.1": {"F-Secure": {"Detects": ["Telemetry", "Enrichment", "General Behavior"], "Screenshots": {"CC-20.A.1-6.png": "Enrichment of whoami.exe with a tag identifying the command as enumeration", "CC-20.A.1-7.png": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)", "CC-20.A.1-5.png": "Telemetry showing the execution of whoami", "": ""}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-20.A.1-1.png": "Execution sequence showing whoami.exe executing from magnify.exe", "MS-20.A.1-4.png": "Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "PA-20.B.1-1.png": "Telemetry showing magnify.exe executing whoami.exe", "PA-20.B.1-2.png": "Enrichment of whoami.exe executing as an enumeration command"}, "Score": 25}, "FireEye": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "FE-20.A.1-5.png": "Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)", "FE-20.A.1-6.png": "Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}, "Score": 22}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-20-1.png": "Telemetry showing whoami.exe execution"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-20-1.png": "Telemetry from event tree showing execution of whoami.exe (tainted by parent alert on magnify.exe)", "EG-20-2.png": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery)\u00a0(tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-20.B.1-1.png": "Telemetry showing magnify.exe executing whoami.exe (tainted by the parent POS Interactive Login Event alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MC-20.A.1-2.png": "Telemetry showing magnify.exe (original name identified as cmd.exe) executing whoami.exe (tainted by a trace detection on magnify.exe)", "MC-20.A.1-3.png": "Specific Behavior alert for the whoami command was executed through a masqueraded tool (magnify.exe)"}, "Score": 67}, "SentinelOne": {"Detects": ["Enrichment"], "Screenshots": {"": "", "S1-20.B.1-1.png": "Enrichment of whoami command (displays logged on user information)"}, "Score": 15}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CS-20.B.1-1.png": "Telemetry from process tree showing magnify.exe child process whoami.exe (tainted by pink line indicating critical severity)", "": ""}, "Score": 7}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-20.B.1-10.png": "Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)"}, "Score": 67}, "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-20.B.1-2.png": "Enrichment of whoami.exe\u00a0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)", "": "", "CB-20.B.1-1.png": "Telemetry from process tree with telemetry showing whoami.exe execution"}, "Score": 25}}, "12.B.1": {"F-Secure": {"Detects": ["Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-12.B.1-1.png": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments", "CC-12.A.1-1.png": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation"}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-12.B.1-1.png": "Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments", "MS-12.A.1-4.png": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process", "MS-12.E.1-4.png": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-12.B.1-1.png": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"FE-12.B.1-1.png": "Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)", "": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-1.png": "Telemetry showing whoami.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed"], "Screenshots": {"": "", "EG-12-2.png": "Telemetry showing whoami.exe with command-line arguments", "EG-12-1.png": "Enriched event tree showing enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-12.B.1-1.png": "Enrichment of whoami.exe with condition Whoami Reconnaissance Command (tainted by parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-12.A.1-3.png": "Telemetry showing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)", "MC-12.A.1-2.png": "Enrichment of whoami.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-12.A.1-3.png": "Telemetry showing whoami.exe with command-line arguments (tainted Group ID not shown but was the search parameter)", "S1-12.A.1-2.png": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting whoami.exe", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["General Behavior-Delayed-Tainted", "Telemetry", "General Behavior-Delayed"], "Screenshots": {"CS-E-6.png": "Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)", "": "", "CS-12.B.1-1.png": "OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 61}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-12.B.1-1.png": "Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)", "CR-12.B.1-2.png": "Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery"}, "Score": 22}, "Procedure": "Empire: 'whoami /all /fo list' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-12.B.1-1.png": "Telemetry from process tree showing whoami.exe with command-line arguments", "CB-12.B.1-2.png": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}, "Score": 25}}, "12.E.1.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Indicator of Compromise"], "Screenshots": {"": "", "PA-12.E.1.1-1.png": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire UserInfo"}, "Score": 20}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"EG-12-E-02.png": "Interactive Shell events showing the WinEnum script and the Get-UserInfo function (does not count as a detection due to manual process of pulling events)", "": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of user information", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1032": {"TechniqueName": "Standard Cryptographic Protocol", "Steps count": 1, "Steps": {"11.B.1": {"F-Secure": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "CC-11.A.1-5.png": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}, "Score": 60}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-11.B.1-3.png": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel", "": "", "MS-11.B.1-4.png": "Telemetry within alert showing decoded command-line arguments containing HTTPS"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["General Behavior-Delayed"], "Screenshots": {"": "", "FE-11.B.1-4.png": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)"}, "Score": 27}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-11-2.png": "Telemetry showing network connections, including over port 443 (does not count as a detection)"}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-11-2.png": "Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert) ", "EG-11-6.png": "Telemetry showing connection to letsencrypt.org"}, "Score": 7}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": "", "MC-11.A.1-5.png": "Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)", "MC-11.B.1-4.png": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)"}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": "", "S1-11.B.1-1.png": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)"}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"CS-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)", "": ""}, "Score": 0}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-11.B.1-11.png": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (tainted by a parent PowerShell alert)", "CR-11.A.1-13.png": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-11.B.1-2.png": "Telemetry showing modloads and certificate check"}, "Score": 10}}}, "TacticGroup": "Command and Control"}, "T1201": {"TechniqueName": "Password Policy Discovery", "Steps count": 1, "Steps": {"12.E.1.3": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-03.png": "Interactive Shell events showing the WinEnum script and the Password Last Changed function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of password policy information", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1016": {"TechniqueName": "System Network Configuration Discovery", "Steps count": 6, "Steps": {"12.A.2": {"F-Secure": {"Detects": ["Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-12.A.2-4.png": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration", "CC-12.A.2-3.png": "Telemetry showing ipconfig.exe with command line arguments"}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-12.A.1-4.png": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process", "MS-12.A.1-2.png": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments", "MS-12.E.1-4.png": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-12.A.2-2.png": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)", "PA-12.A.2-1.png": "Telemetry showing powershell.exe executing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)", "FE-12.A.2-1.png": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-1.png": "Telemetry showing ipconfig.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-12-2.png": "Telemetry showing ipconfig.exe with command-line arguments", "EG-12-1.png": "Event tree view of telemetry showing ipconfig.exe with command-line arguments (tainted by parent PowerShell alerts)"}, "Score": 7}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-12.A.2-1.png": "Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-12.A.1-3.png": "Telemetry showing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)", "MC-12.A.1-2.png": "Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-12.A.1-3.png": "Telemetry showing ipconfig.exe with command-line arguments (tainted Group ID not shown but was the search parameter)", "": "", "S1-12.A.1-1.png": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting ipconfig.exe"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-E-6.png": "Email excerpt from the OverWatch team indicating ipconfig was part of basic reconnaissance activity (General Behavior)", "": "", "CS-12.A.1-2.png": "Telemetry from process tree showing ipconfig.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 34}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"CR-12.A.2-1.png": "Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)", "": ""}, "Score": 22}, "Procedure": "Empire: 'ipconfig /all' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-12.A.2-1.png": "Telemetry from process tree showing ipconfig.exe with command-line arguments", "": "", "CB-12.A.1-1.png": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)"}, "Score": 25}}, "4.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-4.B.1-2.png": "Telemetry showing netsh.exe with command-line arguments"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-4.B.1-1.png": "Telemetry showing execution sequence for netsh.exe with command-line arguments", "MS-4.A.1-2.png": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "PA-4.B.1-2.png": "Enrichment of netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)", "PA-4.B.1-1.png": "Telemetry showing cmd.exe executing netsh with command-line arguments"}, "Score": 25}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-4.B.1-1.png": "Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)", "": "", "FE-4.B.1-2.png": "Excerpt from the Managed Defense Report with additional details about netsh", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-04-1.png": "Telemetry showing netsh.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-04-1.png": "Telemetry from event tree showing netsh with command-line arguments"}, "Score": 10}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-4.B.1-1.png": "Telemetry showing netsh.exe with command-line arguments (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-4.A.1-2.png": "Enrichment of netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules", "MC-4.A.1-10.png": "Process tree within trace detection showing cmd.exe executing netsh.exe (tainted by a parent alert on cmd.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-4.A.1-2.png": "Telemetry showing netsh.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["General Behavior-Delayed", "Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-4.B.1-1.png": "OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious", "CS-E-3.png": "Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)"}, "Score": 64}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-4.B.1-10.png": "Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-4.B.1-1.png": "Telemetry from process tree showing netsh.exe with command-line arguments", "CB-4.B.1-2.png": "Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon"}, "Score": 25}}, "12.A.1": {"F-Secure": {"Detects": ["Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-12.A.1-1.png": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance", "CC-12.A.1-2.png": "Telemetry showing route.exe with command-line arguments"}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-12.A.1-4.png": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process", "MS-12.A.1-1.png": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments", "MS-12.E.1-4.png": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-12.A.1-1.png": "Telemetry showing powershell.exe executing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)", "PA-12.A.1-2.png": "Enrichment of route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)", "FE-12.A.1-1.png": "Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-1.png": "Telemetry showing route.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-12-2.png": "Telemetry showing route.exe with command-line arguments", "EG-12-1.png": "Event tree view of telemetry showing route.exe with command-line arguments (tainted by parent PowerShell alerts)"}, "Score": 7}, "CounterTack": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "CT-12.A.1-1.png": "Enrichment of route.exe with conditions Reconnaissance Tool and Route Spawned with Reconnaissance (tainted by the parent Script File Created alert)"}, "Score": 12}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-12.A.1-3.png": "Telemetry showing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)", "MC-12.A.1-2.png": "Enrichment of route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-12.A.1-3.png": "Telemetry showing route.exe with command-line arguments (tainted Group ID not shown but was the search parameter)", "S1-12.A.1-2.png": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting route.exe", "S1-12.A.1-1.png": "Threat story showing partial tree of activity from the initial compromise alert", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-E-6.png": "Email excerpt from the OverWatch team indicating route print was part of basic reconnaissance activity (General Behavior)", "": "", "CS-12.A.1-1.png": "Telemetry from process tree showing route.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-12.A.1-1.png": "Telemetry showing route.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: 'route print' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"CB-12.A.1-2.png": "Telemetry from process tree showing route.exe with command-line arguments", "": ""}, "Score": 10}}, "2.A.2": {"F-Secure": {"Detects": ["Enrichment", "General Behavior"], "Screenshots": {"CC-2.A.2-2.png": "Enrichment of arp.exe indicating its usage can be a sign of reconnaissance", "": "", "CC-2.A.2-99.png": "General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}, "Score": 45}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.A.1-6.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities", "MS-2.A.1-2.png": "Telemetry showing execution sequence for arp.exe with command-line arguments"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment-Tainted"], "Screenshots": {"PA-2.A.2-1.png": "Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "": "", "PA-2.A.2-3.png": "Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.A.2-2.png": "Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)", "PA-2.A.2-4.png": "Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)", "FE-2.A.1-2.png": "Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)", "FE-2.A.1-5.png": "Excerpt from the Managed Defense Report with additional details about arp.exe execution"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-1.png": "Telemetry showing arp.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "": "", "EG-02-3.png": "Telemetry showing arp.exe with command-line arguments (tainted by parent Malicious File Detection)"}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-2.A.2-1.png": "Telemetry showing arp.exe with command-line arguments (tainted by the parent Script File Created alert) "}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-1.png": "Telemetry showing cmd.exe executing arp.exe (tainted by a trace detection on Resume Viewer.exe)", "MC-2.A.1-23.png": "Enrichment of arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.2-1.png": "Telemetry showing arp.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (arp not specifically shown)", "": "", "CS-2.A.2-1.png": "Telemetry showing arp with command-line arguments", "CS-E-3.png": "Email excerpt from the OverWatch team indicating arp was a reconnaissance command (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-2.A.2-10.png": "Telemetry showing arp.exe executing within the process tree (tainted by a parent Injected Shellcode alert)", "CR-2.B.1-10.png": "Telemetry showing cmd.exe executing arp with command-line arguments", "CR-2.A.2-5.png": "Telemetry showing cmd.exe executing arp with command-line arguments"}, "Score": 7}, "Procedure": "Cobalt Strike: 'arp -a' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.A.2-2.png": "Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)", "CB-2.A.2-1.png": "Telemetry from process tree showing arp.exe with command-line arguments"}, "Score": 25}}, "2.A.1": {"F-Secure": {"Detects": ["General Behavior", "Enrichment", "General Behavior"], "Screenshots": {"CC-2.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig) ", "": "", "CC-2.A.1-99.png": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-2.A.1-2.png": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration"}, "Score": 75}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.A.1-4.png": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of discovery techniques", "MS-2.A.1-1.png": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment-Tainted", "General Behavior-Tainted"], "Screenshots": {"PA-2.A.1-2.png": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)", "PA-2.A.1-3.png": "Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.A.1-1.png": "Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.A.1-4.png": "General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "": ""}, "Score": 61}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-2.A.1-4.png": "Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)", "FE-2.A.1-1.png": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)", "": ""}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-1.png": "Telemetry showing ipconfig.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["General Behavior-Tainted", "Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-1.png": "Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)", "EG-02-2.png": "Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)", "": ""}, "Score": 55}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-2.A.1-1.png": "Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-1.png": "Telemetry showing cmd.exe executing ipconfig.exe (tainted by a trace detection on Resume Viewer.exe)", "MC-2.A.1-23.png": "Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-2.A.1-3.png": "Telemetry showing ipconfig.exe with command-line arguments (tainted by relationship to threat story)", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (ipconfig not specifically shown)", "": "", "CS-2.A.1-2.png": "Telemetry showing ipconfig with command-line arguments", "CS-E-3.png": "Email excerpt from the OverWatch team indicating ipconfig was a reconnaissance command (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"CR-2.A.1-10.png": "Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)", "": "", "CR-2.B.1-10.png": "Telemetry showing cmd.exe executing ipconfig with command-line arguments"}, "Score": 22}, "Procedure": "Cobalt Strike: 'ipconfig /all' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.A.1-1.png": "Telemetry from process tree showing ipconfig.exe with command-line arguments", "CB-2.A.1-2.png": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)"}, "Score": 25}}, "12.E.1.11": {"F-Secure": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CC-12.E.1-3.png": "Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-12.E.1-2.png": "Telemetry of execution sequence showing Get-NetInfo invocation"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Indicator of Compromise"], "Screenshots": {"": "", "PA-12.E.1.11-1.png": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire NetInfo"}, "Score": 20}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-10.png": "Interactive Shell events showing the WinEnum script and the Network Adapters function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.E.1-3.png": "Additional telemetry showing powershell.exe WMI queries for network adapter and configuration information", "S1-12.E.1-2.png": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of network adapters", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1204": {"TechniqueName": "User Execution", "Steps count": 1, "Steps": {"1.A.1": {"F-Secure": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"": "", "CC-1.A.1-4.png": "Telemetry showing the execution of Resume Viewer.exe"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"MS-1.A.1-8.png": "Exploit Guard audit of Resume Viewer.exe", "MS-1.A.1-4.png": "Telemetry showing execution of pdfhelper.cmd and update.dat", "MS-1.A.1-5.png": "Telemetry showing execution of decoy PDF by MicrosoftPdfReader.exe", "MS-1.A.1-6.png": "Telemetry showing Resume Viewer.exe binary and process metadata", "MS-1.A.1-7.png": "Telemetry showing Resume Viewer.exe binary reputation", "MS-1.A.1-1.png": "Telemetry showing execution of Resume Viewer.exe from explorer.exe and dropping pdfhelper.cmd and autoupdate.bat", "MS-1.A.1-2.png": "Telemetry showing write of pdfhelper.cmd", "MS-1.A.1-3.png": "Telemetry showing write of autoupdate.bat"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"PA-1.A.1-1.png": "Telemetry showing Resume Viewer.exe running as a process", "": ""}, "Score": 10}, "FireEye": {"Detects": ["General Behavior-Configuration Change", "Telemetry"], "Screenshots": {"": "", "FE-1.A.1-5.png": "Telemetry showing Resume Viewer.exe being executed by explorer.exe", "FE-1.A.1-1.png": "General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)"}, "Score": 37}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-01-1.png": "Telemetry showing Resume Viewer.exe execution"}, "Score": 10}, "Endgame": {"Detects": ["General Behavior", "Telemetry-Tainted"], "Screenshots": {"": "", "EG-01-2.png": "Event tree view showing Malicious File Detection General Behavior alert on Resume Viewer.exe execution", "EG-01-1.png": "Malicious File Detection General Behavior alert on Resume Viewer.exe execution and surrounding telemetry"}, "Score": 37}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-1.A.1-2.png": "Telemetry showing Resume Viewer.exe running (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-1.A.1-1.png": "Telemetry showing that Resume Viewer.exe was executed by Explorer.exe by user Debbie"}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "S1-1.A.1-1.png": "Telemetry from process tree showing execution of Resume Viewer.exe", "S1-1.A.1-2.png": "General Behavior alert for execution of Resume Viewer.exe as a suspicious file"}, "Score": 40}, "CrowdStrike": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"": "", "CS-1.A.1-1.png": "Machine Learning General Behavior alert showing execution of Resume Viewer.exe and detection as malicious"}, "Score": 40}, "Cybereason": {"Detects": ["General Behavior", "General Behavior", "Telemetry-Tainted"], "Screenshots": {"CR-1.A.1-11.png": "General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file", "CR-1.A.1-10.png": "General Behavior alert identifying Resume Viewer.exe as unknown malware", "CR-1.A.1-100.png": "Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)", "": ""}, "Score": 67}, "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "CarbonBlack": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CB-1.A.1-2.png": "Telemetry from process tree showing Resume Viewer.exe execution sequence", "CB-1.A.1-1.png": "General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application"}, "Score": 40}}}, "TacticGroup": "Execution"}, "T1039": {"TechniqueName": "Data from Network Shared Drive", "Steps count": 2, "Steps": {"18.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"CC-18.A.1-3.png": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin", "": ""}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": "", "MS-18.B.1-1.png": "Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)"}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted"], "Screenshots": {"PA-18.B.1-1.png": "Telemetry showing a file event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) (tainted by a parent alert on wscript.exe)", "": "", "PA-18.B.1-2.png": "Specific Behavior alert for a script engine reading files from network locations (tainted by a parent alert on wscript.exe)"}, "Score": 64}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-18.B.1-1.png": "Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-18.B.1-1.png": "Exported telemetry of threat story (taints event) showing .vsdx file copy from network shared drive on Conficker"}, "Score": 7}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "9.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-9.B.1-1.png": "Telemetry showing a file read event for the .vsdx file from the network shared drive"}, "Score": 10}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-09-3.png": "Telemetry showing .vsdx file creation, but no indication of network shared drive (does not count as a detection)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": "", "S1-9.B.1-1.png": "Telemetry showing .vsdx file access from WormShare on the network shared drive"}, "Score": 10}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": "", "CR-9.B.1-20.png": "Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)"}, "Score": 0}, "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "collection"}, "T1055": {"TechniqueName": "Process Injection", "Steps count": 4, "Steps": {"3.C.1": {"F-Secure": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "CC-3.C.1-1.png": "Specific Behavior alert for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection"}, "Score": 60}, "Microsoft": {"Detects": ["Enrichment-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"MS-3.C.1-4.png": "Telemetry showing process injection activity audited by Exploit Guard", "": "", "MS-3.C.1-1.png": "Enrichment of powershell.exe injecting into cmd.exe", "MS-3.C.1-2.png": "Alert for \\'Suspicious PowerShell command-line\\' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)", "MS-3.C.1-3.png": "Specific Behavior alert showing powershell.exe process injection"}, "Score": 69}, "PaloAltoNetworks": {"Detects": ["Specific Behavior-Tainted"], "Screenshots": {"PA-3.C.1-1.png": "Specific Behavior alert for PowerShell injecting shellcode (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "": ""}, "Score": 57}, "FireEye": {"Detects": ["Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-3.C.1-2.png": "Continued excerpt from the Managed Defense Report showing the artifact evidence of a process injection from PowerShell.exe to cmd.exe", "FE-3.C.1-1.png": "Excerpt from the Managed Defense Report identifying a process injection from PowerShell.exe to cmd.exe (Specific Behavior)"}, "Score": 57}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-03-2.png": "Telemetry showing powershell.exe creating a remote thread into cmd.exe"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "EG-03-2.png": "Specific Behavior alert for process injection into cmd.exe"}, "Score": 60}, "CounterTack": {"Detects": ["Specific Behavior-Tainted"], "Screenshots": {"": "", "CT-3.C.1-1.png": "Specific Behavior alert for DLL injection detection labeled with Process Hijacking and Privilege Escalation (tainted by the parent \\\"Powershell process created\\\" alert)"}, "Score": 57}, "McAfee": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "MC-3.C.1-1.png": "Specific Behavior alert \u00a0for\u00a0a process injection from PowerShell into cmd.exe based on both connecting to a named pipe, tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)"}, "Score": 60}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-3.C.1-2.png": "Telemetry showing powershell.exe injecting into cmd.exe (Group ID tainted this event but was not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Specific Behavior-Tainted", "Telemetry", "General Behavior-Delayed-Tainted"], "Screenshots": {"CS-3.C.1-2.png": "Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)", "": "", "CS-3.C.1-1.png": "Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious"}, "Score": 91}, "Cybereason": {"Detects": ["Specific Behavior-Tainted"], "Screenshots": {"": "", "CR-3.C.1-10.png": "Specific Behavior alert for powershell.exe injecting into cmd.exe", "CR-3.C.1-100.png": "Specific Behavior alert for PowerShell injection into cmd.exe mapped to ATT&CK Tactic (Defense Evasion) and Technique (Process Injection) (tainted by a parent PowerShell alert)"}, "Score": 57}, "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"CB-3.C.1-3.png": "Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe", "CB-3.C.1-2.png": "Telemetry showing open handles and thread injection into cmd.exe", "CB-3.C.1-1.png": "Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)", "": ""}, "Score": 70}}, "8.D.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["Enrichment"], "Screenshots": {"": "", "MS-8.D.1-2.png": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"}, "Score": 15}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-8.D.1-2.png": "Enrichment of cmd.exe injecting into explorer.exe as code injection via CreateThread"}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-08-4.png": "Floating Code module generated from DLL injection showing introspection into the module's characteristics (does not count as a detection)"}, "Score": 0}, "Endgame": {"Detects": ["Specific Behavior-Tainted"], "Screenshots": {"": "", "EG-08-3.png": "Event tree showing process injection Specific Behavior alert (last alert in the view, ID 2561310) (tainted by parent Malicious File Detection and process injection alerts and labeled with the correct ATT&CK Technique, Process Injection, and Tactics, Defense Evasion and Execution)"}, "Score": 57}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-8.D.1-1.png": "Telemetry showing remote thread being created into explorer.exe"}, "Score": 10}, "McAfee": {"Detects": ["Specific Behavior-Tainted"], "Screenshots": {"": "", "MC-8.D.1-9.png": "Specific Behavior alert for code injection into explorer.exe, tagged with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection)", "MC-8.D.1-1.png": "Specific Behavior alert for code injection into explorer.exe (tainted by a trace detection on cmd.exe)"}, "Score": 57}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-8.D.1-1.png": "Telemetry showing powershell.exe injecting into explorer.exe (Group ID tainted this event but was not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"CS-8.D.1-2.png": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890)", "": ""}, "Score": 10}, "Cybereason": {"Detects": ["Specific Behavior"], "Screenshots": {"CR-8.D.1-20.png": "Specific Behavior alert for Malicious code injection to explorer.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)", "CR-8.D.1-21.png": "Specific Behavior alert for process injection explorer.exe rolled into chain of injections", "": ""}, "Score": 60}, "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-8.D.1-1.png": "Telemetry showing \\\"open handle\\\" crossproc on explorer.exe by the process"}, "Score": 10}}, "5.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-5.A.1-1.png": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe", "MS-5.A.1-3.png": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe", "MS-5.A.2-2.png": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "PA-5.A.1-1.png": "A Specific Behavior alert for a suspicious handle being opened to lsass.exe, tagged with a related ATT&CK Technique (Credential Dumping)"}, "Score": 60}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-05-1.png": "Telemetry showing process accesses into lsass.exe"}, "Score": 10}, "CounterTack": {"Detects": ["General Behavior"], "Screenshots": {"CT-5.A.1-1.png": "General Behavior alert showing DDNA Scan for svchost.exe", "": "", "CT-5.A.1-3.png": "General Behavior alert additional details on DDNA Scan for svchost.exe, including that it appears to inject code into another process", "CT-5.A.1-2.png": "General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process"}, "Score": 30}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Enrichment"], "Screenshots": {"": "", "CS-5.A.1-8.png": "Enrichment showing ReflectiveDllOpenLsass and ProcessHollowingDetected events"}, "Score": 15}, "Cybereason": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "CR-5.A.1-11.png": "Specific Behavior alert with correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)", "CR-5.A.1-21.png": "Data within alert showing loaded powerkatz.dll as floating executable code"}, "Score": 60}, "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-5.A.1-1.png": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}, "Score": 10}}, "5.A.2": {"F-Secure": {"Detects": ["Enrichment"], "Screenshots": {"": "", "CC-5.A.2-1.png": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection"}, "Score": 15}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-5.A.1-1.png": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe", "MS-5.A.2-1.png": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe", "MS-5.A.2-2.png": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-5.A.1-2.png": "Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)"}, "Score": 7}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "EG-05-2.png": "Telemetry showing process injection into lsass.exe (tainted by parent Process Injection alert)", "EG-05-5.png": "Specific Behavior alert mapped to the correct ATT&CK Technique (Process Injection)"}, "Score": 67}, "CounterTack": {"Detects": ["Specific Behavior-Tainted", "General Behavior"], "Screenshots": {"CT-5.A.2-2.png": "Specific Behavior alert showing process hijacking detection for lsass.exe thread create (tainted by the parent \\\"Powershell process created\\\" and \\\"Policy Remote Process Compromise\\\" alerts)", "CT-5.A.2-3.png": "General Behavior alert showing DDNA Scan for svchost.exe", "": "", "CT-5.A.2-5.png": "General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process"}, "Score": 87}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-5.A.2-1.png": "Telemetry showing powershell.exe invoking a remote thread into lsass.exe (Group ID tainted this event but was not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Enrichment"], "Screenshots": {"CS-5.A.2-5.png": "Enrichment showing ReflectiveDllOpenLsass, ProcessHollowingDetected, and LsassInjectedCode events", "": ""}, "Score": 15}, "Cybereason": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "CR-5.A.2-10.png": "Specific Behavior alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection", "CR-5.A.2-20.png": "Details of Specific Behavior alert for svchost.exe process injection into lsass.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)", "CR-5.A.2-11.png": "Data within alert showing loaded hashdumpx64.dll as floating executable code"}, "Score": 60}, "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"CB-5.A.2-4.png": "Specific Behavior alert showing correct ATT&CK Technique (Process Injection)", "": "", "CB-5.A.2-1.png": "Alert showing correct ATT&CK Technique (Process Injection) within process tree", "CB-5.A.2-2.png": "Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe"}, "Score": 70}}}, "TacticGroup": "Defense Evasion, Privilege Escalation"}, "T1018": {"TechniqueName": "Remote System Discovery", "Steps count": 3, "Steps": {"13.A.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-13.A.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"MS-13.A.1-2.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments", "MS-13.A.1-3.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)", "MS-13.A.1-1.png": "Telemetry showing execution of net.exe with command-line arguments", "": ""}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-13.A.1-1.png": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)", "PA-13.A.1-2.png": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 19}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-13.A.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-13-1.png": "Telemetry showing execution of net.exe and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-13-2.png": "Telemetry from event tree showing with net.exe with command-line arguments (tainted by parent alert)", "EG-13-3.png": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery) (tainted by parent alert)"}, "Score": 16}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"CT-13.A.1-1.png": "Enrichment of net.exe with condition Net Group Reconnaissance Command (tainted by the parent Script File Created alert)", "": ""}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-13.A.1-2.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers", "": "", "MC-13.A.1-1.png": "Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-13.A.1-1.png": "Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-13.A.1-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-13.A.1-2.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)"}, "Score": 46}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"CR-13.A.1-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)", "": "", "CR-13.A.1-10.png": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 37}, "Procedure": "Empire: 'net group \"Domain Computers\" /domain' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-13.A.1-2.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)", "CB-13.A.1-1.png": "Telemetry showing process tree with net.exe and command-line arguments"}, "Score": 25}}, "4.A.1": {"F-Secure": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "CC-4.A.1-2.png": "Telemetry showing net.exe with command-line arguments", "CC-4.A.1-1.png": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-4.A.1-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments", "MS-4.A.1-2.png": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment", "Enrichment", "Enrichment"], "Screenshots": {"": "", "PA-4.A.1-1.png": "Telemetry showing cmd.exe executing net with command-line arguments", "PA-4.A.1-2.png": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1", "PA-4.A.1-3.png": "Enrichment of the execution of net.exe as the execution of an enumeration command", "PA-4.A.1-4.png": "Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)"}, "Score": 55}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)", "FE-4.A.1-2.png": "Excerpt from the Managed Defense Report with additional details about net group", "FE-4.A.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-04-1.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry", "Enrichment-Delayed"], "Screenshots": {"": "", "EG-04-2.png": "Enriched event tree showing enrichment of net with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery)", "EG-04-1.png": "Telemetry from event tree showing net with command-line arguments"}, "Score": 22}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-4.A.1-1.png": "Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-4.A.1-2.png": "Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers", "MC-4.A.1-10.png": "Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-4.A.1-1.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["Enrichment", "Telemetry", "General Behavior-Delayed", "General Behavior-Delayed"], "Screenshots": {"CS-4.A.1-3.png": "OverWatch General Behavior alert for net group", "CS-4.A.1-2.png": "Additional process tree view showing net.exe enrichment", "CS-4.A.1-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)", "": ""}, "Score": 79}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-4.A.1-101.png": "Telemetry showing net.exe executing with command-line arguments", "CR-4.A.1-100.png": "General Behavior alert for net.exe executing as part of a suspicious execution chain", "CR-4.A.1-10.png": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}, "Score": 37}, "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" /domain' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-4.A.1-2.png": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)", "": "", "CB-4.A.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments"}, "Score": 25}}, "4.A.2": {"F-Secure": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "CC-4.A.1-2.png": "Telemetry showing net.exe with command-line arguments", "CC-4.A.1-1.png": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-4.A.1-2.png": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)", "MS-4.A.2-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "PA-4.A.2-2.png": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 ", "PA-4.A.2-1.png": "Telemetry showing cmd.exe executing net with command-line arguments"}, "Score": 25}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-4.A.2-2.png": "Excerpt from the Managed Defense Report with additional details about net group", "FE-4.A.2-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-04-1.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry", "Enrichment-Delayed"], "Screenshots": {"": "", "EG-04-2.png": "Enriched event tree showing enrichment of net group command mapped to related ATT&CK Technique (T1069 - Permission Groups Discovery) and\u00a0correct Tactic (Discovery) ", "EG-04-1.png": "Telemetry from event tree showing net with command-line arguments"}, "Score": 22}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-4.A.2-1.png": "Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-4.A.1-2.png": "Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers", "MC-4.A.1-10.png": "Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-4.A.1-3.png": "Event tree showing net.exe (tainted by launch from process lineage previously identified as malicious)", "S1-4.A.1-2.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Enrichment", "Telemetry", "General Behavior-Delayed", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-4.A.2-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)", "CS-4.A.2-2.png": "Additional process tree view showing net.exe enrichment", "CS-4.A.2-3.png": "OverWatch General Behavior alert for net group ", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, "Score": 79}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-4.A.2-10.png": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)", "CR-4.A.1-101.png": "Telemetry showing net.exe executing with command-line arguments", "CR-4.A.2-100.png": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, "Score": 37}, "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" /domain' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-4.A.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "": "", "CB-4.A.2-2.png": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}, "Score": 25}}}, "TacticGroup": "Discovery"}, "T1071": {"TechniqueName": "Standard Application Layer Protocol", "Steps count": 4, "Steps": {"6.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"CC-6.B.1-2.png": "Telemetry showing rundll32 making HTTP connections", "": ""}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"PA-6.B.1-1.png": "Telemetry showing port 80 command and control traffic as well as the loading of winhttp.dll", "": ""}, "Score": 10}, "FireEye": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-6.B.1-4.png": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)", "FE-6.B.1-3.png": "Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)"}, "Score": 37}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-6.B.1-2.png": "Telemetry showing outbound C2 traffic over HTTP to www.freegoogleadsense.info (C2 domain)"}, "Score": 10}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-6.B.1-2.png": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)", "MC-6.B.1-22.png": "Telemetry showing that the winhttp.dll module was loaded into the process (PID 6276) that made the network connection"}, "Score": 10}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "CR-6.B.1-30.png": "Enrichment of rundll32.exe making an unusual network connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol) (tainted by a parent Injected Shellcode alert)", "CR-6.B.1-100.png": "Enrichment of rundll32.exe showing connection over port 80 and the amount of transmitted/received bytes (tainted by a parent Injected Shellcode alert)", "CR-6.B.1-101.png": "Enrichment of rundll32.exe showing winhttp.dll module loaded (tainted by a parent Injected Shellcode alert)"}, "Score": 12}, "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-6.B.1-2.png": "Telemetry showing network connection over TCP port 80 to the C2 domain (could be used in conjunction with modload to determine protocol)", "CB-6.B.1-8.png": "Telemetry showing modloads showing winhttp.dll loaded"}, "Score": 10}}, "1.C.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-1.C.1-T1071-new.png": "Telemetry showing rundll32 making DNS queries"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Configuration Change"], "Screenshots": {"": "", "MS-1.C.1-1.png": "Telemetry showing DNS requests to the C2 domain (custom query)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["Indicator of Compromise", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-1.C.1-2.png": "Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)", "FE-1.C.1-5.png": "Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)"}, "Score": 77}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-01-6.png": "Telemetry showing DNS connections", "EG-01-5.png": "Telemetry showing DNS requests from rundll32.exe (tainted by parent Malicious File Detection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-1.C.1-1.png": "Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe"}, "Score": 10}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-1.C.1-1.png": "Telemetry showing DNS requests to the C2 domain (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Specific Behavior", "General Behavior-Delayed", "Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "CS-E-4.png": "Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)", "CS-1.C.1-1.png": "Telemetry showing DNS requests", "CS-1.C.1-2.png": "Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious"}, "Score": 154}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-1.C.1-20.png": "Telemetry showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)", "CR-1.C.1-100.png": "Process tree showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}, "Score": 7}, "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "14.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-14.A.1-2.png": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-14.A.1-4.png": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": "", "PA-14.A.1-5.png": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}, "Score": 0}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"FE-14.A.1-4.png": "Enrichment of HTTP GET request with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)", "": ""}, "Score": 15}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-14-1.png": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"EG-14-1.png": "Telemetry showing decoded PowerShell with download request of wdbypass over port 8080", "": ""}, "Score": 10}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-14.A.1-2.png": "Telemetry showing port 8080  HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["None"], "Screenshots": {"": "", "MC-14.A.1-1.png": "Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)"}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"CS-14.A.1-7.png": "Decoded PowerShell (outside of capability) showing download request over HTTP (does not count as a detection)", "CS-14.A.1-6.png": "Telemetry showing encoded PowerShell command that decodes to show HTTP traffic (does not count as a detection)", "": ""}, "Score": 0}, "Cybereason": {"Detects": ["Specific Behavior-Tainted"], "Screenshots": {"": "", "CR-14.A.1-40.png": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080", "CR-14.A.1-30.png": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol) (tainted by a parent PowerShell alert)"}, "Score": 57}, "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "11.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-11.A.1-5.png": "An alert for PowerShell downloading a significant amount of data using HTTP(S) (does not count as a detection since it was based on port)", "CC-11.B.1-T1071-new.png": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Indicator of Compromise-Configuration Change"], "Screenshots": {"MS-11.B.1-3.png": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel", "MS-11.B.1-2.png": "Alert\u00a0for C2 domain indicator of compromise\u00a0", "": "", "MS-11.B.1-4.png": "Telemetry within alert showing decoded command-line arguments containing HTTPS"}, "Score": 24}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["General Behavior-Delayed"], "Screenshots": {"": "", "FE-11.B.1-4.png": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)"}, "Score": 27}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-11-2.png": "Telemetry showing network connections, including over port 443"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-11-2.png": "Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert) ", "EG-11-6.png": "Telemetry showing connection to letsencrypt.org"}, "Score": 7}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": "", "MC-11.A.1-5.png": "Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)", "MC-11.B.1-4.png": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)"}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": "", "S1-11.B.1-1.png": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)"}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"CS-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)", "": ""}, "Score": 0}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-11.B.1-11.png": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (does not count as a detection)", "CR-11.A.1-13.png": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-11.B.1-2.png": "Telemetry showing modloads and certificate check"}, "Score": 10}}}, "TacticGroup": "Command and Control"}, "T1135": {"TechniqueName": "Network Share Discovery", "Steps count": 2, "Steps": {"12.E.1.9.2": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-12.E.1.9-1.png": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-07.png": "Interactive Shell events showing the WinEnum script and the Mapped Network Drives function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.E.1-3.png": "Additional telemetry showing powershell.exe WMI queries for logical disk information", "S1-12.E.1-2.png": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.E.1.9.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-12.E.1.9-1.png": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-06.png": "Interactive Shell events showing the WinEnum script and the Available Shares function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of available shares", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1132": {"TechniqueName": "Data Encoding", "Steps count": 1, "Steps": {"1.C.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-1.C.1-T1071-new.png": "Telemetry showing rundll32 making encoded DNS queries"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "FE-1.C.1-2.png": "Telemetry showing encoded DNS requests (tainted by parent Cobalt Strike DNS Beacon alert)"}, "Score": 7}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-1.C.1-2.png": "Telemetry showing stream of DNS requests with encoded data", "S1-1.C.1-1.png": "Telemetry showing DNS query for freegoogleadsenseinfo.com (C2 domain) (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-1.C.1-2.png": "Telemetry within an alert showing encoded DNS requests (tainted by parent Exfiltration alert)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-1.C.1-20.png": "Telemetry showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)", "CR-1.C.1-100.png": "Process tree showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}, "Score": 7}, "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Command and Control"}, "T1076": {"TechniqueName": "Remote Desktop Protocol", "Steps count": 3, "Steps": {"20.A.1": {"F-Secure": {"Detects": ["Enrichment"], "Screenshots": {"": "", "CC-20.A.1-2.png": "Enrichment of a Remote Desktop connection indicating a successful login to Remote Desktop Services. "}, "Score": 15}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-20.A.1-2.png": "Telemetry showing svchost.exe starting terminal service session on Creeper from CodeRed (10.0.1.5)", "MS-20.A.1-3.png": "Telemetry showing Kmitnick RDP logon from CodeRed to Creeper"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-20.A.1-2.png": "Telemetry showing an inbound connection to Creeper (10.0.0.4) on port 3389"}, "Score": 10}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-20.A.1-1.png": "Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)", "": "", "FE-20.A.1-2.png": "Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-20-3.png": "Telemetry showing connection to Creeper (10.0.0.4) on port 3389"}, "Score": 10}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-20.A.1-1.png": "Telemetry showing connection to Creeper (10.0.0.4) on port 3389"}, "Score": 10}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-20.A.1-3.png": "Telemetry showing logon type 10 (remote interactive logon) for Kmitnick on Creeper"}, "Score": 10}, "Cybereason": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "CR-20.A.1-20.png": "Telemetry of connection to port 3389 on Creeper (10.0.0.4)", "CR-20.A.1-21.png": "Enrichment of RDP connection to\u00a0Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)"}, "Score": 25}, "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "6.C.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-6.C.1-T1076-new.png": "Telemetry showing rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-6.C.1-4.png": "Graph showing movement from Debbie account to George", "MS-6.C.1-1.png": "Telemetry showing execution sequence for cmd.exe connection over RDP to 10.0.0.5 (Conficker)", "MS-6.C.1-3.png": "Telemetry showing user logon activity on 10.0.0.5 (Conficker) showing George with a logon type 10 RemoteInteractive logon event", "MS-6.C.1-2.png": "Telemetry showing execution sequence on 10.0.0.5 (Conficker) showing George logon"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "General Behavior-Tainted"], "Screenshots": {"": "", "PA-6.C.1-1.png": "\nTelemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent process injection alert on cmd.exe)", "PA-6.C.1-2.png": "General Behavior alert for an unexpected process using the RDP port (tainted by a parent process injection alert on cmd.exe)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-6.C.1-1.png": "Enrichment of RDP connection from rundll32.exe with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-06-3.png": "Telemetry showing cmd.exe connecting over port 3389 (RDP) to 10.0.0.5 (Conficker)"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-06-3.png": "Telemetry showing Type 10 (interactive remote) login event by user George on Conficker", "EG-06-4.png": "Event tree view of telemetry showing port 3389 connection to 10.0.0.5 (Conficker) (tainted by parent Process Injection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change", "Telemetry"], "Screenshots": {"": "", "CT-6.C.1-1.png": "Enrichment of outbound TCP port 3389 (RDP) connection with Lateral Movement and Remote Share Access (tainted by parent \\\"Windows command prompt invoked\\\" alert)", "CT-6.C.1-2.png": "Telemetry showing inbound TCP port 3389 connection to 10.0.0.5 (Conficker)"}, "Score": 19}, "McAfee": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "MC-6.C.1-1.png": "Telemetry showing a connection to 10.0.0.5 (Conficker) over TCP port 3389", "MC-6.C.1-2.png": "Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol)"}, "Score": 25}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-6.C.1-1.png": "Telemetry showing port 3389 connection (tainted by relationship to threat story shown in Group ID)", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"CS-6.C.1-3.png": "Telemetry showing logon type 10 (interactive remote login) as user George@shockwave on 10.0.0.5 (Conficker)", "": "", "CS-6.C.1-5.png": "Telemetry showing a network connection to 10.0.0.5 (Conficker) over TCP port 3389", "CS-E-1.png": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)"}, "Score": 37}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-6.B.1-20.png": "Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent Injected Shellcode alert, listed as Owner process)", "": "", "CR-6.C.1-10.png": "Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type", "CR-6.C.1-11.png": "Telemetry showing rdpclip.exe executing on 10.0.0.5 (Conficker)"}, "Score": 7}, "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-6.C.1-3.png": "Telemetry showing rdpclip.exe running", "CB-6.B.1-1.png": "Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)", "CB-6.C.1-1.png": "Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)"}, "Score": 25}}, "10.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-10.B.1-T1076-new.png": "Telemetry showing a RemoteInteractive connection over port 3389 to Conficker (10.0.0.5)"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-10.B.1-2.png": "Telemetry showing successful port 3389 connection to Conficker (10.0.0.5)"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "PA-10.B.1-3.png": "Enrichment of the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol)", "PA-10.B.1-2.png": "Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389"}, "Score": 25}, "FireEye": {"Detects": ["Enrichment", "Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-10.B.1-4.png": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker", "FE-10.B.1-3.png": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)", "FE-10.B.1-1.png": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, "Score": 82}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-10-7.png": "Telemetry showing remote connections over port 3389 to 10.0.0.5 (Conficker)", "EG-10-6.png": "Telemetry showing Type 10 (interactive) logon for Jesse"}, "Score": 10}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-10.B.1-2.png": "Enrichment of TCP port 3389 (RDP) connection to 10.0.0.5 (Conficker) with conditions Lateral Movement and Remote Share Access (tainted by the parent \\\"Windows command prompt invoked\\\" alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-10.A.1-1.png": "Enrichment of the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol)", "": "", "MC-10.B.1-3.png": "Telemetry showing a connection over port 3389 to Conficker (10.0.0.5) (tainted by parent alert on rundll32.exe)", "MC-10.B.1-1.png": "Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-10.B.1-2.png": "Threat group identified as malicious, including rundll32.exe (PID 184) proxying the port 3389 connection (port 3389 connection not specifically shown in this view, but it identifies the rundll32.exe process tainting the connection by Group ID)", "": "", "S1-10.B.1-1.png": "Telemetry showing connection over port 3389 to 10.0.0.5 (Conficker)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-10.B.1-1.png": "Telemetry showing user logon by Jesse to Conficker with type 10 (interactive logon)", "CS-10.B.1-2.png": "Telemetry showing logged-on user activity, including the use of rdpclip.exe", "CS-E-1.png": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)"}, "Score": 37}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-10.B.1-100.png": "Telemetry showing rundll32.exe process used to proxy connection over port 3389 from Nimda (10.0.1.6) to Conficker (10.0.0.5) (tainted by a parent Injected Shellcode alert)", "CR-10.B.1-10.png": "Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type", "CR-10.B.1-20.png": "Telemetry showing a TCP port 3389 connection to Conficker (10.0.0.5) ", "": ""}, "Score": 7}, "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-10.B.1-2.png": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)", "CB-10.B.1-1.png": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, "Score": 25}}}, "TacticGroup": "Lateral Movement"}, "T1053": {"TechniqueName": "Scheduled Task", "Steps count": 2, "Steps": {"10.A.2": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-10.A.1-2.png": "Telemetry showing rundll32 starting updater.dll, tainted by an \"abnormal rundll32 launch\" alert"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-10.A.2-1.png": "Telemetry showing execution sequence for svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-10.A.2-4.png": "Telemetry showing rundll32.exe executing updater.dll", "PA-10.A.2-3.png": "Telemetry showing svchost.exe running with command-line arguments \"-k netsvcs -p -s Schedule\""}, "Score": 10}, "FireEye": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"FE-10.A.2-3.png": "Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)", "FE-10.A.2-2.png": "Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)", "FE-10.A.2-1.png": "Telemetry showing rundll32.exe executing updater.dll", "": ""}, "Score": 64}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-10-2.png": "Telemetry showing rundll32.exe executing updater.dll"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-10-1.png": "Telemetry showing rundll32.exe executing updater.dll (tainted by Malicious File Detection alert)", "EG-10-2.png": "Telemetry showing rundll32.exe executing updater.dll (tainted by Process Injection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-10.A.2-1.png": "Telemetry showing svchost.exe executing rundll32.exe (tainted by parent \\\"Sponsor process started V2\\\" alert)", "": ""}, "Score": 7}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-10.A.2-1.png": "Telemetry showing rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \"-k netsvcs -p -s Schedule\""}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": "", "S1-10.A.2-2.png": "Telemetry showing rundll32.exe executing updater.dll", "S1-10.A.1-3.png": "Group ID query showing both autoupdate.bat and updater.dll persistence execution"}, "Score": 10}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-10.A.2-2.png": "Telemetry showing rundll32.exe executing updater.dll (tainted by the parent OverWatch alert)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-10.A.2-100.png": "Telemetry showing rundll32.exe executing update.dat (tainted by a parent Injected Shellcode alert)", "": "", "CR-10.A.1-20.png": "Parent alert for Injected shellcode into rundll32.exe"}, "Score": 7}, "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-10.A.2-2.png": "Telemetry from process tree showing updater.dll executed by rundll32.exe", "CB-10.A.2-1.png": "Telemetry from process tree showing svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"}, "Score": 10}}, "7.C.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-7.C.1-2.png": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-7.C.1-1.png": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence", "MS-7.C.1-2.png": "Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task"}, "Score": 67}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted", "Specific Behavior-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-7.C.1-4.png": "Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)", "PA-7.C.1-1.png": "Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)", "PA-7.C.1-3.png": "Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)", "PA-7.C.1-2.png": "Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)"}, "Score": 136}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-7.C.1-3.png": "Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)", "FE-7.C.1-2.png": "Excerpt from the Managed Defense Report with additional details about schtask", "FE-7.C.1-1.png": "Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)", "": ""}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-07-2.png": "Telemetry showing the schtask.exe and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Enrichment", "Telemetry-Tainted", "Enrichment-Delayed-Tainted", "Specific Behavior-Tainted"], "Screenshots": {"": "", "EG-07-4.png": "Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)", "EG-07-3.png": "Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)", "EG-07-2.png": "Enrichment of scheduled task from persistence hunt"}, "Score": 88}, "CounterTack": {"Detects": ["Specific Behavior", "Telemetry"], "Screenshots": {"CT-7.C.1-1.png": "Specific Behavior alert on \\\"Schtasks with create command\\\" for schtasks.exe run from cmd.exe", "": ""}, "Score": 70}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MC-7.C.1-1.png": "Specific Behavior alert for a task being created that runs an executable (via rundll32) under system rights at Windows logon, tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task)", "MC-7.C.1-3.png": "Telemetry showed cmd.exe creating the \"Resume Viewer Update Checker\" scheduled task via schtasks.exe (tainted by a trace detection on cmd.exe)"}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-7.C.1-1.png": "Telemetry showing schtask.exe and associated command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "General Behavior-Delayed-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "CS-E-4.png": "Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)", "CS-7.C.1-2.png": "Telemetry showing creation of the scheduled task", "CS-7.C.1-3.png": "General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)"}, "Score": 91}, "Cybereason": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "CR-7.C.1-11.png": "Telemetry showing the Resume Viewer Update Checker scheduled task", "CR-7.C.1-10.png": "Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)"}, "Score": 25}, "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-7.C.1-2.png": "Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)", "CB-7.C.1-1.png": "Telemetry showing process tree containing schtasks.exe and full command a task creation"}, "Score": 70}}}, "TacticGroup": "Execution, Persistence, Privilege Escalation"}, "T1074": {"TechniqueName": "Data Staged", "Steps count": 1, "Steps": {"18.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-18.B.1-T1074-new.png": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin", "CC-18.A.1-4.png": "Telemetry showing a file create event for the .vsdx file in the Recycle Bin"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": "", "MS-18.B.1-1.png": "Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)"}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"PA-18.B.1-1.png": "Telemetry showing file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin (tainted by a parent alert on wscript.exe)", "": ""}, "Score": 7}, "FireEye": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "FE-18.B.1-3.png": "Specific Behavior alert for File Write to Root of Recycle Bin", "FE-18.B.1-2.png": "Additional telemetry showing file write of .vsdx with PowerShell File Write alert", "FE-18.B.1-1.png": "Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert"}, "Score": 67}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-18-1.png": "Telemetry showing the file creation of the .vsdx file in the Recycle Bin", "EG-18-2.png": "Event tree showing creation of the .vsdx file (tainted by parent alerts on powershell.exe)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-18.B.1-1.png": "Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MC-18.B.1-9.png": "Specific Behavior alert for PowerShell creating a file in the Recycle Bin, tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged).", "MC-18.B.1-1.png": "Telemetry showing file creation in the Recycle Bin (tainted by parent alert on cmd.exe)"}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-18.B.1-1.png": "Exported telemetry of threat story (taints event) showing .vsdx file copy and write"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed the .vsdx file being copied to Recycle Bin for staging (Specific Behavior)", "": "", "CS-18.B.1-1.png": "Telemetry showing the .vsdx being written into the Recycle Bin (event_SimpleName of OoxmlFileWritten)"}, "Score": 67}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-18.B.1-10.png": "Telemetry of file create/write of vsdx (tainted by a parent PowerShell alert, listed as Owner process)"}, "Score": 7}, "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-18.B.1-2.png": "Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)", "CB-18.B.1-1.png": "Telemetry showing creation of the .vsdx file in the Recycle Bin"}, "Score": 70}}}, "TacticGroup": "collection"}, "T1010": {"TechniqueName": "Application Window Discovery", "Steps count": 2, "Steps": {"8.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "15.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-15.A.1-1.png": "Telemetry showing powershell.exe executing the GetForegroundWindow method"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Indicator of Compromise"], "Screenshots": {"": "", "PA-15.A.1-3.png": "Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow", "PA-15.A.1-2.png": "Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window"}, "Score": 30}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"CS-15.A.1-2.png": "Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow", "": ""}, "Score": 10}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1078": {"TechniqueName": "Valid Accounts", "Steps count": 3, "Steps": {"16.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-16.C.1-2.png": "Telemetry showing a logon event for user Kmitnick on Conficker (10.0.0.5)", "CC-16.C.1-1.png": "Telemetry showing net.exe logon attempt"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.B.1-3.png": "Telemetry showing 10.0.1.5 (CodeRed) system accessed resources on 10.0.0.5 (Conficker)", "MS-16.B.1-1.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.B.1-2.png": "Telemetry showing user Kmitnick login activity on 10.0.0.5 (Conficker)", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"PA-16.B.1-3.png": "Enrichment of an lsass.exe event with the correct ATT&CK Technique (Valid Accounts).", "PA-16.B.1-2.png": "Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)", "PA-16.B.1-1.png": "Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)", "": ""}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "FE-16.B.1-1.png": "Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert", "FE-16.B.1-2.png": "Telemetry showing successful logon of user Kmitnick"}, "Score": 25}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"RSA-16-2.png": "Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick", "": ""}, "Score": 10}, "Endgame": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"EG-16-7.png": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "": "", "EG-16-3.png": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)"}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.B.1-2.png": "Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\\"FileExts Registry Key modified\\\" alert)", "CT-16.B.1-1.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MC-16.A.1-3.png": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)", "": "", "MC-16.A.1-4.png": "Telemetry showing a login event on Conficker (10.0.0.5) for user Kmitnick"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.B.1-1.png": "Telemetry showing net.exe logon attempts, the last of which using valid credentials for user Kmitnick (tainted by relationship to threat story)", "S1-16.A.1-2.png": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed-Tainted"], "Screenshots": {"": "", "CS-16.B.1-2.png": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)", "CS-16.B.1-1.png": "Telemetry from process tree showing successful net.exe connection using valid credentials of Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, "Score": 31}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.B.1-20.png": "Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, "Score": 22}, "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"CB-16.B.1-1.png": "Telemetry showing process tree with five different net.exe logon attempts, including a success", "": "", "CB-16.B.1-2.png": "Telemetry showing successful logon via net.exe"}, "Score": 10}}, "10.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-10.B.1-T1076-new.png": "Telemetry showing a RemoteInteractive connection as Jesse over port 3389 to Conficker (10.0.0.5)"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-10.B.1-1.png": "Telemetry showing local user account Jesse first and last seen logons on Conficker"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"PA-10.B.1-1.png": "Telemetry showing userinit.exe as well as explorer.exe spawn as the user Jesse", "": ""}, "Score": 10}, "FireEye": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-10.B.1-3.png": "Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)", "FE-10.B.1-2.png": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, "Score": 67}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-10-3.png": "Telemetry showing \\\"unregmp2.exe /FirstLogon\\\" (associated with user logon)", "RSA-10-4.png": "Telemetry showing user name \\\"Jesse J\\\" within Machine Properties"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-10-3.png": "Telemetry showing userinit.exe running as Jesse (tainted by parent \\\"Start Folder Persistence\\\" alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-10.B.1-1.png": "Telemetry showing explorer.exe running as Jesse"}, "Score": 10}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-10.B.1-1.png": "Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)"}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": "", "S1-10.B.1-3.png": "Telemetry showing last logged on user identified as Jesse"}, "Score": 10}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-10.B.1-1.png": "Telemetry showing user logon by Jesse to Conficker"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CR-10.B.1-10.png": "Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type"}, "Score": 10}, "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-10.B.1-2.png": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)", "CB-10.B.1-1.png": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, "Score": 25}}, "16.D.1": {"F-Secure": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "CC-16.C.1-2.png": "Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)", "CC-16.C.1-1.png": "Telemetry showing net.exe with command-line arguments", "CC-16.D.1-T1078-new.png": "The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.D.1-2.png": "Telemetry from query showing successful Kmitnick logon event for Creeper", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.D.1-1.png": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"PA-16.D.1-1.png": "Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)", "": "", "PA-16.D.1-2.png": "Telemetry showing a event for a successful login by user Kmitnick (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-16.D.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)", "FE-16.D.1-1.png": "Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-4.png": "Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick"}, "Score": 10}, "Endgame": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"EG-16-7.png": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "EG-16-6.png": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.D.1-1.png": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-16.D.1-9.png": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.D.1-1.png": "Telemetry showing a net.exe logon attempt using valid credentials for user Kmitnick (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-16.D.1-2.png": "Telemetry showing successful net use connection by Kmitnick in the process tree view (tainted by previous powershell.exe detection by red line indicating high severity)"}, "Score": 7}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.D.1-10.png": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}, "Score": 37}, "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-16.D.1-1.png": "Telemetry showing process tree with logon using valid account credentials"}, "Score": 10}}}, "TacticGroup": "Defense Evasion, Persistence, Privilege Escalation, Initial Access"}, "T1110": {"TechniqueName": "Brute Force", "Steps count": 2, "Steps": {"16.B.1": {"F-Secure": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CC-16.C.1-1.png": "Telemetry showing net.exe logon attempt"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-16.A.1-1.png": "Specific Behavior alert for brute force attempt to remote SMB shares", "MS-16.B.1-1.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-16.B.1-2.png": "Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)", "PA-16.B.1-1.png": "Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "FE-16.B.1-1.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)", "FE-16.B.1-2.png": "Telemetry showing successful logon of user Kmitnick"}, "Score": 25}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"RSA-16-2.png": "Telemetry showing logon attempts via net.exe and command-line arguments", "": ""}, "Score": 10}, "Endgame": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"EG-16-7.png": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "": "", "EG-16-4.png": "Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)", "EG-16-3.png": "Enrichment of successful net.exe connection with \\\"Mounting Hidden Share\\\" and Lateral Movement tags (tainted by parent PowerShell alert)"}, "Score": 28}, "CounterTack": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.B.1-2.png": "Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\\"FileExts Registry Key modified\\\" alert)", "CT-16.B.1-1.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 19}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"MC-16.A.1-3.png": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)", "MC-16.A.1-2.png": "Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility", "": ""}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.B.1-1.png": "Telemetry showing net.exe logon attempts (tainted by relationship to threat story)", "S1-16.A.1-2.png": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)", "CS-16.B.1-2.png": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)", "CS-16.B.1-1.png": "Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, "Score": 58}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.B.1-20.png": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, "Score": 22}, "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment-Configuration Change"], "Screenshots": {"CB-16.B.1-1.png": "Telemetry showing process tree with five different net.exe logon attempts, including a success", "": "", "CB-16.B.1-2.png": "Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}, "Score": 22}}, "16.A.1": {"F-Secure": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CC-16.A.1-2.png": "Telemetry showing net.exe logon attempts"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"MS-16.A.1-3.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.A.1-2.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.A.1-1.png": "Specific Behavior alert for brute force attempt to remote SMB shares", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.A.1-5.png": "System access history from CodeRed to Nimda and Morris", "MS-16.A.1-4.png": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server", "": ""}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "General Behavior"], "Screenshots": {"PA-16.A.1-4.png": "General Behavior alert for a sensitive administrative shares mapping with unexpected parent", "": "", "PA-16.A.1-1.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local Kmitnick (tainted by a parent alert on wscript.exe)", "PA-16.A.1-2.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)", "PA-16.A.1-3.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)"}, "Score": 37}, "FireEye": {"Detects": ["Enrichment", "Telemetry-Configuration Change", "General Behavior-Delayed"], "Screenshots": {"FE-16.A.1-2.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-3.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-1.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-6.png": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)", "FE-16.A.1-4.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-5.png": "Telemetry showing failed logon attempt for Kmitnick", "": ""}, "Score": 49}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-1.png": "Telemetry showing logon attempts via net.exe and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-16-2.png": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "EG-16-1.png": "Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)"}, "Score": 28}, "CounterTack": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "CT-16.A.1-1.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)", "CT-16.A.1-2.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)", "CT-16.A.1-3.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)", "CT-16.A.1-4.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, "Score": 12}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MC-16.A.1-2.png": "Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility", "MC-16.A.1-1.png": "Telemetry showing powershell.exe executing repeated logon attempts via net.exe (tainted by a parent alert on powershell.exe)"}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.A.1-2.png": "Telemetry showing net.exe logon attempts and corresponding exit codes", "S1-16.A.1-1.png": "Telemetry showing net.exe logon attempts (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "General Behavior-Delayed-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)", "CS-16.A.1-1.png": "Telemetry showing net.exe logon attempts", "CS-16.A.1-3.png": "Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)", "CS-16.A.1-2.png": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)", "CS-16.A.1-4.png": "Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)"}, "Score": 61}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.A.1-20.png": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-2.png": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-3.png": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-1.png": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-10.png": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, "Score": 22}, "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00a0Kmitnick, Bob, and Frieda", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment-Configuration Change"], "Screenshots": {"": "", "CB-16.B.1-2.png": "Enrichment of the individual net.exe logon attempts with tag \\\"Credential Access using Admin Shares - Failed Attempts\\\"", "CB-16.A.1-1.png": "Telemetry showing process tree with four different net.exe logon attempts"}, "Score": 22}}}, "TacticGroup": "Credential Access"}, "T1113": {"TechniqueName": "Screen Capture", "Steps count": 1, "Steps": {"8.D.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["Enrichment-Configuration Change"], "Screenshots": {"": "", "MS-8.D.1-1.png": "Enrichment of explorer.exe with ScreenshotTaken"}, "Score": 12}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"PA-8.D.1-1.png": "Enrichment of the execution of a specific API call using screen capture and suspicious activity", "": ""}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-08-4.png": "Floating Code module generated from DLL injection showing multiple jpeg components (does not count as a detection)"}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-08-5.png": "Strings output extracted from Process Injection alert, showing BitBlt and CreateCompatibleBitmap that could be associated with screen capture, but no evidence of execution (does not count as a detection)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-8.D.1-1.png": "Telemetry showing remote thread being created into explorer.exe (does not count as a detection)", "CT-8.D.1-2.png": "DDNA JSON output showing the process had the capability to capture screen shots (does not count as a detection; DDNA scan was manually initiated)"}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"CS-8.D.1-2.png": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)", "": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"CR-8.D.1-11.png": "Alert for explorer.exe loading a Meterpreter agent (does not count as detection)", "CR-8.D.1-10.png": "Alert showing loaded screenshotx64.dll module (does not count as a detection)", "": ""}, "Score": 0}, "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": "", "CB-8.D.1-1.png": "Telemetry showing modloads and crossprocess events (does not count as a detection)"}, "Score": 0}}}, "TacticGroup": "Collection"}, "T1136": {"TechniqueName": "Create Account", "Steps count": 1, "Steps": {"7.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-7.A.1-2.png": "Telemetry showing the creation of the new user Jesse"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Configuration Change"], "Screenshots": {"": "", "MS-7.A.1-1.png": "Telemetry showing creation of user account Jesse"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"PA-7.A.1-3.png": "Telemetry showing mmc.exe creating a Registry key for user Jesse ", "": "", "PA-7.A.1-4.png": "Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account)"}, "Score": 25}, "FireEye": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-7.A.1-4.png": "Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)", "FE-7.A.1-1.png": "Telemetry showing creation of user Jesse "}, "Score": 67}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["Specific Behavior-Configuration Change"], "Screenshots": {"": "", "CT-7.A.1-2.png": "Child event of Specific Behavior alert showing new account added to local admins group", "CT-7.A.1-1.png": "Specific Behavior alert for \\\"New user account created\\\" and event showing account name was Jesse"}, "Score": 57}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-7.A.1-1.png": "Telemetry showing creation of user account Jesse"}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": "", "S1-7.A.1-1.png": "Telemetry showing creation of user account Jesse"}, "Score": 10}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-7.A.1-1.png": "Telemetry showing creation of the user Jesse with the user RID 000003E8", "CS-7.A.1-2.png": "Telemetry showing user RID 000003E8 (corresponding to the user Jesse) added to the admin group (00000220), a well-known security identifier", "CS-7.A.1-3.png": "Telemetry showing group membership of the user Jesse, including Remote (0000022B), Admins (00000220), and Users (00000221), which are well-known security identifiers"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CR-7.A.1-20.png": "Telemetry showing lsass.exe creating a Registry key for user Jesse"}, "Score": 10}, "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment-Configuration Change"], "Screenshots": {"": "", "CB-7.A.1-2.png": "Telemetry showing Registry modifications for new user Jesse", "CB-7.A.1-4.png": "Enrichment of lsass.exe with tag \\\"Create Accounts using GUI\\\""}, "Score": 22}}}, "TacticGroup": "Persistence"}, "T1082": {"TechniqueName": "System Information Discovery", "Steps count": 4, "Steps": {"2.E.2": {"F-Secure": {"Detects": ["General Behavior", "Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"CC-2.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "CC-2.A.2-2.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance", "CC-2.A.1-99.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-2.E.2-2.png": "Telemetry showing net.exe with command-line arguments", "": ""}, "Score": 85}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-2.E.2-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments", "MS-2.E.2-2.png": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-2.E.2-1.png": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.E.2-3.png": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.E.2-2.png": "Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)", "FE-2.E.2-1.png": "Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)", "FE-2.E.2-2.png": "Excerpt from the Managed Defense Report with additional details about net"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-3.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-9.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-2.E.2-1.png": "Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)", "": ""}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)", "MC-2.B.1-5.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-9.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net config not specifically shown)", "": "", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net config was a reconnaissance command (General Behavior)", "CS-2.D.2-1.png": "Telemetry showing net with command-line arguments"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry", "Enrichment-Tainted"], "Screenshots": {"": "", "CR-2.E.2-10.png": "Telemetry showing cmd.exe executing net executing with command-line arguments", "CR-2.E.2-12.png": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.E.2-2.png": "Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)", "CB-2.E.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments"}, "Score": 25}}, "2.E.1": {"F-Secure": {"Detects": ["Enrichment", "General Behavior"], "Screenshots": {"": "", "CC-2.E.1-1.png": "Enrichment of systeminfo.exe indicating it could be used for reconnaissance.", "CC-2.B.1-1.png": "General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}, "Score": 45}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.E.1-1.png": "Telemetry showing execution sequence for systeminfo.exe", "MS-2.A.1-4.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-2.E.1-2.png": "Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)", "PA-2.E.1-3.png": "Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.E.1-1.png": "Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-2.E.1-1.png": "Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery) ", "FE-2.E.1-2.png": "Excerpt from the Managed Defense Report with additional details about systeminfo", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-3.png": "Telemetry showing systeminfo.exe"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-8.png": "Telemetry showing systeminfo.exe (tainted by parent Malicious File Detection)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-2.E.1-1.png": "Telemetry showing systeminfo.exe (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-1.png": "Process tree within trace detection containing cmd.exe executing the systeminfo.exe (tainted by a parent alert on Resume Viewer.exe)", "MC-2.B.1-5.png": "Enrichment of systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-8.png": "Telemetry showing systeminfo.exe (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)", "": "", "CS-2.E.1-1.png": "OverWatch General Behavior alert indicating systeminfo.exe was suspicious", "CS-E-3.png": "Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)", "CS-2.D.2-1.png": "Telemetry showing systeminfo"}, "Score": 61}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-2.E.1-11.png": "Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)", "CR-2.B.1-10.png": "Telemetry showing cmd.exe executing systeminfo"}, "Score": 22}, "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.E.1-1.png": "Telemetry from process tree showing systeminfo.exe", "CB-2.E.1-2.png": "Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)"}, "Score": 25}}, "12.E.1.6.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-12.E.1-2.png": "Telemetry of execution sequence showing Get-SysInfo invocation"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Indicator of Compromise"], "Screenshots": {"": "", "PA-12.E.1.6-1.png": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo"}, "Score": 20}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-05.png": "Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.E.1-3.png": "Additional telemetry showing powershell.exe WMI queries for operating system information", "S1-12.E.1-2.png": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-12.E.1.6.1-1.png": "Telemetry showing the Get-Sysinfo function"}, "Score": 10}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of system information", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.E.1.6.2": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-12.E.1-2.png": "Telemetry of execution sequence showing Get-HotFix invocation"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1083": {"TechniqueName": "File and Directory Discovery", "Steps count": 7, "Steps": {"18.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-18.A.1-T1083-new.png": "Telemetry showing powershell.exe executing the Get-ChildItem command "}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"MS-18.A.1-1.png": "Query showing .vsdx PowerShell file search script that was executed", "": ""}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-18.A.1-1.png": "Telemetry showing an event with the execution of the Get-ChildItem command (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "8.A.1": {"F-Secure": {"Detects": ["General Behavior", "Enrichment", "General Behavior"], "Screenshots": {"": "", "CC-8.A.1-99.png": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.", "CC-8.A.1-98.png": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-8.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir) "}, "Score": 75}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-8.A.1-1.png": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments", "": "", "MS-8.A.1-2.png": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"PA-8.A.1-4.png": "Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)", "": "", "PA-8.A.1-1.png": "Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-8.A.1-2.png": "Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-8.A.1-1.png": "Enrichment of cmd.exe executing dir with Dir Command alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and, Tactic, Discovery)"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-08-1.png": "Telemetry showing cmd.exe executing dir with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed"], "Screenshots": {"": "", "EG-08-1.png": "Enriched event tree showing enrichment of dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-8.A.1-1.png": "Telemetry showing dir with command-line arguments (tainted by the parent \\\"Powershell process created\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-8.A.1-1.png": "Telemetry showing cmd.exe executing the dir command (tainted by a trace detection on cmd.exe)", "": "", "MC-8.A.2-5.png": "Enrichment of cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-8.A.1-2.png": "Telemetry showing cmd.exe executing dir with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-8.A.1-2.png": "Process tree view showing cmd.exe that ran dir (dir not specifically shown, cmd.exe is second from top and tainted by previous detection by orange line indicating medium severity)", "CS-8.A.1-1.png": "Telemetry showing cmd.exe running dir with command-line arguments (search was on commands running within the past 10 minutes)"}, "Score": 7}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-8.A.1-10.png": "Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'dir /s /b \"\\\\conficker\\wormshare\"' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-8.C.1-2.png": "Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)", "CB-8.A.1-1.png": "Telemetry from process tree showing dir with command-line arguments"}, "Score": 25}}, "8.A.2": {"F-Secure": {"Detects": ["General Behavior", "Enrichment", "General Behavior"], "Screenshots": {"": "", "CC-8.A.1-99.png": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-8.A.2-2.png": "Enrichment of tree.exe with a tag identifying the command as enumeration", "CC-8.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree) "}, "Score": 75}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-8.A.2-1.png": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments", "MS-8.A.1-2.png": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-8.A.2-2.png": "Enrichment of cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)", "PA-8.A.2-1.png": "Telemetry showed cmd.exe executing tree with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-8.A.1-2.png": "Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)", "FE-7.C.1-3.png": "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)", "FE-8.A.1-4.png": "Excerpt from Managed Defense Report showing additional details about tree", "": ""}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-08-1.png": "Telemetry showing cmd.exe executing tree with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed"], "Screenshots": {"": "", "EG-08-1.png": "Enriched event tree showing enrichment of tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-8.A.2-1.png": "Telemetry showing tree with command-line arguments (tainted by the parent \\\"Powershell process created\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-8.A.1-2.png": "Telemetry showing cmd.exe executing tree.exe (tainted by a trace detection on cmd.exe)", "MC-8.A.2-5.png": "Enrichment of tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-8.A.1-3.png": "Telemetry showing cmd.exe executing tree with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-8.A.2-2.png": "Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)", "": "", "CS-8.A.1-2.png": "OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)", "CS-8.A.1-1.png": "Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)"}, "Score": 58}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-8.A.1-20.png": "Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-8.C.1-2.png": "Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)", "CB-8.A.1-2.png": "Telemetry from process tree showing tree.com with command-line arguments"}, "Score": 25}}, "12.E.1.4.2": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-12.E.1.4-1.png": "Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-04.png": "Interactive Shell events showing the WinEnum script and the Interesting Files function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of interesting files", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.E.1.4.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-12.E.1.4-1.png": "Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-03.png": "Interactive Shell events showing the WinEnum script and the Last 5 files opened function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "9.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.K.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-16.D.1-1.png": "Telemetry showing powershell.exe executing the type command with command-line arguments"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-16.K.1-1.png": "Telemetry showing a file read event for update.vbs (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": ""}, "Score": 10}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1081": {"TechniqueName": "Credentials in Files", "Steps count": 1, "Steps": {"15.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-15.A.1-4.png": "Telemetry showing powershell.exe executing the Get-Content cmdlet on IT_tasks.txt"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": "", "MS-15.B.1-1.png": "Telemetry showing \"Get-Content\" cmdlet (does not count as a detection)"}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-15.B.1-1.png": "Telemetry showing a file read event for IT_tasks.txt"}, "Score": 10}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-15.A.1-2.png": "Telemetry showing decoded PowerShell script containing the function Get-Keystrokes", "": "", "CS-E-8.png": "Excerpt from email sent by OverWatch team indicating keylogging activity occurred (Specific Behavior)"}, "Score": 67}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Credential Access"}, "T1086": {"TechniqueName": "PowerShell", "Steps count": 35, "Steps": {"13.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": ""}, "12.F.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "17.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "17.B.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.F.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "17.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.G.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.G.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.D.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.D.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": ""}, "18.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.E.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "18.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.E.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": ""}, "17.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.K.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "11.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.H.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.A.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "19.D.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "19.D.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.G.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": ""}, "16.I.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.J.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": ""}, "15.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "13.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "13.B.2": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "13.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "16.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": ""}, "16.L.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Execution"}, "T1087": {"TechniqueName": "Account Discovery", "Steps count": 5, "Steps": {"2.G.2": {"F-Secure": {"Detects": ["Enrichment", "General Behavior"], "Screenshots": {"": "", "CC-2.H.1-2.png": "Enrichment of net.exe with a tag identifying the command as enumeration", "CC-2.G.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}, "Score": 45}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.G.2-2.png": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities", "MS-2.G.2-3.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments", "MS-2.G.2-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment-Tainted"], "Screenshots": {"PA-2.G.2-3.png": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.G.2-2.png": "Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)", "PA-2.G.2-1.png": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "": ""}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)", "FE-2.G.2-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)", "FE-2.E.2-2.png": "Excerpt from the Managed Defense Report with additional details about net"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-4.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-14.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-2.G.2-1.png": "Enrichment of net.exe with conditions Reconnaissance Tool and Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.A.1-26.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-14.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)", "": "", "CS-2.G.1-1.png": "Telemetry showing net with command-line arguments", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net user was a reconnaissance command (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry", "Enrichment-Tainted"], "Screenshots": {"": "", "CR-2.D.2-10.png": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)", "CR-2.G.2-10.png": "Telemetry showing net executing with command-line arguments", "CR-2.G.1-100.png": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'net user george /domain' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-2.G.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "": "", "CB-2.G.2-2.png": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}, "Score": 25}}, "12.G.1": {"F-Secure": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"": "", "CC-12.G.1-T1087-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-12.G.1-2.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments", "MS-12.G.1-1.png": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments", "MS-12.E.1-4.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"PA-12.G.1-2.png": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)", "": "", "PA-12.G.1-1.png": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)", "FE-12.G.1-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-2.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed"], "Screenshots": {"": "", "EG-12-7.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts)", "EG-12-6.png": "Telemetry from event tree showing net.exe with command-line arguments (tainted by parent PowerShell alert)"}, "Score": 16}, "CounterTack": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "CT-12.G.1-1.png": "Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 12}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-12.F.1-1.png": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)", "MC-12.F.1-2.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.F.1-1.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)", "S1-12.F.1-2.png": "Continued threat story showing related processes", "S1-12.F.1-3.png": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)", "CS-12.G.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 34}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-12.G.1-1.png": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)", "CR-12.G.1-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, "Score": 37}, "Procedure": "Empire: 'net user' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-12.G.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-12.F.1-3.png": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}, "Score": 25}}, "12.G.2": {"F-Secure": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"": "", "CC-12.G.2-T1087-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-12.E.1-4.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)", "MS-12.G.2-2.png": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper", "MS-12.G.2-3.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments", "MS-12.G.2-1.png": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, "Score": 91}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"PA-12.G.2-1.png": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)", "": "", "PA-12.G.2-2.png": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)"}, "Score": 22}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "FE-12.G.2-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-2.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed"], "Screenshots": {"": "", "EG-12-7.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "CT-12.G.2-1.png": "Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 12}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-12.F.1-1.png": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)", "MC-12.F.1-3.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery)."}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.F.1-1.png": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe", "S1-12.F.1-2.png": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe", "S1-12.F.1-3.png": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-12.G.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-12.G.1-1.png": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)", "CR-12.G.2-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, "Score": 37}, "Procedure": "Empire: 'net user /domain' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-12.G.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-12.F.1-3.png": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}, "Score": 25}}, "7.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-7.A.1-1.png": "Telemetry showing mmc.exe running lursmgr.msc"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-7.A.1-2.png": "Telemetry showing mmc.exe running lusrmgr.msc"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "PA-7.A.1-1.png": "Telemetry showing lusrmgr.msc running from mmc.exe ", "PA-7.A.1-5.png": "Enrichment of mmc.exe as reconnaissance via the MMC utility with local users and groups view"}, "Score": 25}, "FireEye": {"Detects": ["Telemetry"], "Screenshots": {"": "", "FE-7.A.1-3.png": "Telemetry showing mmc.exe running lusrmgr.exe "}, "Score": 10}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"EG-07-5.png": "Telemetry showing mmc.exe running lusrmgr.msc", "": ""}, "Score": 10}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-7.A.1-3.png": "Telemetry showing mmc.exe running lusrmgr.msc (tainted by the parent \\\"LSA Registry Key modified\\\" alert)\u00a0"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-7.A.1-2.png": "Telemetry showing lusrmgr.msc running from mmc.exe"}, "Score": 10}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-6.C.1-4.png": "Telemetry showing mmc.exe running lursmgr.msc"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CR-7.A.1-10.png": "Telemetry showing lusrmgr.msc running from mmc.exe"}, "Score": 10}, "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-7.A.1-3.png": "Telemetry showing mmc.exe running lusrmgr.msc"}, "Score": 10}}, "2.G.1": {"F-Secure": {"Detects": ["General Behavior", "Enrichment"], "Screenshots": {"": "", "CC-2.G.1-2.png": "Enrichment of net.exe with a tag identifying the command as enumeration", "CC-2.G.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) "}, "Score": 45}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities", "MS-2.G.1-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments", "MS-2.G.1-2.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-2.G.1-1.png": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.G.1-2.png": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 19}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)", "FE-2.G.1-2.png": "Excerpt from the Managed Defense Report with additional details about net", "FE-2.G.1-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-3.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-13.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)", "": ""}, "Score": 28}, "CounterTack": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "CT-2.G.1-1.png": "Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 12}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.A.1-26.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-13.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)", "": "", "CS-2.G.1-1.png": "Telemetry showing net with command-line arguments"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry", "Enrichment-Tainted"], "Screenshots": {"": "", "CR-2.D.2-10.png": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)", "CR-2.G.2-100.png": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)", "CR-2.G.1-10.png": "Telemetry showing net executing with command-line arguments"}, "Score": 22}, "Procedure": "Cobalt Strike: 'net user /domain' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-2.G.1-2.png": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)", "": "", "CB-2.G.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments"}, "Score": 25}}}, "TacticGroup": "Discovery"}, "T1085": {"TechniqueName": "Rundll32", "Steps count": 1, "Steps": {"1.A.1": {"F-Secure": {"Detects": ["General Behavior", "Specific Behavior", "Telemetry"], "Screenshots": {"": "", "CC-1.A.1-4.png": "Telemetry showing rundll32.exe executing update.dat"}, "Score": 100}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-1.A.1-10.png": "Telemetry showing rundll32.exe process injection sequence", "MS-1.A.1-13.png": "General Behavior alert on low-reputation DLL load by signed executable"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted", "General Behavior-Tainted"], "Screenshots": {"": "", "PA-1.A.1-5.png": "Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-1.A.1-4.png": "Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-1.A.1-7.png": "Additional details of General Behavior alert for rundll32.exe executing update.dat", "PA-1.A.1-6.png": "General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 91}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-1.A.1-6.png": "Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)", "FE-1.A.1-3.png": "Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-01-1.png": "Telemetry showing execution of Resume Viewer.exe"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted"], "Screenshots": {"": "", "EG-01-11.png": "Specific Behavior alert for RunDLL32 with Suspicious DLL Location and surrounding telemetry\u00a0 (tagged with correct ATT&CK Technique, T1085 - Rundll32 and Tactics, Defense Evasion, Execution; tainted by parent Malicious File Detection alert)", "EG-01-10.png": "Telemetry showing rundll32.exe running update.dat execution event", "EG-01-2.png": "Event tree view showing the Malicious File Detection alert tainting rundll32.exe telemetry"}, "Score": 64}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-1.A.1-1.png": "Telemetry showing cmd.exe launched rundll32.exe (tainted by the Script File Created alert) "}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MC-1.A.1-5.png": "Telemetry showing cmd.exe executing update.dat via rundll32.exe", "MC-1.B.1-6.png": "Process tree within trace detection showing rundll32.exe executing (tainted by a parent alert on Resume Viewer.exe)", "MC-1.A.1-23.png": "Specific Behavior alerts based on suspicious indicators that a \"Loaded non-DLL and non-CPL file with specified parameters via rundll32.\" The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32)"}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-1.A.1-1.png": "Telemetry from process tree showing rundll32.exe (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Specific Behavior", "General Behavior-Delayed", "Telemetry"], "Screenshots": {"": "", "CS-1.A.1-6.png": "Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)", "CS-1.A.1-4.png": "OverWatch General Behavior alert indicating rundll32 execution was suspicious"}, "Score": 97}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted", "Specific Behavior-Tainted"], "Screenshots": {"": "", "CR-1.A.1-30.png": "Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)", "CR-1.A.1-101.png": "Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)", "CR-1.A.1-200.png": "Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)"}, "Score": 121}, "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-1.A.1-2.png": "Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe", "CB-1.A.1-1.png": "Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)"}, "Score": 25}}}, "TacticGroup": "Defense Evasion, Execution"}, "T1049": {"TechniqueName": "System Network Connections Discovery", "Steps count": 4, "Steps": {"12.E.1.12": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"MS-12.E.1-3.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments", "MS-12.E.1-2.png": "Telemetry of execution sequence showing Get-NetInfo invocation", "MS-12.E.1-1.png": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments", "": "", "MS-12.E.1-4.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-12.E.1.12-1.png": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.E.1.12-1.png": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-3.png": "Telemetry showing netstat.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed"], "Screenshots": {"EG-12-3.png": "Event tree showing telemetry of netstat subprocess associated with WinEnum (tainted by parent PowerShell alerts)", "EG-12-E-10.png": "Interactive Shell events showing the WinEnum script and the Netstat Established Connections and Processes function (does not count as a detection due to manual process of pulling events)", "EG-12-7.png": "Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)\u00a0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)", "": ""}, "Score": 16}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-12.F.1-1.png": "Telemetry showing powershell.exe executing netstat.exe (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.E.1-1.png": "Telemetry showing netstat.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-12.E.12-2.png": "Telemetry from process tree showing netstat.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 7}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-12.E.1.12-1.png": "Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery)\u00a0(tainted by a parent PowerShell alert)"}, "Score": 22}, "Procedure": "Empire: WinEnum module included enumeration of established network connections", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-12.E.1.12-2.png": "Telemetry from process tree showing netstat.exe with command-line arguments", "CB-12.E.1.12-1.png": "Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)"}, "Score": 25}}, "13.B.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-13.A.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-13.A.1-3.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)", "MS-13.B.1-1.png": "Telemetry showing execution of net.exe with command-line arguments", "MS-13.B.1-2.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-13.B.1-1.png": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "FE-13.B.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-13-1.png": "Telemetry showing execution of net.exe and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-13-3.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)", "EG-13-1.png": "Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)"}, "Score": 73}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-13.B.1-1.png": "Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-13.A.1-1.png": "Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-13.A.1-1.png": "Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net use was part of additional malicious discovery activity (General Behavior)", "CS-13.B.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, "Score": 34}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-13.B.1-10.png": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)", "CR-13.B.1-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)"}, "Score": 37}, "Procedure": "Empire: 'net use' via PowerShell", "CarbonBlack": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"": "", "CB-13.A.1-2.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}, "Score": 25}}, "13.B.2": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-13.A.1-1.png": "General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.G.1-2.png": "Telemetry showing powershell.exe executing netstat.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-13.A.1-3.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)", "MS-13.B.2-2.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments", "MS-13.B.2-1.png": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"PA-13.B.2-1.png": "Telemetry showing powershell.exe executing netstat with command-line arguments (tainted by a parent alert on wscript.exe)", "": ""}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)", "FE-13.B.2-1.png": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-13-3.png": "Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}, "Score": 16}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-13.B.2-1.png": "Telemetry showing netstat.exe with command-line arguments (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-13.A.1-2.png": "Enrichment of nestat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered", "": "", "MC-13.A.1-1.png": "Telemetry showed powershell.exe executing netstat.exe (tainted by parent alert on wscript.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-13.A.1-1.png": "Telemetry showing execution of netstat.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-13.B.2-1.png": "Telemetry from process tree showing netstat.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating netstat was part of additional malicious discovery activity (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-13.B.2-10.png": "Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)"}, "Score": 22}, "Procedure": "Empire: 'netstat -ano' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-13.B.1-1.png": "Telemetry showing process tree with netstat.exe and command-line arguments", "CB-13.A.1-2.png": "Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)"}, "Score": 25}}, "4.C.1": {"F-Secure": {"Detects": ["Enrichment"], "Screenshots": {"": "", "CC-4.C.1-2.png": "Enrichment of netstat.exe with a tag identifying the command as enumeration"}, "Score": 15}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-4.C.1-1.png": "Telemetry showing execution sequence for netstat.exe with command-line arguments", "MS-4.A.1-2.png": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "PA-4.C.1-2.png": "Enrichment of netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery)", "PA-4.C.1-1.png": "Telemetry showing cmd.exe executing netstat with command-line arguments"}, "Score": 25}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-4.C.1-1.png": "Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)", "FE-4.C.1-2.png": "Excerpt from the Managed Defense Report with additional details about netstat", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-04-1.png": "Telemetry showing netstat.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry", "Enrichment-Delayed"], "Screenshots": {"": "", "EG-04-4.png": "Additional UI view of telemetry (showing the netstat command in this instance) ", "EG-04-2.png": "Enriched event tree showing enrichment of netstat with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)", "EG-04-1.png": "Telemetry from event tree showing netstat with command-line arguments"}, "Score": 22}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-4.C.1-1.png": "Telemetry showing netstat.exe with command-line arguments (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-4.A.1-6.png": "Enrichment of netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered", "MC-4.A.1-10.png": "Process tree within trace detection showing cmd.exe executing netstat.exe (tainted by a parent alert on cmd.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-4.A.1-2.png": "Telemetry showing netstat.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["General Behavior-Delayed", "Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-4.C.1-1.png": "OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious", "CS-E-3.png": "Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)"}, "Score": 64}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-4.C.1-100.png": "Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)", "CR-4.C.1-10.png": "Telemetry showing cmd.exe executing netstat with command-line arguments"}, "Score": 22}, "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-4.C.1-1.png": "Telemetry from process tree showing netstat.exe with command-line arguments", "CB-4.C.1-2.png": "Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)"}, "Score": 25}}}, "TacticGroup": "Discovery"}, "T1088": {"TechniqueName": "Bypass User Account Control", "Steps count": 2, "Steps": {"3.A.1": {"F-Secure": {"Detects": ["Enrichment"], "Screenshots": {"": "", "CC-3.A.1-2.png": "Enrichment of an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass."}, "Score": 15}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-3.A.1-2.png": "Telemetry showing powershell.exe running as high integrity as SYSTEM", "": "", "MS-3.A.1-1.png": "Telemetry showing rundll32.exe running as medium integrity as user Debbie", "MS-3.C.1-2.png": "Alert for \\'Suspicious PowerShell command-line\\' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-3.A.1-3.png": "Telemetry showing process integrity level change from parent rundll32.exe (medium) to child powershell.exe (high), both running as user Debbie"}, "Score": 10}, "FireEye": {"Detects": ["Telemetry-Configuration Change"], "Screenshots": {"": "", "FE-3.A.1-3.png": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0xfcf5fd", "FE-3.A.1-4.png": "Telemetry showing group membership of token logon ID 0xfcf5fd, associated with user Debbie, which includes S-1-16-12288 (High Mandatory Level)"}, "Score": 7}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-03-2.png": "Alert for powershell.exe execution with encoded command-line arguments (does not count as a detection)"}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-03-06.png": "Telemetry showing authentication (logon) ID mismatch between parent and child processes"}, "Score": 10}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-3.A.1-2.png": "Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)", "CT-3.A.1-1.png": "Alert for PowerShell process creation (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "MC-3.A.1-3.png": "Specific Behavior alert for a possible UAC bypass, tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation)"}, "Score": 60}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": ""}, "Score": 10}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-3.A.1-1.png": "Telemetry showing process integrity level change for Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High)"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-3.A.1-20.png": "Telemetry showing powershell.exe running as high integrity as user Debbie (tainted by a parent PowerShell alert)", "CR-3.A.1-1.png": "Telemetry showing powershell.exe running as medium integrity as user Debbie"}, "Score": 7}, "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "14.A.1": {"F-Secure": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"": "", "CC-14.A.1-T1088-new.png": "Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process", "CC-14.A.1-1.png": "General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-14.A.1-5.png": "Parent alert for \\\"Suspicious sequence of exploration activities\\\" showing powershell.exe process tainting this event", "": "", "MS-14.A.1-1.png": "Telemetry showing medium integrity powershell.exe process executing Invoke-BypassUACTokenManipulation as user Bob", "MS-14.A.1-3.png": "Telemetry showing high integrity powershell.exe process as Bob", "MS-14.A.1-2.png": "Telemetry showing high integrity powershell.exe process as SYSTEM"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Indicator of Compromise"], "Screenshots": {"PA-14.A.1-2.png": "Telemetry showing powershell.exe running as high integrity level (12288)", "PA-14.A.1-3.png": "Indicator of Compromise alert identifying a PowerShell Empire script performing the bypass UAC attack.", "PA-14.A.1-1.png": "Telemetry showing powershell.exe running as medium integrity level (8192)", "": ""}, "Score": 30}, "FireEye": {"Detects": ["Telemetry-Configuration Change"], "Screenshots": {"": "", "FE-14.A.1-7.png": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0x10530b3 ", "FE-14.A.1-8.png": "Telemetry showing group membership of token logon ID 0x10530b3 associated with user Bob, which includes S-1-16-12288 (High Mandatory Level)"}, "Score": 7}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-14-2.png": "Telemetry showing authentication (logon) ID mismatch between parent and child processes", "EG-14-4.png": "Telemetry showing svhost.exe seclogon event for token login id 0x9b6855 (10184789), used by the spawned powershell.exe"}, "Score": 10}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-14.A.1-1.png": "Alert for encoded PowerShell (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "MC-14.A.1-1.png": "Specific Behavior alert for a possible UAC bypass.", "MC-14.A.1-2.png": "Telemetry showing an integrity level change for powershell.exe"}, "Score": 70}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-14.A.1-1.png": "Telemetry showing process integrity level change from medium to high (tainted by relationship to threat story but Group ID not shown in this view)", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "CS-14.A.1-4.png": "Telemetry showing the Invoke-BypassUACTokenManipulation function", "CS-E-8.png": "Email excerpt from the OverWatch team indicating obfuscated PowerShell invoked UAC bypass (Specific Behavior)", "CS-14.A.1-9.png": "Telemetry showing integrity level change through query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000)"}, "Score": 67}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-14.A.1-11.png": "Telemetry showing powershell.exe executing with medium process integrity (tainted by a parent PowerShell alert)", "CR-14.A.1-12.png": "Telemetry showing powershell.exe executing with high process integrity (tainted by a parent PowerShell alert)", "CR-14.A.1-13.png": "Parent alert generated for malicious use of PowerShell"}, "Score": 7}, "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Defense Evasion, Privilege Escalation"}, "T1057": {"TechniqueName": "Process Discovery", "Steps count": 5, "Steps": {"2.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "PA-2.C.1-1.png": "Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 12}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.C.2 ": {"F-Secure": {"Detects": ["General Behavior", "Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-2.D.2-99.png": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)", "CC-2.D.2-2.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist) ", "CC-2.C.2-2.png": "Telemetry showing tasklist.exe with command-line arguments"}, "Score": 70}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.A.1-4.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe", "MS-2.C.2-1.png": "Telemetry showing execution sequence for tasklist.exe with command-line arguments", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-2.C.2-3.png": "Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.C.2-2.png": "Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)", "PA-2.C.2-1.png": "Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-2.C.2-1.png": "Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)", "FE-2.C.2-2.png": "Excerpt from the Managed Defense Report with additional details about tasklist", "": ""}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-1.png": "Telemetry showing tasklist.exe with command-line arguments", "RSA-02-2.png": "Additional telemetry showing tasklist.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-5.png": "Telemetry showing tasklist.exe with command-line arguments (tainted by parent Malicious File Detection)", "": "", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, "Score": 28}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-2.C.2-1.png": "Telemetry showing tasklist.exe with command-line arguments (tainted by the parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-1.png": "Process tree within trace detection containing cmd.exe executing tasklist.exe (tainted by a parent alert on Resume Viewer.exe)", "MC-2.A.1-23.png": "Enrichment of tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-5.png": "Telemetry showing tasklist.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (tasklist not specifically shown)", "": "", "CS-E-3.png": "Email excerpt from the OverWatch team indicating tasklist was a reconnaissance command (General Behavior)", "CS-2.B.1-1.png": "Telemetry showing tasklist with command-line arguments"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-2.A.2-10.png": "Telemetry showing tasklist.exe executing within the process tree (tainted by a parent Injected Shellcode alert)", "CR-2.C.2-10.png": "Telemetry showing cmd.exe executing tasklist with command-line arguments"}, "Score": 7}, "Procedure": "Cobalt Strike: 'tasklist /v' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.C.2-1.png": "Telemetry from process tree showing tasklist.exe with command-line arguments", "CB-2.C.2-2.png": "Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)"}, "Score": 25}}, "3.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "PA-3.B.1-1.png": "Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 12}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "8.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "PA-8.B.1-1.png": "Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 12}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.C.1": {"F-Secure": {"Detects": ["Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-12.C.1-1.png": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments", "CC-12.A.1-1.png": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance", "CC-12.A.1-99.png": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-12.C.1-1.png": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments", "": "", "MS-12.A.1-4.png": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process", "MS-12.E.1-4.png": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-12.C.1-2.png": "Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)", "PA-12.C.1-3.png": "Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)", "PA-12.C.1-1.png": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.C.1-1.png": "Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-1.png": "Telemetry showing qprocess.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-12-1.png": "Event tree view of telemetry showing qprocess.exe with command-line arguments (tainted by parent PowerShell alerts)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-12.C.1-1.png": "Telemetry showing qprocess.exe with command-line arguments (tainted by parent Script File Created alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment"], "Screenshots": {"": "", "MC-12.A.1-99.png": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried", "MC-12.A.1-3.png": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)", "MC-12.A.1-2.png": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes"}, "Score": 37}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-12.A.1-3.png": "Telemetry showing qprocess.exe with command-line arguments (tainted Group ID not shown but was the search parameter)", "": "", "S1-12.A.1-1.png": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting qprocess.exe"}, "Score": 7}, "CrowdStrike": {"Detects": ["General Behavior-Delayed-Tainted", "Telemetry", "General Behavior-Delayed"], "Screenshots": {"CS-E-6.png": "Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)", "": "", "CS-12.C.1-1.png": "OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 61}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-12.C.1-1.png": "Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)", "CR-12.B.1-2.png": "Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery"}, "Score": 22}, "Procedure": "Empire: 'qprocess *' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-12.C.1-1.png": "Telemetry from process tree showing qprocess.exe with command-line arguments", "CB-12.C.1-2.png": "Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)"}, "Score": 25}}}, "TacticGroup": "Discovery"}, "T1022": {"TechniqueName": "Data Encrypted", "Steps count": 1, "Steps": {"19.B.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-19.C.1-1.png": "General Behavior alert showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-19.B.1-4.png": "Telemetry showing recycler.exe execution"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-19.B.1-1.png": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression", "MS-19.A.1-3.png": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-19.B.1-1.png": "Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["General Behavior", "Enrichment", "Enrichment", "General Behavior", "Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-19.B.1-2.png": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with correct ATT&CK Technique, T1022 - Data Encrypted)", "FE-19.B.1-3.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.B.1-1.png": "General Behavior alert for Execution from Suspicious Directory", "FE-19.B.1-4.png": "General Behavior alert for File Write To Root Of Recycle Bin", "FE-19.B.1-5.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)", "": ""}, "Score": 162}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-19-1.png": "Telemetry showing execution of recycler.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-19-1.png": "Enriched event tree showing enrichment of recycler.exe and creation of old.rar output with correct ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration) (tainted by Windows Script Executing PowerShell alert, tree is initially available unenriched to show the base telemetry)", "EG-19-4.png": "Specific Behavior alert for the execution of recycler.exe named \\\"Exfiltration-Encrypting Files with WinRar\\\" (tainted by Windows Script Executing PowerShell alert)"}, "Score": 73}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change", "Telemetry-Tainted"], "Screenshots": {"": "", "CT-19.B.1-1.png": "Enrichment showing recycler.exe creating old.rar (enriched with \\\"Data Exfiltration Archiving\\\", tainted by parent \\\"Powershell executed encoded command\\\" alerts)", "CT-19.B.1-3.png": "Telemetry showing recycler.exe with full command-line (tainted by parent \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts)"}, "Score": 16}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-19.A.1-2.png": "Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)", "MC-19.A.1-3.png": "Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-19.A.1-2.png": "Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID", "S1-19.B.1-1.png": "Telemetry showing the execution of recycler.exe"}, "Score": 7}, "CrowdStrike": {"Detects": ["Specific Behavior-Tainted", "Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-19.B.1-1.png": "Specific Behavior alert showing use of -hp flags within command-line (mapped to related ATT&CK Technique, Data Compressed, and correct Tactic, Exfiltration; tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)", "": ""}, "Score": 124}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-19.B.1-20.png": "Telemetry showing recycler.exe execution\u00a0(tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing recycler.exe and command-line arguments with encryption password", "": "", "CB-19.B.1-2.png": "Enrichment of recycler.exe with correct ATT&CK Technique (1022 - Data Encrypted)"}, "Score": 25}}}, "TacticGroup": "Exfiltration"}, "T1056": {"TechniqueName": "Input Capture", "Steps count": 2, "Steps": {"8.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["Telemetry-Configuration Change", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-8.C.1-3.png": "Telemetry showing explorer.exe reading user keystrokes", "MS-8.C.1-2.png": "Specific Behavior alert for \\\"Possible keylogging activity\\\" against explorer.exe", "MS-8.C.1-1.png": "Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)"}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"PA-8.C.1-2.png": "Telemetry showing code injection into explorer.exe (does not count as a detection)", "PA-8.C.1-3.png": "Telemetry showing hook injection from explorer.exe (does not count as a detection)", "PA-8.C.1-1.png": "Enrichment of the execution of a specific API call as keylogging and suspicious activity", "": ""}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"RSA-08-3.png": "Floating Code module output showing keylogger key definitions (does not count as a detection)", "RSA-08-2.png": "Floating Code module output showing keylogger aggressor script (does not count as a detection)", "": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"EG-08-2.png": "Event tree showing a Process Injection alert from which strings were pulled (does not count as a detection)", "": "", "EG-08-4.png": "Strings output extracted from Process Injection alert, showing key definitions typically associated with a keylogger, but no evidence of execution (does not count as a detection)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-8.C.1-2.png": "Command-Line Interface view for host Nimda kicking off DDNA Scan for PID 11252 (does not count as a detection)", "CT-8.C.1-3.png": "DDNA JSON output from PID 11252 showing process capabilities (does not count as a detection)", "CT-8.C.1-1.png": "Telemetry showing remote thread being created into explorer.exe (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": "", "MC-8.C.1-3.png": "Alert that cmd.exe obtained a handle to the memory thread and injected code into explorer.exe (does not count as detection)"}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-8.C.1-2.png": "Telemetry showing GetAsyncKeyStateApi (Group ID tainted the event but was not shown in this view)", "S1-8.C.1-1.png": "Telemetry showing process injection into explorer.exe (does not count as a detection)"}, "Score": 7}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"CS-8.C.1-1.png": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)", "": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"CR-8.C.1-10.png": "Alert for Chain of Injections for powershell.exe injecting into cmd.exe (does not count as detection)", "CR-8.C.1-11.png": "Alert showing loaded keyloggerx64.dll module (does not count as detection)", "CR-8.C.1-12.png": "Alert showing keyloggerx64.dll module loaded into explorer.exe, including memory address and size (does not count as a detection)", "": "", "CR-8.C.1-100.png": "Alert for Chain of Injections showing powershell.exe injecting into explorer.exe (does not count as detection)"}, "Score": 0}, "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "15.A.1": {"F-Secure": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CC-15.A.1-1.png": "Telemetry showing powershell.exe executing the GetAsyncKeyState method", "CC-15.B.1-3.png": "Enrichment of powershell.exe with a tag indicating .NET keylogging"}, "Score": 25}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-15.A.1-1.png": "Telemetry showing execution of Get-Keystrokes cmdlet", "MS-15.A.1-2.png": "Telemetry showing keylogger events", "MS-15.A.1-3.png": "Specific Behavior alert for keylogging activity from powershell.exe", "MS-15.A.1-5.png": "Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)"}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Enrichment", "Indicator of Compromise"], "Screenshots": {"": "", "PA-15.A.1-2.png": "Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window", "PA-15.A.1-1.png": "Enrichment of the execution of a specific API call as keylogging and suspicious activity"}, "Score": 35}, "FireEye": {"Detects": ["None"], "Screenshots": {"FE-15.A.1-1.png": "PowerShell activity during the time of the keylogging (does not count as detection)", "": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-15-1.png": "Telemetry showing PowerShell Script Block logging with execution of Get-KeyStrokes (does not count as a detection)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "S1-15.A.1-1.png": "Enrichment of use of GetAsyncKeyStateApi tagged as a keylogger (tainted by relationship to threat story but Group ID not shown in this view)"}, "Score": 12}, "CrowdStrike": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"CS-E-12.png": "Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)", "": "", "CS-15.B.1-1.png": "Telemetry showing FsPostOpen event for IT_tasks.txt", "CS-15.B.1-2.png": "Telemetry showing file read event for IT_tasks.txt"}, "Score": 37}, "Cybereason": {"Detects": ["Indicator of Compromise", "Telemetry"], "Screenshots": {"": "", "CR-15.A.1-20.png": "Indicator of Compromise alert for Malicious Command Get-Keystrokes\u00a0", "CR-15.A.1-100.png": "Telemetry showing modloads associated with a keylogger"}, "Score": 30}, "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-15.A.1-1.png": "Telemetry showing modloads associated with keylogger", "CB-15.A.1-3.png": "Enrichment of data with tag \\\"PowerShell Input Capture -keylogger\\\""}, "Score": 25}}}, "TacticGroup": "collection, Credential Access"}, "T1026": {"TechniqueName": "Multiband Communication", "Steps count": 1, "Steps": {"6.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-1.C.1-1.png": "Telemetry showing rundll32.exe making DNS queries", "CC-6.B.1-T1043-new.png": "Telemetry showing rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server)"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-6.B.1-1.png": "Telemetry showing execution sequence for rundll32.exe opening port 80 network connection", "MS-6.B.1-2.png": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection", "MS-6.B.1-3.png": "Telemetry showing DNS traffic to C2 domain"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"PA-6.B.1-1.png": "Telemetry showing ports 80 and 53 command and control traffic", "": ""}, "Score": 10}, "FireEye": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-6.B.1-4.png": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)", "FE-6.B.1-2.png": "Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)"}, "Score": 67}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-06-6.png": "Telemetry showing DNS connections", "EG-06-7.png": "Telemetry showing port 80 traffic (tainted by parent\u00a0Malicious File Detection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-1.C.1-1.png": "Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe", "CT-6.B.1-1.png": "Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by the parent \\\"Sponsor Process Established Network Connection\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-6.B.1-1.png": "Telemetry showing port 80 connection to 192.168.0.4 (C2 server)", "S1-1.C.1-1.png": "Telemetry showing DNS query to C2 domain (tainted by relationship to threat story shown in Group ID)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-6.C.1-1.png": "Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)", "CS-1.C.1-2.png": "Telemetry within an alert showing abnormally large DNS requests occurred (tainted by parent Exfiltration alert)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-6.B.1-20.png": "Telemetry showing the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain) (tainted by a parent Injected Shellcode alert, listed as Owner process)", "": ""}, "Score": 7}, "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"CB-6.B.1-3.png": "Telemetry showing network connection over UDP port 53", "CB-6.B.1-2.png": "Telemetry showing network connection over TCP port 80", "": ""}, "Score": 10}}}, "TacticGroup": "Command and Control"}, "T1077": {"TechniqueName": "Windows Admin Shares", "Steps count": 3, "Steps": {"16.B.1": {"F-Secure": {"Detects": ["Telemetry", "Specific Behavior", "General Behavior"], "Screenshots": {"": "", "CC-16.B.1-2.png": "Specific Behavior alerts for net.exe connecting to a remote administrative share", "CC-16.B.1-3.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-16.C.1-1.png": "Telemetry showing a net use logon attempt to ADMIN$ shares"}, "Score": 100}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-16.A.1-1.png": "Specific Behavior alert for brute force attempt to remote SMB shares", "MS-16.B.1-1.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-16.B.1-1.png": "Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-16.B.1-1.png": "Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)", "FE-16.B.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"RSA-16-2.png": "Telemetry showing logon attempt targeting ADMIN$ via net.exe and command-line arguments", "": ""}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"EG-16-7.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "": "", "EG-16-3.png": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)"}, "Score": 73}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.B.1-2.png": "Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\\"FileExts Registry Key modified\\\" alert)", "CT-16.B.1-1.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"MC-16.A.1-3.png": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)", "MC-16.A.1-2.png": "Specific Behavior alert for the net utility executed to authenticate to a remote admin share with valid accounts, tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares)", "": ""}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.B.1-1.png": "Telemetry showing a net.exe logon attempt targeting ADMIN$ (tainted by relationship to threat story)", "S1-16.A.1-2.png": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)", "CS-16.B.1-2.png": "OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)", "CS-16.B.1-1.png": "Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, "Score": 58}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.B.1-20.png": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, "Score": 67}, "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00a0", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"CB-16.B.1-1.png": "Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$", "": "", "CB-16.B.1-2.png": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}, "Score": 70}}, "16.D.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-16.C.1-3.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-16.C.1-1.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.D.1-1.png": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"PA-16.D.1-1.png": "Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)", "": ""}, "Score": 7}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-16.D.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)", "FE-16.D.1-1.png": "Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-4.png": "Telemetry showing logon attempt targeting C$ via net.exe and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"EG-16-7.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "EG-16-6.png": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)", "": ""}, "Score": 73}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.D.1-1.png": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MC-16.D.1-5.png": "Specific Behavior alert for the net utility removing a shared connection via PowerShell, mapped to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)", "MC-16.D.1-9.png": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)"}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.D.1-1.png": "Telemetry showing a net.exe logon attempt targeting C$ (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)", "CS-16.D.1-2.png": "Telemetry showing process tree containing successful net use connection to C$ (tainted by previous powershell.exe detection by red line indicating high severity)"}, "Score": 34}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.D.1-10.png": "Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)", "CR-16.D.1-100.png": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, "Score": 67}, "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-16.D.1-2.png": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)", "CB-16.D.1-1.png": "Telemetry showing process tree with successful net.exe logon targeting C$"}, "Score": 70}}, "16.A.1": {"F-Secure": {"Detects": ["Telemetry", "Specific Behavior", "General Behavior"], "Screenshots": {"CC-16.A.1-1.png": "Specific Behavior alerts for net.exe connecting to a remote administrative share", "": "", "CC-16.A.1-2.png": "Telemetry showing net use logon attempts to ADMIN$ shares", "CC-16.A.1-99.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, "Score": 100}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"MS-16.A.1-3.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.A.1-2.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.A.1-1.png": "Specific Behavior alert for brute force attempt to remote SMB shares", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "": "", "MS-16.A.1-4.png": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"}, "Score": 64}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "PA-16.A.1-5.png": "Specific Behavior alert for a net.exe logon attempt to ADMIN$ tagged with the correct ATT&CK Technique (Windows Admin Shares)", "PA-16.A.1-1.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local user Kmitnick (tainted by a parent alert on wscript.exe)", "PA-16.A.1-2.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)", "PA-16.A.1-3.png": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)"}, "Score": 67}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"FE-16.A.1-2.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Bob", "FE-16.A.1-3.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick", "FE-16.A.1-1.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Frieda", "FE-16.A.1-4.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick", "": ""}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-1.png": "Telemetry showing logon attempts targeting ADMIN$ via net.exe and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-16-2.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)", "EG-16-1.png": "Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)"}, "Score": 73}, "CounterTack": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "CT-16.A.1-1.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)", "CT-16.A.1-2.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)", "CT-16.A.1-3.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)", "CT-16.A.1-4.png": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, "Score": 12}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-16.A.1-1.png": "Telemetry showing powershell.exe executing repeated logon attempts targeting ADMIN$ via net.exe (tainted by a parent alert on powershell.exe)"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.A.1-2.png": "Telemetry showing net.exe logon attempts targeting ADMIN$ and corresponding exit codes", "S1-16.A.1-1.png": "Telemetry showing net.exe logon attempts targeting ADMIN$ (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "General Behavior-Delayed-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-16.A.1-1.png": "Telemetry showing net use logon attempts to ADMIN$ shares", "": "", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)", "CS-16.A.1-2.png": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)"}, "Score": 61}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.A.1-20.png": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-2.png": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-3.png": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-1.png": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)", "CR-16.A.1-10.png": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, "Score": 67}, "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-16.A.1-3.png": "Specific Behavior alerts for of the 4 different net.exe logon attempts", "CB-16.A.1-1.png": "Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$"}, "Score": 70}}}, "TacticGroup": "Lateral Movement"}, "T1115": {"TechniqueName": "Clipboard Data", "Steps count": 1, "Steps": {"12.E.1.5": {"F-Secure": {"Detects": ["Telemetry", "Indicator of Compromise"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "CC-12.E.1-4.png": "Indicator of Compromise alert for PowerShell Empire accessing the clipboard."}, "Score": 30}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"PA-12.E.1.5-1.png": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data)", "": ""}, "Score": 15}, "FireEye": {"Detects": ["Indicator of Compromise-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker executed the Windows Clipboard capability of Empire (Indicator of Compromise)", "FE-12.E.1.5-2.png": "Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)", "FE-12.E.1.5-1.png": "PowerShell Execution alert containing encoded PowerShell command (does not count as a detection)"}, "Score": 17}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-12-E-05.png": "Interactive Shell events showing the WinEnum script and Clipboard Contents function (does not count as part of detection due to manual process of pulling events)", "EG-12-4.png": "Telemetry showing decoded PowerShell displaying Windows.Clipboard as part of WinEnum. The PowerShell process was tainted by parent PowerShell alerts."}, "Score": 7}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": "", "MC-12.E.1.1-5.png": "Telemetry showing execution of an encoded PowerShell command (does not count as a detection)"}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": "", "CS-12.E.1.5-1.png": "OverWatch alert indicating encoded PowerShell was suspicious (does not count as a detection)", "CS-12.E.1.5-3.png": "Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)", "CS-12.E.1-2.png": "Telemetry showing encoded PowerShell, which decodes to show Windows.Clipboard details (does not count as a detection)"}, "Score": 0}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-12.E.1.5-1.png": "Telemetry of the PowerShell function to gather clipboard data (tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "collection"}, "T1050": {"TechniqueName": "New Service", "Steps count": 1, "Steps": {"16.I.1": {"F-Secure": {"Detects": ["Telemetry", "Specific Behavior", "General Behavior"], "Screenshots": {"CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments", "CC-16.D.1-2.png": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}, "Score": 100}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"MS-16.I.1-3.png": "Specific Behavior alert on suspicious service registration on Creeper", "MS-16.I.1-2.png": "Telemetry showing AdobeUpdater service registry information that was changed on Creeper", "MS-16.I.1-1.png": "Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation", "MS-16.D.1-4.png": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "": ""}, "Score": 67}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted", "Enrichment"], "Screenshots": {"PA-16.I.1-4.png": "Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)", "": "", "PA-16.I.1-1.png": "Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)", "PA-16.I.1-2.png": "Telemetry showing the creation of Registry keys associated with the AdobeUpdater service ", "PA-16.I.1-3.png": "Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)"}, "Score": 79}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-16.I.1-3.png": "Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)", "FE-16.I.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-7.png": "Telemetry showing execution of sc.exe to create the AdobeUpdater service"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Delayed-Tainted", "Specific Behavior"], "Screenshots": {"": "", "EG-16-14.png": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)", "EG-16-13.png": "Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)"}, "Score": 76}, "CounterTack": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Configuration Change"], "Screenshots": {"": "", "CT-16.I.1-1.png": "Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\\"Powershell executed remote commands\\\" alert)", "CT-16.I.1-2.png": "Specific Behavior alert for \\\"\\\"New Windows service created\\\"\\\" and additional alert for \\\"Windows Service Registry Key modified\\\" "}, "Score": 64}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-16.J.1-4.png": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)", "": "", "MC-16.I.1-1.png": "Telemetry showing that a new service was added", "MC-16.J.1-3.png": "Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.I.1-1.png": "Telemetry showing execution of sc.exe to create the AdobeUpdater service (tainted by prior threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-16.H.1-2.png": "Telemetry from process tree showing sc.exe execution to create the AdobeUpdater service (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed a newly created file (AdobeUpdater service in registry) to establish persistence (General Behavior)", "CS-16.H.1-4.png": "Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description"}, "Score": 34}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.I.1-13.png": "Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)"}, "Score": 67}, "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-16.H.1-3.png": "Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK", "CB-16.I.1-1.png": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}, "Score": 70}}}, "TacticGroup": "Persistence, Privilege Escalation"}, "T1069": {"TechniqueName": "Permission Groups Discovery", "Steps count": 6, "Steps": {"12.E.1.2": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": "", "FE-12.E.1.2-1.png": "Telemetry showing loading of System.DirectoryServices.AccountManagement assembly (does not count as a detection)"}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-03.png": "Interactive Shell events showing the WinEnum script and the AD Group Memberships function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-12.E.1.2-1.png": "Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper) (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.F.1": {"F-Secure": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"": "", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "CC-12.F.1-T1069-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-12.F.1-1.png": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments", "MS-12.F.1-2.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments", "MS-12.E.1-4.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"PA-12.F.1-3.png": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)", "PA-12.F.1-2.png": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)", "PA-12.F.1-1.png": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)", "": "", "PA-12.F.1-4.png": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}, "Score": 46}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "FE-12.F.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-2.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed", "Enrichment-Tainted"], "Screenshots": {"": "", "EG-12-7.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)", "EG-12-5.png": "Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)"}, "Score": 28}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-12.F.1-1.png": "Enrichment of net.exe with conditions Net Domain Admins Reconnaissance Command and Net Group Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment", "Enrichment"], "Screenshots": {"": "", "MC-12.F.1-99.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups", "MC-12.F.1-1.png": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)", "MC-12.F.1-2.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins"}, "Score": 37}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.F.1-3.png": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-12.F.1-3.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)", "CS-12.F.1-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)"}, "Score": 46}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"CR-12.F.1-1.png": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)", "": "", "CR-12.F.1-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, "Score": 37}, "Procedure": "Empire: 'net group \"Domain Admins\" /domain' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-12.F.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "": "", "CB-12.F.1-3.png": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}, "Score": 25}}, "12.F.2": {"F-Secure": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"CC-12.F.2-T1069-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": "", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-12.F.2-2.png": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments", "MS-12.F.2-1.png": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments", "MS-12.E.1-4.png": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, "Score": 34}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment"], "Screenshots": {"": "", "PA-12.F.2-1.png": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)", "PA-12.F.2-2.png": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)", "PA-12.F.2-3.png": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}, "Score": 34}, "FireEye": {"Detects": ["Enrichment", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "FE-12.F.2-1.png": "Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, "Score": 42}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-2.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Delayed", "Enrichment-Tainted"], "Screenshots": {"": "", "EG-12-7.png": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert."}, "Score": 28}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-12.F.2-1.png": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-12.F.1-1.png": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)", "MC-12.F.1-2.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.F.1-1.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-12.F.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net localgroup was part of additional malicious discovery activity (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-12.F.2-1.png": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)", "CR-12.F.2-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, "Score": 37}, "Procedure": "Empire: 'net\u00a0localgroup\u00a0administrators' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-12.F.1-3.png": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)", "CB-12.F.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments"}, "Score": 25}}, "2.F.1": {"F-Secure": {"Detects": ["General Behavior", "Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"CC-2.F.1-2.png": "Telemetry showing net.exe with command-line arguments", "": "", "CC-2.F.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "CC-2.F.1-98.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "CC-2.F.1-99.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, "Score": 85}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities", "MS-2.F.1-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments", "MS-2.F.1-2.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"PA-2.F.1-1.png": "Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)", "": ""}, "Score": 15}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)", "FE-2.F.1-2.png": "Excerpt from the Managed Defense Report with additional details about net", "FE-2.F.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-3.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-10.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)", "EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "": "", "EG-02-16.png": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, "Score": 40}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-2.F.1-1.png": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)", "MC-2.B.1-6.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-10.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)", "CS-2.F.1-3.png": "OverWatch General Behavior alert for net localgroup ", "CS-2.F.1-1.png": "Telemetry showing net with command-line arguments", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)", "": ""}, "Score": 61}, "Cybereason": {"Detects": ["Telemetry", "Enrichment-Tainted"], "Screenshots": {"": "", "CR-2.F.1-10.png": "Telemetry showing cmd.exe executing net with command-line arguments", "CR-2.D.2-10.png": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)", "CR-2.F.1-100.png": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-2.F.1-3.png": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)", "CB-2.F.1-2.png": "Enrichment of net.exe with tag Administrator Enumeration", "CB-2.F.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "": ""}, "Score": 25}}, "2.F.3": {"F-Secure": {"Detects": ["Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-2.F.3-1.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance", "CC-2.F.3-2.png": "Telemetry showing net.exe with command-line arguments", "CC-2.F.3-3.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"MS-2.F.3-2.png": "Telemetry showing domain admins group discovery by Nimda at the domain controller", "MS-2.F.3-3.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments", "MS-2.F.3-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities", "": ""}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-2.F.3-5.png": "Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.F.3-4.png": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.F.3-3.png": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.F.3-2.png": "Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-2.F.3-1.png": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 31}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-2.F.3-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)", "FE-2.F.3-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}, "Score": 72}, "RSA": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"RSA-02-5.png": "Event enrichment from IIOC module \\\"Enumerates domain administrators\\\"", "": "", "RSA-02-3.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 25}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)", "EG-02-12.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)", "": "", "EG-02-17.png": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}, "Score": 40}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-2.F.3-1.png": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.A.1-27.png": "Enrichment of net group with a correct ATT&CK Tactic (Discovery) and Technique (Permission Group Discovery) and a suspicious indicator that a net utility was used to gather information of user groups", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-2.A.1-12.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.F.1-2.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity", "CS-2.F.1-1.png": "Telemetry showing net with command-line arguments", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)", "": ""}, "Score": 46}, "Cybereason": {"Detects": ["Telemetry", "General Behavior-Tainted"], "Screenshots": {"": "", "CR-2.F.3-100.png": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)", "CR-2.D.2-10.png": "Process tree showing alerted net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)", "CR-2.F.3-10.png": "Telemetry showing cmd.exe executing net with command-line arguments"}, "Score": 37}, "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" /domain' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.F.3-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.F.3-3.png": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)", "CB-2.F.3-2.png": "Enrichment of net.exe with tag Administrator Enumeration"}, "Score": 25}}, "2.F.2": {"F-Secure": {"Detects": ["General Behavior", "Enrichment", "Telemetry", "General Behavior"], "Screenshots": {"CC-2.F.2-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "": "", "CC-2.F.2-99.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance", "CC-2.F.2-2.png": "Telemetry showing net.exe with command-line arguments", "CC-2.F.2-98.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}, "Score": 85}, "Microsoft": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "MS-2.A.1-3.png": "General Behavior alert on suspicious sequence of exploration activities", "MS-2.F.2-2.png": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments", "MS-2.F.2-1.png": "Telemetry showing execution sequence for net.exe with command-line arguments"}, "Score": 37}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-2.F.2-1.png": "Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)", "FE-2.F.2-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)", "FE-2.F.2-2.png": "Excerpt from the Managed Defense Report with additional details about net"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-02-3.png": "Telemetry showing net.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "General Behavior-Configuration Change-Delayed-Tainted"], "Screenshots": {"EG-02-18.png": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period", "EG-02-11.png": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)", "": "", "EG-02-16.png": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)", "EG-02-19.png": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, "Score": 40}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-2.F.2-1.png": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"": "", "MC-2.B.1-4.png": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)", "MC-2.B.1-6.png": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-2.A.1-11.png": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)", "": "", "CS-2.F.1-1.png": "Telemetry showing net with command-line arguments", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry", "Enrichment-Tainted"], "Screenshots": {"CR-2.F.2-10.png": "Telemetry showing cmd.exe executing net with command-line arguments", "": "", "CR-2.D.2-10.png": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)", "CR-2.F.2-100.png": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, "Score": 22}, "Procedure": "Cobalt Strike: 'net localgroup administrators /domain' via cmd", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-2.F.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.F.2-2.png": "Enrichment of net.exe with tag Administrator Enumeration", "CB-2.F.2-3.png": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}, "Score": 25}}}, "TacticGroup": "Discovery"}, "T1126": {"TechniqueName": "Network Share Connection Removal", "Steps count": 1, "Steps": {"16.C.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-16.C.1-3.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-16.C.1-1.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.C.1-1.png": "Telemetry showing net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content)", "MS-16.A.1-6.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"PA-16.C.1-2.png": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal)", "": "", "PA-16.C.1-1.png": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, "Score": 22}, "FireEye": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-16.C.1-1.png": "Telemetry showed net.exe executing with command-line arguments. ", "FE-16.B.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)"}, "Score": 67}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-3.png": "Telemetry showing net.exe execution and command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-16-5.png": "Telemetry showing event tree containing net.exe and command-line argument (tainted by parent PowerShell alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.C.1-1.png": "Telemetry showing net.exe and command-line arguments (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"MC-16.A.1-3.png": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)", "MC-16.A.1-2.png": "Specific Behavior alert for the net utility removing a shared connection via PowerShell, tagged to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)", "": ""}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-16.C.1-1.png": "Telemetry showing net.exe and command-line arguments (tainted by relationship to threat story)", "": ""}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating they observed ADMIN$ artifact removed (General Behavior)", "CS-16.C.1-1.png": "Telemetry from process tree showing net.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, "Score": 34}, "Cybereason": {"Detects": ["General Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-16.C.1-10.png": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}, "Score": 37}, "Procedure": "Empire: 'net use /delete' via PowerShell", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-16.C.1-1.png": "Telemetry showing process tree with net.exe and command-line arguments", "CB-16.B.1-2.png": "Specific Behavior alerts for removing connected network share"}, "Score": 70}}}, "TacticGroup": "Defense Evasion"}, "T1107": {"TechniqueName": "File Deletion", "Steps count": 2, "Steps": {"19.D.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-19.D.1-1.png": "Telemetry showing the deletion of old.rar"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"MS-19.D.1-1.png": "Telemetry showing PowerShell executing the Remove-Item cmdlet (does not count as a detection)", "": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-19.D.1-1.png": "Telemetry showing the file delete event for old.rar (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-19-3.png": "Master file table on 10.0.1.5 (CodeRed) shows old.rar listed under deleted files (does not count as a detection)"}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-19.D.1-1.png": "Telemetry showing powershell.exe deleting old.rar (tainted by the parent \\\"PowerShell executed encoded commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-19.D.1-1.png": "Telemetry exported from threat story showing the deletion of old.rar was tainted by prior activity because it was under the same Group ID"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed old.rar being deleted (Specific Behavior)", "": "", "CS-19.D.1-1.png": "Telemetry showing deletion of old.rar"}, "Score": 67}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-19.D.1-10.png": "Telemetry showing a deletion event for old.rar via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)", "": ""}, "Score": 7}, "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-19.D.1-1.png": "Telemetry showing filemod (file modification) deletion of old.rar"}, "Score": 10}}, "19.D.2": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-19.D.1-1.png": "Telemetry showing the deletion of recycler.exe"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-19.D.1-1.png": "Telemetry showing the file delete event for recycler.exe (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-19-3.png": "Telemetry showing file deletion of recycler.exe"}, "Score": 10}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-19.D.2-1.png": "Telemetry showing powershell.exe deleting recycler.exe (tainted by the parent \\\"PowerShell executed encoded commands\\\" alert)", "": ""}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-19.D.1-1.png": "Telemetry showing file deletion event for recycler.exe (tainted by a parent alert on cmd.exe)", "MC-19.D.1-9.png": "Enrichment of PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder", "": ""}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-19.D.1-1.png": "Telemetry exported from threat story showing the deletion of recycler.exe was tainted by prior activity because it was under the same Group ID"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed recycler.exe being deleted (Specific Behavior)", "CS-19.D.1-2.png": "Telemetry showing deletion of recycler.exe", "": ""}, "Score": 67}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-19.D.2-10.png": "Telemetry showing a deletion event for recycler.exe via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)"}, "Score": 7}, "Procedure": "Empire: 'del recycler.exe'", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-19.D.1-1.png": "Telemetry showing filemod (file modification) deletion of recycler.exe"}, "Score": 10}}}, "TacticGroup": "Defense Evasion"}, "T1106": {"TechniqueName": "Execution through API", "Steps count": 8, "Steps": {"8.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "3.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "8.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "9.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "8.D.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "9.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "2.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.E.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Execution"}, "T1105": {"TechniqueName": "Remote File Copy", "Steps count": 5, "Steps": {"19.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-19.B.1-2.png": "Telemetry showing the creation of recycler.exe"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-19.A.1-1.png": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH", "MS-19.A.1-3.png": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "General Behavior-Tainted", "General Behavior-Tainted"], "Screenshots": {"PA-19.A.1-3.png": "General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)", "PA-19.A.1-2.png": "General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)", "PA-19.A.1-1.png": "Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)", "": ""}, "Score": 61}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-19.A.1-1.png": "Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)", "FE-19.A.1-2.png": "Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-19-1.png": "Telemetry showing file write of recycler.exe"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-19-1.png": "Telemetry showing file creation of recycler.exe by powershell.exe (tainted by parent PowerShell alerts)"}, "Score": 7}, "CounterTack": {"Detects": ["General Behavior-Configuration Change", "Telemetry-Tainted"], "Screenshots": {"": "", "CT-19.A.1-2.png": "Telemetry showing creation of recycler.exe (tainted by \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts) and powershell.exe behavior contributing to \\\"Policy Dropper Behavior\\\" alert", "CT-19.A.1-1.png": "General Behavior alert for \\\"Policy Dropper Behavior\\\" based on three correlated events"}, "Score": 34}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-19.A.1-1.png": "Telemetry showing file creation event for recycler.exe"}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"S1-19.A.1-1.png\n": "Telemetry showing file write of recycler.exe", "": "", "S1-19.A.1-2.png": "Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-19.A.1-3.png": "Telemetry showing network connection from 192.168.0.5 (C2 server) used by powershell.exe to transfer recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)", "CS-19.A.1-1.png": "Telemetry showing file write of recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-19.A.1-20.png": "Telemetry showing file create/write of recycler.exe (tainted by a parent PowerShell alert, listed as Owner process)"}, "Score": 7}, "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing filemod (file modification) creation of recycler.exe", "": ""}, "Score": 10}}, "7.B.1": {"F-Secure": {"Detects": ["Enrichment"], "Screenshots": {"": "", "CC-7.B.1-1.png": "Enrichment of the creation of updater.dll identifying that a command prompt modified an unknown DLL"}, "Score": 15}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"MS-7.B.1-1.png": "Telemetry showing file write of updater.dll", "": ""}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Specific Behavior-Tainted", "Specific Behavior"], "Screenshots": {"": "", "PA-7.B.1-1.png": "Telemetry showed the file create event for updater.dll", "PA-7.B.1-2.png": "Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)", "PA-7.B.1-3.png": "Specific Behavior alert for a Windows scripting engine creating an executable on disk"}, "Score": 127}, "FireEye": {"Detects": ["Enrichment", "Telemetry-Tainted"], "Screenshots": {"FE-7.B.1-2.png": "Telemetry showing updater.dll file write (tainted by parent AV signature alert)", "": "", "FE-7.B.1-1.png": "Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \u00a0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, "Score": 22}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-07-1.png": "Telemetry showing file write event of updater.dll"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-07-1.png": "Telemetry showing creation of updater.dll\u00a0(tainted by parent Malicious File Detection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-7.B.1-1.png": "Telemetry showing creation of updater.dll (tainted by the parent \\\"Powershell process created\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Specific Behavior", "Specific Behavior"], "Screenshots": {"MC-7.B.1-1.png": "Specific Behavior alert for a new PE file created in the Windows system (System32) folder", "": "", "MC-7.B.1-99.png": "Specific Behavior alert for a new dynamic library file created in the Windows system (System32) folder"}, "Score": 120}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-7.B.1-1.png": "Telemetry showing file write of updater.dll (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CS-7.B.1-2.png": "Additional telemetry showing\u00a0file write for updater.dll", "CS-7.B.1-1.png": "Telemetry showing file write for updater.dll (tainted by the parent \\\"unexpected process\\\" alert)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-7.B.1-10.png": "Telemetry showing the file write of updater.dll (tainted by a parent alert on cmd.exe, listed as Owner Process)", "CR-7.B.1-11.png": "Parent alert for updater.dll being detected as known malware"}, "Score": 7}, "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-7.B.1-1.png": "Telemetry showing updater.dll written to disk"}, "Score": 10}}, "16.E.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-16.D.1-6.png": "Telemetry showing the creation of autoupdate.vbs"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-16.D.1-4.png": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.E.1-1.png": "Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-16.E.1-1.png": "Telemetry showing file create and write events for autoupdate.vbs"}, "Score": 10}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"": "", "FE-16.E.1-2.png": "Additional details on enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert", "FE-16.E.1-1.png": "Enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy) and Tactics, Command and Control and Lateral Movement)"}, "Score": 15}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-16-5.png": "Telemetry showing file write of autoupdate.vbs"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-16-8.png": "Telemetry showing creation of autoupdate.vbs (tainted by parent PowerShell alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-16.E.1-1.png": "Telemetry showing powershell.exe creating autoupdate.vbs (tainted by parent \\\"Powershell executed remote commands\\\" alerts)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "MC-16.E.1-2.png": "Telemetry showing the creation of autoupdate.vbs", "MC-16.E.1-1.png": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell"}, "Score": 25}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.E.1-2.png": "Telemetry showing creation and writes to autoupdate.vbs", "S1-16.E.1-1.png": "Telemetry showing file event for autoupdate.vbs (tainted by relationship to threat story but Group ID not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating they observed autoupdate.vbs written (General Behavior)", "CS-16.E.1-1.png": "Telemetry showing File Write and New Script Write for autoupdate.vbs within powershell.exe (tainted by previous detection by orange line indicating medium severity)"}, "Score": 34}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-16.E.1-10.png": "Telemetry showing file write of autoupdate.vbs (tainted by a parent PowerShell alert, listed as Owner process)"}, "Score": 7}, "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-16.E.1-1.png": "Telemetry showing creation and write to autoupdate.vbs"}, "Score": 10}}, "14.A.1": {"F-Secure": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CC-14.A.1-2.png": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass", "CC-14.A.1-1.png": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}, "Score": 70}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-14.A.1-4.png": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments", "MS-14.A.1-3.png": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": "", "PA-14.A.1-5.png": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}, "Score": 0}, "FireEye": {"Detects": ["Enrichment"], "Screenshots": {"FE-14.A.1-4.png": "Enrichment of HTTP GET request for wdbypass with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy, and Tactic, Command and Control)", "": ""}, "Score": 15}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-14-1.png": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"EG-14-1.png": "Telemetry showing decoded PowerShell with download request of wdbypass over port 8080", "": ""}, "Score": 10}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-14.A.1-2.png": "Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["None"], "Screenshots": {"": "", "MC-14.A.1-1.png": "Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)"}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Specific Behavior-Delayed"], "Screenshots": {"": "", "CS-E-11.png": "Email excerpt from the OverWatch team indicating PowerShell retrieved the file wdbypass (Specific Behavior)"}, "Score": 57}, "Cybereason": {"Detects": ["Specific Behavior-Tainted"], "Screenshots": {"": "", "CR-14.A.1-40.png": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080", "CR-14.A.1-10.png": "Specific Behavior alert for Download & execute of the wdbypass file"}, "Score": 57}, "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": ""}, "Score": 10}}, "16.G.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-16.D.1-6.png": "Telemetry showing the creation of update.vbs"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-16.G.1-1.png": "Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)", "": "", "MS-16.D.1-4.png": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)", "MS-16.G.1-2.png": "Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Specific Behavior-Tainted"], "Screenshots": {"": "", "PA-16.G.1-2.png": "Specific Behavior alert for a script being modified/moved to a remote location (tainted by a parent alert on wscript.exe)", "PA-16.G.1-1.png": "Telemetry showed file create and write events for update.vbs"}, "Score": 67}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-16.G.1-1.png": "Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert", "FE-16.G.1-2.png": "Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": ""}, "Score": 10}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "CT-16.G.1-1.png": "Enrichment of powershell.exe creating update.vbs (tainted by parent \\\"Powershell executed remote commands\\\" alerts)"}, "Score": 9}, "McAfee": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"MC-16.G.1-1.png": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell", "": "", "MC-16.G.1-2.png": "Telemetry showing the creation of update.vbs"}, "Score": 25}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-16.G.1-2.png": "Telemetry showing create file event of update.vbs on 10.0.0.4 (Creeper) (tainted by relationship to threat story but Group ID not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-16.G.1-1.png": "Telemetry showing update.vbs with event_name NewScriptWritten indicating a write to C$"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-16.G.1-10.png": "Telemetry of file events for write of update.vbs to Creeper (10.0.0.4) (tainted by a parent PowerShell alert, listed as Owner process)", "": ""}, "Score": 7}, "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-16.G.1-1.png": "Telemetry showing remote creation and write to update.vbs"}, "Score": 10}}}, "TacticGroup": "Command and Control, Lateral Movement"}, "T1134": {"TechniqueName": "Access Token Manipulation", "Steps count": 2, "Steps": {"3.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-3.A.1-1.png": "Telemetry showing logon event for user Debbie with an elevated token", "CC-3.A.1-3.png": "Telemetry showing svchost.exe executed with the seclogon command-line argument "}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-3.A.1-2.png": "Telemetry showing svchost.exe execution with seclogon command-line argument then subsequent powershell.exe", "": "", "MS-3.C.1-2.png": "Alert for \\'Suspicious PowerShell command-line\\' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-3.A.1-2.png": "Telemetry showing logon event with an elevated token and new logon ID", "PA-3.A.1-1.png": "Telemetry showing svchost.exe executed with the seclogon command-line argument"}, "Score": 10}, "FireEye": {"Detects": ["Telemetry-Configuration Change"], "Screenshots": {"": "", "FE-3.A.1-3.png": "Telemetry showing svchost.exe seclogon event for token login ID 0xfcf5fd", "FE-3.A.1-4.png": "Telemetry showing group membership of token logon ID 0xfcf5fd, which includes S-1-16-12288 (High Mandatory Level)"}, "Score": 7}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"": "", "EG-03-06.png": "Telemetry showing powershell.exe spawned with token authentication id 100243447", "EG-03-7.png": "Telemetry showing svhost.exe seclogon event for token login id 0x5f997f7 (100243447)"}, "Score": 10}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": "", "CT-3.A.1-2.png": "Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)", "CT-3.A.1-1.png": "Alert for PowerShell process creation (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["Telemetry-Delayed"], "Screenshots": {"MC-3.A.1-2.png": "Telemetry showing a New Credentials logon event for user Debbie", "": "", "MC-3.A.1-1.png": "Telemetry showing svchost.exe, with the seclogon command-line argument"}, "Score": 7}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": "", "CR-3.C.1-10.png": "Alert for malicious code injection into PowerShell (does not count as a detection)", "CR-3.A.1-10.png": "Telemetry showing the bypassuactoken.x64.dll was loaded (does not count as a detection)"}, "Score": 0}, "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"CB-3.A.1-5.png": "Telemetry showing svchost.exe activity related to token manipulation", "": "", "CB-3.A.1-6.png": "Telemetry showing svchost.exe command line arguments, specifically seclogon"}, "Score": 10}}, "5.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-5.B.1-T1134-new.png": "Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-5.B.1-4.png": "Alert for suspicious process injection showing tainted association via a process tree containing subsequent cmd.exe processes (inner failure message in screenshot not relevant to tested functionality)", "MS-5.B.1-2.png": "Telemetry showing resulting cmd.exe running as user George", "MS-5.B.1-1.png": "Telemetry showing svchost.exe invocation with seclogon flag subsequently running cmd.exe as SYSTEM"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-5.B.1-1.png": "Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation (tainted by a parent process injection alert on cmd.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Telemetry"], "Screenshots": {"": "", "FE-5.B.1-1.png": "Telemetry showing the user George executing reg.exe with command-line arguments during Step 6", "FE-4.A.1-1.png": "Telemetry showing the user Debbie executing net.exe with command-line arguments during Step 4"}, "Score": 10}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Specific Behavior", "Telemetry-Tainted"], "Screenshots": {"": "", "EG-05-7.png": "Telemetry showing the cmd.exe that spawned as user George from rundll32.exe running as user Debbie (tainted by parent Privilege Escalation alert)", "EG-05-6.png": "Specific Behavior alert on Privilege Escalation showing a process spawning (cmd.exe) with different tokens than the parent (rundll32.exe) (mapped to the correct ATT&CK Technique, T1134 - Access Token Manipulation, and Tactics, Privilege Escalation and Defense Evasion)"}, "Score": 67}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-5.C.1-1.png": "Telemetry showing a change in user execution context from Debbie to George between processes"}, "Score": 10}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"CS-5.B.1-1.png": "Telemetry showing children of the compromised process (PID 21898821890) first running as Debbie, then as George", "": ""}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-5.B.1-10.png": "Telemetry within the process tree showing cmd.exe associated with users Debbie and George (tainted by a parent alert on explorer.exe)", "": ""}, "Score": 7}, "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-5.B.1-2.png": "Telemetry showing parent cmd.exe process running under user context Debbie", "CB-5.B.1-3.png": "Telemetry showing child cmd.exe process running under user context George"}, "Score": 10}}}, "TacticGroup": "Defense Evasion, Privilege Escalation"}, "T1064": {"TechniqueName": "Scripting", "Steps count": 3, "Steps": {"1.A.1": {"F-Secure": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"": "", "CC-1.A.1-4.png": "Telemetry showing the execution of pdfhelper.cmd"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-1.B.1-1.png": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "PA-1.A.1-3.png": "Specific Behavior alert for execution of Windows script engine tagged with the correct ATT&CK Technique (Scripting)", "PA-1.A.1-2.png": "Telemetry showing cmd.exe launching pdfhelper.cmd"}, "Score": 70}, "FireEye": {"Detects": ["Telemetry"], "Screenshots": {"": "", "FE-1.A.1-2.png": "Telemetry showing the child cmd.exe process running the pdfhelper.cmd script"}, "Score": 10}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-01-1.png": "Telemetry showing Resume Viewer.exe execution (does not count as a detection)"}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-01-3.png": "Telemetry showing pdfhelper.cmd spawned as a child process of Resume Viewer.exe (tainted by parent Malicious File Detection alert)", "EG-01-9.png": "Telemetry showing cmd.exe process creation and execution of pdfhelper.cmd (tainted by parent Malicious File Detection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-1.A.1-4.png": "Telemetry showing cmd.exe running pdfhelper.cmd (tainted by the Script File Created alert)\u00a0"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-1.B.1-6.png": "Process tree within trace detection containing cmd.exe executing pdfhelper.cmd (tainted by a parent alert on Resume Viewer.exe)", "MC-1.B.1-5.png": "Telemetry showing pdfhelper.cmd execution"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-1.B.1-1.png": "Telemetry from process tree showing the child cmd.exe process running the script pdfhelper.cmd (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["General Behavior-Delayed", "Telemetry"], "Screenshots": {"": "", "CS-1.A.1-7.png": "Telemetry showing pdfhelper.cmd execution", "CS-1.A.1-5.png": "OverWatch General Behavior alert indicating pdfhelper.cmd execution was suspicious"}, "Score": 37}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-1.A.1-20.png": "Telemetry showing cmd.exe launching pdfhelper.cmd (tainted by parent alert on explorer.exe)", "": ""}, "Score": 7}, "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"CB-1.A.1-3.png": "Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script", "": "", "CB-1.A.1-1.png": "Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)"}, "Score": 25}}, "11.A.1": {"F-Secure": {"Detects": ["Telemetry", "Enrichment", "Specific Behavior"], "Screenshots": {"": "", "CC-11.A.1-5.png": "Specific Behavior alert for PowerShell executing a long, encoded command", "CC-11.A.1-3.png": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe", "CC-11.A.1-1.png": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code"}, "Score": 85}, "Microsoft": {"Detects": ["Telemetry", "Specific Behavior", "Specific Behavior-Delayed", "Specific Behavior"], "Screenshots": {"MS-11.A.1-8.png": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire", "MS-11.A.1-4.png": "Telemetry showing PowerShell script metadata and decoded command-line arguments", "MS-11.A.1-5.png": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\"", "MS-11.A.1-6.png": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content", "MS-11.A.1-7.png": "Specific Behavior alert for PowerShell script with malicious cmdlets", "MS-11.A.1-1.png": "Telemetry showing execution of autoupdate.vbs script", "MS-11.A.1-2.png": "Telemetry showing execution of wscript.exe", "MS-11.A.1-3.png": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"}, "Score": 187}, "PaloAltoNetworks": {"Detects": ["Specific Behavior", "Specific Behavior", "Specific Behavior", "Indicator of Compromise", "Indicator of Compromise", "Specific Behavior", "Telemetry-Tainted"], "Screenshots": {"PA-11.A.1-3.png": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)", "PA-11.A.1-2.png": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)", "PA-11.A.1-1.png": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)", "PA-11.A.1-7.png": "Specific Behavior alert for suspicious PowerShell activity", "PA-11.A.1-6.png": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)", "PA-11.A.1-5.png": "Specific Behavior alert for PowerShell execution with base64 encoded commands", "PA-11.A.1-4.png": "Indicator of Compromise alert identifying PowerShell Empire", "PA-11.A.1-8.png": "Indicator of Compromise alerts for suspicious PowerShell strings"}, "Score": 287}, "FireEye": {"Detects": ["Specific Behavior", "Enrichment", "Indicator of Compromise"], "Screenshots": {"": "", "FE-11.A.1-4.png": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)", "FE-11.A.1-1.png": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)", "FE-11.A.1-3.png": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage", "FE-11.A.1-2.png": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, "Score": 95}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-11-1.png": "Telemetry showing the autoupdate.vbs script executed by wscript.exe"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior", "Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "EG-11-1.png": "Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)", "EG-11-7.png": "Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)"}, "Score": 127}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-11.A.1-3.png": "Telemetry showing powershell.exe creation from wscript.exe (tainted by the parent Script File Created alert) ", "CT-11.A.1-2.png": "Telemetry showing script execution (tainted by the parent Script File Created alert) "}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior", "Specific Behavior", "Enrichment", "Enrichment", "Specific Behavior", "Specific Behavior"], "Screenshots": {"": "", "MC-11.A.1-5.png": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe", "MC-11.A.1-1.png": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, "Score": 277}, "SentinelOne": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "S1-11.A.1-1.png": "General Behavior alert for execution of autoupdate.vbs listed as an active threat", "S1-11.A.1-2.png": "Telemetry showing wscript.exe and powershell.exe "}, "Score": 40}, "CrowdStrike": {"Detects": ["Specific Behavior", "General Behavior-Delayed", "Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-E-6.png": "Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)", "": "", "CS-11.A.1-2.png": "General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious", "CS-11.A.1-1.png": "Specific Behavior alert for PowerShell sharing characteristics with known exploit kits"}, "Score": 154}, "Cybereason": {"Detects": ["Specific Behavior", "Telemetry-Tainted"], "Screenshots": {"": "", "CR-11.A.1-14.png": "Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell", "CR-11.A.1-13.png": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)", "CR-11.A.1-12.png": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)", "CR-11.A.1-11.png": "Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)"}, "Score": 67}, "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "CarbonBlack": {"Detects": ["Enrichment", "Telemetry", "Specific Behavior", "Specific Behavior"], "Screenshots": {"CB-11.A.1-1.png": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)", "": "", "CB-11.A.1-3.png": "Specific Behavior alerts for Powershell scripting", "CB-11.A.1-2.png": "Telemetry showing process tree of script execution"}, "Score": 145}}, "12.E.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MS-12.E.1-2.png": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum", "MS-12.E.1-1.png": "Telemetry showing powershell.exe execution sequence resulting from WinEnum", "MS-12.A.1-4.png": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process", "MS-12.E.1-5.png": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\"", "MS-12.E.1-4.png": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"}, "Score": 67}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted", "Indicator of Compromise"], "Screenshots": {"": "", "PA-12.E.1-1.png": "Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)", "PA-12.E.1-2.png": "Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)", "PA-12.E.1-3.png": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum"}, "Score": 84}, "FireEye": {"Detects": ["Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-12.E.1-1.png": "Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)"}, "Score": 72}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-12-3.png": "Telemetry showing a PowerShell script written to disk"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted"], "Screenshots": {"EG-12-3.png": "Specific Behavior alert for \\\"PowerShell with Unusual Arguments\\\" (tagged with correct ATT&CK Technique, T1086 - PowerShell, and Tactic, Execution; tainted by parent PowerShell alerts)", "": "", "EG-12-E-01.png": "Telemetry pulled by Interactive Shell showing the contents of the WinEnum script (does not count as a detection)", "EG-12-7.png": "Telemetry showing powershell.exe execution (ID 2397532) (tainted by parent PowerShell alerts)"}, "Score": 64}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-12.E.1.2-1.png": "Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper)"}, "Score": 10}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-12.E.1-4.png": "Telemetry showing the PowerShell script (.ps1) being written to the temp folder"}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.E.1-1.png": "Telemetry showing encoded PowerShell script (tainted Group ID not shown but was the search parameter)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry", "Specific Behavior-Delayed", "Specific Behavior-Delayed"], "Screenshots": {"CS-12.E.1-1.png": "Telemetry showing the temp write of the ps1 script", "": "", "CS-12.E.1-3.png": "Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)", "CS-12.E.1-4.png": "OverWatch Specific Behavior alert indicating the PowerShell script was malicious"}, "Score": 124}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted"], "Screenshots": {"": "", "CR-12.E.1-100.png": "Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)", "CR-12.E.1-2.png": "Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)", "CR-12.E.1-1.png": "Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function"}, "Score": 64}, "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-12.E.1-2.png": "Telemetry showing dynamically loaded libraries (modloads) that may indicate PowerShell functionality", "CB-12.E.1-1.png": "Telemetry showing powershell.exe execution"}, "Score": 10}}}, "TacticGroup": "Defense Evasion, Execution"}, "T1003": {"TechniqueName": "Credential Dumping", "Steps count": 2, "Steps": {"5.A.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["Enrichment-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "MS-5.A.2-2.png": "Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)", "MS-5.A.1-2.png": "Specific Behavior alert description for sensitive credential memory read", "MS-5.A.1-3.png": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe", "MS-5.A.1-1.png": "Process tree for sensitive credential memory read alert"}, "Score": 69}, "PaloAltoNetworks": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "PA-5.A.1-1.png": "A Specific Behavior alert for a suspicious handle being opened to lsass.exe to dump password, tagged with the correct ATT&CK Technique (Credential Dumping)"}, "Score": 60}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "EG-05-1.png": "Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)"}, "Score": 60}, "CounterTack": {"Detects": ["None"], "Screenshots": {"CT-5.A.1-1.png": "Alert showing DDNA Scan for svchost.exe (does not count as a detection)", "": "", "CT-5.A.1-3.png": "Alert showing additional DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)", "CT-5.A.1-2.png": "Alert showing DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)"}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Specific Behavior-Tainted", "Telemetry", "General Behavior-Delayed-Tainted"], "Screenshots": {"CS-5.A.1-6.png": "Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )", "": ""}, "Score": 91}, "Cybereason": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "CR-5.A.1-11.png": "Specific Behavior alert with correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection) with details about svchost.exe accessing lsass"}, "Score": 60}, "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-5.A.1-4.png": "Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)", "CB-5.A.1-1.png": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}, "Score": 70}}, "5.A.2": {"F-Secure": {"Detects": ["Enrichment"], "Screenshots": {"": "", "CC-5.A.2-1.png": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping"}, "Score": 15}, "Microsoft": {"Detects": ["Enrichment-Tainted"], "Screenshots": {"": "", "MS-5.A.2-2.png": "Alert for process injection into lsass.exe tainting this event (inner failure message in screenshot not relevant to tested functionality)", "MS-5.A.2-1.png": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"}, "Score": 12}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "PA-5.A.1-3.png": "Specific Behavior alert for svchost dumping credentials via the Registry tagged with the correct ATT&CK Technique (Credential Dumping)", "PA-5.A.1-2.png": "Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)"}, "Score": 67}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "EG-05-2.png": "Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)"}, "Score": 60}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-5.A.2-2.png": "Telemetry showing thread create to lsass.exe (tainted by the parent \\\"Powershell process created\\\" and \\\"Policy Remote Process Compromise\\\" alerts)", "": ""}, "Score": 7}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Specific Behavior-Tainted", "Specific Behavior-Tainted", "Telemetry", "General Behavior-Delayed-Tainted"], "Screenshots": {"": "", "CS-5.A.2-4.png": "Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )", "CS-5.A.2-1.png": "Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert"}, "Score": 148}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-5.A.2-10.png": "Parent alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection", "CR-5.A.2-20.png": "Telemetry showing svchost.exe process injection into lsass.exe (tainted by a parent injection alert)", "CR-5.A.2-11.png": "Telemetry within alert showing loaded hashdumpx64.dll as floating executable code"}, "Score": 7}, "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-5.A.2-2.png": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}, "Score": 10}}}, "TacticGroup": "Credential Access"}, "T1041": {"TechniqueName": "Exfiltration Over Command and Control Channel", "Steps count": 1, "Steps": {"9.B.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["None"], "Screenshots": {"": "", "PA-9.B.1-2.png": "Port 53 network traffic to/from freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)"}, "Score": 0}, "FireEye": {"Detects": ["None"], "Screenshots": {"": "", "FE-9.B.1-1.png": "DNS requests to freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)"}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": "", "CR-9.B.1-20.png": "Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)"}, "Score": 0}, "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Exfiltration"}, "T1060": {"TechniqueName": "Registry Run Keys / Startup Folder", "Steps count": 2, "Steps": {"10.A.1": {"F-Secure": {"Detects": ["Specific Behavior", "Telemetry"], "Screenshots": {"": "", "CC-10.A.1-2.png": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder", "CC-10.A.1-1.png": "Specific Behavior alert for a batch file automatically being started from the Startup folder."}, "Score": 70}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"MS-10.A.1-1.png": "Telemetry showing Startup folder execution sequence for autoupdate.bat on user logon", "": ""}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-10.A.1-1.png": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder"}, "Score": 10}, "FireEye": {"Detects": ["Enrichment", "Telemetry", "Telemetry-Tainted", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-10.A.1-1.png": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)", "FE-10.A.1-2.png": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder", "FE-10.A.1-3.png": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)", "FE-10.A.1-4.png": "Additional details of rundll32.exe telemetry", "FE-10.A.1-5.png": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}, "Score": 89}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-10-1.png": "Telemetry showing the execution of autoupdate.bat from the Startup Folder"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"EG-10-5.png": "Telemetry showing rundll32.exe executing update.dat (tainted by parent \\\"RunDLL32 with Suspicious DLL Location\\\" alert)", "": ""}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"CT-10.A.1-2.png": "Telemetry showing cmd.exe starting rundll32.exe", "CT-10.A.1-3.png": "Telemetry showing explorer.exe creating cmd.exe and executing .bat from startup\u00a0", "": ""}, "Score": 10}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"MC-10.A.1-1.png": "Telemetry showing cmd.exe executing autoupdate.bat then update.dat via rundll32.exe", "": ""}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": "", "S1-10.A.1-3.png": "Group ID query showing both autoupdate.bat and updater.dll persistence execution", "S1-10.A.1-2.png": "Telemetry showing execution of autoupdate.bat from the Startup folder"}, "Score": 10}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-10.A.1-1.png": "Telemetry showing cmd.exe running autoupdate.bat from Startup folder"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CR-10.A.1-10.png": "Parent alert for Injected shellcode into rundll32.exe", "": "", "CR-10.A.1-100.png": "Telemetry showing rundll32.exe executing autoupdate.bat from the Startup folder (tainted by a parent Injected Shellcode alert)"}, "Score": 7}, "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-10.A.1-1.png": "Telemetry from process tree showing cmd.exe executing autoupdate.bat from Startup folder"}, "Score": 10}}, "1.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-1.B.1-T1060-new.png": "Telemetry showing the autoupdate.bat within the Startup folder"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-1.B.1-1.png": "Telemetry showing write of autoupdate.bat to startup folder"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted-Configuration Change"], "Screenshots": {"": "", "PA-1.B.1-2.png": "Enrichment of a file being created in the Startup folder tagged with the correct ATT&CK Technique (Registry Run Keys / Start Folder) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-1.B.1-1.png": "Telemetry showing autoupdate.bat being moved to the user Debbie's Startup folder (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 16}, "FireEye": {"Detects": ["Telemetry", "Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-1.B.1-1.png": "Telemetry showing autoupdate.bat file written to the Startup folder", "FE-1.B.1-2.png": "Enrichment of autoupdate.bat being written to Startup with Persistence category", "FE-1.B.1-3.png": "Additional details on enrichment of autoupdate.dat", "FE-1.B.1-4.png": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)"}, "Score": 82}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-01-1.png": "Telemetry showing cmd.exe \\\"rename to executable\\\" event for autoupdate.bat in Startup folder"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted"], "Screenshots": {"EG-01-7.png": "\\\"Detected Persistence - Start Folder Persistence\\\" Specific Behavior alert related to autoupdate.bat (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Start Folder, and Tactic, Persistence; tainted by cmd.exe generating the alert)", "": "", "EG-01-8.png": "Telemetry showing autoupdate.bat written to the Start Menu (tainted by parent Malicious File Detection alert)"}, "Score": 64}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-1.B.1-1.png": "Telemetry showing autoupdate.bat created in Startup folder"}, "Score": 10}, "McAfee": {"Detects": ["Specific Behavior"], "Screenshots": {"": "", "MC-1.B.1-1.png": "Specific Behavior alert for \"An exe/bat/lnk/dll file has been copied or renamed in the Windows Startup Folder\" for persistence based on pdfhelper.cmd, tagged with the correct ATT&CK Tactic (Persistence) and Technique (Registry Run Keys / Start Folder)"}, "Score": 60}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-1.B.1-1.png": "Telemetry showing autoupdate.bat write to the Startup folder (tainted by relationship to threat story)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-1.B.1-1.png": "Telemetry showing Registry modification related to Startup Folder"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-1.B.1-100.png": "Process tree showing the cmd.exe associated with the autoupdate.bat file event (tainted by parent alert on explorer.exe)", "CR-1.B.1-10.png": "Telemetry showing rename file event for autoupdate.bat"}, "Score": 7}, "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-1.B.1-1.png": "Telemetry showing filemods indicating update.bat was written to the Startup folder", "CB-1.B.1-2.png": "Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)"}, "Score": 25}}}, "TacticGroup": "Persistence"}, "T1061": {"TechniqueName": "Graphical User Interface", "Steps count": 1, "Steps": {"7.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-7.A.1-T1061-new.png": "Telemetry showing mmc.exe running lursmgr.msc"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MS-7.A.1-2.png": "Telemetry showing mmc.exe running lusrmgr.msc"}, "Score": 10}, "PaloAltoNetworks": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "PA-7.A.1-2.png": "Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface)", "PA-7.A.1-1.png": "Telemetry showing lusrmgr.msc running from mmc.exe "}, "Score": 25}, "FireEye": {"Detects": ["Telemetry"], "Screenshots": {"": "", "FE-7.A.1-3.png": "Telemetry showing mmc.exe spawning lusrmgr.exe "}, "Score": 10}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["Telemetry"], "Screenshots": {"EG-07-5.png": "Telemetry showing mmc.exe running lursmgr.msc", "": ""}, "Score": 10}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-7.A.1-3.png": "Telemetry showing mmc.exe process executing lusrmgr.msc (tainted by the parent \\\"LSA Registry Key modified\\\" alert) "}, "Score": 7}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-7.A.1-2.png": "Telemetry showing mmc.exe running lusrmgr.msc"}, "Score": 10}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-6.C.1-4.png": "Telemetry showing mmc.exe running lursmgr.msc"}, "Score": 10}, "Cybereason": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CR-7.A.1-30.png": "Telemetry showing lusrmgr.msc running from mmc.exe"}, "Score": 10}, "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-7.A.1-3.png": "Telemetry showing mmc.exe running lusrmgr.msc"}, "Score": 10}}}, "TacticGroup": "Execution"}, "T1048": {"TechniqueName": "Exfiltration Over Alternative Protocol", "Steps count": 1, "Steps": {"19.C.1": {"F-Secure": {"Detects": ["Specific Behavior", "Telemetry"], "Screenshots": {"": "", "CC-19.C.1-1.png": "A Specific Behavior alert for the execution of ftp.exe with a command file option by an unusual parent process and could be used for exfiltration", "CC-19.C.1-2.png": "Telemetry showing ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21"}, "Score": 70}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"MS-19.C.1-2.png": "Telemetry showing powreshell.exe running ftp.exe and the subsequent connection to 192.168.0.4 (C2 server) on port 21", "": "", "MS-19.C.1-1.png": "Telemetry showing powreshell.exe running ftp.exe and the subsequent connection to 192.168.0.4 (C2 server) on port 20", "MS-19.A.1-3.png": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted"], "Screenshots": {"": "", "PA-19.C.1-1.png": "Telemetry showing ftp.exe execution (tainted by a parent alert on wscript.exe)", "PA-19.C.1-3.png": "Enrichment of ftp.exe as the execution of a CLI file transfer/copy utility (tainted by a parent alert on wscript.exe)", "PA-19.C.1-2.png": "Telemetry showing an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21 (tainted by a parent alert on wscript.exe)"}, "Score": 19}, "FireEye": {"Detects": ["Enrichment", "Enrichment", "Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-19.C.1-3.png": "Enrichment of ftp.exe executing the ftp.txt file with FTP Utility Execution alert (tagged with the correct ATT&CK Software, S0095 - FTP)", "": "", "FE-19.C.1-6.png": "Excerpt from the Managed Defense Report showing the writing of FTP command to ftp.txt and the subsequent execution of the ftp.txt file (Specific Behavior)", "FE-19.C.1-5.png": "Enrichment of TCP port 21 connection to 192.168.0.4 (C2 server) (tagged with correct ATT&CK Technique, T1048 - Exfiltration Over Alternative Protocol and, Tactic, Exfiltration)", "FE-19.C.1-4.png": "Enrichment of ftp.exe executing ftp.exe based on the use of the -s argument with FTP Utility Execution alert"}, "Score": 102}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-19-2.png": "Telemetry showing the execution ftp.exe"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-19-2.png": "Telemetry showing the ftp.exe with command-line arguments including ftp.txt and subsequent connection to 192.168.0.4 (C2 server) on port 21"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CT-19.C.1-1.png": "Telemetry showing powershell.exe executing ftp.exe (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)", "": "", "CT-19.C.1-2.png": "Telemetry showing outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21 (tainted by the parent \\\"PowerShell executed encoded commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Enrichment"], "Screenshots": {"MC-19.C.1-2.png": "Enrichment of powershell.exe executing ftp.exe with the correct ATT&CK Tactic (Exfiltration) and Technique (Exfiltration over Alternative Protocol) and a suspicious indicator that a connection was made to a remove server via the ftp protocol", "": "", "MC-19.C.1-1.png": "Telemetry showing cmd.exe executing ftp.exe, which made an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21 (tainted by a trace detection on cmd.exe)"}, "Score": 22}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-19.C.1-1.png": "Telemetry showing the execution of ftp.exe with ftp.txt associated to prior lateral movement threat story by Group ID"}, "Score": 7}, "CrowdStrike": {"Detects": ["General Behavior-Delayed-Tainted", "Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed the collected files being exfiltrated via FTP (Specific Behavior)", "CS-19.C.1-1.png": "OverWatch General Behavior alert indicating ftp.exe executing with ftp.txt was suspicious (tainted by previous powershell.exe detection by red line indicating high severity)", "": ""}, "Score": 91}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-19.C.1-11.png": "Enrichment of ftp.exe execution with related ATT&CK Tactic (Command\u00a0and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol) (tainted by a parent PowerShell alert)", "CR-19.C.1-10.png": "Enrichment of ftp.exe execution in process tree with related ATT&CK Tactic (Command\u00a0and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol) (tainted by a parent PowerShell alert)", "CR-19.C.1-13.png": "Continuation of\u00a0enrichment of\u00a0ftp.exe execution in process tree showing command-line arguments", "CR-19.C.1-12.png": "Continuation of\u00a0enrichment of ftp.exe execution showing total number of bytes transmitted"}, "Score": 22}, "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-19.C.1-2.png": "Enrichment of ftp.exe with correct ATT&CK Technique (Exfil Over Alternate Protocol)", "CB-19.C.1-1.png": "Telemetry from process tree showing execution of ftp.exe with command-line arguments"}, "Score": 25}}}, "TacticGroup": "Exfiltration"}, "T1063": {"TechniqueName": "Security Software Discovery", "Steps count": 2, "Steps": {"12.E.1.10.2": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Enrichment"], "Screenshots": {"": "", "PA-12.E.1.10-1.png": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery)"}, "Score": 15}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-09.png": "Interactive Shell events showing the WinEnum script and the Firewall Rules function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}, "12.E.1.10.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, "Score": 10}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-12.E.1.10-2.png": "Telemetry showing an event log for the WMI query of the system AV products"}, "Score": 10}, "FireEye": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": "", "EG-12-E-08.png": "Interactive Shell events showing the WinEnum script and the AV Solution function (does not count as a detection due to manual process of pulling events)"}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted"], "Screenshots": {"": "", "S1-12.E.1-3.png": "Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)", "S1-12.E.1-2.png": "Enrichment of powershell.exe with action \\\"attempted to find other installed security software\\\" (tainted Group ID not shown but was the search parameter)"}, "Score": 19}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Cybereason": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "CarbonBlack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}}}, "TacticGroup": "Discovery"}, "T1002": {"TechniqueName": "Data Compressed", "Steps count": 1, "Steps": {"19.B.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "CC-19.C.1-1.png": "General Behavior alert showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-19.B.1-5.png": "Telemetry showing the creation of old.rar as the output of recycler.exe running", "CC-19.B.1-4.png": "Telemetry showing recycler.exe execution"}, "Score": 40}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-19.B.1-1.png": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression", "MS-19.A.1-3.png": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-19.B.1-1.png": "Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)"}, "Score": 7}, "FireEye": {"Detects": ["General Behavior", "Enrichment", "Enrichment", "General Behavior", "Enrichment", "Specific Behavior-Delayed"], "Screenshots": {"FE-19.B.1-2.png": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed)", "FE-19.B.1-3.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.B.1-1.png": "General Behavior alert for Execution from Suspicious Directory", "FE-19.B.1-4.png": "General Behavior alert for File Write To Root Of Recycle Bin", "FE-19.B.1-5.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)", "": ""}, "Score": 162}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-19-1.png": "Telemetry showing execution of recycler.exe with command-line arguments"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior-Tainted", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-19-1.png": "Enriched event tree showing enrichment of recycler.exe and creation of old.rar output with related ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration) (tainted by Windows Script Executing PowerShell alert, tree is initially available unenriched to show the base telemetry)", "EG-19-4.png": "Specific Behavior alert for the execution of recycler.exe named \\\"Exfiltration-Encrypting Files with WinRar\\\" (tainted by Windows Script Executing PowerShell alert)"}, "Score": 73}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change", "Telemetry-Tainted"], "Screenshots": {"": "", "CT-19.B.1-1.png": "Enrichment showing recycler.exe creating old.rar (enriched with \\\"Data Exfiltration Archiving\\\", tainted by parent \\\"Powershell executed encoded command\\\" alerts)", "CT-19.B.1-3.png": "Telemetry showing recycler.exe with full command-line (tainted by parent \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts)"}, "Score": 16}, "McAfee": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MC-19.A.1-2.png": "Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)", "MC-19.A.1-3.png": "Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)"}, "Score": 7}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-19.A.1-2.png": "Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID", "S1-19.B.1-1.png": "Telemetry showing the execution of recycler.exe"}, "Score": 7}, "CrowdStrike": {"Detects": ["Specific Behavior-Tainted", "Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"CS-19.B.1-1.png": "Specific Behavior alert on RAR archive written (mapped to correct ATT&CK Technique, Data Compressed, and Tactic, Exfiltration; tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)", "CS-19.B.1-3.png": "Additional details of recycler.exe from the alert showing it was signed by win.rar GmbH", "": ""}, "Score": 124}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-19.B.1-10.png": "Telemetry showing recycler.exe execution\u00a0(tainted by a parent PowerShell alert)"}, "Score": 7}, "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-19.B.1-2.png": "Enrichment of recycler.exe with correct ATT&CK Technique (1002 - Data Compressed)", "CB-19.B.1-3.png": "Process tree with telemetry showing recycler.exe and command-line arguments", "CB-19.B.1-1.png": "Telemetry showing filemod (file modification) creation of old.rar output of recycler.exe"}, "Score": 25}}}, "TacticGroup": "Exfiltration"}, "T1043": {"TechniqueName": "Commonly Used Port", "Steps count": 4, "Steps": {"6.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-6.B.1-T1043-new.png": "Telemetry showing network connections over port 80 to 192.168.0.4 (C2 server)"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-6.B.1-1.png": "Telemetry showing execution sequence for rundll32.exe opening network connection", "MS-6.B.1-2.png": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"PA-6.B.1-1.png": "Telemetry showing port 80 command and control traffic", "": ""}, "Score": 10}, "FireEye": {"Detects": ["Telemetry", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-6.B.1-4.png": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)", "FE-6.B.1-1.png": "Telemetry showing port 80 connections to 192.168.0.4 (C2 server)"}, "Score": 37}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-06-2.png": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)"}, "Score": 10}, "Endgame": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "EG-06-2.png": "Telemetry showing a TCP port 80 connection from rundll32.exe", "EG-06-7.png": "Telemetry showing port 80 traffic (tainted by the parent\u00a0Malicious File Detection alert)"}, "Score": 7}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-6.B.1-1.png": "Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by parent \\\"Sponsor Process Established Network Connection\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "MC-6.B.1-2.png": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)", "MC-6.C.1-2.png": "Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port)"}, "Score": 25}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-6.B.1-1.png": "Telemetry showing port 80 connection to 192.168.0.4 (C2 server) (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-6.C.1-1.png": "Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)"}, "Score": 10}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted"], "Screenshots": {"CR-6.B.1-20.png": "Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)", "CR-6.B.1-10.png": "Enrichment of rundll32.exe making a connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)", "": ""}, "Score": 19}, "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "CarbonBlack": {"Detects": ["Telemetry", "Enrichment"], "Screenshots": {"": "", "CB-6.B.1-2.png": "Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)", "CB-6.B.1-4.png": "Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)"}, "Score": 25}}, "1.C.1": {"F-Secure": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Microsoft": {"Detects": ["None"], "Screenshots": {"": "", "MS-1.C.1-1.png": "Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)"}, "Score": 0}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted"], "Screenshots": {"": "", "PA-1.C.1-2.png": "Specific Behavior alert for a scripting engine (rundll32.exe) making a network connection over DNS ports (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)", "PA-1.C.1-1.png": "Telemetry showing port 53 command and control traffic (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, "Score": 64}, "FireEye": {"Detects": ["Telemetry", "Specific Behavior-Delayed"], "Screenshots": {"FE-1.C.1-1.png": "Telemetry showing port 53 command and control traffic", "": "", "FE-1.C.1-4.png": "Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)"}, "Score": 67}, "RSA": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "Endgame": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CounterTack": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "McAfee": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "SentinelOne": {"Detects": ["None"], "Screenshots": {"": ""}, "Score": 0}, "CrowdStrike": {"Detects": ["None"], "Screenshots": {"": "", "CS-1.C.1-1.png": "OverWatch alert showing suspicious DNS traffic (does not count as a detection)"}, "Score": 0}, "Cybereason": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CR-1.C.1-10.png": "Telemetry showing port 53 command and control traffic"}, "Score": 10}, "Procedure": "Cobalt Strike: C2 channel established using port 53", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"CB-6.B.1-3.png": "Telemetry showing network connection over UDP port 53", "": ""}, "Score": 10}}, "14.A.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-14.A.1-2.png": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-14.A.1-4.png": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments", "MS-14.A.1-3.png": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-14.A.1-4.png": "Telemetry showing an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080"}, "Score": 10}, "FireEye": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"FE-14.A.1-4.png": "Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)", "": "", "FE-14.A.1-9.png": "Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)", "FE-11.B.1-4.png": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)"}, "Score": 34}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-14-1.png": "Telemetry of decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)", "RSA-14-2.png": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"}, "Score": 10}, "Endgame": {"Detects": ["General Behavior", "Telemetry"], "Screenshots": {"EG-14-1.png": "Telemetry showing decoded PowerShell with download request of wdbypass over port 8080", "": "", "EG-14-3.png": "General Behavior alert for Command and Control associated with network traffic from PowerShell over TCP port 8080"}, "Score": 40}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-14.A.1-2.png": "Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry"], "Screenshots": {"": "", "MC-14.A.1-4.png": "Telemetry showing a network connection to 192.168.0.5 (C2 server) over TCP port 8080"}, "Score": 10}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-14.A.1-2.png": "Telemetry showing network connections over port 8080 in the filter (tainted by relationship to threat story but Group ID not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CS-14.A.1-5.png": "Telemetry showing IEX connection over to 192.168.0.5 (C2 server) on TCP port 8080"}, "Score": 10}, "Cybereason": {"Detects": ["Specific Behavior-Tainted", "Telemetry"], "Screenshots": {"": "", "CR-14.A.1-40.png": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080", "CR-14.A.1-30.png": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)"}, "Score": 67}, "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "CarbonBlack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CB-14.A.1-3.png": "Telemetry showing network connection to 192.168.0.5 (C2 server) over TCP port 8080"}, "Score": 10}}, "11.B.1": {"F-Secure": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CC-11.A.1-4.png": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)"}, "Score": 10}, "Microsoft": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "MS-11.B.1-1.png": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)", "MS-11.A.1-9.png": "Telemetry showing powershell.exe communicating over TCP port 443", "MS-11.B.1-4.png": "Telemetry within alert showing decoded command-line arguments containing port 443\u00a0and tainted relationship to the powershell.exe process"}, "Score": 7}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted", "Enrichment-Tainted", "General Behavior-Tainted"], "Screenshots": {"PA-11.A.1-3.png": "Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)", "": "", "PA-11.B.1-1.png": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)", "PA-11.B.1-2.png": "General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)"}, "Score": 46}, "FireEye": {"Detects": ["Telemetry-Tainted", "General Behavior-Delayed"], "Screenshots": {"": "", "FE-11.B.1-3.png": "Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)", "FE-11.B.1-1.png": "Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)", "FE-11.B.1-4.png": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)"}, "Score": 34}, "RSA": {"Detects": ["None"], "Screenshots": {"": "", "RSA-11-2.png": "Telemetry showing network connections, including over port 443 (does not count as a detection)"}, "Score": 0}, "Endgame": {"Detects": ["Telemetry-Tainted", "Specific Behavior-Tainted"], "Screenshots": {"": "", "EG-11-2.png": "Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert) ", "EG-11-3.png": "Telemetry showing powershell.exe making connections over port 443 (tainted by parent alert) ", "EG-11-5.png": "Specific Behavior alert for \\\"PowerShell Making Network Connections\\\" (mapped to correct ATT&CK Tactic, Command and Control)", "EG-11-6.png": "Event tree view of Specific Behavior alert for \\\"Command and Control PowerShell Network\\\"(tainted by parent alert)"}, "Score": 64}, "CounterTack": {"Detects": ["Telemetry"], "Screenshots": {"": "", "CT-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over TCP port 443"}, "Score": 10}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior", "Enrichment"], "Screenshots": {"": "", "MC-11.A.1-5.png": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port", "MC-11.B.1-4.png": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe) "}, "Score": 82}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-11.B.1-1.png": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (Group ID tainted the event but was not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CS-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over port 443 (tainted by parent powershell.exe high severity alert indicated by red icon)", "": ""}, "Score": 7}, "Cybereason": {"Detects": ["Enrichment-Tainted", "Telemetry-Tainted"], "Screenshots": {"": "", "CR-11.B.1-100.png": "Enrichment of powershell.exe making a connection over a \u201dHTTP Port,\" tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)", "CR-11.B.1-11.png": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)", "CR-11.A.1-13.png": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, "Score": 19}, "Procedure": "Empire: C2 channel established using port 443", "CarbonBlack": {"Detects": ["Enrichment", "Telemetry"], "Screenshots": {"CB-11.A.1-1.png": "Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)", "": "", "CB-11.B.1-1.png": "Telemetry showing network connections, including over TCP port 443"}, "Score": 25}}}, "TacticGroup": "Command and Control"}, "T1015": {"TechniqueName": "Accessibility Features", "Steps count": 2, "Steps": {"17.C.1": {"F-Secure": {"Detects": ["Specific Behavior", "Telemetry", "Enrichment"], "Screenshots": {"": "", "CC-17.B.2-1.png": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command", "CC-17.A.1-2.png": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation"}, "Score": 85}, "Microsoft": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "MS-17.C.1-1.png": "Telemetry showing overwrite of magnify.exe", "MS-17.C.1-2.png": "Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash", "MS-17.C.1-3.png": "Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten"}, "Score": 70}, "PaloAltoNetworks": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "PA-17.C.1-2.png": "Telemetry showing change in the hash of magnify.exe", "PA-17.C.1-1.png": "Telemetry showing file write events overwriting magnify.exe in the system directory (tainted by a parent alert on cmd.exe)"}, "Score": 7}, "FireEye": {"Detects": ["Specific Behavior", "Specific Behavior", "Specific Behavior-Delayed"], "Screenshots": {"FE-17.C.1-1.png": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)", "": "", "FE-17.C.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)", "FE-17.C.1-2.png": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, "Score": 177}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-17-2.png": "Magnify.exe hash matches cmd.exe (top two hashes in Tracking pane, file names and full hash values cut off)", "RSA-17-1.png": "Telemetry showing file write to magnify.exe in the system directory"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"EG-17-2.png": "Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)", "": "", "EG-17-1.png": "Specific Behavior alert on overwrite of magnify.exe named \\\"Persistence-Accessibility Features\\\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)"}, "Score": 76}, "CounterTack": {"Detects": ["Enrichment-Tainted-Configuration Change", "Telemetry-Tainted"], "Screenshots": {"": "", "CT-17.C.1-2.png": "Telemetry showing copy of cmd.exe to magnify.exe in the system directory (tainted by the parent \\\"New Windows service created\\\" alert)", "CT-17.C.1-1.png": "Enrichment showing powershell.exe creating and writing magnify.exe (enriched with condition \\\"Creation of Sticky Keys File\\\", tainted by the parent \\\"New Windows service created\\\" alert)"}, "Score": 16}, "McAfee": {"Detects": ["Telemetry", "General Behavior"], "Screenshots": {"": "", "MC-17.C.1-1.png": "Telemetry showing a file modification event for Magnifier.exe", "MC-17.A.1-9.png": "A General Behavior alert for powershell.exe altering the attributes of an executable file under the Windows system folder"}, "Score": 40}, "SentinelOne": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "S1-17.C.1-1.png": "Telemetry showing file copy and write events of cmd.exe to overwrite magnify.exe with matching hash values (tainted by prior lateral movement threat story; Group ID not shown in this view)"}, "Score": 7}, "CrowdStrike": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"CS-17.C.1-2.png": "Additional view of telemetry showing the magnify.exe file write", "": "", "CS-17.C.1-1.png": "Telemetry showing file write of magnify.exe by powershell.exe (tainted by parent powershell.exe high severity alert indicated by red icon)"}, "Score": 7}, "Cybereason": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CR-17.C.1-10.png": "Telemetry showing creation and write events for magnify.exe (tainted by a parent PowerShell alert, listed as Owner process)"}, "Score": 7}, "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "CB-17.A.1-2.png": "Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)", "CB-17.C.1-1.png": "Telemetry showing creation and file write replacing magnify.exe in the system directory"}, "Score": 70}}, "20.A.1": {"F-Secure": {"Detects": ["Telemetry", "General Behavior", "Enrichment"], "Screenshots": {"": "", "CC-20.A.1-7.png": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor", "CC-20.A.1-4.png": "General Behavior alert for magnify.exe executing as a process with a renamed executable", "CC-20.A.1-3.png": "Telemetry showing me magnify.exe executing from utilman.exe"}, "Score": 55}, "Microsoft": {"Detects": ["Telemetry", "Specific Behavior"], "Screenshots": {"": "", "MS-20.A.1-1.png": "Telemetry showing sequence of magnify.exe executing from utilman.exe", "MS-20.A.1-4.png": "Specific Behavior alert on sticky keys binary hijack of magnify.exe"}, "Score": 70}, "PaloAltoNetworks": {"Detects": ["Telemetry"], "Screenshots": {"": "", "PA-20.A.1-1.png": "Telemetry showing magnify.exe executing from utilman.exe"}, "Score": 10}, "FireEye": {"Detects": ["General Behavior", "Specific Behavior", "Specific Behavior-Delayed"], "Screenshots": {"": "", "FE-20.A.1-3.png": "General Behavior alert for RENAMED CMD.EXE", "FE-20.A.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)", "FE-20.A.1-5.png": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)", "FE-20.A.1-4.png": "Continued details for General Behavior alert for RENAMED CMD.EXE"}, "Score": 147}, "RSA": {"Detects": ["Telemetry"], "Screenshots": {"": "", "RSA-20-1.png": "Telemetry showing magnify.exe execution"}, "Score": 10}, "Endgame": {"Detects": ["Specific Behavior", "Telemetry-Tainted", "Enrichment-Delayed-Tainted"], "Screenshots": {"": "", "EG-20-1.png": "Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)", "EG-20-2.png": "Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)"}, "Score": 76}, "CounterTack": {"Detects": ["Telemetry-Tainted"], "Screenshots": {"": "", "CT-20.B.1-1.png": "Telemetry showing magnify.exe (tainted by the parent POS Interactive Login Event alert)"}, "Score": 7}, "McAfee": {"Detects": ["Telemetry-Tainted", "Specific Behavior"], "Screenshots": {"": "", "MC-20.A.1-2.png": "Telemetry showing magnify.exe (original name identified as cmd.exe) executing from utilman.exe (tainted by a trace detection on magnify.exe)", "MC-20.A.1-3.png": "Specific Behavior alert for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features)"}, "Score": 67}, "SentinelOne": {"Detects": ["Telemetry"], "Screenshots": {"": "", "S1-20.B.1-1.png": "Telemetry showing magnify.exe execution (identified as Windows Command Processor)"}, "Score": 10}, "CrowdStrike": {"Detects": ["Specific Behavior", "Telemetry", "General Behavior-Delayed"], "Screenshots": {"CS-E-12.png": "Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)", "": "", "CS-20.A.1-2.png": "File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name", "CS-20.A.1-1.png": "Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)"}, "Score": 97}, "Cybereason": {"Detects": ["Specific Behavior", "Telemetry"], "Screenshots": {"": "", "CR-20.A.1-11.png": "Specific Behavior alert for magnify.exe, in process tree,\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)", "CR-20.A.1-10.png": "Specific Behavior alert for magnify.exe\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}, "Score": 70}, "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "CarbonBlack": {"Detects": ["Telemetry", "Specific Behavior", "General Behavior", "General Behavior"], "Screenshots": {"CB-20.B.1-2.png": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores", "": "", "CB-20.B.1-1.png": "Telemetry from process tree telemetry showing magnify.exe execution"}, "Score": 130}}}, "TacticGroup": "Persistence, Privilege Escalation"}}